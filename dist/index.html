<!doctype html><html lang="zh-CN"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>MCæˆ¿å­</title><script type="module">import{createPinia as e,defineStore as t,storeToRefs as a}from'https://testingcf.jsdelivr.net/npm/pinia/+esm';var n={502(e,t){t.A=(e,t)=>{const a=e.__vccOpts||e;for(const[e,n]of t)a[e]=n;return a}}},o={};const l=Vue,s={class:'top-bar'},r={class:'top-bar-left'},c={class:'player-card'},i={class:'player-info'},d={class:'player-name'},u={class:'player-role'},m={class:'top-bar-center'},p={class:'datetime-group'},v={class:'date-item'},f={class:'item-value'},g={class:'time-item'},h={class:'location-item'},y={class:'item-value location-text'},V={class:'top-bar-right'},N=['title'],E={class:'action-buttons'},k=['title'],b={class:'btn-icon'},C=['title'],w={class:'btn-icon'},S=(0,l.defineComponent)({__name:'TopBar',props:{connectionStatus:{default:'connected'},isFullscreen:{type:Boolean,default:!1},isDarkTheme:{type:Boolean,default:!1},gameDate:{default:''},gamePeriod:{default:''},gameLocation:{default:''},playerName:{default:''},playerPosition:{default:''},playerDepartment:{default:''}},emits:['toggle-fullscreen','toggle-theme'],setup(e){const t=e,a=(0,l.computed)(()=>{switch(t.connectionStatus){case'connected':return'åœ¨çº¿';case'connecting':return'è¿æ¥ä¸­...';case'disconnected':return'ç¦»çº¿';default:return'æœªçŸ¥'}}),n=(0,l.computed)(()=>t.playerName||'æœªç™»å½•'),o=(0,l.computed)(()=>t.playerPosition&&t.playerDepartment?`${t.playerDepartment}Â·${t.playerPosition}`:t.playerPosition?t.playerPosition:t.playerDepartment?t.playerDepartment:'ç­‰å¾…åˆ†é…'),S=(0,l.computed)(()=>t.gameDate||'ç­‰å¾…æ•°æ®...'),B=(0,l.computed)(()=>t.gamePeriod||'--:--'),I=(0,l.computed)(()=>t.gameLocation||'æœªçŸ¥åœ°ç‚¹'),M=(0,l.computed)(()=>{const e=(t.gamePeriod||'').match(/^(\d{1,2}):(\d{2})$/);if(!e)return'period-default';const a=parseInt(e[1],10);return a>=6&&a<12?'period-morning':a>=12&&a<14?'period-noon':a>=14&&a<18?'period-afternoon':a>=18&&a<21?'period-evening':'period-night'});return(t,A)=>((0,l.openBlock)(),(0,l.createElementBlock)('header',s,[(0,l.createCommentVNode)(' å·¦ä¾§ï¼šç©å®¶ä¿¡æ¯ '),(0,l.createElementVNode)('div',r,[(0,l.createCommentVNode)(' ç©å®¶ä¿¡æ¯å¡ç‰‡ '),(0,l.createElementVNode)('div',c,[A[2]||(A[2]=(0,l.createElementVNode)('div',{class:'player-avatar'},[(0,l.createElementVNode)('span',{class:'avatar-icon'},'ğŸ‘¤')],-1)),(0,l.createElementVNode)('div',i,[(0,l.createElementVNode)('span',d,(0,l.toDisplayString)(n.value),1),(0,l.createElementVNode)('span',u,(0,l.toDisplayString)(o.value),1)])])]),(0,l.createCommentVNode)(' ä¸­é—´ï¼šæ¸¸æˆçŠ¶æ€ï¼ˆæ—¥æœŸæ—¶é—´ + åœ°ç‚¹ï¼‰ '),(0,l.createElementVNode)('div',m,[(0,l.createCommentVNode)(' æ—¥æœŸæ—¶é—´ç»„åˆæ˜¾ç¤º '),(0,l.createElementVNode)('div',p,[(0,l.createElementVNode)('div',v,[A[3]||(A[3]=(0,l.createElementVNode)('span',{class:'item-icon'},'ğŸ“…',-1)),(0,l.createElementVNode)('span',f,(0,l.toDisplayString)(S.value),1)]),(0,l.createElementVNode)('div',g,[(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(['period-badge',M.value])},(0,l.toDisplayString)(B.value),3)])]),(0,l.createCommentVNode)(' åœ°ç‚¹æ˜¾ç¤º '),(0,l.createElementVNode)('div',h,[A[4]||(A[4]=(0,l.createElementVNode)('span',{class:'item-icon'},'ğŸ“',-1)),(0,l.createElementVNode)('span',y,(0,l.toDisplayString)(I.value),1)])]),(0,l.createCommentVNode)(' å³ä¾§ï¼šçŠ¶æ€æŒ‡ç¤º + åŠŸèƒ½æŒ‰é’® '),(0,l.createElementVNode)('div',V,[(0,l.createCommentVNode)(' è¿æ¥çŠ¶æ€æŒ‡ç¤ºå™¨ '),(0,l.createElementVNode)('div',{class:(0,l.normalizeClass)(['connection-indicator',e.connectionStatus]),title:a.value},[...A[5]||(A[5]=[(0,l.createElementVNode)('span',{class:'status-dot'},null,-1)])],10,N),(0,l.createCommentVNode)(' åŠŸèƒ½æŒ‰é’®ç»„ '),(0,l.createElementVNode)('div',E,[(0,l.createElementVNode)('button',{class:'action-btn',title:e.isDarkTheme?'åˆ‡æ¢åˆ°æµ…è‰²æ¨¡å¼':'åˆ‡æ¢åˆ°æ·±è‰²æ¨¡å¼',onClick:A[0]||(A[0]=e=>t.$emit('toggle-theme'))},[(0,l.createElementVNode)('span',b,(0,l.toDisplayString)(e.isDarkTheme?'â˜€ï¸':'ğŸŒ™'),1)],8,k),(0,l.createElementVNode)('button',{class:'action-btn',title:e.isFullscreen?'é€€å‡ºå…¨å±':'å…¨å±æ˜¾ç¤º',onClick:A[1]||(A[1]=e=>t.$emit('toggle-fullscreen'))},[(0,l.createElementVNode)('span',w,(0,l.toDisplayString)(e.isFullscreen?'â¬œ':'â›¶'),1)],8,C)])])]))}});var B=function e(t){var a=o[t];if(void 0!==a)return a.exports;var l=o[t]={exports:{}};return n[t](l,l.exports,e),l.exports}(502);const I=(0,B.A)(S,[['__scopeId','data-v-704fab95']]),M=['innerHTML'],A={key:0,class:'streaming-cursor'},D=(0,l.defineComponent)({__name:'ContentBlockRenderer',props:{content:{default:''},isStreaming:{type:Boolean,default:!1},theme:{default:'auto'}},setup(e,{expose:t}){const a=e,n=(0,l.computed)(()=>'dark'===a.theme||'light'!==a.theme&&('undefined'!=typeof document&&(document.documentElement.classList.contains('dark-theme')||document.body.classList.contains('dark-theme')||window.matchMedia?.('(prefers-color-scheme: dark)').matches))),o=(0,l.computed)(()=>{if(!a.content)return'';let e=function(e){const t={'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'};return e.replace(/[&<>"]/g,e=>t[e]||e)}(a.content);return e=e.replace(/\n/g,'<br>'),e=e.replace(/ã€ã€([^ã€ã€‘]*)ã€‘ã€‘/g,(e,t)=>`<span class="block-system">ã€ã€${t}ã€‘ã€‘</span>`),e=e.replace(/ã€([^ã€ã€‘]+)ã€‘/g,(e,t)=>`<span class="block-scenery">ã€${t}ã€‘</span>`),e=e.replace(/ã€Œ([^ã€Œã€]+)ã€/g,(e,t)=>`<span class="block-dialogue">ã€Œ${t}ã€</span>`),e=e.replace(/\*([^*]+)\*/g,(e,t)=>`<span class="block-thought">*${t}*</span>`),e});return t({isDarkTheme:n}),(t,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{class:(0,l.normalizeClass)(['content-renderer',{'content-renderer--dark':n.value}])},[(0,l.createElementVNode)('span',{class:'content-text',innerHTML:o.value},null,8,M),e.isStreaming?((0,l.openBlock)(),(0,l.createElementBlock)('span',A,'â–Œ')):(0,l.createCommentVNode)('v-if',!0)],2))}}),x=(0,B.A)(D,[['__scopeId','data-v-5c20d1a7']]),T={class:'header-left'},R={key:0,class:'changes-count'},L={class:'header-right'},P={class:'toggle-icon'},O={key:0,class:'panel-content'},F={key:0,class:'no-changes'},j={class:'changes-list'},U={class:'change-path'},W={class:'path-icon'},H=['title'],G={class:'change-values'},K=['title'],J=['title'],q={key:0,class:'change-comment'},Y={class:'comment-text'},X={key:2,class:'panel-footer'},Z=(0,l.defineComponent)({__name:'VariableChangesPanel',props:{changes:{default:()=>[]},defaultExpanded:{type:Boolean,default:!1}},emits:['clear','copy'],setup(e,{expose:t,emit:a}){const n=e,o=a,s=(0,l.ref)(n.defaultExpanded),r=()=>{s.value=!s.value},c=e=>void 0!==e.oldValue&&null!==e.oldValue,i=e=>{if(!c(e))return'change-new';const t=typeof e.oldValue,a=typeof e.newValue;if('number'===t&&'number'===a){if(e.newValue>e.oldValue)return'change-increase';if(e.newValue<e.oldValue)return'change-decrease'}return'change-modify'},d=e=>{if(!c(e))return'âœ¨';const t=typeof e.oldValue,a=typeof e.newValue;if('number'===t&&'number'===a){if(e.newValue>e.oldValue)return'ğŸ“ˆ';if(e.newValue<e.oldValue)return'ğŸ“‰'}return'âœï¸'},u=e=>{if(e.length<=30)return e;const t=e.split('.');return t.length<=2?e.substring(0,27)+'...':`${t[0]}...${t.slice(-2).join('.')}`},m=e=>{if(null===e)return'null';if(void 0===e)return'undefined';const t=typeof e;if('string'===t){const t=20;return e.length>t?`"${e.substring(0,t)}..."`:`"${e}"`}if('number'===t)return String(e);if('boolean'===t)return e?'true':'false';if(Array.isArray(e))return`[${e.length}é¡¹]`;if('object'===t){return`{${Object.keys(e).length}é”®}`}return String(e)},p=e=>{if(null===e)return'null';if(void 0===e)return'undefined';try{return JSON.stringify(e,null,2)}catch{return String(e)}},v=()=>{o('clear')},f=()=>{const e=n.changes.map(e=>{let t=`${e.path}: `;return c(e)&&(t+=`${p(e.oldValue)} â†’ `),t+=p(e.newValue),e.comment&&(t+=` // ${e.comment}`),t}).join('\n');o('copy',e),navigator.clipboard&&navigator.clipboard.writeText(e).then(()=>{console.log('[VariableChangesPanel] å·²å¤åˆ¶åˆ°å‰ªè´´æ¿')}).catch(e=>{console.error('[VariableChangesPanel] å¤åˆ¶å¤±è´¥:',e)})};return t({expand:()=>{s.value=!0},collapse:()=>{s.value=!1},toggle:r}),(t,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{class:(0,l.normalizeClass)(['variable-changes-panel',{expanded:s.value,collapsed:!s.value}])},[(0,l.createCommentVNode)(' é¢æ¿å¤´éƒ¨ - å§‹ç»ˆå¯è§ '),(0,l.createElementVNode)('div',{class:'panel-header',onClick:r},[(0,l.createElementVNode)('div',T,[a[0]||(a[0]=(0,l.createElementVNode)('span',{class:'header-icon'},'ğŸ“Š',-1)),a[1]||(a[1]=(0,l.createElementVNode)('span',{class:'header-title'},'å˜é‡å˜åŒ–',-1)),e.changes.length>0?((0,l.openBlock)(),(0,l.createElementBlock)('span',R,(0,l.toDisplayString)(e.changes.length),1)):(0,l.createCommentVNode)('v-if',!0)]),(0,l.createElementVNode)('div',L,[(0,l.createElementVNode)('span',P,(0,l.toDisplayString)(s.value?'â–¼':'â–¶'),1)])]),(0,l.createCommentVNode)(' é¢æ¿å†…å®¹ - å±•å¼€æ—¶æ˜¾ç¤º '),(0,l.createVNode)(l.Transition,{name:'expand'},{default:(0,l.withCtx)(()=>[s.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',O,[(0,l.createCommentVNode)(' æ— å˜åŒ–æç¤º '),0===e.changes.length?((0,l.openBlock)(),(0,l.createElementBlock)('div',F,[...a[2]||(a[2]=[(0,l.createElementVNode)('span',{class:'empty-icon'},'ğŸ“­',-1),(0,l.createElementVNode)('span',{class:'empty-text'},'æœ¬æ¬¡å›å¤æ— å˜é‡æ›´æ–°',-1)])])):((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createCommentVNode)(' å˜é‡å˜åŒ–åˆ—è¡¨ '),(0,l.createElementVNode)('div',j,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.changes,(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:t,class:(0,l.normalizeClass)(['change-item',i(e)])},[(0,l.createCommentVNode)(' å˜é‡è·¯å¾„ '),(0,l.createElementVNode)('div',U,[(0,l.createElementVNode)('span',W,(0,l.toDisplayString)(d(e)),1),(0,l.createElementVNode)('span',{class:'path-text',title:e.path},(0,l.toDisplayString)(u(e.path)),9,H)]),(0,l.createCommentVNode)(' å€¼å˜åŒ– '),(0,l.createElementVNode)('div',G,[(0,l.createCommentVNode)(' æ—§å€¼ï¼ˆå¦‚æœæœ‰ï¼‰ '),c(e)?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:0},[(0,l.createElementVNode)('span',{class:'old-value',title:p(e.oldValue)},(0,l.toDisplayString)(m(e.oldValue)),9,K),a[3]||(a[3]=(0,l.createElementVNode)('span',{class:'arrow'},'â†’',-1))],64)):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' æ–°å€¼ '),(0,l.createElementVNode)('span',{class:'new-value',title:p(e.newValue)},(0,l.toDisplayString)(m(e.newValue)),9,J)]),(0,l.createCommentVNode)(' æ³¨é‡Šï¼ˆå¦‚æœæœ‰ï¼‰ '),e.comment?((0,l.openBlock)(),(0,l.createElementBlock)('div',q,[a[4]||(a[4]=(0,l.createElementVNode)('span',{class:'comment-icon'},'ğŸ’¬',-1)),(0,l.createElementVNode)('span',Y,(0,l.toDisplayString)(e.comment),1)])):(0,l.createCommentVNode)('v-if',!0)],2))),128))])],2112)),(0,l.createCommentVNode)(' åº•éƒ¨æ“ä½œæ  '),e.changes.length>0?((0,l.openBlock)(),(0,l.createElementBlock)('div',X,[(0,l.createElementVNode)('button',{class:'btn-clear',onClick:(0,l.withModifiers)(v,['stop']),title:'æ¸…ç©ºå˜åŒ–è®°å½•'},[...a[5]||(a[5]=[(0,l.createElementVNode)('span',{class:'btn-icon'},'ğŸ—‘ï¸',-1),(0,l.createTextVNode)(' æ¸…ç©º ',-1)])]),(0,l.createElementVNode)('button',{class:'btn-copy',onClick:(0,l.withModifiers)(f,['stop']),title:'å¤åˆ¶å˜åŒ–è®°å½•'},[...a[6]||(a[6]=[(0,l.createElementVNode)('span',{class:'btn-icon'},'ğŸ“‹',-1),(0,l.createTextVNode)(' å¤åˆ¶ ',-1)])])])):(0,l.createCommentVNode)('v-if',!0)])):(0,l.createCommentVNode)('v-if',!0)]),_:1})],2))}}),Q=(0,B.A)(Z,[['__scopeId','data-v-73a3470b']]),ee={class:'panel-header'},te={class:'header-actions'},ae={class:'ai-mode-segmented'},ne={class:'preset-count'},oe={class:'mode-hint'},le=(0,l.defineComponent)({__name:'GameStartHeader',props:{aiMode:{},presetCount:{}},emits:['update:aiMode','open-presets'],setup:e=>(t,a)=>((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,null,[(0,l.createElementVNode)('header',ee,[a[4]||(a[4]=(0,l.createElementVNode)('div',{class:'header-content'},[(0,l.createElementVNode)('div',{class:'header-text'},[(0,l.createElementVNode)('h2',{class:'header-title'},'è‡ªå®šä¹‰å¼€å±€')])],-1)),(0,l.createElementVNode)('div',te,[(0,l.createCommentVNode)(' AI æ¨¡å¼åˆ†æ®µæŒ‰é’® '),(0,l.createElementVNode)('div',ae,[(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['segment',{active:'off'===e.aiMode}]),onClick:a[0]||(a[0]=e=>t.$emit('update:aiMode','off'))},' ç›´æ¥å¼€å§‹ ',2),(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['segment',{active:'polish'===e.aiMode}]),onClick:a[1]||(a[1]=e=>t.$emit('update:aiMode','polish'))},' AI æ¶¦è‰² ',2)]),(0,l.createCommentVNode)(' é¢„è®¾æŒ‰é’® '),(0,l.createElementVNode)('button',{class:'preset-btn',title:'ç®¡ç†é¢„è®¾',onClick:a[2]||(a[2]=e=>t.$emit('open-presets'))},[a[3]||(a[3]=(0,l.createElementVNode)('span',{class:'preset-text'},'é¢„è®¾',-1)),(0,l.createElementVNode)('span',ne,(0,l.toDisplayString)(e.presetCount),1)])])]),(0,l.createCommentVNode)(' æ¨¡å¼è¯´æ˜ '),(0,l.createElementVNode)('div',oe,(0,l.toDisplayString)('off'===e.aiMode?'æ–‡æ¡£å˜é‡ç”±å‰ç«¯ç›´æ¥å†™å…¥ï¼Œå…¶ä½™å†…å®¹ï¼ˆèŠ±åå†Œã€NPCã€ç³»ç»Ÿå˜é‡ã€å¼€åœºæè¿°ï¼‰ä»ç”± AI ç”Ÿæˆ':'æ‰€æœ‰å˜é‡ï¼ˆå«æ–‡æ¡£æ¶¦è‰²ï¼‰å…¨éƒ¨ç”± AI ç”Ÿæˆ'),1)],64))}),se=(0,B.A)(le,[['__scopeId','data-v-b2c97ed8']]),re={office:{type:'office',label:'åŠå…¬å®¤',icon:'ğŸ¢',defaultName:'ç¬¬ä¸ƒå¤„',defaultDescription:'å›½å®¶ç‰¹åˆ«äº‹åŠ¡ç®¡ç†å±€ç¬¬ä¸ƒæ‰§è¡Œå¤„ï¼Œè´Ÿè´£å¤„ç†å„ç±»ç‰¹æ®Šäº‹åŠ¡ã€‚',defaultRosterFields:'å‘˜å·¥ç¼–å·ã€å§“åã€æ€§åˆ«ã€å¹´é¾„ã€éƒ¨é—¨ã€èŒä½ã€èŒçº§ã€å…¥èŒå¹´é™ã€èº«é«˜ã€ä½“é‡ã€ä¸‰å›´ã€é¢å®¹è¯„åˆ†ã€æ€§æ ¼ç‰¹å¾ã€ç»¼åˆè¯„çº§ã€å¤‡æ³¨',defaultDressCode:'å·¥ä½œæ—¥ç€æ­£è£…ï¼Œå¥³æ€§å‘˜å·¥éœ€ç©¿é«˜è·Ÿé‹ï¼Œè£™è£…é•¿åº¦ä¸å¾—è¶…è¿‡è†ä¸Š10cm',defaultOtherRules:'æ¯æ—¥9:00æ‰“å¡ä¸Šç­ï¼Œ18:00ä¸‹ç­ã€‚è¿Ÿåˆ°æ—©é€€æŒ‰è§„å®šå¤„ç†ã€‚'},school:{type:'school',label:'å­¦æ ¡',icon:'ğŸ«',defaultName:'å¸‚ç«‹ç¬¬ä¸€é«˜ä¸­',defaultDescription:'ä¸€æ‰€æ™®é€šçš„å¸‚ç«‹é«˜ä¸­ï¼Œå­¦é£ä¼˜è‰¯ï¼Œç¯å¢ƒä¼˜ç¾ã€‚',defaultRosterFields:'å­¦å·ã€å§“åã€æ€§åˆ«ã€å¹´é¾„ã€ç­çº§ã€èŒåŠ¡ã€èº«é«˜ã€ä½“é‡ã€ä¸‰å›´ã€æˆç»©æ’åã€æ€§æ ¼ç‰¹å¾ã€ç‰¹é•¿ã€å¤‡æ³¨',defaultDressCode:'åœ¨æ ¡æœŸé—´é¡»ç©¿ç€æ ¡æœï¼Œä½“è‚²è¯¾ç©¿è¿åŠ¨æœ',defaultOtherRules:'æ¯æ—¥7:30æ—©è‡ªä¹ ï¼Œ17:00æ”¾å­¦ã€‚ç¦æ­¢æºå¸¦æ‰‹æœºè¿›å…¥æ•™å®¤ã€‚'},hospital:{type:'hospital',label:'åŒ»é™¢',icon:'ğŸ¥',defaultName:'å¸‚ä¸­å¿ƒåŒ»é™¢',defaultDescription:'ä¸€æ‰€ä¸‰çº§ç”²ç­‰ç»¼åˆåŒ»é™¢ï¼Œæ‹¥æœ‰å…ˆè¿›çš„åŒ»ç–—è®¾å¤‡å’Œä¼˜ç§€çš„åŒ»æŠ¤å›¢é˜Ÿã€‚',defaultRosterFields:'å·¥å·ã€å§“åã€æ€§åˆ«ã€å¹´é¾„ã€ç§‘å®¤ã€èŒç§°ã€èº«é«˜ã€ä½“é‡ã€ä¸‰å›´ã€ä¸“ä¸šæŠ€èƒ½ã€æ€§æ ¼ç‰¹å¾ã€å¤‡æ³¨',defaultDressCode:'å·¥ä½œæ—¶é—´ç©¿ç€ç™½å¤§è¤‚æˆ–æŠ¤å£«æœ',defaultOtherRules:'å®è¡Œä¸‰ç­å€’åˆ¶åº¦ï¼Œä¸¥æ ¼éµå®ˆåŒ»ç–—è§„èŒƒå’ŒèŒä¸šé“å¾·ã€‚'},military:{type:'military',label:'å†›é˜Ÿ',icon:'ğŸ–ï¸',defaultName:'æŸéƒ¨é˜Ÿé©»åœ°',defaultDescription:'ä¸€å¤„å†›äº‹é©»åœ°ï¼Œçºªå¾‹ä¸¥æ˜ï¼Œæˆ˜æ–—åŠ›å¼ºã€‚',defaultRosterFields:'å†›å·ã€å§“åã€æ€§åˆ«ã€å¹´é¾„ã€éƒ¨é˜Ÿã€å†›è¡”ã€èº«é«˜ã€ä½“é‡ã€ä¸‰å›´ã€ä½“èƒ½è¯„çº§ã€ä¸“ä¸šæŠ€èƒ½ã€æ€§æ ¼ç‰¹å¾ã€å¤‡æ³¨',defaultDressCode:'åœ¨è¥åŒºå†…ç©¿ç€å†›è£…ï¼Œè®­ç»ƒæ—¶ç©¿ä½œè®­æœ',defaultOtherRules:'æ¯æ—¥6:00èµ·åºŠï¼Œ22:00ç†„ç¯ã€‚ä¸¥æ ¼éµå®ˆå†›è§„å†›çºªã€‚'},custom:{type:'custom',label:'è‡ªå®šä¹‰',icon:'âœ¨',defaultName:'',defaultDescription:'',defaultRosterFields:'',defaultDressCode:'',defaultOtherRules:''}};re.office.defaultName,re.office.defaultDescription,re.office.defaultRosterFields,re.office.defaultDressCode,re.office.defaultOtherRules,re.office.defaultRosterFields,re.office.defaultDressCode,re.office.defaultOtherRules;const ce='mclite_game_start_presets';const ie={class:'section-content'},de={class:'form-row'},ue={class:'form-group'},me={class:'scene-type-selector'},pe=['onClick'],ve={class:'scene-icon'},fe={class:'scene-label'},ge={key:0,class:'check-icon'},he={class:'form-row'},ye={class:'form-group'},Ve=['value'],Ne={key:0,class:'error-text'},Ee={class:'form-row'},ke={class:'form-group'},be=['value'],Ce={class:'char-count'},we={class:'form-row'},Se={class:'form-group'},Be=['value'],Ie={class:'char-count'},Me=(0,l.defineComponent)({__name:'SceneSettingsSection',props:{modelValue:{},errors:{}},emits:['update:modelValue','scene-type-change'],setup(e,{emit:t}){const a=e,n=t,o=(0,l.computed)(()=>Object.values(re));function s(e,t){n('update:modelValue',{...a.modelValue,[e]:t})}return(t,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('section',{class:(0,l.normalizeClass)(['setting-section',{'has-content':e.modelValue.sceneName}])},[a[7]||(a[7]=(0,l.createStaticVNode)('<div class="section-header" data-v-15032e13><div class="section-header-left" data-v-15032e13><span class="section-icon" data-v-15032e13>ğŸ“</span><h3 class="section-title" data-v-15032e13>åœºæ™¯è®¾å®š</h3></div><span class="required-badge" data-v-15032e13>å¿…å¡«</span></div>',1)),(0,l.createElementVNode)('div',ie,[(0,l.createCommentVNode)(' åœºæ™¯ç±»å‹ '),(0,l.createElementVNode)('div',de,[(0,l.createElementVNode)('div',ue,[a[3]||(a[3]=(0,l.createElementVNode)('label',{class:'form-label'},[(0,l.createTextVNode)(' åœºæ™¯ç±»å‹ '),(0,l.createElementVNode)('span',{class:'required-mark'},'*')],-1)),(0,l.createElementVNode)('div',me,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.value,t=>((0,l.openBlock)(),(0,l.createElementBlock)('button',{key:t.type,class:(0,l.normalizeClass)(['scene-type-btn',{active:e.modelValue.sceneType===t.type}]),onClick:e=>{return a=t.type,void n('scene-type-change',a);var a}},[(0,l.createElementVNode)('span',ve,(0,l.toDisplayString)(t.icon),1),(0,l.createElementVNode)('span',fe,(0,l.toDisplayString)(t.label),1),e.modelValue.sceneType===t.type?((0,l.openBlock)(),(0,l.createElementBlock)('span',ge,'âœ“')):(0,l.createCommentVNode)('v-if',!0)],10,pe))),128))])])]),(0,l.createCommentVNode)(' åœºæ™¯åç§° '),(0,l.createElementVNode)('div',he,[(0,l.createElementVNode)('div',ye,[a[4]||(a[4]=(0,l.createElementVNode)('label',{class:'form-label'},[(0,l.createTextVNode)(' åœºæ™¯åç§° '),(0,l.createElementVNode)('span',{class:'required-mark'},'*')],-1)),(0,l.createElementVNode)('input',{value:e.modelValue.sceneName,type:'text',class:(0,l.normalizeClass)(['form-input',{'has-error':e.errors.sceneName,'has-value':e.modelValue.sceneName}]),placeholder:'ä¾‹å¦‚ï¼šç¬¬ä¸ƒå¤„ã€XXé«˜ä¸­ã€å¸‚ä¸­å¿ƒåŒ»é™¢',onInput:a[0]||(a[0]=e=>s('sceneName',e.target.value))},null,42,Ve),e.errors.sceneName?((0,l.openBlock)(),(0,l.createElementBlock)('span',Ne,(0,l.toDisplayString)(e.errors.sceneName),1)):(0,l.createCommentVNode)('v-if',!0)])]),(0,l.createCommentVNode)(' åœºæ™¯æè¿° '),(0,l.createElementVNode)('div',Ee,[(0,l.createElementVNode)('div',ke,[a[5]||(a[5]=(0,l.createElementVNode)('label',{class:'form-label'},[(0,l.createTextVNode)(' åœºæ™¯æè¿° '),(0,l.createElementVNode)('span',{class:'optional-mark'},'å¯é€‰')],-1)),(0,l.createElementVNode)('textarea',{value:e.modelValue.sceneDescription,class:(0,l.normalizeClass)(['form-textarea',{'has-value':e.modelValue.sceneDescription}]),rows:'3',placeholder:'å¯¹åœºæ™¯çš„è¯¦ç»†æè¿°ï¼ˆå¯é€‰ï¼‰',onInput:a[1]||(a[1]=e=>s('sceneDescription',e.target.value))},null,42,be),(0,l.createElementVNode)('span',Ce,(0,l.toDisplayString)(e.modelValue.sceneDescription?.length||0)+' å­—',1)])]),(0,l.createCommentVNode)(' ä¸–ç•Œè§‚ '),(0,l.createElementVNode)('div',we,[(0,l.createElementVNode)('div',Se,[a[6]||(a[6]=(0,l.createElementVNode)('label',{class:'form-label'},[(0,l.createTextVNode)(' ä¸–ç•Œè§‚ '),(0,l.createElementVNode)('span',{class:'optional-mark'},'å¯é€‰')],-1)),(0,l.createElementVNode)('textarea',{value:e.modelValue.worldView,class:(0,l.normalizeClass)(['form-textarea',{'has-value':e.modelValue.worldView}]),rows:'3',placeholder:'æè¿°è¿™ä¸ªä¸–ç•Œçš„èƒŒæ™¯ã€è§„åˆ™ã€ç‰¹è‰²...',onInput:a[2]||(a[2]=e=>s('worldView',e.target.value))},null,42,Be),(0,l.createElementVNode)('span',Ie,(0,l.toDisplayString)(e.modelValue.worldView?.length||0)+' å­—',1)])])])],2))}}),Ae=(0,B.A)(Me,[['__scopeId','data-v-15032e13']]),De={class:'section-content'},xe={class:'form-row form-row-2col'},_e={class:'form-group'},Te=['value'],$e={class:'form-group'},Re=['value'],Le={class:'form-row form-row-2col'},Pe={class:'form-group'},Oe=['value'],Fe={key:0,class:'error-text'},je={class:'form-group'},Ue=['value'],ze=(0,l.defineComponent)({__name:'PlayerSettingsSection',props:{modelValue:{},errors:{}},emits:['update:modelValue'],setup(e,{emit:t}){const a=e,n=t;function o(e,t){n('update:modelValue',{...a.modelValue,[e]:t})}return(t,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('section',{class:(0,l.normalizeClass)(['setting-section',{'has-content':e.modelValue.playerPosition}])},[a[9]||(a[9]=(0,l.createStaticVNode)('<div class="section-header" data-v-23286912><div class="section-header-left" data-v-23286912><span class="section-icon" data-v-23286912>ğŸ‘¤</span><h3 class="section-title" data-v-23286912>ç©å®¶è®¾å®š</h3></div><span class="required-badge" data-v-23286912>éƒ¨åˆ†å¿…å¡«</span></div>',1)),(0,l.createElementVNode)('div',De,[(0,l.createElementVNode)('div',xe,[(0,l.createElementVNode)('div',_e,[a[4]||(a[4]=(0,l.createElementVNode)('label',{class:'form-label'},[(0,l.createTextVNode)(' å§“å '),(0,l.createElementVNode)('span',{class:'optional-mark'},'å¯é€‰')],-1)),(0,l.createElementVNode)('input',{value:e.modelValue.playerName,type:'text',class:(0,l.normalizeClass)(['form-input',{'has-value':e.modelValue.playerName}]),placeholder:'ç•™ç©ºåˆ™ä½¿ç”¨ <user>',onInput:a[0]||(a[0]=e=>o('playerName',e.target.value))},null,42,Te),a[5]||(a[5]=(0,l.createElementVNode)('span',{class:'help-text'},'ç•™ç©ºå°†ä½¿ç”¨é…’é¦†ç”¨æˆ·å',-1))]),(0,l.createElementVNode)('div',$e,[a[6]||(a[6]=(0,l.createElementVNode)('label',{class:'form-label'},[(0,l.createTextVNode)(' å¹´é¾„ '),(0,l.createElementVNode)('span',{class:'optional-mark'},'å¯é€‰')],-1)),(0,l.createElementVNode)('input',{value:e.modelValue.playerAge,type:'number',class:(0,l.normalizeClass)(['form-input',{'has-value':e.modelValue.playerAge}]),placeholder:'18',min:'1',max:'999',onInput:a[1]||(a[1]=e=>o('playerAge',e.target.valueAsNumber||null))},null,42,Re)])]),(0,l.createElementVNode)('div',Le,[(0,l.createElementVNode)('div',Pe,[a[7]||(a[7]=(0,l.createElementVNode)('label',{class:'form-label'},[(0,l.createTextVNode)(' èº«ä»½/èŒä½ '),(0,l.createElementVNode)('span',{class:'required-mark'},'*')],-1)),(0,l.createElementVNode)('input',{value:e.modelValue.playerPosition,type:'text',class:(0,l.normalizeClass)(['form-input',{'has-error':e.errors.playerPosition,'has-value':e.modelValue.playerPosition}]),placeholder:'ä¾‹å¦‚ï¼šç§‘å‘˜ã€å­¦ç”Ÿã€æŠ¤å£«',onInput:a[2]||(a[2]=e=>o('playerPosition',e.target.value))},null,42,Oe),e.errors.playerPosition?((0,l.openBlock)(),(0,l.createElementBlock)('span',Fe,(0,l.toDisplayString)(e.errors.playerPosition),1)):(0,l.createCommentVNode)('v-if',!0)]),(0,l.createElementVNode)('div',je,[a[8]||(a[8]=(0,l.createElementVNode)('label',{class:'form-label'},[(0,l.createTextVNode)(' æ‰€å±éƒ¨é—¨ '),(0,l.createElementVNode)('span',{class:'optional-mark'},'å¯é€‰')],-1)),(0,l.createElementVNode)('input',{value:e.modelValue.playerDepartment,type:'text',class:(0,l.normalizeClass)(['form-input',{'has-value':e.modelValue.playerDepartment}]),placeholder:'ä¾‹å¦‚ï¼šè¡ŒåŠ¨ä¸€ç§‘ã€é«˜äºŒä¸‰ç­',onInput:a[3]||(a[3]=e=>o('playerDepartment',e.target.value))},null,42,Ue)])])])],2))}}),We=(0,B.A)(ze,[['__scopeId','data-v-23286912']]),He={class:'section-header'},Ge={class:'section-header-right'},Ke={class:'field-count'},Je={class:'section-content'},qe={class:'preset-fields'},Ye={class:'preset-tags'},Xe=['onClick'],Ze={key:0,class:'empty-hint'},Qe={class:'tag-text'},et=['onClick'],tt={class:'add-field-row'},at=['disabled'],nt={key:0,class:'error-text'},ot=(0,l.defineComponent)({__name:'RosterFieldsSection',props:{modelValue:{},error:{}},emits:['update:modelValue'],setup(e,{emit:t}){const a=['å§“å','æ€§åˆ«','å¹´é¾„','éƒ¨é—¨','èŒä½','èŒçº§','èº«é«˜','ä½“é‡','ä¸‰å›´','é¢å®¹è¯„åˆ†','æ€§æ ¼ç‰¹å¾','å…¥èŒå¹´é™','å­¦å†','ç‰¹é•¿','ç»¼åˆè¯„çº§','å¤‡æ³¨'],n=e,o=t,s=(0,l.ref)(''),r=(0,l.computed)(()=>a.filter(e=>!n.modelValue.includes(e)));function c(){const e=s.value.trim();e&&!n.modelValue.includes(e)&&(o('update:modelValue',[...n.modelValue,e]),s.value='')}return(t,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('section',{class:(0,l.normalizeClass)(['setting-section',{'has-content':e.modelValue.length>0}])},[(0,l.createElementVNode)('div',He,[a[2]||(a[2]=(0,l.createElementVNode)('div',{class:'section-header-left'},[(0,l.createElementVNode)('span',{class:'section-icon'},'ğŸ“Š'),(0,l.createElementVNode)('h3',{class:'section-title'},'èŠ±åå†Œå­—æ®µå®šä¹‰')],-1)),(0,l.createElementVNode)('div',Ge,[(0,l.createElementVNode)('span',Ke,(0,l.toDisplayString)(e.modelValue.length)+' ä¸ªå­—æ®µ',1),a[1]||(a[1]=(0,l.createElementVNode)('span',{class:'required-badge'},'å¿…å¡«',-1))])]),(0,l.createElementVNode)('div',Je,[a[5]||(a[5]=(0,l.createElementVNode)('p',{class:'card-desc'},' å®šä¹‰äººå‘˜æ¡£æ¡ˆéœ€è¦è®°å½•å“ªäº›ä¿¡æ¯ï¼Œç‚¹å‡»é¢„è®¾å­—æ®µå¿«é€Ÿæ·»åŠ ï¼Œæˆ–æ‰‹åŠ¨è¾“å…¥ ',-1)),(0,l.createCommentVNode)(' é¢„è®¾å­—æ®µå¿«é€Ÿæ·»åŠ  '),(0,l.createElementVNode)('div',qe,[a[4]||(a[4]=(0,l.createElementVNode)('span',{class:'preset-label'},'å¸¸ç”¨å­—æ®µï¼š',-1)),(0,l.createElementVNode)('div',Ye,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(r.value,e=>((0,l.openBlock)(),(0,l.createElementBlock)('button',{key:e,class:'preset-tag',onClick:t=>function(e){n.modelValue.includes(e)||o('update:modelValue',[...n.modelValue,e])}(e)},[a[3]||(a[3]=(0,l.createElementVNode)('span',{class:'tag-icon'},'+',-1)),(0,l.createTextVNode)(' '+(0,l.toDisplayString)(e),1)],8,Xe))),128))])]),(0,l.createCommentVNode)(' å·²é€‰å­—æ®µ '),(0,l.createElementVNode)('div',{class:(0,l.normalizeClass)(['selected-fields',{'has-fields':e.modelValue.length>0}])},[0===e.modelValue.length?((0,l.openBlock)(),(0,l.createElementBlock)('span',Ze,' ç‚¹å‡»ä¸Šæ–¹å­—æ®µæ·»åŠ ï¼Œæˆ–åœ¨ä¸‹æ–¹è¾“å…¥è‡ªå®šä¹‰å­—æ®µ ')):(0,l.createCommentVNode)('v-if',!0),(0,l.createVNode)(l.TransitionGroup,{name:'tag',tag:'div',class:'field-tags'},{default:(0,l.withCtx)(()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.modelValue,(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e,class:'field-tag',style:(0,l.normalizeStyle)({'--tag-index':t})},[(0,l.createElementVNode)('span',Qe,(0,l.toDisplayString)(e),1),(0,l.createElementVNode)('button',{class:'tag-remove',title:'ç§»é™¤',onClick:e=>function(e){const t=[...n.modelValue];t.splice(e,1),o('update:modelValue',t)}(t)},'âœ•',8,et)],4))),128))]),_:1})],2),(0,l.createCommentVNode)(' æ‰‹åŠ¨æ·»åŠ  '),(0,l.createElementVNode)('div',tt,[(0,l.withDirectives)((0,l.createElementVNode)('input',{'onUpdate:modelValue':a[0]||(a[0]=e=>s.value=e),type:'text',class:'add-field-input',placeholder:'è¾“å…¥è‡ªå®šä¹‰å­—æ®µåç§°ï¼ŒæŒ‰å›è½¦æ·»åŠ ',onKeyup:(0,l.withKeys)(c,['enter'])},null,544),[[l.vModelText,s.value]]),(0,l.createElementVNode)('button',{class:'add-field-btn',disabled:!s.value.trim(),onClick:c},' æ·»åŠ  ',8,at)]),e.error?((0,l.openBlock)(),(0,l.createElementBlock)('span',nt,(0,l.toDisplayString)(e.error),1)):(0,l.createCommentVNode)('v-if',!0)])],2))}}),lt=(0,B.A)(ot,[['__scopeId','data-v-1d3e43b4']]),st={class:'document-tabs'},rt={class:'tabs-list'},ct=['onClick'],it={class:'tab-icon'},dt={class:'tab-title'},ut=['onClick'],mt=(0,l.defineComponent)({__name:'DocumentTabs',props:{documents:{},activeIndex:{}},emits:['select','add','delete'],setup:e=>(t,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',st,[(0,l.createElementVNode)('div',rt,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.documents,(a,n)=>((0,l.openBlock)(),(0,l.createElementBlock)('button',{key:a.docKey||n,class:(0,l.normalizeClass)(['tab-item',{active:e.activeIndex===n}]),onClick:e=>t.$emit('select',n)},[(0,l.createElementVNode)('span',it,(0,l.toDisplayString)(a.isFormDocument?'ğŸ“‹':'ğŸ“œ'),1),(0,l.createElementVNode)('span',dt,(0,l.toDisplayString)(a.docKey||a.title||`æ–‡æ¡£ ${n+1}`),1),e.documents.length>1?((0,l.openBlock)(),(0,l.createElementBlock)('button',{key:0,class:'tab-close',title:'åˆ é™¤æ–‡æ¡£',onClick:(0,l.withModifiers)(e=>t.$emit('delete',n),['stop'])},' âœ• ',8,ut)):(0,l.createCommentVNode)('v-if',!0)],10,ct))),128))]),(0,l.createElementVNode)('button',{class:'add-tab-btn',title:'æ–°å»ºæ–‡æ¡£',onClick:a[0]||(a[0]=e=>t.$emit('add'))},[...a[1]||(a[1]=[(0,l.createElementVNode)('span',null,'+ æ–°å»º',-1)])])]))}),pt=(0,B.A)(mt,[['__scopeId','data-v-cb6886f0']]),vt={class:'doc-meta-editor'},ft={class:'meta-row'},gt={class:'form-group'},ht=['value'],yt={class:'form-group'},Vt=['value'],Nt={class:'meta-row'},Et={class:'form-group flex-1'},kt=['value'],bt={class:'form-group form-toggle-group'},Ct=(0,l.defineComponent)({__name:'DocumentMetaEditor',props:{document:{}},emits:['update'],setup(e,{emit:t}){const a=t;function n(e,t){a('update',e,t)}return(t,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',vt,[(0,l.createElementVNode)('div',ft,[(0,l.createElementVNode)('div',gt,[a[4]||(a[4]=(0,l.createElementVNode)('label',{class:'form-label'},[(0,l.createTextVNode)(' æ–‡æ¡£æ ‡è¯† Key '),(0,l.createElementVNode)('span',{class:'required-mark'},'*')],-1)),(0,l.createElementVNode)('input',{value:e.document.docKey,type:'text',class:(0,l.normalizeClass)(['form-input',{'has-value':e.document.docKey}]),placeholder:'ä¾‹å¦‚ï¼šå‘˜å·¥å®ˆåˆ™ã€ç€è£…è§„å®š',onInput:a[0]||(a[0]=e=>n('docKey',e.target.value))},null,42,ht)]),(0,l.createElementVNode)('div',yt,[a[5]||(a[5]=(0,l.createElementVNode)('label',{class:'form-label'},'æ–‡æ¡£æ ‡é¢˜',-1)),(0,l.createElementVNode)('input',{value:e.document.title,type:'text',class:(0,l.normalizeClass)(['form-input',{'has-value':e.document.title}]),placeholder:'æ–‡æ¡£æ­£å¼æ ‡é¢˜',onInput:a[1]||(a[1]=e=>n('title',e.target.value))},null,42,Vt)])]),(0,l.createElementVNode)('div',Nt,[(0,l.createElementVNode)('div',Et,[a[6]||(a[6]=(0,l.createElementVNode)('label',{class:'form-label'},'æ–‡æ¡£æè¿°',-1)),(0,l.createElementVNode)('input',{value:e.document.description,type:'text',class:(0,l.normalizeClass)(['form-input',{'has-value':e.document.description}]),placeholder:'ç®€è¦æè¿°ï¼ˆå¯é€‰ï¼‰',onInput:a[2]||(a[2]=e=>n('description',e.target.value))},null,42,kt)]),(0,l.createElementVNode)('div',bt,[a[7]||(a[7]=(0,l.createElementVNode)('label',{class:'form-label'},'è¡¨å•æ–‡æ¡£',-1)),(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['toggle-btn',{active:e.document.isFormDocument}]),onClick:a[3]||(a[3]=t=>n('isFormDocument',!e.document.isFormDocument))},(0,l.toDisplayString)(e.document.isFormDocument?'æ˜¯':'å¦'),3)])])]))}}),wt=(0,B.A)(Ct,[['__scopeId','data-v-d3c9924a']]),St={class:'node-row'},Bt=['title'],It={key:1,class:'toggle-placeholder'},Mt=['value','onKeydown'],At={class:'node-text'},Dt=['value','placeholder'],xt={class:'node-actions'},_t={class:'field-badge'},Tt=(0,l.defineComponent)({__name:'EditorNodeItem',props:{node:{},depth:{},document:{},isFormDocument:{type:Boolean}},emits:['update-key','update-text','toggle-expand','add-child','add-sibling','delete-node','edit-field-def','indent-node','outdent-node'],setup(e,{emit:t}){const a=e,n=t,o=(0,l.ref)(null),s=(0,l.ref)(null),r=(0,l.ref)(null),c=(0,l.computed)(()=>null!==o.value),i=(0,l.computed)(()=>a.node.childIds.length>0),d=(0,l.computed)(()=>[...a.node.childIds].sort((e,t)=>{const n=a.document.nodes.get(e),o=a.document.nodes.get(t);return(n?.sortIndex??0)-(o?.sortIndex??0)})),u=(0,l.computed)(()=>{const e=a.node.text;return e?e.length>80?e.substring(0,80)+'...':e:''});function m(e){return a.document.nodes.get(e)}function p(e){o.value=e,(0,l.nextTick)(()=>{'key'===e&&s.value?(s.value.focus(),s.value.select()):'text'===e&&r.value&&(r.value.focus(),r.value.select())})}function v(){n('toggle-expand',a.node.id)}function f(e){e.shiftKey?n('outdent-node',a.node.id):n('indent-node',a.node.id)}return(t,g)=>{const h=(0,l.resolveComponent)('EditorNodeItem',!0);return(0,l.openBlock)(),(0,l.createElementBlock)('div',{class:(0,l.normalizeClass)(['editor-node',[`depth-${e.depth}`,{collapsed:!e.node.expanded,editing:c.value}]])},[(0,l.createCommentVNode)(' èŠ‚ç‚¹è¡Œ '),(0,l.createElementVNode)('div',St,[(0,l.createCommentVNode)(' ç¼©è¿› + æŠ˜å ç®­å¤´ '),(0,l.createElementVNode)('div',{class:'node-indent',style:(0,l.normalizeStyle)({paddingLeft:20*e.depth+'px'})},[i.value?((0,l.openBlock)(),(0,l.createElementBlock)('button',{key:0,class:'toggle-btn',title:e.node.expanded?'æ”¶èµ·':'å±•å¼€',onClick:v},[(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(['toggle-arrow',{expanded:e.node.expanded}])},'â–¶',2)],8,Bt)):((0,l.openBlock)(),(0,l.createElementBlock)('span',It))],4),(0,l.createCommentVNode)(' key åŒºåŸŸ '),(0,l.createElementVNode)('div',{class:(0,l.normalizeClass)(['node-key',[`key-depth-${Math.min(e.depth,5)}`]])},['key'===o.value?((0,l.openBlock)(),(0,l.createElementBlock)('input',{key:0,ref_key:'keyInputRef',ref:s,value:e.node.key,class:'key-input',placeholder:'èŠ‚ç‚¹æ ‡é¢˜',onInput:g[0]||(g[0]=e=>{return t=e.target.value,void n('update-key',a.node.id,t);var t}),onBlur:g[1]||(g[1]=e=>o.value=null),onKeydown:[g[2]||(g[2]=(0,l.withKeys)(e=>o.value=null,['enter'])),(0,l.withKeys)((0,l.withModifiers)(f,['prevent']),['tab']),g[3]||(g[3]=(0,l.withKeys)(e=>o.value=null,['escape']))]},null,40,Mt)):((0,l.openBlock)(),(0,l.createElementBlock)('span',{key:1,class:(0,l.normalizeClass)(['key-display',{empty:!e.node.key}]),onClick:g[4]||(g[4]=e=>p('key'))},(0,l.toDisplayString)(e.node.key||'(ç‚¹å‡»ç¼–è¾‘æ ‡é¢˜)'),3))],2),(0,l.createCommentVNode)(' text åŒºåŸŸï¼ˆå¶å­èŠ‚ç‚¹æˆ–åˆ†æ”¯çš„ _tï¼‰ '),(0,l.createElementVNode)('div',At,['text'===o.value?((0,l.openBlock)(),(0,l.createElementBlock)('input',{key:0,ref_key:'textInputRef',ref:r,value:e.node.text,class:'text-input',placeholder:'leaf'===e.node.type?'å†…å®¹æ–‡æœ¬':'æ­£æ–‡ï¼ˆ_tï¼‰',onInput:g[5]||(g[5]=e=>{return t=e.target.value,void n('update-text',a.node.id,t);var t}),onBlur:g[6]||(g[6]=e=>o.value=null),onKeydown:[g[7]||(g[7]=(0,l.withKeys)((0,l.withModifiers)(e=>o.value=null,['exact']),['enter'])),g[8]||(g[8]=(0,l.withKeys)(e=>o.value=null,['escape']))]},null,40,Dt)):((0,l.openBlock)(),(0,l.createElementBlock)('span',{key:1,class:(0,l.normalizeClass)(['text-display',{empty:!e.node.text}]),onClick:g[9]||(g[9]=e=>p('text'))},(0,l.toDisplayString)(u.value||'(ç‚¹å‡»ç¼–è¾‘å†…å®¹)'),3))]),(0,l.createCommentVNode)(' æ“ä½œæŒ‰é’® '),(0,l.createElementVNode)('div',xt,[(0,l.createElementVNode)('button',{class:'action-btn',title:'æ·»åŠ å­èŠ‚ç‚¹ (Ctrl+Enter)',onClick:g[10]||(g[10]=a=>t.$emit('add-child',e.node.id))},[...g[23]||(g[23]=[(0,l.createElementVNode)('span',{class:'action-icon'},'â†³+',-1)])]),(0,l.createElementVNode)('button',{class:'action-btn',title:'æ·»åŠ åŒçº§èŠ‚ç‚¹ (Enter)',onClick:g[11]||(g[11]=a=>t.$emit('add-sibling',e.node.id))},[...g[24]||(g[24]=[(0,l.createElementVNode)('span',{class:'action-icon'},'â†“+',-1)])]),e.isFormDocument?((0,l.openBlock)(),(0,l.createElementBlock)('button',{key:0,class:(0,l.normalizeClass)(['action-btn field-btn',{'has-fields':e.node.fieldDefs&&e.node.fieldDefs.length>0}]),title:'ç»‘å®šè¡¨å•å­—æ®µ',onClick:g[12]||(g[12]=a=>t.$emit('edit-field-def',e.node.id))},[...g[25]||(g[25]=[(0,l.createElementVNode)('span',{class:'action-icon'},'ğŸ“‹',-1)])],2)):(0,l.createCommentVNode)('v-if',!0),(0,l.createElementVNode)('button',{class:'action-btn danger',title:'åˆ é™¤',onClick:g[13]||(g[13]=a=>t.$emit('delete-node',e.node.id))},[...g[26]||(g[26]=[(0,l.createElementVNode)('span',{class:'action-icon'},'âœ•',-1)])])])]),(0,l.createCommentVNode)(' è¡¨å•å­—æ®µæŒ‡ç¤ºå™¨ '),e.node.fieldDefs&&e.node.fieldDefs.length>0?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'field-indicator',style:(0,l.normalizeStyle)({marginLeft:20*e.depth+24+'px'})},[(0,l.createElementVNode)('span',_t,'ğŸ“‹ '+(0,l.toDisplayString)(e.node.fieldDefs.length)+' ä¸ªè¡¨å•å­—æ®µ',1)],4)):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' é€’å½’æ¸²æŸ“å­èŠ‚ç‚¹ '),e.node.expanded&&i.value?((0,l.openBlock)(),(0,l.createBlock)(l.TransitionGroup,{key:1,name:'node',tag:'div',class:'node-children'},{default:(0,l.withCtx)(()=>[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(d.value,a=>((0,l.openBlock)(),(0,l.createBlock)(h,{key:a,node:m(a),depth:e.depth+1,document:e.document,'is-form-document':e.isFormDocument,onUpdateKey:g[14]||(g[14]=(e,a)=>t.$emit('update-key',e,a)),onUpdateText:g[15]||(g[15]=(e,a)=>t.$emit('update-text',e,a)),onToggleExpand:g[16]||(g[16]=e=>t.$emit('toggle-expand',e)),onAddChild:g[17]||(g[17]=e=>t.$emit('add-child',e)),onAddSibling:g[18]||(g[18]=e=>t.$emit('add-sibling',e)),onDeleteNode:g[19]||(g[19]=e=>t.$emit('delete-node',e)),onEditFieldDef:g[20]||(g[20]=e=>t.$emit('edit-field-def',e)),onIndentNode:g[21]||(g[21]=e=>t.$emit('indent-node',e)),onOutdentNode:g[22]||(g[22]=e=>t.$emit('outdent-node',e))},null,8,['node','depth','document','is-form-document']))),128))]),_:1})):(0,l.createCommentVNode)('v-if',!0)],2)}}}),$t=(0,B.A)(Tt,[['__scopeId','data-v-0a118b06']]);let Rt=0;function Lt(e){return{id:`enode_${Date.now()}_${++Rt}`,parentId:null,key:'',type:'leaf',text:'',childIds:[],sortIndex:0,expanded:!0,...e}}function Pt(e){return{docKey:'',title:'',description:'',isFormDocument:!1,nodes:new Map,rootNodeIds:[],...e}}function Ot(e){return{docKey:e.docKey,title:e.title,description:e.description,isFormDocument:e.isFormDocument,formMeta:e.formMeta,nodes:Array.from(e.nodes.entries()),rootNodeIds:e.rootNodeIds}}function Ft(e){const t=new Map;if(Array.isArray(e.nodes))for(const[a,n]of e.nodes)t.set(a,n);return{docKey:e.docKey||'',title:e.title||'',description:e.description||'',isFormDocument:!!e.isFormDocument,formMeta:e.formMeta,nodes:t,rootNodeIds:e.rootNodeIds||[]}}function jt(e){return{sceneType:e.sceneType,sceneName:e.sceneName,sceneDescription:e.sceneDescription,worldView:e.worldView,playerName:e.playerName,playerAge:e.playerAge,playerPosition:e.playerPosition,playerDepartment:e.playerDepartment,rosterFields:[...e.rosterFields],additionalNotes:e.additionalNotes,documents:e.documents.map(Ot),aiMode:e.aiMode}}function Ut(e){return{sceneType:e.sceneType||'office',sceneName:e.sceneName||'',sceneDescription:e.sceneDescription||'',worldView:e.worldView||'',playerName:e.playerName||'',playerAge:e.playerAge??null,playerPosition:e.playerPosition||'',playerDepartment:e.playerDepartment||'',rosterFields:e.rosterFields||[],additionalNotes:e.additionalNotes||'',documents:Array.isArray(e.documents)?e.documents.map(Ft):[],aiMode:e.aiMode||'polish'}}const zt={class:'outline-editor'},Wt={key:0,class:'empty-state'},Ht={class:'node-tree'},Gt={key:2,class:'add-root-area'},Kt=(0,l.defineComponent)({__name:'DocumentOutlineEditor',props:{document:{}},emits:['update','edit-field-def'],setup(e,{emit:t}){const a=e,n=t,o=(0,l.computed)(()=>[...a.document.rootNodeIds].sort((e,t)=>{const n=a.document.nodes.get(e),o=a.document.nodes.get(t);return(n?.sortIndex??0)-(o?.sortIndex??0)}));function s(){n('update',a.document)}function r(){const e=Lt({type:'leaf',sortIndex:a.document.rootNodeIds.reduce((e,t)=>{const n=a.document.nodes.get(t);return Math.max(e,n?.sortIndex??0)},-1)+1,levelHint:'chapter'});a.document.nodes.set(e.id,e),a.document.rootNodeIds.push(e.id),s()}function c(e,t){const n=a.document.nodes.get(e);n&&(n.key=t,s())}function i(e,t){const n=a.document.nodes.get(e);n&&(n.text=t,s())}function d(e){const t=a.document.nodes.get(e);t&&(t.expanded=!t.expanded)}function u(e){const t=a.document.nodes.get(e);if(!t)return;t.type='branch',t.expanded=!0;const n=Lt({parentId:e,sortIndex:t.childIds.reduce((e,t)=>{const n=a.document.nodes.get(t);return Math.max(e,n?.sortIndex??0)},-1)+1});a.document.nodes.set(n.id,n),t.childIds.push(n.id),s()}function m(e){const t=a.document.nodes.get(e);if(!t)return;const n=Lt({parentId:t.parentId,sortIndex:t.sortIndex+.5});if(a.document.nodes.set(n.id,n),t.parentId){const o=a.document.nodes.get(t.parentId);if(o){const t=o.childIds.indexOf(e);o.childIds.splice(t+1,0,n.id),y(o.childIds)}}else{const t=a.document.rootNodeIds.indexOf(e);a.document.rootNodeIds.splice(t+1,0,n.id),V()}s()}function p(e){const t=a.document.nodes.get(e);if(t){if(v(e),t.parentId){const n=a.document.nodes.get(t.parentId);n&&(n.childIds=n.childIds.filter(t=>t!==e),0!==n.childIds.length||n.fieldDefs?.length||(n.type='leaf'))}else a.document.rootNodeIds=a.document.rootNodeIds.filter(t=>t!==e);s()}}function v(e){const t=a.document.nodes.get(e);if(t){for(const e of t.childIds)v(e);a.document.nodes.delete(e)}}function f(e){const t=a.document.nodes.get(e);if(!t)return;let n;if(t.parentId){const e=a.document.nodes.get(t.parentId);if(!e)return;n=e.childIds}else n=a.document.rootNodeIds;const o=[...n].sort((e,t)=>{const n=a.document.nodes.get(e),o=a.document.nodes.get(t);return(n?.sortIndex??0)-(o?.sortIndex??0)}),l=o.indexOf(e);if(l<=0)return;const r=o[l-1],c=a.document.nodes.get(r);if(c){if(t.parentId){const n=a.document.nodes.get(t.parentId);n&&(n.childIds=n.childIds.filter(t=>t!==e))}else a.document.rootNodeIds=a.document.rootNodeIds.filter(t=>t!==e);c.type='branch',c.expanded=!0,t.parentId=r,t.sortIndex=c.childIds.length,c.childIds.push(e),s()}}function g(e){const t=a.document.nodes.get(e);if(!t||!t.parentId)return;const n=a.document.nodes.get(t.parentId);if(!n)return;n.childIds=n.childIds.filter(t=>t!==e),0!==n.childIds.length||n.fieldDefs?.length||(n.type='leaf');const o=n.parentId;if(t.parentId=o,o){const t=a.document.nodes.get(o);if(t){const a=t.childIds.indexOf(n.id);t.childIds.splice(a+1,0,e),y(t.childIds)}}else{const t=a.document.rootNodeIds.indexOf(n.id);a.document.rootNodeIds.splice(t+1,0,e),V()}s()}function h(e){n('edit-field-def',e)}function y(e){e.forEach((e,t)=>{const n=a.document.nodes.get(e);n&&(n.sortIndex=t)})}function V(){a.document.rootNodeIds.forEach((e,t)=>{const n=a.document.nodes.get(e);n&&(n.sortIndex=t)})}return(t,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',zt,[(0,l.createCommentVNode)(' ç©ºçŠ¶æ€ '),0===e.document.rootNodeIds.length?((0,l.openBlock)(),(0,l.createElementBlock)('div',Wt,[a[1]||(a[1]=(0,l.createElementVNode)('p',{class:'empty-text'},'æš‚æ— æ–‡æ¡£å†…å®¹ï¼Œç‚¹å‡»ä¸‹æ–¹æŒ‰é’®æ·»åŠ ç¬¬ä¸€ä¸ªç« èŠ‚',-1)),(0,l.createElementVNode)('button',{class:'add-root-btn',onClick:r},[...a[0]||(a[0]=[(0,l.createElementVNode)('span',null,'+ æ·»åŠ ç« èŠ‚',-1)])])])):((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createCommentVNode)(' èŠ‚ç‚¹æ ‘ '),(0,l.createElementVNode)('div',Ht,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.value,t=>((0,l.openBlock)(),(0,l.createBlock)($t,{key:t,node:e.document.nodes.get(t),depth:0,document:e.document,'is-form-document':e.document.isFormDocument,onUpdateKey:c,onUpdateText:i,onToggleExpand:d,onAddChild:u,onAddSibling:m,onDeleteNode:p,onEditFieldDef:h,onIndentNode:f,onOutdentNode:g},null,8,['node','document','is-form-document']))),128))])],2112)),(0,l.createCommentVNode)(' åº•éƒ¨æ·»åŠ æŒ‰é’® '),e.document.rootNodeIds.length>0?((0,l.openBlock)(),(0,l.createElementBlock)('div',Gt,[(0,l.createElementVNode)('button',{class:'add-root-btn-sm',onClick:r},' + æ·»åŠ é¡¶å±‚ç« èŠ‚ ')])):(0,l.createCommentVNode)('v-if',!0)]))}}),Jt=(0,B.A)(Kt,[['__scopeId','data-v-90f80318']]),qt={class:'form-meta-editor'},Yt={class:'meta-body'},Xt={class:'meta-row'},Zt={class:'form-group'},Qt=['value'],ea={class:'meta-row'},ta={class:'form-group'},aa=['value'],na={class:'form-group',style:{'max-width':'120px'}},oa=['value'],la={class:'workflow-section'},sa={key:0,class:'workflow-steps'},ra={class:'step-number'},ca=['value','onInput'],ia=['value','onInput'],da={class:'step-checkbox'},ua=['checked','onChange'],ma=['onClick'],pa={key:1,class:'workflow-empty'},va=(0,l.defineComponent)({__name:'FormMetaEditor',props:{formMeta:{}},emits:['update'],setup(e,{emit:t}){const a=e,n=t,o=(0,l.computed)(()=>a.formMeta.workflow||[]);function s(e,t){n('update',{...a.formMeta,[e]:t})}function r(){const e=[...o.value];e.push({step:e.length+1,name:'',handler:'',canReject:!0}),n('update',{...a.formMeta,workflow:e})}function c(e,t,l){const s=[...o.value];s[e]={...s[e],[t]:l},n('update',{...a.formMeta,workflow:s})}return(t,i)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',qt,[i[8]||(i[8]=(0,l.createElementVNode)('div',{class:'meta-header'},[(0,l.createElementVNode)('span',{class:'meta-title'},'è¡¨å•è®¾å®š')],-1)),(0,l.createElementVNode)('div',Yt,[(0,l.createElementVNode)('div',Xt,[(0,l.createElementVNode)('div',Zt,[i[3]||(i[3]=(0,l.createElementVNode)('label',{class:'form-label'},'è¡¨å•åç§°',-1)),(0,l.createElementVNode)('input',{value:e.formMeta.formName,type:'text',class:'form-input',placeholder:'ä¾‹å¦‚ï¼šç‰©èµ„ç”³è¯·è¡¨',onInput:i[0]||(i[0]=e=>s('formName',e.target.value))},null,40,Qt)])]),(0,l.createElementVNode)('div',ea,[(0,l.createElementVNode)('div',ta,[i[4]||(i[4]=(0,l.createElementVNode)('label',{class:'form-label'},'æè¿°',-1)),(0,l.createElementVNode)('input',{value:e.formMeta.description||'',type:'text',class:'form-input',placeholder:'è¡¨å•ç”¨é€”æè¿°ï¼ˆå¯é€‰ï¼‰',onInput:i[1]||(i[1]=e=>s('description',e.target.value))},null,40,aa)]),(0,l.createElementVNode)('div',na,[i[5]||(i[5]=(0,l.createElementVNode)('label',{class:'form-label'},'æœ‰æ•ˆå¤©æ•°',-1)),(0,l.createElementVNode)('input',{value:e.formMeta.validDays||'',type:'number',class:'form-input',placeholder:'ä¸é™',min:'1',onInput:i[2]||(i[2]=e=>s('validDays',e.target.valueAsNumber||void 0))},null,40,oa)])]),(0,l.createCommentVNode)(' å·¥ä½œæµæ­¥éª¤ '),(0,l.createElementVNode)('div',la,[(0,l.createElementVNode)('div',{class:'workflow-header'},[i[6]||(i[6]=(0,l.createElementVNode)('span',{class:'workflow-label'},'å®¡æ‰¹å·¥ä½œæµ',-1)),(0,l.createElementVNode)('button',{class:'add-step-btn',onClick:r},'+ æ·»åŠ æ­¥éª¤')]),o.value.length>0?((0,l.openBlock)(),(0,l.createElementBlock)('div',sa,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.value,(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:t,class:'workflow-step'},[(0,l.createElementVNode)('span',ra,(0,l.toDisplayString)(e.step),1),(0,l.createElementVNode)('input',{value:e.name,type:'text',class:'step-input',placeholder:'æ­¥éª¤åç§°',onInput:e=>c(t,'name',e.target.value)},null,40,ca),(0,l.createElementVNode)('input',{value:e.handler,type:'text',class:'step-input',placeholder:'å¤„ç†äºº',onInput:e=>c(t,'handler',e.target.value)},null,40,ia),(0,l.createElementVNode)('label',da,[(0,l.createElementVNode)('input',{type:'checkbox',checked:e.canReject,onChange:e=>c(t,'canReject',e.target.checked)},null,40,ua),i[7]||(i[7]=(0,l.createElementVNode)('span',null,'å¯é©³å›',-1))]),(0,l.createElementVNode)('button',{class:'step-remove',onClick:e=>function(e){const t=[...o.value];t.splice(e,1),t.forEach((e,t)=>e.step=t+1),n('update',{...a.formMeta,workflow:t})}(t)},'âœ•',8,ma)]))),128))])):((0,l.openBlock)(),(0,l.createElementBlock)('p',pa,'æš‚æ— å·¥ä½œæµæ­¥éª¤'))])])]))}}),fa=(0,B.A)(va,[['__scopeId','data-v-d7fda2bc']]),ga='MC.æ–‡æ¡£',ha={$meta:{extensible:!0}},ya={title:'',description:''};function Va(e){return e.startsWith('$')}function Na(e){return'title'===e||'description'===e||Va(e)}function Ea(e){return'string'==typeof e}function ka(e){return'object'==typeof e&&null!==e}function ba(e){let t=0;for(const[,a]of e)t++,ka(a)&&a._s&&(t+=ba(Object.entries(a._s)));return t}function Ca(e){const t={$meta:{extensible:!0},title:e.title,description:e.description||''};e.isFormDocument&&e.formMeta&&(t.$formMeta={...e.formMeta});for(const a of e.rootNodeIds){const n=e.nodes.get(a);n&&n.key.trim()&&(t[n.key]=wa(e,n))}return t}function wa(e,t){if('leaf'===t.type&&0===t.childIds.length&&!t.fieldDefs?.length)return t.text;const a={};if(t.text&&(a._t=t.text),t.childIds.length>0){const n={},o=[...t.childIds].sort((t,a)=>{const n=e.nodes.get(t),o=e.nodes.get(a);return(n?.sortIndex??0)-(o?.sortIndex??0)});for(const t of o){const a=e.nodes.get(t);a&&a.key.trim()&&(n[a.key]=wa(e,a))}Object.keys(n).length>0&&(a._s={$meta:{extensible:!0},...n})}return t.fieldDefs&&t.fieldDefs.length>0&&(a.$fieldDef=1===t.fieldDefs.length?t.fieldDefs[0]:t.fieldDefs),a}function Sa(e){const t={title:e.title,description:e.description,$meta:{extensible:!0}};e.isFormDocument&&e.formMeta&&(t.$formMeta=e.formMeta);for(const a of e.rootNodeIds){const n=e.nodes.get(a);n&&n.key.trim()&&(t[n.key]=Ba(e,n))}return t}function Ba(e,t){if('leaf'===t.type&&0===t.childIds.length&&!t.fieldDefs?.length)return t.text||'ï¼ˆè¯·æ¶¦è‰²è¡¥å……ï¼‰';const a={};if(t.text&&(a._t=t.text),t.childIds.length>0){const n={$meta:{extensible:!0}},o=[...t.childIds].sort((t,a)=>{const n=e.nodes.get(t),o=e.nodes.get(a);return(n?.sortIndex??0)-(o?.sortIndex??0)});for(const t of o){const a=e.nodes.get(t);a&&a.key.trim()&&(n[a.key]=Ba(e,a))}a._s=n}return t.fieldDefs&&t.fieldDefs.length>0&&(a.$fieldDef=1===t.fieldDefs.length?t.fieldDefs[0]:t.fieldDefs),a}const Ia=new Set(['$meta','$formMeta','$fieldDef','title','description']);class Ma{static fieldCounter=0;static parseDocuments(e){const t={};for(const[a,n]of Object.entries(e)){if(a.startsWith('$')||!n||'object'!=typeof n)continue;const e=n;if(!e.$formMeta)continue;const o=e.$formMeta,l=[];this.fieldCounter=0,this.collectFieldsRecursive(e,l),l.sort((e,t)=>e.formPosition-t.formPosition),t[a]={meta:o,fields:l,sourceDocId:a}}return{forms:t}}static collectFieldsRecursive(e,t){if(e.$fieldDef){const a=Array.isArray(e.$fieldDef)?e.$fieldDef:[e.$fieldDef];for(const e of a){this.fieldCounter++;const a=e.fieldId||this.generateFieldId(e.label);t.push({...e,fieldId:a,formPosition:this.fieldCounter})}}if(e._s&&'object'==typeof e._s){const a=e._s;for(const[e,n]of Object.entries(a))e.startsWith('$')||n&&'object'==typeof n&&!Array.isArray(n)&&this.collectFieldsRecursive(n,t)}for(const[a,n]of Object.entries(e))Ia.has(a)||a.startsWith('$')||'_t'===a||'_s'===a||n&&'object'==typeof n&&!Array.isArray(n)&&this.collectFieldsRecursive(n,t)}static generateFieldId(e){return`field_${e.replace(/[^a-zA-Z0-9\u4e00-\u9fff]/g,'_')}_${this.fieldCounter}`}static getFormDefinition(e,t){return this.parseDocuments(e).forms[t]||null}static getAvailableForms(e){const t=this.parseDocuments(e);return Object.entries(t.forms).map(([e,t])=>({formId:e,formName:t.meta.formName,description:t.meta.description}))}}const Aa={class:'form-preview-panel'},Da={class:'preview-header'},xa={class:'preview-body'},_a={key:0,class:'preview-empty'},Ta={key:1,class:'preview-form'},$a={class:'form-title'},Ra={key:0,class:'form-desc'},La={class:'form-fields'},Pa={class:'field-label'},Oa={key:0,class:'required-mark'},Fa={class:'field-input-preview'},ja=['placeholder'],Ua=['placeholder'],za=['placeholder'],Wa={key:3,type:'date',class:'preview-input',disabled:''},Ha={key:4,type:'datetime-local',class:'preview-input',disabled:''},Ga={key:5,class:'preview-input',disabled:''},Ka={key:6,class:'radio-group'},Ja={key:7,class:'checkbox-group'},qa={key:8,class:'readonly-text'},Ya=['placeholder'],Xa=(0,l.defineComponent)({__name:'FormPreviewPanel',props:{document:{}},emits:['close'],setup(e){const t=e,a=(0,l.computed)(()=>{if(!t.document.isFormDocument)return[];const e=Ca(t.document),a={$meta:{extensible:!0},[t.document.docKey||'__preview']:e},n=Ma.parseDocuments(a),o=t.document.docKey||'__preview';return n.forms[o]?.fields||[]});function n(e){return e.options?e.options.map(e=>'string'==typeof e?e:e.label):[]}return(t,o)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',Aa,[(0,l.createElementVNode)('div',Da,[o[1]||(o[1]=(0,l.createElementVNode)('span',{class:'preview-icon'},'ğŸ‘ï¸',-1)),o[2]||(o[2]=(0,l.createElementVNode)('span',{class:'preview-title'},'è¡¨å•é¢„è§ˆ',-1)),(0,l.createElementVNode)('button',{class:'preview-close',onClick:o[0]||(o[0]=e=>t.$emit('close'))},'âœ•')]),(0,l.createElementVNode)('div',xa,[0===a.value.length?((0,l.openBlock)(),(0,l.createElementBlock)('div',_a,[...o[3]||(o[3]=[(0,l.createElementVNode)('p',null,'æš‚æ— è¡¨å•å­—æ®µï¼Œè¯·åœ¨æ–‡æ¡£èŠ‚ç‚¹ä¸Šç»‘å®š $fieldDef',-1)])])):((0,l.openBlock)(),(0,l.createElementBlock)('div',Ta,[(0,l.createElementVNode)('div',$a,(0,l.toDisplayString)(e.document.formMeta?.formName||e.document.title),1),e.document.formMeta?.description?((0,l.openBlock)(),(0,l.createElementBlock)('div',Ra,(0,l.toDisplayString)(e.document.formMeta.description),1)):(0,l.createCommentVNode)('v-if',!0),(0,l.createElementVNode)('div',La,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(a.value,e=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.fieldId,class:'preview-field'},[(0,l.createElementVNode)('label',Pa,[(0,l.createTextVNode)((0,l.toDisplayString)(e.label)+' ',1),e.required?((0,l.openBlock)(),(0,l.createElementBlock)('span',Oa,'*')):(0,l.createCommentVNode)('v-if',!0)]),(0,l.createElementVNode)('div',Fa,['text'===e.inputType?((0,l.openBlock)(),(0,l.createElementBlock)('input',{key:0,type:'text',class:'preview-input',placeholder:e.placeholder||e.label,disabled:''},null,8,ja)):'textarea'===e.inputType?((0,l.openBlock)(),(0,l.createElementBlock)('textarea',{key:1,class:'preview-textarea',placeholder:e.placeholder||e.label,rows:'2',disabled:''},null,8,Ua)):'number'===e.inputType?((0,l.openBlock)(),(0,l.createElementBlock)('input',{key:2,type:'number',class:'preview-input',placeholder:e.placeholder||'0',disabled:''},null,8,za)):'date'===e.inputType?((0,l.openBlock)(),(0,l.createElementBlock)('input',Wa)):'datetime'===e.inputType?((0,l.openBlock)(),(0,l.createElementBlock)('input',Ha)):'select'===e.inputType?((0,l.openBlock)(),(0,l.createElementBlock)('select',Ga,[(0,l.createElementVNode)('option',null,(0,l.toDisplayString)(e.placeholder||'è¯·é€‰æ‹©'),1),((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(n(e),e=>((0,l.openBlock)(),(0,l.createElementBlock)('option',{key:e},(0,l.toDisplayString)(e),1))),128))])):'radio'===e.inputType?((0,l.openBlock)(),(0,l.createElementBlock)('div',Ka,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(n(e),e=>((0,l.openBlock)(),(0,l.createElementBlock)('label',{key:e,class:'radio-option'},[o[4]||(o[4]=(0,l.createElementVNode)('input',{type:'radio',disabled:''},null,-1)),(0,l.createTextVNode)(' '+(0,l.toDisplayString)(e),1)]))),128))])):'checkbox'===e.inputType?((0,l.openBlock)(),(0,l.createElementBlock)('div',Ja,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(n(e),e=>((0,l.openBlock)(),(0,l.createElementBlock)('label',{key:e,class:'checkbox-option'},[o[5]||(o[5]=(0,l.createElementVNode)('input',{type:'checkbox',disabled:''},null,-1)),(0,l.createTextVNode)(' '+(0,l.toDisplayString)(e),1)]))),128))])):'readonly'===e.inputType?((0,l.openBlock)(),(0,l.createElementBlock)('span',qa,(0,l.toDisplayString)(e.defaultValue||'ï¼ˆåªè¯»å­—æ®µï¼‰'),1)):((0,l.openBlock)(),(0,l.createElementBlock)('input',{key:9,type:'text',class:'preview-input',placeholder:e.inputType,disabled:''},null,8,Ya))])]))),128))])]))])]))}}),Za=(0,B.A)(Xa,[['__scopeId','data-v-9c3fd1f4']]),Qa={class:'field-editor-modal'},en={class:'modal-header'},tn={class:'modal-body'},an={class:'field-info'},nn={class:'fields-list'},on={class:'field-row'},ln={class:'form-group'},sn=['onUpdate:modelValue'],rn={class:'form-group',style:{'max-width':'150px'}},cn=['onUpdate:modelValue'],dn=['onClick'],un={class:'field-options'},mn={class:'checkbox-label'},pn=['checked','onChange'],vn={key:0,class:'options-input'},fn=['value','onCompositionend','onChange'],gn={class:'source-group'},hn={class:'checkbox-label'},yn=['checked','onChange'],Vn={key:1,class:'placeholder-input'},Nn=['value','onInput'],En={class:'modal-footer'},kn=(0,l.defineComponent)({__name:'FieldDefEditor',props:{visible:{type:Boolean},nodeKey:{},fieldDefs:{}},emits:['close','save'],setup(e,{emit:t}){const a=e,n=t,o=(0,l.ref)([]);function s(){o.value.push({label:'',inputType:'text',required:!1})}function r(){n('save',o.value.filter(e=>e.label.trim()))}function c(e){return e.split(/[,ï¼Œ]/).map(e=>e.trim()).filter(e=>e)}return(0,l.watch)(()=>a.visible,e=>{e&&(o.value=a.fieldDefs.map(e=>({...e})))}),(t,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',null,[(0,l.createVNode)(l.Transition,{name:'modal'},{default:(0,l.withCtx)(()=>[e.visible?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'field-editor-overlay',onClick:a[2]||(a[2]=(0,l.withModifiers)(e=>t.$emit('close'),['self']))},[(0,l.createElementVNode)('div',Qa,[(0,l.createElementVNode)('div',en,[a[3]||(a[3]=(0,l.createElementVNode)('div',{class:'modal-title'},[(0,l.createElementVNode)('span',{class:'modal-icon'},'ğŸ“‹'),(0,l.createElementVNode)('h3',null,'è¡¨å•å­—æ®µç»‘å®š')],-1)),(0,l.createElementVNode)('button',{class:'modal-close',onClick:a[0]||(a[0]=e=>t.$emit('close'))},'âœ•')]),(0,l.createElementVNode)('div',tn,[(0,l.createElementVNode)('p',an,[a[4]||(a[4]=(0,l.createTextVNode)('ä¸ºèŠ‚ç‚¹ "',-1)),(0,l.createElementVNode)('strong',null,(0,l.toDisplayString)(e.nodeKey),1),a[5]||(a[5]=(0,l.createTextVNode)('" ç»‘å®šè¡¨å•å­—æ®µ',-1))]),(0,l.createCommentVNode)(' å·²ç»‘å®šçš„å­—æ®µåˆ—è¡¨ '),(0,l.createElementVNode)('div',nn,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.value,(e,t)=>{return(0,l.openBlock)(),(0,l.createElementBlock)('div',{key:t,class:'field-item'},[(0,l.createElementVNode)('div',on,[(0,l.createElementVNode)('div',ln,[a[6]||(a[6]=(0,l.createElementVNode)('label',null,'å­—æ®µæ ‡ç­¾',-1)),(0,l.withDirectives)((0,l.createElementVNode)('input',{'onUpdate:modelValue':t=>e.label=t,type:'text',class:'form-input',placeholder:'å­—æ®µæ ‡ç­¾'},null,8,sn),[[l.vModelText,e.label]])]),(0,l.createElementVNode)('div',rn,[a[8]||(a[8]=(0,l.createElementVNode)('label',null,'è¾“å…¥ç±»å‹',-1)),(0,l.withDirectives)((0,l.createElementVNode)('select',{'onUpdate:modelValue':t=>e.inputType=t,class:'form-input'},[...a[7]||(a[7]=[(0,l.createElementVNode)('option',{value:'text'},'æ–‡æœ¬',-1),(0,l.createElementVNode)('option',{value:'textarea'},'å¤šè¡Œæ–‡æœ¬',-1),(0,l.createElementVNode)('option',{value:'number'},'æ•°å­—',-1),(0,l.createElementVNode)('option',{value:'date'},'æ—¥æœŸ',-1),(0,l.createElementVNode)('option',{value:'datetime'},'æ—¥æœŸæ—¶é—´',-1),(0,l.createElementVNode)('option',{value:'select'},'ä¸‹æ‹‰é€‰æ‹©',-1),(0,l.createElementVNode)('option',{value:'radio'},'å•é€‰',-1),(0,l.createElementVNode)('option',{value:'checkbox'},'å¤šé€‰',-1),(0,l.createElementVNode)('option',{value:'readonly'},'åªè¯»',-1),(0,l.createElementVNode)('option',{value:'table'},'è¡¨æ ¼',-1)])],8,cn),[[l.vModelSelect,e.inputType]])]),(0,l.createElementVNode)('button',{class:'remove-btn',title:'ç§»é™¤å­—æ®µ',onClick:e=>function(e){o.value.splice(e,1)}(t)},'âœ•',8,dn)]),(0,l.createCommentVNode)(' é¢å¤–é€‰é¡¹ '),(0,l.createElementVNode)('div',un,[(0,l.createElementVNode)('label',mn,[(0,l.createElementVNode)('input',{type:'checkbox',checked:e.required,onChange:t=>e.required=t.target.checked},null,40,pn),a[9]||(a[9]=(0,l.createTextVNode)(' å¿…å¡« ',-1))]),['select','radio','checkbox'].includes(e.inputType)?((0,l.openBlock)(),(0,l.createElementBlock)('div',vn,[a[10]||(a[10]=(0,l.createElementVNode)('label',null,'é€‰é¡¹ï¼ˆç”¨é€—å·æˆ–é¡¿å·åˆ†éš”ï¼Œå¦‚ï¼šé€‰é¡¹1ã€é€‰é¡¹2ã€é€‰é¡¹3ï¼‰',-1)),(0,l.createElementVNode)('input',{value:(n=e.options,n&&Array.isArray(n)?n.map(e=>'string'==typeof e?e:e.label||'').join(','):''),type:'text',class:'form-input',placeholder:'é€‰é¡¹1ã€é€‰é¡¹2ã€é€‰é¡¹3',onCompositionend:t=>e.options=c(t.target.value),onChange:t=>e.options=c(t.target.value)},null,40,fn)])):(0,l.createCommentVNode)('v-if',!0),(0,l.createElementVNode)('div',gn,[(0,l.createElementVNode)('label',hn,[(0,l.createElementVNode)('input',{type:'checkbox',checked:'roster'===e.sourceType,onChange:t=>{e.sourceType=t.target.checked?'roster':void 0,'roster'===e.sourceType&&(e.sourcePath='MC.èŠ±åå†Œ',e.displayField='name')}},null,40,yn),a[11]||(a[11]=(0,l.createTextVNode)(' èŠ±åå†Œé€‰æ‹©å™¨ ',-1))])]),(e.placeholder,(0,l.openBlock)(),(0,l.createElementBlock)('div',Vn,[a[12]||(a[12]=(0,l.createElementVNode)('label',null,'å ä½æç¤º',-1)),(0,l.createElementVNode)('input',{value:e.placeholder||'',type:'text',class:'form-input',placeholder:'å ä½æç¤ºæ–‡æœ¬',onInput:t=>e.placeholder=t.target.value||void 0},null,40,Nn)]))])]);var n}),128))]),(0,l.createElementVNode)('button',{class:'add-field-btn',onClick:s},' + æ·»åŠ å­—æ®µ ')]),(0,l.createElementVNode)('div',En,[(0,l.createElementVNode)('button',{class:'btn btn-secondary',onClick:a[1]||(a[1]=e=>t.$emit('close'))},'å–æ¶ˆ'),(0,l.createElementVNode)('button',{class:'btn btn-primary',onClick:r},'ç¡®è®¤')])])])):(0,l.createCommentVNode)('v-if',!0)]),_:1})]))}}),bn=(0,B.A)(kn,[['__scopeId','data-v-be091d6c']]),Cn={class:'section-header'},wn={class:'doc-count'},Sn={key:1,class:'empty-state'},Bn={class:'document-edit-area'},In={class:'outline-area'},Mn={class:'doc-toolbar'},An=(0,l.defineComponent)({__name:'DocumentEditorSection',props:{documents:{}},emits:['update:documents'],setup(e,{emit:t}){const a=e,n=t,o=(0,l.ref)(0),s=(0,l.ref)(!1),r=(0,l.ref)(!1),c=(0,l.ref)(''),i=(0,l.ref)(''),d=(0,l.ref)([]),u=(0,l.computed)(()=>a.documents[o.value]),m={formName:''};function p(){const e=Pt({docKey:`æ–‡æ¡£${a.documents.length+1}`,title:'',description:''}),t=[...a.documents,e];n('update:documents',t),o.value=t.length-1}function v(){const e=Pt({docKey:'å‘˜å·¥å®ˆåˆ™',title:'å‘˜å·¥å®ˆåˆ™',description:'åœºæ™¯ä¸»è¦è§„ç« åˆ¶åº¦æ–‡æ¡£'}),t=Pt({docKey:'ç”³è¯·è¡¨ç®¡ç†åŠæ³•',title:'ç”³è¯·è¡¨ç®¡ç†åŠæ³•',description:'å„ç±»ç”³è¯·è¡¨æ¨¡æ¿åŠç®¡ç†è§„å®š',isFormDocument:!0,formMeta:{formName:'é€šç”¨ç”³è¯·è¡¨',workflow:[{step:1,name:'æäº¤ç”³è¯·',handler:'ç”³è¯·äºº',canReject:!1},{step:2,name:'å®¡æ‰¹',handler:'ä¸»ç®¡',canReject:!0}]}}),l=Lt({key:'ç¬¬ä¸€ç«  ç”³è¯·æµç¨‹',type:'branch',text:'æœ¬ç« è§„å®šå„ç±»ç”³è¯·çš„æµç¨‹åŠè¦æ±‚ã€‚',sortIndex:0}),s=Lt({key:'ç¬¬ä¸€æ¡ ç”³è¯·è¡¨å­—æ®µ',type:'branch',text:'ç”³è¯·äººé¡»å¡«å†™ä»¥ä¸‹ä¿¡æ¯æäº¤ç”³è¯·ã€‚',parentId:l.id,sortIndex:0,fieldDefs:[{label:'ç”³è¯·äº‹é¡¹',inputType:'text',required:!0,placeholder:'ç®€è¦æè¿°ç”³è¯·äº‹é¡¹'},{label:'ç”³è¯·åŸå› ',inputType:'textarea',required:!0,placeholder:'è¯¦ç»†è¯´æ˜ç”³è¯·åŸå› '},{label:'ç”³è¯·äºº',inputType:'text',required:!0,sourceType:'roster',sourcePath:'MC.èŠ±åå†Œ',displayField:'name'},{label:'ç”³è¯·æ—¥æœŸ',inputType:'date',required:!0}]});l.childIds=[s.id],t.nodes.set(l.id,l),t.nodes.set(s.id,s),t.rootNodeIds=[l.id];const r=[...a.documents,e,t];n('update:documents',r),o.value=a.documents.length}function f(e){if(a.documents.length<=1)return;const t=[...a.documents];t.splice(e,1),n('update:documents',t),o.value>=t.length&&(o.value=t.length-1)}function g(e,t){const a=u.value;a&&(a[e]=t,'isFormDocument'!==e||t||(a.formMeta=void 0),'isFormDocument'===e&&t&&!a.formMeta&&(a.formMeta={...m,formName:a.title||a.docKey}),E())}function h(e){const t=u.value;t&&(t.formMeta=e,E())}function y(){E()}function V(e){const t=u.value;if(!t)return;const a=t.nodes.get(e);a&&(c.value=e,i.value=a.key||'(æœªå‘½åèŠ‚ç‚¹)',d.value=a.fieldDefs?[...a.fieldDefs]:[],r.value=!0)}function N(e){const t=u.value;if(!t)return;const a=t.nodes.get(c.value);a&&(a.fieldDefs=e.length>0?e:void 0,e.length>0&&(a.type='branch'),r.value=!1,E())}function E(){n('update:documents',[...a.documents])}return(0,l.onMounted)(()=>{0===a.documents.length&&v()}),(t,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('section',{class:(0,l.normalizeClass)(['setting-section document-editor-section',{'has-content':e.documents.length>0}])},[(0,l.createElementVNode)('div',Cn,[a[4]||(a[4]=(0,l.createElementVNode)('div',{class:'section-header-left'},[(0,l.createElementVNode)('span',{class:'section-icon'},'ğŸ“‹'),(0,l.createElementVNode)('h3',{class:'section-title'},'è§„ç« åˆ¶åº¦æ–‡æ¡£')],-1)),(0,l.createElementVNode)('span',wn,(0,l.toDisplayString)(e.documents.length)+' ä»½æ–‡æ¡£',1)]),(0,l.createCommentVNode)(' æ–‡æ¡£ Tabs '),e.documents.length>0?((0,l.openBlock)(),(0,l.createBlock)(pt,{key:0,documents:e.documents,'active-index':o.value,onSelect:a[0]||(a[0]=e=>o.value=e),onAdd:p,onDelete:f},null,8,['documents','active-index'])):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' ç©ºçŠ¶æ€ '),0===e.documents.length?((0,l.openBlock)(),(0,l.createElementBlock)('div',Sn,[a[7]||(a[7]=(0,l.createElementVNode)('p',{class:'empty-text'},'æš‚æ— æ–‡æ¡£ï¼Œç‚¹å‡»æŒ‰é’®åˆ›å»ºç¬¬ä¸€ä»½è§„ç« åˆ¶åº¦',-1)),(0,l.createElementVNode)('div',{class:'empty-actions'},[(0,l.createElementVNode)('button',{class:'add-doc-btn',onClick:p},[...a[5]||(a[5]=[(0,l.createElementVNode)('span',null,'+ æ–°å»ºç©ºç™½æ–‡æ¡£',-1)])]),(0,l.createElementVNode)('button',{class:'add-doc-btn secondary',onClick:v},[...a[6]||(a[6]=[(0,l.createElementVNode)('span',null,'+ å¿«é€Ÿåˆ›å»ºé»˜è®¤æ–‡æ¡£',-1)])])])])):u.value?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:2},[(0,l.createCommentVNode)(' å½“å‰æ–‡æ¡£ç¼–è¾‘åŒº '),(0,l.createElementVNode)('div',Bn,[(0,l.createCommentVNode)(' æ–‡æ¡£å…ƒæ•°æ® '),(0,l.createVNode)(wt,{document:u.value,onUpdate:g},null,8,['document']),(0,l.createCommentVNode)(' è¡¨å•å…ƒæ•°æ®ç¼–è¾‘ï¼ˆä»…è¡¨å•æ–‡æ¡£ï¼‰ '),u.value.isFormDocument?((0,l.openBlock)(),(0,l.createBlock)(fa,{key:0,'form-meta':u.value.formMeta||m,onUpdate:h},null,8,['form-meta'])):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' å¤§çº²ç¼–è¾‘å™¨ '),(0,l.createElementVNode)('div',In,[(0,l.createVNode)(Jt,{document:u.value,onUpdate:y,onEditFieldDef:V},null,8,['document'])]),(0,l.createCommentVNode)(' è¡¨å•é¢„è§ˆï¼ˆä»…è¡¨å•æ–‡æ¡£ï¼‰ '),u.value.isFormDocument&&s.value?((0,l.openBlock)(),(0,l.createBlock)(Za,{key:1,document:u.value,onClose:a[1]||(a[1]=e=>s.value=!1)},null,8,['document'])):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' åº•éƒ¨å·¥å…·æ  '),(0,l.createElementVNode)('div',Mn,[u.value.isFormDocument?((0,l.openBlock)(),(0,l.createElementBlock)('button',{key:0,class:(0,l.normalizeClass)(['toolbar-btn',{active:s.value}]),onClick:a[2]||(a[2]=e=>s.value=!s.value)},[a[8]||(a[8]=(0,l.createElementVNode)('span',null,'ğŸ‘ï¸',-1)),(0,l.createElementVNode)('span',null,(0,l.toDisplayString)(s.value?'å…³é—­é¢„è§ˆ':'è¡¨å•é¢„è§ˆ'),1)],2)):(0,l.createCommentVNode)('v-if',!0)])])],2112)):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' å­—æ®µå®šä¹‰ç¼–è¾‘å™¨ '),(0,l.createVNode)(bn,{visible:r.value,'node-key':i.value,'field-defs':d.value,onClose:a[3]||(a[3]=e=>r.value=!1),onSave:N},null,8,['visible','node-key','field-defs'])],2))}}),Dn=(0,B.A)(An,[['__scopeId','data-v-456f4b8c']]),xn={class:'section-content'},_n={class:'form-row'},Tn={class:'form-group'},$n=['value'],Rn={class:'char-count'},Ln=(0,l.defineComponent)({__name:'AdditionalNotesSection',props:{modelValue:{}},emits:['update:modelValue'],setup:e=>(t,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('section',{class:(0,l.normalizeClass)(['setting-section',{'has-content':e.modelValue}])},[a[1]||(a[1]=(0,l.createStaticVNode)('<div class="section-header" data-v-622bcc9a><div class="section-header-left" data-v-622bcc9a><span class="section-icon" data-v-622bcc9a>ğŸ“</span><h3 class="section-title" data-v-622bcc9a>è¡¥å……è¯´æ˜</h3></div><span class="optional-badge" data-v-622bcc9a>å¯é€‰</span></div>',1)),(0,l.createElementVNode)('div',xn,[(0,l.createElementVNode)('div',_n,[(0,l.createElementVNode)('div',Tn,[(0,l.createElementVNode)('textarea',{value:e.modelValue,class:(0,l.normalizeClass)(['form-textarea',{'has-value':e.modelValue}]),rows:'2',placeholder:'å…¶ä»–æƒ³è¦å‘Šè¯‰AIçš„å†…å®¹...',onInput:a[0]||(a[0]=e=>t.$emit('update:modelValue',e.target.value))},null,42,$n),(0,l.createElementVNode)('span',Rn,(0,l.toDisplayString)(e.modelValue?.length||0)+' å­—',1)])])])],2))}),Pn=(0,B.A)(Ln,[['__scopeId','data-v-622bcc9a']]),On={class:'panel-footer'},Fn={class:'footer-left'},jn=['disabled'],Un=['disabled'],zn=['disabled'],Wn={class:'footer-right'},Hn=['disabled'],Gn=['disabled'],Kn={key:0,class:'btn-loading'},Jn=(0,l.defineComponent)({__name:'GameStartFooter',props:{isSubmitting:{type:Boolean},isValid:{type:Boolean},aiMode:{}},emits:['random-fill','reset','save-preset','preview-prompt','start-game'],setup:e=>(t,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('footer',On,[(0,l.createElementVNode)('div',Fn,[(0,l.createElementVNode)('button',{class:'btn btn-secondary',disabled:e.isSubmitting,onClick:a[0]||(a[0]=e=>t.$emit('random-fill'))},' éšæœºå¡«å…… ',8,jn),(0,l.createElementVNode)('button',{class:'btn btn-secondary',disabled:e.isSubmitting,onClick:a[1]||(a[1]=e=>t.$emit('reset'))},' é‡ç½® ',8,Un),(0,l.createElementVNode)('button',{class:'btn btn-success',disabled:e.isSubmitting,onClick:a[2]||(a[2]=e=>t.$emit('save-preset'))},' ä¿å­˜é¢„è®¾ ',8,zn)]),(0,l.createElementVNode)('div',Wn,[(0,l.createElementVNode)('button',{class:'btn btn-outline-primary',disabled:e.isSubmitting||!e.isValid,onClick:a[3]||(a[3]=e=>t.$emit('preview-prompt'))},' é¢„è§ˆ ',8,Hn),(0,l.createElementVNode)('button',{class:'btn btn-primary',disabled:e.isSubmitting||!e.isValid,onClick:a[4]||(a[4]=e=>t.$emit('start-game'))},[e.isSubmitting?((0,l.openBlock)(),(0,l.createElementBlock)('span',Kn,[...a[5]||(a[5]=[(0,l.createElementVNode)('span',{class:'loading-dot'},null,-1),(0,l.createElementVNode)('span',{class:'loading-dot'},null,-1),(0,l.createElementVNode)('span',{class:'loading-dot'},null,-1)])])):((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createTextVNode)((0,l.toDisplayString)('off'===e.aiMode?'ç›´æ¥å¼€å§‹':'AIæ¶¦è‰²å¹¶å¼€å§‹'),1)],64))],8,Gn)])]))}),qn=(0,B.A)(Jn,[['__scopeId','data-v-6b14a14a']]),Yn={class:'preset-panel-modal'},Xn={class:'modal-header'},Zn={class:'modal-body'},Qn={class:'toolbar'},eo={class:'toolbar-info'},to={class:'toolbar-actions'},ao=['disabled'],no={class:'preset-list'},oo={key:0,class:'empty-state'},lo={key:1,class:'preset-items'},so=['onClick'],ro={class:'preset-item-icon'},co={class:'preset-item-content'},io={class:'preset-item-name'},uo={key:0,class:'preset-item-desc'},mo={class:'preset-item-meta'},po={class:'preset-item-actions'},vo=['onClick'],fo=['onClick'],go={class:'modal-footer'},ho={class:'save-preset-modal'},yo={class:'modal-body'},Vo={class:'form-group'},No={class:'form-group'},Eo={class:'modal-footer'},ko=['disabled'],bo={class:'delete-confirm-modal'},Co={class:'modal-footer'},wo=(0,l.defineComponent)({__name:'PresetManagerDialog',props:{visible:{type:Boolean},presets:{},showSaveDialog:{type:Boolean},defaultSaveName:{}},emits:['close','load','save-current','save','delete','export','export-all','import','close-save-dialog'],setup(e,{emit:t}){const a=e,n=t,o=(0,l.ref)(''),s=(0,l.ref)(''),r=(0,l.ref)(!1),c=(0,l.ref)(''),i=(0,l.ref)(null);function d(e){return re[e.editorData?.sceneType]?.icon||'âœ¨'}function u(e){return e.editorData?.documents?.length||0}function m(e){try{return new Date(e).toLocaleString('zh-CN',{year:'numeric',month:'2-digit',day:'2-digit',hour:'2-digit',minute:'2-digit'})}catch{return e}}function p(){n('close-save-dialog')}function v(){o.value.trim()&&n('save',o.value.trim(),s.value.trim())}function f(){c.value&&n('delete',c.value),r.value=!1,c.value=''}function g(){i.value?.click()}function h(e){const t=e.target,a=t.files?.[0];if(!a)return;const o=new FileReader;o.onload=e=>{const t=e.target?.result;t&&n('import',t)},o.readAsText(a),t.value=''}return(0,l.watch)(()=>a.showSaveDialog,e=>{e&&(o.value=a.defaultSaveName,s.value='')}),(t,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',null,[(0,l.createCommentVNode)(' é¢„è®¾ç®¡ç†é¢æ¿ '),(0,l.createVNode)(l.Transition,{name:'modal'},{default:(0,l.withCtx)(()=>[e.visible?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'preset-panel-overlay',onClick:a[4]||(a[4]=(0,l.withModifiers)(e=>t.$emit('close'),['self']))},[(0,l.createElementVNode)('div',Yn,[(0,l.createElementVNode)('div',Xn,[a[9]||(a[9]=(0,l.createElementVNode)('div',{class:'modal-title'},[(0,l.createElementVNode)('span',{class:'modal-icon'},'ğŸ“'),(0,l.createElementVNode)('h3',null,'é¢„è®¾ç®¡ç†')],-1)),(0,l.createElementVNode)('button',{class:'modal-close',onClick:a[0]||(a[0]=e=>t.$emit('close'))},'âœ•')]),(0,l.createElementVNode)('div',Zn,[(0,l.createCommentVNode)(' æ“ä½œæ  '),(0,l.createElementVNode)('div',Qn,[(0,l.createElementVNode)('span',eo,(0,l.toDisplayString)(e.presets.length)+' ä¸ªé¢„è®¾',1),(0,l.createElementVNode)('div',to,[(0,l.createElementVNode)('button',{class:'toolbar-btn',title:'å¯¼å…¥é¢„è®¾',onClick:g},[...a[10]||(a[10]=[(0,l.createElementVNode)('span',null,'ğŸ“¥',-1),(0,l.createTextVNode)(' å¯¼å…¥ ',-1)])]),(0,l.createElementVNode)('button',{class:'toolbar-btn',title:'å¯¼å‡ºå…¨éƒ¨é¢„è®¾',disabled:0===e.presets.length,onClick:a[1]||(a[1]=e=>t.$emit('export-all'))},[...a[11]||(a[11]=[(0,l.createElementVNode)('span',null,'ğŸ“¤',-1),(0,l.createTextVNode)(' å¯¼å‡ºå…¨éƒ¨ ',-1)])],8,ao)])]),(0,l.createCommentVNode)(' é¢„è®¾åˆ—è¡¨ï¼ˆå¯æ»šåŠ¨ï¼‰ '),(0,l.createElementVNode)('div',no,[0===e.presets.length?((0,l.openBlock)(),(0,l.createElementBlock)('div',oo,[...a[12]||(a[12]=[(0,l.createElementVNode)('div',{class:'empty-icon'},'ğŸ“‚',-1),(0,l.createElementVNode)('div',{class:'empty-text'},'æš‚æ— é¢„è®¾',-1),(0,l.createElementVNode)('div',{class:'empty-hint'},'ä¿å­˜å½“å‰é…ç½®æˆ–å¯¼å…¥é¢„è®¾æ–‡ä»¶',-1)])])):((0,l.openBlock)(),(0,l.createElementBlock)('div',lo,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.presets,e=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.id,class:'preset-item',onClick:a=>t.$emit('load',e)},[(0,l.createElementVNode)('div',ro,(0,l.toDisplayString)(d(e)),1),(0,l.createElementVNode)('div',co,[(0,l.createElementVNode)('div',io,(0,l.toDisplayString)(e.name),1),e.description?((0,l.openBlock)(),(0,l.createElementBlock)('div',uo,(0,l.toDisplayString)(e.description),1)):(0,l.createCommentVNode)('v-if',!0),(0,l.createElementVNode)('div',mo,[(0,l.createElementVNode)('span',null,(0,l.toDisplayString)(u(e))+' ç¯‡æ–‡æ¡£',1),a[13]||(a[13]=(0,l.createElementVNode)('span',{class:'meta-sep'},'Â·',-1)),(0,l.createElementVNode)('span',null,(0,l.toDisplayString)(m(e.updatedAt)),1)])]),(0,l.createElementVNode)('div',po,[(0,l.createElementVNode)('button',{class:'action-btn',title:'å¯¼å‡º',onClick:(0,l.withModifiers)(a=>t.$emit('export',e.id),['stop'])},'ğŸ“¤',8,vo),(0,l.createElementVNode)('button',{class:'action-btn danger',title:'åˆ é™¤',onClick:(0,l.withModifiers)(t=>{return a=e.id,c.value=a,void(r.value=!0);var a},['stop'])},'ğŸ—‘ï¸',8,fo)])],8,so))),128))]))])]),(0,l.createElementVNode)('div',go,[(0,l.createElementVNode)('button',{class:'btn btn-secondary',onClick:a[2]||(a[2]=e=>t.$emit('close'))},'å…³é—­'),(0,l.createElementVNode)('button',{class:'btn btn-success',onClick:a[3]||(a[3]=e=>{t.$emit('close'),t.$emit('save-current')})},[...a[14]||(a[14]=[(0,l.createElementVNode)('span',null,'ğŸ’¾',-1),(0,l.createTextVNode)(' ä¿å­˜å½“å‰ä¸ºé¢„è®¾ ',-1)])])])])])):(0,l.createCommentVNode)('v-if',!0)]),_:1}),(0,l.createCommentVNode)(' ä¿å­˜é¢„è®¾å¯¹è¯æ¡† '),(0,l.createVNode)(l.Transition,{name:'modal'},{default:(0,l.withCtx)(()=>[e.showSaveDialog?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'save-preset-overlay',onClick:(0,l.withModifiers)(p,['self'])},[(0,l.createElementVNode)('div',ho,[(0,l.createElementVNode)('div',{class:'modal-header'},[a[15]||(a[15]=(0,l.createElementVNode)('div',{class:'modal-title'},[(0,l.createElementVNode)('span',{class:'modal-icon'},'ğŸ’¾'),(0,l.createElementVNode)('h3',null,'ä¿å­˜é¢„è®¾')],-1)),(0,l.createElementVNode)('button',{class:'modal-close',onClick:p},'âœ•')]),(0,l.createElementVNode)('div',yo,[(0,l.createElementVNode)('div',Vo,[a[16]||(a[16]=(0,l.createElementVNode)('label',{class:'form-label'},[(0,l.createTextVNode)('é¢„è®¾åç§° '),(0,l.createElementVNode)('span',{class:'required'},'*')],-1)),(0,l.withDirectives)((0,l.createElementVNode)('input',{'onUpdate:modelValue':a[5]||(a[5]=e=>o.value=e),type:'text',class:'form-input',placeholder:'è¾“å…¥é¢„è®¾åç§°',onKeyup:(0,l.withKeys)(v,['enter'])},null,544),[[l.vModelText,o.value]])]),(0,l.createElementVNode)('div',No,[a[17]||(a[17]=(0,l.createElementVNode)('label',{class:'form-label'},'é¢„è®¾æè¿°',-1)),(0,l.withDirectives)((0,l.createElementVNode)('textarea',{'onUpdate:modelValue':a[6]||(a[6]=e=>s.value=e),class:'form-textarea',rows:'2',placeholder:'ç®€è¦æè¿°ï¼ˆå¯é€‰ï¼‰'},null,512),[[l.vModelText,s.value]])])]),(0,l.createElementVNode)('div',Eo,[(0,l.createElementVNode)('button',{class:'btn btn-secondary',onClick:p},'å–æ¶ˆ'),(0,l.createElementVNode)('button',{class:'btn btn-primary',disabled:!o.value.trim(),onClick:v},'ä¿å­˜',8,ko)])])])):(0,l.createCommentVNode)('v-if',!0)]),_:1}),(0,l.createCommentVNode)(' åˆ é™¤ç¡®è®¤ '),(0,l.createVNode)(l.Transition,{name:'modal'},{default:(0,l.withCtx)(()=>[r.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'delete-confirm-overlay',onClick:a[8]||(a[8]=(0,l.withModifiers)(e=>r.value=!1,['self']))},[(0,l.createElementVNode)('div',bo,[a[18]||(a[18]=(0,l.createElementVNode)('div',{class:'modal-header danger'},[(0,l.createElementVNode)('div',{class:'modal-title'},[(0,l.createElementVNode)('span',{class:'modal-icon'},'âš ï¸'),(0,l.createElementVNode)('h3',null,'ç¡®è®¤åˆ é™¤')])],-1)),a[19]||(a[19]=(0,l.createElementVNode)('div',{class:'modal-body'},[(0,l.createElementVNode)('p',null,'ç¡®å®šè¦åˆ é™¤è¿™ä¸ªé¢„è®¾å—ï¼Ÿæ­¤æ“ä½œæ— æ³•æ’¤é”€ã€‚')],-1)),(0,l.createElementVNode)('div',Co,[(0,l.createElementVNode)('button',{class:'btn btn-secondary',onClick:a[7]||(a[7]=e=>r.value=!1)},'å–æ¶ˆ'),(0,l.createElementVNode)('button',{class:'btn btn-danger',onClick:f},'åˆ é™¤')])])])):(0,l.createCommentVNode)('v-if',!0)]),_:1}),(0,l.createCommentVNode)(' éšè—çš„æ–‡ä»¶è¾“å…¥ '),(0,l.createElementVNode)('input',{ref_key:'fileInput',ref:i,type:'file',accept:'.json',style:{display:'none'},onChange:h},null,544)]))}}),So=(0,B.A)(wo,[['__scopeId','data-v-8bbf8ee2']]),Bo={class:'prompt-preview-modal'},Io={class:'modal-header'},Mo={class:'modal-body'},Ao={class:'prompt-content-wrapper'},Do=['value'],xo={class:'prompt-stats'},_o={class:'stat-item'},To={class:'stat-item'},$o={key:0,class:'stat-item direct-badge'},Ro={class:'modal-footer'},Lo=(0,l.defineComponent)({__name:'PromptPreviewDialog',props:{visible:{type:Boolean},promptText:{},isDirectCommand:{type:Boolean}},emits:['close','confirm','update:promptText'],setup:e=>(t,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',null,[(0,l.createVNode)(l.Transition,{name:'modal'},{default:(0,l.withCtx)(()=>[e.visible?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'prompt-preview-overlay',onClick:a[4]||(a[4]=(0,l.withModifiers)(e=>t.$emit('close'),['self']))},[(0,l.createElementVNode)('div',Bo,[(0,l.createElementVNode)('div',Io,[a[5]||(a[5]=(0,l.createElementVNode)('div',{class:'modal-title'},[(0,l.createElementVNode)('span',{class:'modal-icon'},'ğŸ“‹'),(0,l.createElementVNode)('h3',null,'æç¤ºè¯é¢„è§ˆ')],-1)),(0,l.createElementVNode)('button',{class:'modal-close',onClick:a[0]||(a[0]=e=>t.$emit('close'))},'âœ•')]),(0,l.createElementVNode)('div',Mo,[a[8]||(a[8]=(0,l.createElementVNode)('div',{class:'prompt-info'},[(0,l.createElementVNode)('span',{class:'info-text'},'ä»¥ä¸‹æ˜¯å°†å‘é€ç»™AIçš„å¼€å±€æç¤ºè¯ï¼Œæ‚¨å¯ä»¥åœ¨æ­¤é¢„è§ˆå’Œç¼–è¾‘')],-1)),(0,l.createElementVNode)('div',Ao,[(0,l.createElementVNode)('textarea',{value:e.promptText,class:'prompt-textarea',rows:'20',onInput:a[1]||(a[1]=e=>t.$emit('update:promptText',e.target.value))},null,40,Do)]),(0,l.createElementVNode)('div',xo,[(0,l.createElementVNode)('span',_o,[a[6]||(a[6]=(0,l.createElementVNode)('span',{class:'stat-icon'},'ğŸ“',-1)),(0,l.createTextVNode)(' å­—æ•°ï¼š'+(0,l.toDisplayString)(e.promptText?.length||0),1)]),(0,l.createElementVNode)('span',To,[a[7]||(a[7]=(0,l.createElementVNode)('span',{class:'stat-icon'},'ğŸ“„',-1)),(0,l.createTextVNode)(' è¡Œæ•°ï¼š'+(0,l.toDisplayString)((e.promptText?.split('\n')||[]).length),1)]),e.isDirectCommand?((0,l.openBlock)(),(0,l.createElementBlock)('span',$o,' ç›´æ¥æ‰§è¡Œæ¨¡å¼ ')):(0,l.createCommentVNode)('v-if',!0)])]),(0,l.createElementVNode)('div',Ro,[(0,l.createElementVNode)('button',{class:'btn btn-secondary',onClick:a[2]||(a[2]=e=>t.$emit('close'))},'å–æ¶ˆ'),(0,l.createElementVNode)('button',{class:'btn btn-primary',onClick:a[3]||(a[3]=e=>t.$emit('confirm'))},[a[9]||(a[9]=(0,l.createElementVNode)('span',null,'ğŸš€',-1)),(0,l.createElementVNode)('span',null,(0,l.toDisplayString)(e.isDirectCommand?'ç¡®è®¤å¹¶ç›´æ¥æ‰§è¡Œ':'ç¡®è®¤å¹¶å¼€å§‹'),1)])])])])):(0,l.createCommentVNode)('v-if',!0)]),_:1})]))}),Po=(0,B.A)(Lo,[['__scopeId','data-v-478f66d2']]);class Oo{static instance=null;cachedData=null;constructor(){}static getInstance(){return Oo.instance||(Oo.instance=new Oo),Oo.instance}loadFromStorage(){if(this.cachedData)return this.cachedData;try{const e=localStorage.getItem(ce);if(e){const t=JSON.parse(e);return 2!==t.version?(console.log('[PresetService] æ£€æµ‹åˆ°æ—§ç‰ˆæœ¬æ•°æ®ï¼Œè¿›è¡Œè¿ç§»...'),this.migrateData(t)):(this.cachedData=t,t)}}catch(e){console.error('[PresetService] åŠ è½½é¢„è®¾æ•°æ®å¤±è´¥:',e)}const e={version:2,presets:[],lastUsedPresetId:void 0};return this.cachedData=e,e}saveToStorage(e){try{return localStorage.setItem(ce,JSON.stringify(e)),this.cachedData=e,console.log('[PresetService] é¢„è®¾æ•°æ®å·²ä¿å­˜'),!0}catch(e){return console.error('[PresetService] ä¿å­˜é¢„è®¾æ•°æ®å¤±è´¥:',e),!1}}migrateData(e){const t=[];for(const a of e.presets||[]){if(a.isBuiltin)continue;const e=a.formData;if(e&&!a.editorData){const t='string'==typeof e.rosterFields?e.rosterFields.split(/[,ï¼Œã€]/).map(e=>e.trim()).filter(e=>e):e.rosterFields||[];a.editorData={sceneType:e.sceneType||'office',sceneName:e.sceneName||'',sceneDescription:e.sceneDescription||'',worldView:e.worldView||'',playerName:e.playerName||'',playerAge:e.playerAge??null,playerPosition:e.playerPosition||'',playerDepartment:e.playerDepartment||'',rosterFields:t,additionalNotes:e.additionalNotes||'',documents:[],aiMode:'polish'},delete a.formData,delete a.isBuiltin}a.editorData&&t.push(a)}const a={version:2,presets:t,lastUsedPresetId:e.lastUsedPresetId};return this.saveToStorage(a),console.log(`[PresetService] è¿ç§»å®Œæˆï¼Œä¿ç•™ ${t.length} ä¸ªç”¨æˆ·é¢„è®¾`),a}getAllPresets(){return[...this.loadFromStorage().presets]}getPresetById(e){return this.loadFromStorage().presets.find(t=>t.id===e)||null}savePreset(e,t,a){try{const n=this.loadFromStorage(),o=function(e,t,a){const n=(new Date).toISOString();return{id:`preset_${Date.now()}_${Math.random().toString(36).substring(2,9)}`,name:e,description:a,editorData:{...t},createdAt:n,updatedAt:n}}(e,t,a);return n.presets.push(o),n.lastUsedPresetId=o.id,this.saveToStorage(n)?(console.log('[PresetService] é¢„è®¾å·²ä¿å­˜:',o.name),o):null}catch(e){return console.error('[PresetService] ä¿å­˜é¢„è®¾å¤±è´¥:',e),null}}updatePreset(e,t){try{const a=this.loadFromStorage(),n=a.presets.findIndex(t=>t.id===e);if(-1===n)return console.warn('[PresetService] é¢„è®¾ä¸å­˜åœ¨:',e),!1;const o=a.presets[n];return void 0!==t.name&&(o.name=t.name),void 0!==t.description&&(o.description=t.description),void 0!==t.editorData&&(o.editorData={...t.editorData}),o.updatedAt=(new Date).toISOString(),this.saveToStorage(a)}catch(e){return console.error('[PresetService] æ›´æ–°é¢„è®¾å¤±è´¥:',e),!1}}deletePreset(e){try{const t=this.loadFromStorage(),a=t.presets.findIndex(t=>t.id===e);return-1===a?(console.warn('[PresetService] é¢„è®¾ä¸å­˜åœ¨:',e),!1):(t.presets.splice(a,1),t.lastUsedPresetId===e&&(t.lastUsedPresetId=void 0),this.saveToStorage(t))}catch(e){return console.error('[PresetService] åˆ é™¤é¢„è®¾å¤±è´¥:',e),!1}}setLastUsedPreset(e){const t=this.loadFromStorage();t.lastUsedPresetId=e,this.saveToStorage(t)}getLastUsedPresetId(){return this.loadFromStorage().lastUsedPresetId}getLastUsedPreset(){const e=this.getLastUsedPresetId();return e?this.getPresetById(e):null}exportPresets(e){if(e){const t=this.getPresetById(e);if(!t)throw new Error('é¢„è®¾ä¸å­˜åœ¨');return JSON.stringify(t,null,2)}const t=this.getAllPresets();return JSON.stringify(t,null,2)}importPresets(e){try{const t=JSON.parse(e);let a=0;const n=Array.isArray(t)?t:[t];for(const e of n){if(!this.validatePresetData(e)){console.warn('[PresetService] è·³è¿‡æ— æ•ˆé¢„è®¾:',e);continue}this.savePreset(e.name,e.editorData,e.description)&&a++}return console.log(`[PresetService] æˆåŠŸå¯¼å…¥ ${a} ä¸ªé¢„è®¾`),a}catch(e){throw console.error('[PresetService] å¯¼å…¥é¢„è®¾å¤±è´¥:',e),new Error('å¯¼å…¥å¤±è´¥ï¼šæ— æ•ˆçš„ JSON æ ¼å¼')}}validatePresetData(e){if(!e||'object'!=typeof e)return!1;const t=e;if('string'!=typeof t.name||!t.name.trim())return!1;if(!t.editorData||'object'!=typeof t.editorData)return!1;const a=t.editorData;return'string'==typeof a.sceneType&&'string'==typeof a.sceneName}clearAllPresets(){try{const e={version:2,presets:[],lastUsedPresetId:void 0};return this.saveToStorage(e)}catch(e){return console.error('[PresetService] æ¸…é™¤é¢„è®¾å¤±è´¥:',e),!1}}getPresetCount(){return this.getAllPresets().length}refreshCache(){this.cachedData=null,this.loadFromStorage()}}const Fo=Oo.getInstance();function jo(e){const t={};t['MC.æ–‡æ¡£']=function(e){const t={$meta:{extensible:!0}};for(const a of e)a.docKey.trim()&&(t[a.docKey]=Ca(a));return t}(e.documents);const a={$meta:{extensible:!0}};for(const t of e.documents)if(t.isFormDocument){a[t.formMeta?.formName?.trim()||t.docKey||'é€šç”¨ç”³è¯·']={$meta:{extensible:!0}}}return t['MC.ç”³è¯·è®°å½•']=a,t['MC.å¾…åŠ']={$meta:{extensible:!0}},t['MC.å…¬å‘Š']={$meta:{extensible:!0}},t}function Uo(e){const t=e.playerName?.trim()||'<user>',a=[];return a.push('è¯·æ ¹æ®ä»¥ä¸‹è®¾å®šå¼€å§‹æ¸¸æˆï¼Œåˆå§‹åŒ–å˜é‡å¹¶ç”Ÿæˆå¼€å±€åœºæ™¯æè¿°ï¼š'),a.push(''),a.push('> æ³¨æ„ï¼šMC.æ–‡æ¡£ã€MC.ç”³è¯·è®°å½•ã€MC.å¾…åŠ å’Œ MC.å…¬å‘Š å·²ç”±å‰ç«¯é¢„å…ˆå†™å…¥ï¼Œä½ **ä¸éœ€è¦**ç”Ÿæˆè¿™äº›å˜é‡ã€‚'),a.push(''),a.push('## åœºæ™¯è®¾å®š'),a.push(`- åœºæ™¯ç±»å‹ï¼š${re[e.sceneType]?.label||e.sceneType}`),a.push(`- åœºæ™¯åç§°ï¼š${e.sceneName}`),e.sceneDescription?.trim()&&a.push(`- åœºæ™¯æè¿°ï¼š${e.sceneDescription}`),e.worldView?.trim()&&a.push(`- ä¸–ç•Œè§‚ï¼š${e.worldView}`),a.push(''),a.push('## ç©å®¶ä¿¡æ¯'),a.push(`- å§“åï¼š${t}`),e.playerAge&&a.push(`- å¹´é¾„ï¼š${e.playerAge}`),a.push(`- èŒä½ï¼š${e.playerPosition}`),e.playerDepartment?.trim()&&a.push(`- éƒ¨é—¨ï¼š${e.playerDepartment}`),a.push(''),a.push('## èŠ±åå†Œè®¾å®š'),a.push(`- èŠ±åå†Œå­—æ®µï¼š${e.rosterFields.join('ã€')}`),a.push('- è¯·ç”Ÿæˆ 2-3 ä¸ªåˆå§‹ NPC æ¡ç›®'),a.push(''),e.additionalNotes?.trim()&&(a.push('## è¡¥å……è¯´æ˜'),a.push(e.additionalNotes),a.push('')),a.push('---'),a.push(''),a.push('## å˜é‡åˆå§‹åŒ–è¦æ±‚'),a.push(''),a.push('ä½¿ç”¨`<UpdateVariable>`æ ‡ç­¾è¾“å‡ºä»¥ä¸‹å˜é‡ï¼ˆ**ä¸åŒ…æ‹¬** MC.æ–‡æ¡£ã€MC.ç”³è¯·è®°å½•ã€MC.å¾…åŠ å’Œ MC.å…¬å‘Šï¼‰ï¼š'),a.push(''),a.push('**1. MC.ç³»ç»Ÿ**ï¼š`{ "å½“å‰åœ°ç‚¹": "xxx", "å½“å‰æ—¶é—´": { "æ—¥æœŸ": "YYYYå¹´MæœˆDæ—¥", "æ—¶é—´": "HH:MM" } }`'),a.push(''),a.push('**2. MC.ç©å®¶**ï¼š`{ "å§“å": "<user>", "å¹´é¾„": æ•°å­—, "èŒä½": "xxx", "éƒ¨é—¨": "xxx" }`'),a.push(''),a.push('**3. MC.ä¸–ç•Œè®¾å®š**ï¼šä¿å­˜åœºæ™¯ç±»å‹ã€åç§°ã€æè¿°ã€ä¸–ç•Œè§‚'),a.push(''),a.push('**4. MC.èŠ±åå†Œ**ï¼ˆå†…è”Schema + entriesç»“æ„ï¼‰ï¼š'),a.push('  - èŠ±åå†Œå¯¹è±¡æœ¬èº«éœ€åŒ…å«`"$meta": { "extensible": true }`'),a.push('  - å†…è”`$schema`å®šä¹‰å­—æ®µç»“æ„'),a.push('  - æ¡ç›®åœ¨`entries`å­å¯¹è±¡ä¸‹ï¼Œé”®åæ ¼å¼`NoXXX`'),a.push('  - `entries`å’Œæ¯ä¸ªNPCæ¡ç›®éœ€åŒ…å«`"$meta": { "extensible": true }`'),a.push(''),a.push('**ä¸è¦**è¾“å‡º MC.æ–‡æ¡£ã€MC.ç”³è¯·è®°å½•ã€MC.å¾…åŠ å’Œ MC.å…¬å‘Šï¼Œè¿™äº›å˜é‡å·²ç»é¢„å…ˆåˆå§‹åŒ–ã€‚'),a.push(''),a.push('---'),a.push(''),a.push('è¯·ç”Ÿæˆå¼€å±€åœºæ™¯æè¿°ï¼Œå¹¶è¾“å‡ºå˜é‡åˆå§‹åŒ–å‘½ä»¤ã€‚'),a.join('\n')}function zo(e){const t=e.playerName?.trim()||'<user>',a=[];if(a.push('è¯·æ ¹æ®ä»¥ä¸‹è®¾å®šå¼€å§‹æ¸¸æˆï¼Œåˆå§‹åŒ–æ‰€æœ‰å˜é‡ï¼š'),a.push(''),a.push('## åœºæ™¯è®¾å®š'),a.push(`- åœºæ™¯ç±»å‹ï¼š${re[e.sceneType]?.label||e.sceneType}`),a.push(`- åœºæ™¯åç§°ï¼š${e.sceneName}`),e.sceneDescription?.trim()&&a.push(`- åœºæ™¯æè¿°ï¼š${e.sceneDescription}`),e.worldView?.trim()&&a.push(`- ä¸–ç•Œè§‚ï¼š${e.worldView}`),a.push(''),a.push('## ç©å®¶ä¿¡æ¯'),a.push(`- å§“åï¼š${t}`),e.playerAge&&a.push(`- å¹´é¾„ï¼š${e.playerAge}`),a.push(`- èŒä½ï¼š${e.playerPosition}`),e.playerDepartment?.trim()&&a.push(`- éƒ¨é—¨ï¼š${e.playerDepartment}`),a.push(''),e.documents.length>0){a.push('## è§„ç« åˆ¶åº¦æ–‡æ¡£éª¨æ¶'),a.push(''),a.push('ä»¥ä¸‹æ˜¯ç©å®¶é¢„å®šä¹‰çš„æ–‡æ¡£ç»“æ„éª¨æ¶ï¼Œè¯·**ä¿ç•™ç°æœ‰ç»“æ„å’Œç« èŠ‚å±‚çº§**ï¼Œæ¶¦è‰²å¹¶è¡¥å……å„æ¡æ¬¾çš„è¯¦ç»†å†…å®¹ã€‚'),a.push('å¦‚æœæŸäº›ç« èŠ‚å†…å®¹æ ‡æ³¨ä¸º"è¯·æ¶¦è‰²è¡¥å……"ï¼Œè¯·æ ¹æ®åœºæ™¯ç±»å‹ç”Ÿæˆåˆç†å†…å®¹ã€‚'),a.push('');for(const t of e.documents){const e=Sa(t);a.push(`### æ–‡æ¡£ï¼š${t.docKey||t.title}`),t.isFormDocument&&a.push('ï¼ˆæ­¤æ–‡æ¡£ä¸ºè¡¨å•æ–‡æ¡£ï¼Œè¯·ä¿ç•™ $formMeta å’Œ $fieldDef å®šä¹‰ï¼‰'),a.push('```json'),a.push(JSON.stringify(e,null,2)),a.push('```'),a.push('')}}return a.push('## èŠ±åå†Œè®¾å®š'),a.push(`- èŠ±åå†Œå­—æ®µï¼š${e.rosterFields.join('ã€')}`),a.push('- è¯·ç”Ÿæˆ 2-3 ä¸ªåˆå§‹ NPC æ¡ç›®'),a.push(''),e.additionalNotes?.trim()&&(a.push('## è¡¥å……è¯´æ˜'),a.push(e.additionalNotes),a.push('')),a.push('---'),a.push(''),a.push('## å˜é‡åˆå§‹åŒ–è¦æ±‚'),a.push(''),a.push('ä½¿ç”¨`<UpdateVariable>`æ ‡ç­¾è¾“å‡ºï¼Œéµå¾ªä»¥ä¸‹ç»“æ„ï¼š'),a.push(''),a.push('**1. MC.ç³»ç»Ÿ**ï¼š`{ "å½“å‰åœ°ç‚¹": "xxx", "å½“å‰æ—¶é—´": { "æ—¥æœŸ": "YYYYå¹´MæœˆDæ—¥", "æ—¶é—´": "HH:MM" } }`'),a.push(''),a.push('**2. MC.ç©å®¶**ï¼š`{ "å§“å": "<user>", "å¹´é¾„": æ•°å­—, "èŒä½": "xxx", "éƒ¨é—¨": "xxx" }`'),a.push(''),a.push('**3. MC.ä¸–ç•Œè®¾å®š**ï¼šä¿å­˜åœºæ™¯ç±»å‹ã€åç§°ã€æè¿°ã€ä¸–ç•Œè§‚'),a.push(''),a.push('**4. MC.æ–‡æ¡£**ï¼šåŸºäºä¸Šæ–¹éª¨æ¶æ¶¦è‰²è¡¥å……ï¼Œé‡‡ç”¨é€’å½’è‡ªç›¸ä¼¼èŠ‚ç‚¹ç»“æ„'),a.push('  - å±‚çº§æŒ‰keyç›´æ¥åµŒå¥—ï¼š`ç¬¬ä¸€ç«  æ€»åˆ™` â†’ `ç¬¬ä¸€èŠ‚ æœºæ„æ¦‚è¿°` â†’ `ç¬¬ä¸€æ¡`'),a.push('  - å¶å­èŠ‚ç‚¹ä¸ºå­—ç¬¦ä¸²ï¼Œåˆ†æ”¯èŠ‚ç‚¹ä¸º `{ _t: "æ­£æ–‡", _s: { ç¼–å·key: å­èŠ‚ç‚¹ } }` å¯¹è±¡'),a.push('  - `_s` å§‹ç»ˆä¸ºå¯¹è±¡ï¼ˆä¸æ˜¯æ•°ç»„ï¼‰ï¼Œkeyä¸ºç¼–å·'),a.push('  - å±‚çº§ç¼–å·ä½“ç³»ï¼šç« >èŠ‚>æ¡>æ¬¾(ä¸€äºŒä¸‰â€¦)>é¡¹(123â€¦)>ç›®(abcâ€¦)'),a.push('  - è¡¨å•æ–‡æ¡£éœ€ä¿ç•™å·²æœ‰çš„`$formMeta`å’Œ`$fieldDef`'),a.push('  - æ¯ä¸ªæ–‡æ¡£å’Œ`_s`éœ€åŒ…å«`"$meta": { "extensible": true }`'),a.push(''),a.push('**5. MC.èŠ±åå†Œ**ï¼ˆå†…è”Schema + entriesç»“æ„ï¼‰ï¼š'),a.push('  - èŠ±åå†Œå¯¹è±¡æœ¬èº«éœ€åŒ…å«`"$meta": { "extensible": true }`'),a.push('  - å†…è”`$schema`å®šä¹‰å­—æ®µç»“æ„'),a.push('  - æ¡ç›®åœ¨`entries`å­å¯¹è±¡ä¸‹ï¼Œé”®åæ ¼å¼`NoXXX`'),a.push('  - `entries`å’Œæ¯ä¸ªNPCæ¡ç›®éœ€åŒ…å«`"$meta": { "extensible": true }`'),a.push(''),a.push('**6. MC.ç”³è¯·è®°å½•**ï¼šæŒ‰è¡¨å•ç±»å‹åˆ†ç±»çš„ç©ºå®¹å™¨'),a.push(''),a.push('**7. MC.å¾…åŠ**ï¼šç©ºå®¹å™¨ `{ "$meta": { "extensible": true } }`'),a.push(''),a.push('**8. MC.å…¬å‘Š**ï¼šç©ºå®¹å™¨ `{ "$meta": { "extensible": true } }`'),a.push(''),a.push('---'),a.push(''),a.push('è¯·ç”Ÿæˆå¼€å±€åœºæ™¯æè¿°ï¼Œå¹¶è¾“å‡ºå®Œæ•´çš„å˜é‡åˆå§‹åŒ–å‘½ä»¤ã€‚'),a.join('\n')}function Wo(e){return'off'===e.aiMode?{prompt:Uo(e),directVariables:jo(e)}:{prompt:zo(e)}}const Ho={class:'game-start-panel'},Go={class:'panel-body'},Ko={class:'collapse-arrow'},Jo={key:0,class:'collapsible-warn'},qo={class:'collapsible-body'},Yo={class:'collapse-arrow'},Xo={class:'collapsible-body'},Zo={key:0,class:'validation-errors'},Qo={class:'error-header'},el={class:'error-list'},tl='mclite_gamestart_cache',al=(0,l.defineComponent)({__name:'GameStartPanel',emits:['start','cancel'],setup(e,{emit:t}){const a=t,n=(0,l.reactive)({sceneType:'office',sceneName:'',sceneDescription:'',worldView:'',playerName:'',playerAge:null,playerPosition:'',playerDepartment:'',rosterFields:[],additionalNotes:'',documents:[],aiMode:'polish'}),o=(0,l.ref)(!1),s=(0,l.ref)(!1),r=(0,l.ref)([]),c=(0,l.ref)(!1),i=(0,l.ref)(!0),d=(0,l.ref)([]),u=(0,l.ref)(!1),m=(0,l.ref)(!1),p=(0,l.ref)(!1),v=(0,l.ref)(''),f=(0,l.ref)(!1),g=(0,l.ref)(void 0),h=(0,l.computed)(()=>({sceneType:n.sceneType,sceneName:n.sceneName,sceneDescription:n.sceneDescription,worldView:n.worldView})),y=(0,l.computed)(()=>({playerName:n.playerName,playerAge:n.playerAge,playerPosition:n.playerPosition,playerDepartment:n.playerDepartment})),V=(0,l.computed)(()=>{if(!s.value)return{};const e={};return n.sceneName?.trim()||(e.sceneName='è¯·è¾“å…¥åœºæ™¯åç§°'),n.playerPosition?.trim()||(e.playerPosition='è¯·è¾“å…¥ç©å®¶èº«ä»½/èŒä½'),0===n.rosterFields.length&&(e.rosterFields='è¯·å®šä¹‰èŠ±åå†Œå­—æ®µ'),e}),N=(0,l.computed)(()=>!!(n.sceneType&&n.sceneName?.trim()&&n.playerPosition?.trim()&&n.rosterFields.length>0)),E=(0,l.computed)(()=>!n.sceneName?.trim()||!n.playerPosition?.trim()||0===n.rosterFields.length),k=(0,l.computed)(()=>{const e=re[n.sceneType]?.label||'è‡ªå®šä¹‰',t=(new Date).toLocaleString('zh-CN',{month:'2-digit',day:'2-digit',hour:'2-digit',minute:'2-digit'});return`${e} - ${n.sceneName||'æœªå‘½å'} (${t})`});function b(e){n.sceneType=e.sceneType,n.sceneName=e.sceneName,n.sceneDescription=e.sceneDescription,n.worldView=e.worldView}function C(e){n.playerName=e.playerName,n.playerAge=e.playerAge,n.playerPosition=e.playerPosition,n.playerDepartment=e.playerDepartment}function w(e){n.sceneType=e;const t=re[e];t&&'custom'!==e&&(n.sceneName=t.defaultName,n.sceneDescription=t.defaultDescription,t.defaultRosterFields&&(n.rosterFields=t.defaultRosterFields.split(/[,ï¼Œã€]/).map(e=>e.trim()).filter(e=>e)))}function S(){const e=[];return n.sceneName?.trim()||e.push('è¯·è¾“å…¥åœºæ™¯åç§°'),n.playerPosition?.trim()||e.push('è¯·è¾“å…¥ç©å®¶èº«ä»½/èŒä½'),0===n.rosterFields.length&&e.push('è¯·å®šä¹‰èŠ±åå†Œå­—æ®µ'),r.value=e,!(e.length>0)||(s.value=!0,c.value=!1,!1)}function B(){if(S()){o.value=!0;try{const e=Wo(n);console.log('[GameStartPanel] å¼€å§‹æ¸¸æˆ, prompté•¿åº¦:',e.prompt.length,'æœ‰directVariables:',!!e.directVariables),a('start',e)}catch(e){console.error('[GameStartPanel] å¼€å§‹æ¸¸æˆå¤±è´¥:',e)}finally{o.value=!1}}}function I(){if(!S())return;const e=Wo(n);v.value=e.prompt,g.value=e.directVariables,f.value=!!e.directVariables,p.value=!0}function M(){p.value=!1,o.value=!0;try{a('start',{prompt:v.value,directVariables:g.value})}finally{o.value=!1}}function A(){const e=['office','school','hospital','military'],t=e[Math.floor(Math.random()*e.length)];w(t);const a=[18,20,22,24,25,28,30];n.playerAge=a[Math.floor(Math.random()*a.length)];const o={office:['ç§‘å‘˜','ä¸»ä»»ç§‘å‘˜','å‰¯ç§‘é•¿','ç§‘é•¿'],school:['å­¦ç”Ÿ','ç­é•¿','å­¦ä¹ å§”å‘˜'],hospital:['å®ä¹ åŒ»ç”Ÿ','ä½é™¢åŒ»å¸ˆ','æŠ¤å£«'],military:['åˆ—å…µ','ä¸‹å£«','ä¸­å£«'],custom:['æˆå‘˜']}[t];n.playerPosition=o[Math.floor(Math.random()*o.length)];const l={office:['è¡ŒåŠ¨ä¸€ç§‘','è¡ŒåŠ¨äºŒç§‘','åå‹¤éƒ¨','äººäº‹éƒ¨'],school:['é«˜ä¸€(1)ç­','é«˜äºŒ(2)ç­'],hospital:['å†…ç§‘','å¤–ç§‘','æ€¥è¯Šç§‘'],military:['ä¸€è¿','äºŒè¿','é€šä¿¡è¿'],custom:['é»˜è®¤éƒ¨é—¨']}[t];n.playerDepartment=l[Math.floor(Math.random()*l.length)],s.value=!1}function D(){const e={sceneType:'office',sceneName:'',sceneDescription:'',worldView:'',playerName:'',playerAge:null,playerPosition:'',playerDepartment:'',rosterFields:[],additionalNotes:'',documents:[],aiMode:'polish'};Object.assign(n,e),s.value=!1,r.value=[];try{localStorage.removeItem(tl)}catch(e){}}function x(){d.value=Fo.getAllPresets()}function T(){x(),u.value=!0}function R(){m.value=!0}function L(e){const t=Ut(e.editorData);n.sceneType=t.sceneType,n.sceneName=t.sceneName,n.sceneDescription=t.sceneDescription,n.worldView=t.worldView,n.playerName=t.playerName,n.playerAge=t.playerAge,n.playerPosition=t.playerPosition,n.playerDepartment=t.playerDepartment,n.additionalNotes=t.additionalNotes,n.rosterFields=t.rosterFields,n.documents=t.documents,n.aiMode=t.aiMode,Fo.setLastUsedPreset(e.id),u.value=!1}function P(e,t){const a=jt(n);Fo.savePreset(e,a,t||void 0)&&(x(),m.value=!1)}function O(e){Fo.deletePreset(e),x()}function F(e){try{W(Fo.exportPresets(e),`preset_${e}.json`)}catch(e){console.error('[GameStartPanel] å¯¼å‡ºé¢„è®¾å¤±è´¥:',e)}}function j(){try{W(Fo.exportPresets(),`mclite_presets_${Date.now()}.json`)}catch(e){console.error('[GameStartPanel] å¯¼å‡ºå…¨éƒ¨é¢„è®¾å¤±è´¥:',e)}}function U(e){try{const t=Fo.importPresets(e);t>0&&(x(),console.log(`[GameStartPanel] æˆåŠŸå¯¼å…¥ ${t} ä¸ªé¢„è®¾`))}catch(e){console.error('[GameStartPanel] å¯¼å…¥é¢„è®¾å¤±è´¥:',e)}}function W(e,t){const a=new Blob([e],{type:'application/json'}),n=URL.createObjectURL(a),o=document.createElement('a');o.href=n,o.download=t,o.click(),URL.revokeObjectURL(n)}let H=null;return(0,l.watch)(()=>n,()=>(H&&clearTimeout(H),void(H=setTimeout(()=>{try{const e=jt(n);localStorage.setItem(tl,JSON.stringify(e))}catch(e){console.warn('[GameStartPanel] ç¼“å­˜ä¿å­˜å¤±è´¥:',e)}},500))),{deep:!0}),(0,l.onMounted)(()=>{x();(function(){try{const e=localStorage.getItem(tl);if(!e)return!1;const t=JSON.parse(e);if(!t||!t.sceneType)return!1;const a=Ut(t);return Object.assign(n,a),console.log('[GameStartPanel] å·²ä»ç¼“å­˜æ¢å¤è¡¨å•æ•°æ®'),!0}catch(e){return console.warn('[GameStartPanel] ç¼“å­˜æ¢å¤å¤±è´¥:',e),!1}})()||w('office')}),(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',Ho,[(0,l.createCommentVNode)(' å¤´éƒ¨ï¼šæ ‡é¢˜ + AIæ¨¡å¼ + é¢„è®¾æŒ‰é’® '),(0,l.createVNode)(se,{'ai-mode':n.aiMode,'preset-count':d.value.length,'onUpdate:aiMode':t[0]||(t[0]=e=>n.aiMode=e),onOpenPresets:T},null,8,['ai-mode','preset-count']),(0,l.createCommentVNode)(' é¢æ¿ä¸»ä½“ '),(0,l.createElementVNode)('div',Go,[(0,l.createCommentVNode)(' åŸºç¡€è®¾å®šï¼ˆå¯æŠ˜å ï¼‰ '),(0,l.createElementVNode)('div',{class:(0,l.normalizeClass)(['collapsible-section',{collapsed:c.value}])},[(0,l.createElementVNode)('button',{class:'collapsible-header',onClick:t[1]||(t[1]=e=>c.value=!c.value)},[(0,l.createElementVNode)('span',Ko,(0,l.toDisplayString)(c.value?'â–¸':'â–¾'),1),t[11]||(t[11]=(0,l.createElementVNode)('span',{class:'collapsible-title'},'åŸºç¡€è®¾å®š',-1)),c.value&&E.value?((0,l.openBlock)(),(0,l.createElementBlock)('span',Jo,'æœ‰æœªå¡«å¿…å¡«é¡¹')):(0,l.createCommentVNode)('v-if',!0)]),(0,l.withDirectives)((0,l.createElementVNode)('div',qo,[(0,l.createCommentVNode)(' åœºæ™¯è®¾å®š '),(0,l.createVNode)(Ae,{'model-value':h.value,errors:V.value,'onUpdate:modelValue':b,onSceneTypeChange:w},null,8,['model-value','errors']),(0,l.createCommentVNode)(' ç©å®¶è®¾å®š '),(0,l.createVNode)(We,{'model-value':y.value,errors:V.value,'onUpdate:modelValue':C},null,8,['model-value','errors']),(0,l.createCommentVNode)(' èŠ±åå†Œå­—æ®µ '),(0,l.createVNode)(lt,{'model-value':n.rosterFields,error:V.value.rosterFields,'onUpdate:modelValue':t[2]||(t[2]=e=>n.rosterFields=e)},null,8,['model-value','error'])],512),[[l.vShow,!c.value]])],2),(0,l.createCommentVNode)(' æ–‡æ¡£ç¼–è¾‘å™¨ï¼ˆæ ¸å¿ƒåŒºåŸŸï¼Œå§‹ç»ˆå±•å¼€ï¼‰ '),(0,l.createVNode)(Dn,{documents:n.documents,'onUpdate:documents':t[3]||(t[3]=e=>n.documents=e)},null,8,['documents']),(0,l.createCommentVNode)(' è¡¥å……è¯´æ˜ï¼ˆå¯æŠ˜å ï¼‰ '),(0,l.createElementVNode)('div',{class:(0,l.normalizeClass)(['collapsible-section',{collapsed:i.value}])},[(0,l.createElementVNode)('button',{class:'collapsible-header',onClick:t[4]||(t[4]=e=>i.value=!i.value)},[(0,l.createElementVNode)('span',Yo,(0,l.toDisplayString)(i.value?'â–¸':'â–¾'),1),t[12]||(t[12]=(0,l.createElementVNode)('span',{class:'collapsible-title'},'è¡¥å……è¯´æ˜',-1))]),(0,l.withDirectives)((0,l.createElementVNode)('div',Xo,[(0,l.createVNode)(Pn,{'model-value':n.additionalNotes,'onUpdate:modelValue':t[5]||(t[5]=e=>n.additionalNotes=e)},null,8,['model-value'])],512),[[l.vShow,!i.value]])],2)]),(0,l.createCommentVNode)(' åº•éƒ¨æ“ä½œæ  '),(0,l.createVNode)(qn,{'is-submitting':o.value,'is-valid':N.value,'ai-mode':n.aiMode,onRandomFill:A,onReset:D,onSavePreset:R,onPreviewPrompt:I,onStartGame:B},null,8,['is-submitting','is-valid','ai-mode']),(0,l.createCommentVNode)(' éªŒè¯é”™è¯¯æç¤º '),(0,l.createVNode)(l.Transition,{name:'slide-up'},{default:(0,l.withCtx)(()=>[r.value.length>0&&s.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',Zo,[(0,l.createElementVNode)('div',Qo,[t[13]||(t[13]=(0,l.createElementVNode)('span',{class:'error-icon'},'âš ï¸',-1)),t[14]||(t[14]=(0,l.createElementVNode)('span',null,'è¯·å®Œå–„ä»¥ä¸‹å¿…å¡«é¡¹ï¼š',-1)),(0,l.createElementVNode)('button',{class:'error-close',onClick:t[6]||(t[6]=e=>s.value=!1)},'âœ•')]),(0,l.createElementVNode)('ul',el,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(r.value,e=>((0,l.openBlock)(),(0,l.createElementBlock)('li',{key:e},(0,l.toDisplayString)(e),1))),128))])])):(0,l.createCommentVNode)('v-if',!0)]),_:1}),(0,l.createCommentVNode)(' é¢„è®¾ç®¡ç† '),(0,l.createVNode)(So,{visible:u.value,presets:d.value,'show-save-dialog':m.value,'default-save-name':k.value,onClose:t[7]||(t[7]=e=>u.value=!1),onLoad:L,onSaveCurrent:R,onSave:P,onDelete:O,onExport:F,onExportAll:j,onImport:U,onCloseSaveDialog:t[8]||(t[8]=e=>m.value=!1)},null,8,['visible','presets','show-save-dialog','default-save-name']),(0,l.createCommentVNode)(' æç¤ºè¯é¢„è§ˆ '),(0,l.createVNode)(Po,{visible:p.value,'prompt-text':v.value,'is-direct-command':f.value,onClose:t[9]||(t[9]=e=>p.value=!1),onConfirm:M,'onUpdate:promptText':t[10]||(t[10]=e=>v.value=e)},null,8,['visible','prompt-text','is-direct-command'])]))}}),nl=(0,B.A)(al,[['__scopeId','data-v-0b23890f']]);function ol(){try{if('undefined'!=typeof window&&window.Mvu)return window.Mvu}catch{}return null}const ll={isMvuAvailable(){const e=ol();return!(!e||'function'!=typeof e.getMvuData)},getMvuData(e){try{const t=ol();return t&&t.getMvuData(e||{type:'message',message_id:'latest'})||null}catch(e){return console.error('[MvuService] è·å–MVUæ•°æ®å¤±è´¥:',e),null}},getVariable(e,t){try{const a=ol();if(!a)return t?.default_value;const n=this.getMvuData(t);return n?a.getMvuVariable(n,e,{category:'stat',default_value:t?.default_value}):t?.default_value}catch(e){return console.error('[MvuService] è·å–å˜é‡å¤±è´¥:',e),t?.default_value}},async setVariable(e,t,a){try{const n=ol();if(!n)return console.error('[MvuService] è®¾ç½®å˜é‡å¤±è´¥: Mvu å¯¹è±¡ä¸å¯ç”¨'),!1;const o=this.getMvuData(a);if(!o)return console.error('[MvuService] è®¾ç½®å˜é‡å¤±è´¥: æ— æ³•è·å– MvuData'),!1;o.stat_data||(console.warn('[MvuService] stat_data ä¸ºç©ºï¼Œåˆå§‹åŒ–ä¸ºç©ºå¯¹è±¡'),o.stat_data={}),o.display_data||(o.display_data={}),console.log('[MvuService] å°è¯•è®¾ç½®å˜é‡:',{path:e,valueType:typeof t,valuePreview:'object'==typeof t?JSON.stringify(t).substring(0,100)+'...':t,stat_data_keys:Object.keys(o.stat_data||{})});let l=!1;try{l=await n.setMvuVariable(o,e,t,{reason:a?.reason,is_recursive:!0})}catch(e){console.warn('[MvuService] MVUåŸç”ŸAPIè°ƒç”¨å¼‚å¸¸:',e),l=!1}if(!l){console.log('[MvuService] MVUåŸç”ŸAPIå¤±è´¥ï¼Œå°è¯•ç›´æ¥è®¾ç½® stat_data...');try{o.stat_data||(console.warn('[MvuService] stat_data åœ¨ API è°ƒç”¨åå˜ä¸ºç©ºï¼Œé‡æ–°åˆå§‹åŒ–'),o.stat_data={});const n=e.split('.');if(n.length>1){let e=o.stat_data;for(let t=0;t<n.length-1;t++){const a=n[t];if(void 0===e[a]||null===e[a])console.log(`[MvuService] åˆ›å»ºä¸­é—´è·¯å¾„: ${n.slice(0,t+1).join('.')}`),e[a]={};else if('object'!=typeof e[a])return console.warn(`[MvuService] è·¯å¾„ "${n.slice(0,t+1).join('.')}" ä¸æ˜¯å¯¹è±¡ï¼Œæ— æ³•ç»§ç»­`),!1;e=e[a]}}this.setNestedValue(o.stat_data,e,t),o.display_data||(o.display_data={});const s=a?.reason?`æ–°å»º (${a.reason})`:'æ–°å»º';try{this.setNestedValue(o.display_data,e,s)}catch(e){console.warn('[MvuService] è®¾ç½® display_data å¤±è´¥:',e)}l=!0,console.log('[MvuService] ç›´æ¥è®¾ç½® stat_data æˆåŠŸ')}catch(e){console.error('[MvuService] ç›´æ¥è®¾ç½® stat_data å¤±è´¥:',e),l=!1}}if(l)try{await n.replaceMvuData(o,a||{type:'message',message_id:'latest'}),console.log('[MvuService] æ•°æ®å·²æ›¿æ¢ä¿å­˜')}catch(e){return console.error('[MvuService] æ›¿æ¢æ•°æ®å¤±è´¥:',e),!1}else console.error('[MvuService] å˜é‡è®¾ç½®å¤±è´¥');return l}catch(e){return console.error('[MvuService] è®¾ç½®å˜é‡å¤±è´¥:',e),!1}},setNestedValue(e,t,a){if(null==e)throw new Error(`[setNestedValue] ç›®æ ‡å¯¹è±¡ä¸º ${e}ï¼Œæ— æ³•è®¾ç½®è·¯å¾„ "${t}"`);if('object'!=typeof e)throw new Error(`[setNestedValue] ç›®æ ‡å¯¹è±¡ä¸æ˜¯å¯¹è±¡ç±»å‹ï¼Œæ— æ³•è®¾ç½®è·¯å¾„ "${t}"`);const n=t.split('.');let o=e;for(let e=0;e<n.length-1;e++){const t=n[e];if(null==o||'object'!=typeof o)throw new Error(`[setNestedValue] è·¯å¾„ "${n.slice(0,e).join('.')}" å¤„çš„å€¼ä¸æ˜¯å¯¹è±¡ï¼Œæ— æ³•ç»§ç»­è®¾ç½®`);t in o&&'object'==typeof o[t]&&null!==o[t]||(o[t]={}),o=o[t]}o[n[n.length-1]]=a},async setVariables(e,t){try{const a=ol();if(!a)return!1;const n=this.getMvuData(t);if(!n)return!1;for(const[o,l]of Object.entries(e))await a.setMvuVariable(n,o,l,{reason:t?.reason,is_recursive:!1});return await a.replaceMvuData(n,t||{type:'message',message_id:'latest'}),!0}catch(e){return console.error('[MvuService] æ‰¹é‡è®¾ç½®å˜é‡å¤±è´¥:',e),!1}},getAllVariableKeys(e){try{const t=this.getMvuData(e);return t?Object.keys(t.stat_data||{}):[]}catch{return[]}},getEvents(){const e=ol();return e?.events||null}},sl=t('mvu',()=>{const e=(0,l.shallowRef)(null),t=(0,l.ref)(!1),a=(0,l.ref)(!1),n=(0,l.ref)(null),o=(0,l.ref)({type:'message',message_id:'latest'}),s=(0,l.ref)([]),r=(0,l.ref)([]),c=(0,l.ref)(!1),i=(0,l.ref)(!1),d=t=>{if(console.log('[MvuStore] å˜é‡æ›´æ–°å¼€å§‹'),t)try{e.value=JSON.parse(JSON.stringify(t))}catch(a){e.value=t}},u=(e,t,a,n)=>{console.log(`[MvuStore] å˜é‡æ›´æ–°: ${t}`,{oldValue:a,newValue:n}),s.value.forEach(e=>{if(t===e.path||t.startsWith(e.path+'.'))try{e.callback(a,n)}catch(t){console.error(`[MvuStore] å˜é‡ç›‘å¬å™¨å›è°ƒå¤±è´¥ (${e.path}):`,t)}})},m=['MC'],p=(e,t)=>t.split('.').reduce((e,t)=>e&&'object'==typeof e?e[t]:void 0,e),v=t=>{if(console.log('[MvuStore] å˜é‡æ›´æ–°ç»“æŸäº‹ä»¶è§¦å‘'),i.value)return void console.log('[MvuStore] æ­£åœ¨æ‰§è¡Œå†…éƒ¨æ›´æ–°ï¼Œè·³è¿‡äº‹ä»¶å¤„ç†ï¼ˆé¿å…æ•°æ®è¦†ç›–ï¼‰');const a=ll.getMvuData(o.value);if(!a)return void console.warn('[MvuStore] è·å–åˆ°çš„æœ€æ–°æ•°æ®ä¸ºç©ºï¼Œä¿æŒç°æœ‰æ•°æ®ä¸å˜');if(!((e,t)=>{if(!e?.stat_data)return!0;const a=Object.keys(e.stat_data),n=Object.keys(t.stat_data||{});if(a.length>0&&n.length<.5*a.length)return console.warn('[MvuStore] æ•°æ®éªŒè¯å¤±è´¥ï¼šé”®æ•°é‡å‡å°‘è¿‡å¤š',{oldCount:a.length,newCount:n.length}),!1;for(const a of m){const n=p(e.stat_data,a),o=p(t.stat_data||{},a);if(void 0!==n&&void 0===o)return console.warn('[MvuStore] æ•°æ®éªŒè¯å¤±è´¥ï¼šå…³é”®è·¯å¾„ä¸¢å¤±',a),!1}return!0})(e.value,a))return void console.warn('[MvuStore] æ•°æ®éªŒè¯å¤±è´¥ï¼Œä¿æŒç°æœ‰æ•°æ®ä¸å˜');const n=Object.keys(a.stat_data||{});try{e.value=JSON.parse(JSON.stringify(a)),console.log('[MvuStore] å·²ä» MVU API è·å–æœ€æ–°æ•°æ®ï¼Œstat_data é”®:',n)}catch(t){e.value=a}f()},f=()=>{e.value&&r.value.forEach(t=>{try{t(e.value)}catch(e){console.error('[MvuStore] æ›´æ–°ç»“æŸç›‘å¬å™¨å›è°ƒå¤±è´¥:',e)}})},g=(0,l.computed)(()=>e.value?.stat_data||{}),h=(0,l.computed)(()=>e.value?.display_data||{}),y=(0,l.computed)(()=>e.value?.delta_data||{}),V=(0,l.computed)(()=>e.value?.initialized_lorebooks||[]),N=(0,l.computed)(()=>e.value?ll.getAllVariableKeys(o.value):[]),E=()=>{if(c.value)return;const e=function(){try{if('undefined'!=typeof window&&'function'==typeof window.eventOn)return window.eventOn}catch{}return null}(),t=ll.getEvents();if(e&&t)try{e(t.VARIABLE_UPDATE_STARTED,d),e(t.SINGLE_VARIABLE_UPDATED,u),e(t.VARIABLE_UPDATE_ENDED,v),c.value=!0,console.log('[MvuStore] å·²æ³¨å†Œ MVU äº‹ä»¶ç›‘å¬')}catch(e){console.error('[MvuStore] æ³¨å†Œäº‹ä»¶ç›‘å¬å¤±è´¥:',e)}else console.warn('[MvuStore] æ— æ³•æ³¨å†Œäº‹ä»¶ç›‘å¬ï¼ševentOn æˆ– Mvu.events ä¸å¯ç”¨')},k=()=>{if(!c.value)return;const e=function(){try{if('undefined'!=typeof window&&'function'==typeof window.eventOff)return window.eventOff}catch{}return null}(),t=ll.getEvents();if(e&&t)try{e(t.VARIABLE_UPDATE_STARTED,d),e(t.SINGLE_VARIABLE_UPDATED,u),e(t.VARIABLE_UPDATE_ENDED,v),c.value=!1,console.log('[MvuStore] å·²å–æ¶ˆ MVU äº‹ä»¶ç›‘å¬')}catch(e){console.error('[MvuStore] å–æ¶ˆäº‹ä»¶ç›‘å¬å¤±è´¥:',e)}},b=async l=>{try{a.value=!0,n.value=null,l&&(o.value=l),console.log('[MvuStore] ç­‰å¾…MVUæ¡†æ¶åŠ è½½...');const s=await(async(e=3e3,t=100)=>{const a=Date.now();for(;Date.now()-a<e;){if(ll.isMvuAvailable())return!0;await new Promise(e=>setTimeout(e,t))}return ll.isMvuAvailable()})();if(t.value=s,!t.value)return console.warn('[MvuStore] MVUå˜é‡æ¡†æ¶æœªåŠ è½½ï¼Œä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®'),e.value={stat_data:{},display_data:{},delta_data:{},initialized_lorebooks:[]},void S();console.log('[MvuStore] MVUæ¡†æ¶å·²å°±ç»ªï¼Œå¼€å§‹åˆå§‹åŒ–...'),await B(),await I(),console.log('[MvuStore] åˆå§‹åŒ–å®Œæˆ')}catch(e){n.value=e instanceof Error?e.message:'åˆå§‹åŒ–å¤±è´¥',console.error('[MvuStore] åˆå§‹åŒ–å¤±è´¥:',e),S()}finally{a.value=!1}};let C=0,w=null;const S=()=>{if(C>=3)return void console.warn('[MvuStore] å·²è¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°ï¼Œåœæ­¢é‡è¯•');w&&clearTimeout(w),C++;const e=500*C;console.log(`[MvuStore] å°†åœ¨ ${e}ms åè¿›è¡Œç¬¬ ${C} æ¬¡é‡è¯•...`),w=setTimeout(async()=>{if(ll.isMvuAvailable()&&!t.value){console.log('[MvuStore] MVUæ¡†æ¶ç°åœ¨å¯ç”¨ï¼Œé‡æ–°åˆå§‹åŒ–...'),t.value=!0;try{await B(),await I(),console.log('[MvuStore] é‡è¯•åˆå§‹åŒ–æˆåŠŸ'),C=0}catch(e){console.error('[MvuStore] é‡è¯•åˆå§‹åŒ–å¤±è´¥:',e),S()}}else ll.isMvuAvailable()||(console.log('[MvuStore] MVUæ¡†æ¶ä»ä¸å¯ç”¨ï¼Œç»§ç»­ç­‰å¾…...'),S())},e)},B=async()=>{for(let e=0;e<3;e++){if(E(),c.value)return;console.log(`[MvuStore] äº‹ä»¶ç›‘å¬å™¨æ³¨å†Œå¤±è´¥ï¼Œé‡è¯• ${e+1}/3...`),await new Promise(e=>setTimeout(e,500))}console.warn('[MvuStore] äº‹ä»¶ç›‘å¬å™¨æ³¨å†Œæœ€ç»ˆå¤±è´¥ï¼Œéƒ¨åˆ†åŠŸèƒ½å¯èƒ½ä¸å¯ç”¨')},I=async()=>{let t=null;for(let a=0;a<3;a++){try{if(await M(),e.value&&e.value.stat_data)return;console.log(`[MvuStore] æ•°æ®åŠ è½½ä¸å®Œæ•´ï¼Œé‡è¯• ${a+1}/3...`)}catch(e){t=e instanceof Error?e:new Error(String(e)),console.warn(`[MvuStore] åŠ è½½æ•°æ®å¤±è´¥ï¼Œé‡è¯• ${a+1}/3:`,e)}await new Promise(e=>setTimeout(e,500))}if(t)throw t},M=async()=>{try{a.value=!0,n.value=null;const t=ll.getMvuData(o.value);e.value=t?JSON.parse(JSON.stringify(t)):null,console.log('[MvuStore] åŠ è½½MVUæ•°æ®å®Œæˆ:',{hasData:!!t,stat_data_keys:e.value?Object.keys(e.value.stat_data||{}):[],has_è§„ç« åˆ¶åº¦:void 0!==e.value?.stat_data?.['è§„ç« åˆ¶åº¦'],è§„ç« åˆ¶åº¦_type:e.value?.stat_data?.['è§„ç« åˆ¶åº¦']?typeof e.value.stat_data['è§„ç« åˆ¶åº¦']:'undefined',è§„ç« åˆ¶åº¦_keys:e.value?.stat_data?.['è§„ç« åˆ¶åº¦']?Object.keys(e.value.stat_data['è§„ç« åˆ¶åº¦']):[]})}catch(e){n.value=e instanceof Error?e.message:'åŠ è½½MVUæ•°æ®å¤±è´¥',console.error('[MvuStore] åŠ è½½MVUæ•°æ®å¤±è´¥:',e)}finally{a.value=!1}},A=(t,a)=>{try{const n=ll.getVariable(t,{...o.value,default_value:a});if(void 0!==n)return n;const l=t.split('.').reduce((e,t)=>e&&'object'==typeof e?e[t]:void 0,e.value?.stat_data);return void 0!==l?l:a}catch(e){return n.value=e instanceof Error?e.message:'è·å–å˜é‡å¤±è´¥',console.error(`[MvuStore] getVariable("${t}") å¤±è´¥:`,e),a}},D=async(e,t,a)=>{try{n.value=null;const l=await ll.setVariable(e,t,{...o.value,reason:a});return l&&await M(),l}catch(e){return n.value=e instanceof Error?e.message:'è®¾ç½®å˜é‡å¤±è´¥',!1}},x=e=>(r.value.push(e),()=>{const t=r.value.indexOf(e);t>-1&&r.value.splice(t,1)}),T=async(e=5e3,t=200)=>{const a=Date.now();let n=null;for(console.log('[MvuStore] ç­‰å¾… MVU æ•°æ®å‡†å¤‡å°±ç»ª...');Date.now()-a<e;){if(!ll.isMvuAvailable()){await new Promise(e=>setTimeout(e,t));continue}const e=ll.getMvuData(o.value),a=e?JSON.stringify(Object.keys(e.stat_data||{})):'null';if(e&&e.stat_data&&Object.keys(e.stat_data).length>0){if(a===n)return console.log('[MvuStore] MVU æ•°æ®å·²ç¨³å®šï¼Œé”®:',Object.keys(e.stat_data)),!0;n=a}await new Promise(e=>setTimeout(e,t))}return console.warn('[MvuStore] ç­‰å¾… MVU æ•°æ®è¶…æ—¶ï¼Œå°è¯•ç»§ç»­åˆå§‹åŒ–...'),ll.isMvuAvailable()},R=e=>{if(!e||'string'!=typeof e)return null;const t=[...e.matchAll(/<UpdateVariable>([\s\S]*?)<\/UpdateVariable>/gi)];return t.length>0?t[t.length-1][1].trim():null},L=e=>{const t=[];if(!e||'string'!=typeof e)return t;const a=e.split('\n');let n,o='',l=0,s=0,r=!1,c='';for(let e=0;e<a.length;e++){const i=a[e].trim();if(!i)continue;if(i.startsWith('//')){n=i.slice(2).trim();continue}o+=(o?'\n':'')+i;for(let e=0;e<i.length;e++){const t=i[e],a=e>0?i[e-1]:'';'"'!==t&&'\''!==t||'\\'===a?r||('{'===t?l++:'}'===t?l--:'['===t?s++:']'===t&&s--):r?t===c&&(r=!1):(r=!0,c=t)}const d=o.trim();if(0===l&&0===s&&(d.endsWith(');')||d.endsWith(')'))){const e=P(o,n);e&&t.push(e),o='',n=void 0,l=0,s=0,r=!1}}if(o.trim()){const e=P(o,n);e&&t.push(e)}return t},P=(e,t)=>{if(!e||'string'!=typeof e)return null;let a=e.trim();a.endsWith(';')&&(a=a.slice(0,-1).trim());const n=O(a);if(n>-1){const e=a.slice(n+2).trim();!t&&e&&(t=e),a=a.slice(0,n).trim()}if(!a)return null;const o=a.match(/^_\.(set|assign|add|remove)\s*\(\s*([\s\S]*)\s*\)$/i);if(o)return F(o[1].toLowerCase(),o[2],t);const l=a.match(/^(SET|ADD|SUB|MUL|DIV|APPEND|REMOVE|CLEAR|TOGGLE|INIT)\s*\(\s*([\s\S]*)\s*\)$/i);return l?j(l[1].toUpperCase(),l[2],t):(console.warn('[MvuStore] æ— æ³•è§£æå‘½ä»¤:',a.substring(0,100)+(a.length>100?'...':'')),null)},O=e=>{let t=!1,a='',n=-1;for(let o=0;o<e.length-1;o++){const l=e[o],s=e[o+1],r=o>0?e[o-1]:'';'"'!==l&&'\''!==l||'\\'===r?t||'/'!==l||'/'!==s||(n=o):t?l===a&&(t=!1):(t=!0,a=l)}return n},F=(e,t,a)=>{const n=U(t);if(n.length<1)return console.warn('[MvuStore] lodashå‘½ä»¤å‚æ•°ä¸è¶³:',e,t.substring(0,50)),null;const o='string'==typeof n[0]?n[0]:String(n[0]);switch(e){case'set':return{type:'SET',path:o,value:n.length>=3?n[2]:n[1],comment:a};case'assign':{if(n.length<3)return console.warn('[MvuStore] _.assignéœ€è¦3ä¸ªå‚æ•°:',t.substring(0,50)),null;const e='string'==typeof n[1]?n[1]:String(n[1]);return{type:'ASSIGN',path:`${o}.${e}`,parentPath:o,key:e,value:n[2],comment:a}}case'add':{const e=n.length>=2?n[1]:1;return{type:'ADD',path:o,value:'number'==typeof e?e:parseFloat(e)||1,comment:a}}case'remove':return n.length>=2?{type:'REMOVE',path:o,value:n[1],comment:a}:{type:'CLEAR',path:o,comment:a};default:return console.warn('[MvuStore] æœªçŸ¥çš„lodashæ–¹æ³•:',e),null}},j=(e,t,a)=>{const n=U(t);if(n.length<1)return console.warn('[MvuStore] å‘½ä»¤å‚æ•°ä¸è¶³:',e),null;return{type:e,path:'string'==typeof n[0]?n[0]:String(n[0]),value:n.length>=2?n[1]:void 0,comment:a}},U=e=>{const t=[];let a='',n=0,o=0,l=!1,s='';const r=e.trim();for(let e=0;e<r.length;e++){const c=r[e],i=e>0?r[e-1]:'';if('"'!==c&&'\''!==c||'\\'===i)if(l)a+=c;else if('{'!==c)if('}'!==c)if('['!==c)if(']'!==c){if(','===c&&0===n&&0===o){const e=a.trim();e&&t.push(W(e)),a='';continue}a+=c}else o--,a+=c;else o++,a+=c;else n--,a+=c;else n++,a+=c;else l?c===s&&(l=!1):(l=!0,s=c),a+=c}const c=a.trim();return c&&t.push(W(c)),t},W=e=>{const t=e.trim();if(t){if('null'===t)return null;if('true'===t)return!0;if('false'===t)return!1;if(/^-?\d+(\.\d+)?$/.test(t))return parseFloat(t);if(t.startsWith('\'')&&t.endsWith('\'')||t.startsWith('"')&&t.endsWith('"'))return t.slice(1,-1);if(t.startsWith('{')&&t.endsWith('}')||t.startsWith('[')&&t.endsWith(']'))try{return JSON.parse(t)}catch{try{const e=t.replace(/'/g,'"');return JSON.parse(e)}catch{return console.warn('[MvuStore] JSONè§£æå¤±è´¥:',t.substring(0,100)),t}}return t}},H=async e=>{try{const{type:t,path:a,value:n,parentPath:l}=e;let s,r;switch(console.log('[MvuStore] æ‰§è¡Œå‘½ä»¤:',{type:t,path:a,valueType:typeof n,valuePreview:'object'==typeof n?JSON.stringify(n).substring(0,200)+'...':n}),'SET'!==t&&'INIT'!==t&&'ASSIGN'!==t&&(s=A(a)),t){case'SET':case'INIT':r=n;break;case'ASSIGN':if(l){console.log(`[MvuStore] ASSIGN æ“ä½œï¼šç¡®ä¿çˆ¶è·¯å¾„ "${l}" å­˜åœ¨...`);await(async e=>{try{const t=ol();if(!t)return!1;const a=ll.getMvuData(o.value);if(!a)return!1;a.stat_data||(a.stat_data={});const n=e.split('.');let l=a.stat_data;for(let e=0;e<n.length;e++){const t=n[e];if(void 0===l[t]||null===l[t])console.log(`[MvuStore] åˆ›å»ºè·¯å¾„: ${n.slice(0,e+1).join('.')}`),l[t]={};else if('object'!=typeof l[t])return console.warn(`[MvuStore] è·¯å¾„ "${n.slice(0,e+1).join('.')}" ä¸æ˜¯å¯¹è±¡ï¼Œæ— æ³•åˆ›å»ºå­è·¯å¾„`),!1;l=l[t]}return await t.replaceMvuData(a,o.value),await M(),!0}catch(e){return console.error('[MvuStore] ç¡®ä¿è·¯å¾„å­˜åœ¨å¤±è´¥:',e),!1}})(l)||console.warn(`[MvuStore] æ— æ³•åˆ›å»ºçˆ¶è·¯å¾„ "${l}"ï¼Œå°è¯•ç›´æ¥è®¾ç½®å®Œæ•´è·¯å¾„...`)}r=n;break;case'ADD':if('number'!=typeof s||'number'!=typeof n)return{success:!1,command:e,error:'ADDæ“ä½œéœ€è¦æ•°å€¼ç±»å‹'};r=s+n;break;case'SUB':if('number'!=typeof s||'number'!=typeof n)return{success:!1,command:e,error:'SUBæ“ä½œéœ€è¦æ•°å€¼ç±»å‹'};r=s-n;break;case'MUL':if('number'!=typeof s||'number'!=typeof n)return{success:!1,command:e,error:'MULæ“ä½œéœ€è¦æ•°å€¼ç±»å‹'};r=s*n;break;case'DIV':if('number'!=typeof s||'number'!=typeof n)return{success:!1,command:e,error:'DIVæ“ä½œéœ€è¦æ•°å€¼ç±»å‹'};if(0===n)return{success:!1,command:e,error:'DIVæ“ä½œä¸èƒ½é™¤ä»¥é›¶'};r=s/n;break;case'APPEND':if(Array.isArray(s))r=[...s,n];else{if('string'!=typeof s||'string'!=typeof n)return{success:!1,command:e,error:'APPENDæ“ä½œéœ€è¦æ•°ç»„æˆ–å­—ç¬¦ä¸²ç±»å‹'};r=s+n}break;case'REMOVE':if(!Array.isArray(s))return{success:!1,command:e,error:'REMOVEæ“ä½œéœ€è¦æ•°ç»„ç±»å‹'};r=s.filter(e=>e!==n);break;case'CLEAR':r=Array.isArray(s)?[]:'object'==typeof s&&null!==s?{}:'string'==typeof s?'':'number'==typeof s?0:null;break;case'TOGGLE':if('boolean'!=typeof s)return{success:!1,command:e,error:'TOGGLEæ“ä½œéœ€è¦å¸ƒå°”ç±»å‹'};r=!s;break;default:return{success:!1,command:e,error:`æœªçŸ¥çš„å‘½ä»¤ç±»å‹: ${t}`}}const c=await D(a,r,e.comment||`${t}æ“ä½œ`);return{success:c,command:e,oldValue:s,newValue:r,error:c?void 0:'è®¾ç½®å˜é‡å¤±è´¥'}}catch(t){return{success:!1,command:e,error:t instanceof Error?t.message:'æ‰§è¡Œå‘½ä»¤å¤±è´¥'}}};let G=0;return{mvuData:e,isMvuAvailable:t,isLoading:a,error:n,currentOptions:o,statData:g,displayData:h,deltaData:y,initializedLorebooks:V,allVariableKeys:N,initialize:b,loadMvuData:M,refresh:async()=>{await M()},getVariable:A,setVariable:D,setVariables:async(e,t)=>{try{n.value=null;const a=await ll.setVariables(e,{...o.value,reason:t});return a&&await M(),a}catch(e){return n.value=e instanceof Error?e.message:'æ‰¹é‡è®¾ç½®å˜é‡å¤±è´¥',!1}},updateVariable:async(e,t,a)=>{try{n.value=null;const o=t(A(e));return await D(e,o,a)}catch(e){return n.value=e instanceof Error?e.message:'æ›´æ–°å˜é‡å¤±è´¥',!1}},watchVariable:(e,t)=>{const a={path:e,callback:t};return s.value.push(a),()=>{const e=s.value.indexOf(a);e>-1&&s.value.splice(e,1)}},onUpdateEnd:x,switchOptions:async e=>{o.value=e,await M()},clearError:()=>{n.value=null},onChatSwitch:async()=>{console.log('[MvuStore] æ£€æµ‹åˆ°èŠå¤©åˆ‡æ¢ï¼Œé‡æ–°åˆå§‹åŒ–...'),e.value=null,n.value=null,a.value=!0,await T(),t.value&&await b(o.value),a.value=!1},destroy:()=>{k(),s.value=[],r.value=[]},registerEventListeners:E,unregisterEventListeners:k,extractUpdateVariableContent:R,parseCommand:e=>{const t=L(e);return t.length>0?t[0]:null},executeCommand:H,parseAndExecuteCommands:async t=>{const a=[];i.value=!0;try{const l=R(t);if(!l)return{success:!0,results:a,error:'æœªæ‰¾åˆ°UpdateVariableæ ‡ç­¾'};console.log('[MvuStore] æå–åˆ°UpdateVariableå†…å®¹ï¼Œé•¿åº¦:',l.length);const s=e.value?JSON.parse(JSON.stringify(e.value)):null,r=await(async t=>{const a=ol();if(!a)return console.warn('[MvuStore] ensureBasicStructure: MVUå…¨å±€å¯¹è±¡ä¸å¯ç”¨'),!1;let l=t||e.value;l||(l=ll.getMvuData(o.value)),l||(console.log('[MvuStore] åˆ›å»ºæ–°çš„ MVU æ•°æ®ç»“æ„...'),l={stat_data:{},display_data:{},delta_data:{},initialized_lorebooks:[]}),l.stat_data||(l.stat_data={});const s=l.stat_data.MC;if(s&&'object'==typeof s&&Object.keys(s).length>0)return console.log('[MvuStore] MC å¯¹è±¡å·²å­˜åœ¨ï¼Œè·³è¿‡åˆå§‹åŒ–'),!0;if(!s||'object'!=typeof s){console.log('[MvuStore] åˆå§‹åŒ–ç©ºçš„ MC å¯¹è±¡...'),l.stat_data.MC={};try{return await a.replaceMvuData(l,o.value),e.value=JSON.parse(JSON.stringify(l)),console.log('[MvuStore] MC åŸºç¡€ç»“æ„åˆå§‹åŒ–å®Œæˆ'),!0}catch(e){return console.error('[MvuStore] ä¿å­˜ MC åŸºç¡€ç»“æ„å¤±è´¥:',e),n.value='åˆå§‹åŒ–åŸºç¡€ç»“æ„å¤±è´¥: '+(e instanceof Error?e.message:String(e)),!1}}return!0})(s);r||console.warn('[MvuStore] åŸºç¡€ç»“æ„åˆå§‹åŒ–å¤±è´¥ï¼Œå°è¯•ç»§ç»­æ‰§è¡Œå‘½ä»¤...');const c=e.value?JSON.parse(JSON.stringify(e.value)):null,i=ol();if(i&&'function'==typeof i.parseMessage&&(console.log('[MvuStore] å°è¯•ä½¿ç”¨ MVU åŸç”Ÿ parseMessage è§£æ...'),c))try{const t=JSON.parse(JSON.stringify(c));console.log('[MvuStore] parseMessage ä½¿ç”¨çš„æ•°æ®ï¼Œstat_data é”®:',Object.keys(t.stat_data||{})),await(async(e,t)=>{const a=(e=>{const t=[],a=/_\.assign\s*\(\s*['"]([^'"]+)['"]/gi;let n;for(;null!==(n=a.exec(e));){const e=n[1];e&&!t.includes(e)&&t.push(e)}return t})(e);if(0===a.length)return;console.log('[MvuStore] å‘ç° _.assign å‘½ä»¤ï¼Œéœ€è¦ç¡®ä¿ä»¥ä¸‹çˆ¶è·¯å¾„å­˜åœ¨:',a),t.stat_data||(t.stat_data={});let n=!1;for(const e of a){const a=e.split('.');let o=t.stat_data;for(let e=0;e<a.length;e++){const t=a[e];if(void 0===o[t]||null===o[t])console.log(`[MvuStore] åˆ›å»ºç¼ºå¤±è·¯å¾„: ${a.slice(0,e+1).join('.')}`),o[t]={},n=!0;else if('object'!=typeof o[t]){console.warn(`[MvuStore] è·¯å¾„ "${a.slice(0,e+1).join('.')}" ä¸æ˜¯å¯¹è±¡ï¼Œè·³è¿‡`);break}o=o[t]}}if(n){const e=ol();if(e)try{await e.replaceMvuData(t,o.value),console.log('[MvuStore] å·²ä¿å­˜åˆ›å»ºçš„è·¯å¾„ç»“æ„')}catch(e){console.error('[MvuStore] ä¿å­˜è·¯å¾„ç»“æ„å¤±è´¥:',e)}}})(l,t);const a=await i.parseMessage(l,t);if(a){const n=Object.keys(a.stat_data||{}),l=Object.keys(t.stat_data||{});if(console.log('[MvuStore] parseMessage ç»“æœéªŒè¯:',{oldKeys:l.length,newKeys:n.length}),l.length>0&&0===n.length)throw console.warn('[MvuStore] parseMessage è¿”å›çš„æ•°æ®ä¸¢å¤±äº†æ‰€æœ‰é”®ï¼Œå°è¯•æ¢å¤...'),s&&(e.value=s),new Error('parseMessage è¿”å›æ•°æ®ä¸å®Œæ•´');return await i.replaceMvuData(a,o.value),e.value=JSON.parse(JSON.stringify(a)),console.log('[MvuStore] MVU parseMessage æ‰§è¡ŒæˆåŠŸï¼Œæœ¬åœ°ç¼“å­˜å·²æ›´æ–°'),console.log('[MvuStore] æ›´æ–°åçš„ stat_data é”®:',Object.keys(a.stat_data||{})),f(),{success:!0,results:[{success:!0,command:{type:'SET',path:'MVU_NATIVE',value:null}}],error:void 0}}console.log('[MvuStore] MVU parseMessage è¿”å› undefinedï¼Œå°è¯•è‡ªå®šä¹‰è§£æ...')}catch(e){console.warn('[MvuStore] MVU parseMessage å¤±è´¥ï¼Œå›é€€åˆ°è‡ªå®šä¹‰è§£æ:',e)}console.log('[MvuStore] ä½¿ç”¨è‡ªå®šä¹‰è§£æå™¨...');const d=L(l);console.log('[MvuStore] è§£æåˆ°',d.length,'æ¡å‘½ä»¤');for(const e of d){const t=await H(e);a.push(t),t.success?console.log(`[MvuStore] å‘½ä»¤æ‰§è¡ŒæˆåŠŸ: ${e.type}('${e.path}')`):console.warn(`[MvuStore] å‘½ä»¤æ‰§è¡Œå¤±è´¥: ${e.type}('${e.path}') - ${t.error}`)}const u=a.every(e=>e.success),m=a.filter(e=>e.success).length,p=a.length-m,v=ll.getMvuData(o.value);if(v){const t=Object.keys(v.stat_data||{});Object.keys(e.value?.stat_data||{}).length>0&&0===t.length?console.warn('[MvuStore] æœ€æ–°æ•°æ®ä¸¢å¤±äº†æ‰€æœ‰é”®ï¼Œä¿æŒç°æœ‰æ•°æ®ä¸å˜'):(e.value=JSON.parse(JSON.stringify(v)),console.log('[MvuStore] æœ¬åœ°ç¼“å­˜å·²åŒæ­¥ï¼Œstat_data é”®:',t))}return console.log(`[MvuStore] å‘½ä»¤æ‰§è¡Œå®Œæˆ: ${m}æˆåŠŸ, ${p}å¤±è´¥`),f(),{success:u,results:a,error:u?void 0:`${p}æ¡å‘½ä»¤æ‰§è¡Œå¤±è´¥`}}catch(e){console.error('[MvuStore] è§£ææ‰§è¡Œå‘½ä»¤å¤±è´¥:',e);try{await M()}catch(e){console.error('[MvuStore] åˆ·æ–°MVUæ•°æ®å¤±è´¥:',e)}return{success:!1,results:a,error:e instanceof Error?e.message:'è§£ææ‰§è¡Œå‘½ä»¤å¤±è´¥'}}finally{const e=()=>{G=Math.max(0,G-1),0===G&&(i.value=!1,console.log('[MvuStore] å†…éƒ¨æ›´æ–°æ ‡å¿—å·²æ¸…é™¤'))};let t=!1;const a=x(()=>{t||(t=!0,a(),e())});setTimeout(()=>{t||(a(),e(),console.log('[MvuStore] å†…éƒ¨æ›´æ–°æ ‡å¿—è¶…æ—¶æ¸…é™¤'))},500)}}}}),rl='MC.å¾…åŠ';function cl(e,t){const a={id:e,title:'',description:'',source:'',priority:'æ™®é€š',deadline:'',status:'æœªå®Œæˆ',raw:t},n=t.match(/ã€(.+?)ã€‘/);n&&(a.title=n[1]);const o=t.split('|').map(e=>e.trim());for(const e of o)e.startsWith('æ¥æºï¼š')?a.source=e.replace('æ¥æºï¼š','').trim():e.startsWith('ä¼˜å…ˆçº§ï¼š')?a.priority=e.replace('ä¼˜å…ˆçº§ï¼š','').trim():e.startsWith('æˆªæ­¢ï¼š')?a.deadline=e.replace('æˆªæ­¢ï¼š','').trim():e.startsWith('çŠ¶æ€ï¼š')?a.status=e.replace('çŠ¶æ€ï¼š','').trim():e.startsWith('ã€')||e.includes('ï¼š')||a.description||(a.description=e);if(!a.description&&o.length>0){const e=o[0].replace(/ã€.+?ã€‘/,'').trim();e&&(a.description=e)}return a}const il=t('todo',()=>{const e=sl(),t=(0,l.ref)(!1),a=(0,l.ref)(0);let n=null;const o=(0,l.computed)(()=>{a.value;return e.getVariable(rl,{})}),s=(0,l.computed)(()=>{const e=o.value,t=[];for(const[a,n]of Object.entries(e))a.startsWith('$')||'string'!=typeof n||t.push(cl(a,n));return t.sort((e,t)=>t.id.localeCompare(e.id))}),r=(0,l.computed)(()=>s.value.filter(e=>'æœªå®Œæˆ'===e.status||'è¿›è¡Œä¸­'===e.status).length),c=(0,l.computed)(()=>s.value.length);return{isInitialized:t,dataVersion:a,todoItems:s,pendingCount:r,totalCount:c,initialize:async()=>{t.value||(e.isMvuAvailable||await e.initialize(),n||(n=e.onUpdateEnd(()=>{a.value++})),t.value=!0)},refresh:async()=>{await e.refresh(),a.value++},destroy:()=>{n&&(n(),n=null)},completeTodo:async t=>{try{const n=o.value[t];if('string'!=typeof n)return{success:!1,error:'æ‰¾ä¸åˆ°è¯¥å¾…åŠæ¡ç›®'};let l=n;const s=/çŠ¶æ€ï¼š[^|]+/;s.test(l)?l=l.replace(s,'çŠ¶æ€ï¼šå·²å®Œæˆ'):l+=' | çŠ¶æ€ï¼šå·²å®Œæˆ';const r=`${rl}.${t}`;return await e.setVariable(r,l,`å®Œæˆå¾…åŠ ${t}`),a.value++,{success:!0}}catch(e){return{success:!1,error:e instanceof Error?e.message:'æ“ä½œå¤±è´¥'}}}}});function dl(e,t){const a={id:e,category:'',title:'',publisher:'',date:'',importance:'æ™®é€š',raw:t},n=t.match(/ã€(.+?)ã€‘/);n&&(a.category=n[1]);const o=t.split('|').map(e=>e.trim());if(o.length>0){const e=o[0].replace(/ã€.+?ã€‘/,'').trim();e&&(a.title=e)}for(const e of o)e.startsWith('å‘å¸ƒï¼š')?a.publisher=e.replace('å‘å¸ƒï¼š','').trim():e.startsWith('æ—¥æœŸï¼š')?a.date=e.replace('æ—¥æœŸï¼š','').trim():e.startsWith('é‡è¦æ€§ï¼š')&&(a.importance=e.replace('é‡è¦æ€§ï¼š','').trim());return a}const ul=t('notice',()=>{const e=sl(),t=(0,l.ref)(!1),a=(0,l.ref)(0);let n=null;const o=(0,l.computed)(()=>{a.value;return e.getVariable('MC.å…¬å‘Š',{})}),s=(0,l.computed)(()=>{const e=o.value,t=[];for(const[a,n]of Object.entries(e))a.startsWith('$')||'string'!=typeof n||t.push(dl(a,n));return t.sort((e,t)=>t.id.localeCompare(e.id))}),r=(0,l.computed)(()=>s.value.length);return{isInitialized:t,dataVersion:a,noticeItems:s,totalCount:r,initialize:async()=>{t.value||(e.isMvuAvailable||await e.initialize(),n||(n=e.onUpdateEnd(()=>{a.value++})),t.value=!0)},refresh:async()=>{await e.refresh(),a.value++},destroy:()=>{n&&(n(),n=null)}}}),ml={class:'todo-widget'},pl={key:0,class:'widget-dropdown'},vl={class:'dropdown-list'},fl={class:'todo-checkbox'},gl=['checked','disabled','onChange'],hl={class:'todo-content'},yl={class:'todo-header'},Vl={class:'todo-title'},Nl={key:0,class:'priority-tag urgent'},El={key:1,class:'priority-tag normal'},kl={class:'todo-meta'},bl={key:0,class:'meta-tag source'},Cl={key:1,class:'meta-tag deadline'},wl=(0,l.defineComponent)({__name:'TodoWidget',props:{expanded:{type:Boolean},items:{},pendingCount:{}},emits:['toggle','complete'],setup(e,{emit:t}){const a=t;return(t,n)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',ml,[(0,l.createCommentVNode)(' æŠ˜å æ€ï¼šå¾½ç« æŒ‰é’® '),(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['widget-badge',{active:e.expanded}]),onClick:n[0]||(n[0]=e=>t.$emit('toggle'))},[n[1]||(n[1]=(0,l.createElementVNode)('span',{class:'badge-icon'},'ğŸ“‹',-1)),n[2]||(n[2]=(0,l.createElementVNode)('span',{class:'badge-label'},'å¾…åŠ',-1)),(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(['badge-count',{'has-items':e.pendingCount>0}])},(0,l.toDisplayString)(e.pendingCount),3)],2),(0,l.createCommentVNode)(' å±•å¼€æ€ï¼šä¸‹æ‹‰å¡ç‰‡ '),(0,l.createVNode)(l.Transition,{name:'dropdown'},{default:(0,l.withCtx)(()=>[e.expanded&&e.items.length>0?((0,l.openBlock)(),(0,l.createElementBlock)('div',pl,[(0,l.createElementVNode)('div',vl,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.items,e=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.id,class:(0,l.normalizeClass)(['todo-item',{'is-completed':'å·²å®Œæˆ'===e.status||'å·²å–æ¶ˆ'===e.status,'is-urgent':'ç´§æ€¥'===e.priority}])},[(0,l.createCommentVNode)(' å¤é€‰æ¡† '),(0,l.createElementVNode)('label',fl,[(0,l.createElementVNode)('input',{type:'checkbox',checked:'å·²å®Œæˆ'===e.status,disabled:'å·²å®Œæˆ'===e.status||'å·²å–æ¶ˆ'===e.status,onChange:t=>{return n=e.id,void a('complete',n);var n}},null,40,gl),n[3]||(n[3]=(0,l.createElementVNode)('span',{class:'checkmark'},null,-1))]),(0,l.createCommentVNode)(' å†…å®¹åŒº '),(0,l.createElementVNode)('div',hl,[(0,l.createElementVNode)('div',yl,[(0,l.createElementVNode)('span',Vl,(0,l.toDisplayString)(e.title||e.description),1),'ç´§æ€¥'===e.priority?((0,l.openBlock)(),(0,l.createElementBlock)('span',Nl,'ç´§æ€¥')):((0,l.openBlock)(),(0,l.createElementBlock)('span',El,'æ™®é€š'))]),(0,l.createElementVNode)('div',kl,[e.source?((0,l.openBlock)(),(0,l.createElementBlock)('span',bl,(0,l.toDisplayString)(e.source),1)):(0,l.createCommentVNode)('v-if',!0),e.deadline?((0,l.openBlock)(),(0,l.createElementBlock)('span',Cl,'æˆªæ­¢ï¼š'+(0,l.toDisplayString)(e.deadline),1)):(0,l.createCommentVNode)('v-if',!0),(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(['meta-tag status','status-'+e.status])},(0,l.toDisplayString)(e.status),3)])])],2))),128))])])):(0,l.createCommentVNode)('v-if',!0)]),_:1})]))}}),Sl=(0,B.A)(wl,[['__scopeId','data-v-2d2aca8c']]),Bl={class:'notice-widget'},Il={key:0,class:'widget-dropdown'},Ml={class:'dropdown-list'},Al={class:'notice-content'},Dl={class:'notice-header'},xl={key:0,class:'category-tag'},_l={class:'notice-title'},Tl={class:'notice-meta'},$l={key:0,class:'meta-tag publisher'},Rl={key:1,class:'meta-tag date'},Ll=(0,l.defineComponent)({__name:'NoticeWidget',props:{expanded:{type:Boolean},items:{},totalCount:{}},emits:['toggle'],setup:e=>(t,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',Bl,[(0,l.createCommentVNode)(' æŠ˜å æ€ï¼šå¾½ç« æŒ‰é’® '),(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['widget-badge',{active:e.expanded}]),onClick:a[0]||(a[0]=e=>t.$emit('toggle'))},[a[1]||(a[1]=(0,l.createElementVNode)('span',{class:'badge-icon'},'ğŸ“¢',-1)),a[2]||(a[2]=(0,l.createElementVNode)('span',{class:'badge-label'},'å…¬å‘Š',-1)),(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(['badge-count',{'has-items':e.totalCount>0}])},(0,l.toDisplayString)(e.totalCount),3)],2),(0,l.createCommentVNode)(' å±•å¼€æ€ï¼šä¸‹æ‹‰å¡ç‰‡ '),(0,l.createVNode)(l.Transition,{name:'dropdown'},{default:(0,l.withCtx)(()=>[e.expanded&&e.items.length>0?((0,l.openBlock)(),(0,l.createElementBlock)('div',Il,[(0,l.createElementVNode)('div',Ml,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.items,e=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.id,class:(0,l.normalizeClass)(['notice-item',{'is-urgent':'ç´§æ€¥'===e.importance,'is-important':'é‡è¦'===e.importance}])},[(0,l.createCommentVNode)(' é‡è¦æ€§æŒ‡ç¤ºæ¡ '),(0,l.createElementVNode)('div',{class:(0,l.normalizeClass)(['importance-bar','importance-'+e.importance])},null,2),(0,l.createCommentVNode)(' å†…å®¹åŒº '),(0,l.createElementVNode)('div',Al,[(0,l.createElementVNode)('div',Dl,[e.category?((0,l.openBlock)(),(0,l.createElementBlock)('span',xl,(0,l.toDisplayString)(e.category),1)):(0,l.createCommentVNode)('v-if',!0),(0,l.createElementVNode)('span',_l,(0,l.toDisplayString)(e.title),1)]),(0,l.createElementVNode)('div',Tl,[e.publisher?((0,l.openBlock)(),(0,l.createElementBlock)('span',$l,(0,l.toDisplayString)(e.publisher),1)):(0,l.createCommentVNode)('v-if',!0),e.date?((0,l.openBlock)(),(0,l.createElementBlock)('span',Rl,(0,l.toDisplayString)(e.date),1)):(0,l.createCommentVNode)('v-if',!0),(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(['meta-tag importance','importance-'+e.importance])},(0,l.toDisplayString)(e.importance),3)])])],2))),128))])])):(0,l.createCommentVNode)('v-if',!0)]),_:1})]))}),Pl=(0,B.A)(Ll,[['__scopeId','data-v-dd4538d8']]),Ol={key:0,class:'widget-dock'},Fl={class:'dock-bar'},jl=(0,l.defineComponent)({__name:'WidgetDock',setup(e){const t=il(),a=ul(),n=(0,l.ref)(null),o=(0,l.computed)(()=>t.isInitialized||a.isInitialized),s=e=>{n.value===e?n.value=null:n.value=e},r=async e=>{const a=await t.completeTodo(e);a.success||console.warn('[WidgetDock] å®Œæˆå¾…åŠå¤±è´¥:',a.error)},c=e=>{if(null===n.value)return;e.target.closest('.widget-dock')||(n.value=null)};return(0,l.onMounted)(async()=>{await Promise.all([t.initialize(),a.initialize()]),document.addEventListener('click',c,!0)}),(0,l.onUnmounted)(()=>{document.removeEventListener('click',c,!0),t.destroy(),a.destroy()}),(e,c)=>o.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',Ol,[(0,l.createElementVNode)('div',Fl,[(0,l.createVNode)(Sl,{expanded:'todo'===n.value,items:(0,l.unref)(t).todoItems,'pending-count':(0,l.unref)(t).pendingCount,onToggle:c[0]||(c[0]=e=>s('todo')),onComplete:r},null,8,['expanded','items','pending-count']),(0,l.createVNode)(Pl,{expanded:'notice'===n.value,items:(0,l.unref)(a).noticeItems,'total-count':(0,l.unref)(a).totalCount,onToggle:c[1]||(c[1]=e=>s('notice'))},null,8,['expanded','items','total-count'])])])):(0,l.createCommentVNode)('v-if',!0)}}),Ul=(0,B.A)(jl,[['__scopeId','data-v-16f1afc2']]),zl={class:'main-content'},Wl={class:'game-text-container'},Hl={key:0,class:'processing-state'},Gl={class:'content-header'},Kl={class:'content-meta'},Jl={key:0,class:'meta-item'},ql={key:1,class:'meta-item streaming-badge'},Yl={class:'game-text'},Xl=(0,l.defineComponent)({__name:'MainContent',props:{currentContent:{default:''},isProcessing:{type:Boolean,default:!1},isStreaming:{type:Boolean,default:!1},variableChanges:{default:()=>[]},lastUpdateTime:{default:''}},emits:['game-start'],setup(e,{expose:t,emit:a}){const n=e,o=a,s=(0,l.ref)(null),r=(0,l.ref)(null),c=(0,l.computed)(()=>n.variableChanges.length>0),i=(0,l.computed)(()=>!n.isProcessing&&!n.isStreaming&&(!n.currentContent||''===n.currentContent.trim())),d={enabled:!0,showIcons:!0,enableAnimations:!0},u=e=>{console.log('[MainContent] å†…å®¹å—è¢«ç‚¹å‡»:',e.block.type,e.block.displayContent.substring(0,50))},m=e=>{e.success&&console.log('[MainContent] å†…å®¹è§£æå®Œæˆ:',{æ€»å—æ•°:e.statistics.totalBlocks,å„ç±»å‹:e.statistics.blockCounts,è€—æ—¶:e.statistics.parseTime.toFixed(2)+'ms'})},p=()=>{(0,l.nextTick)(()=>{s.value&&(s.value.scrollTop=s.value.scrollHeight)})},v=()=>{console.log('[MainContent] æ¸…ç©ºå˜é‡å˜åŒ–è®°å½•')},f=e=>{console.log('[MainContent] å¤åˆ¶å˜é‡å˜åŒ–è®°å½•:',e.substring(0,100))},g=e=>{console.log('[MainContent] å¼€å§‹æ¸¸æˆï¼Œprompté•¿åº¦:',e.prompt.length,'æœ‰directVariables:',!!e.directVariables),o('game-start',e)},h=()=>{console.log('[MainContent] å–æ¶ˆå¼€å±€')};return(0,l.watch)(()=>n.currentContent,()=>{p()}),t({scrollToBottom:p,expandChangesPanel:()=>r.value?.expand(),collapseChangesPanel:()=>r.value?.collapse()}),(t,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('main',zl,[(0,l.createCommentVNode)(' è‡ªå®šä¹‰å¼€å±€é¢æ¿ - å½“å†…å®¹ä¸ºç©ºæ—¶æ˜¾ç¤º '),i.value?((0,l.openBlock)(),(0,l.createBlock)(nl,{key:0,onStart:g,onCancel:h})):((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createCommentVNode)(' æ¸¸æˆæ–‡æœ¬æ˜¾ç¤ºåŒºåŸŸ - æœ‰å†…å®¹æ—¶æ˜¾ç¤º '),(0,l.createElementVNode)('div',Wl,[(0,l.createCommentVNode)(' AIæ­£åœ¨æ€è€ƒçŠ¶æ€ '),e.isProcessing&&!e.isStreaming?((0,l.openBlock)(),(0,l.createElementBlock)('div',Hl,[...a[0]||(a[0]=[(0,l.createStaticVNode)('<div class="thinking-panel" data-v-0ee91b54><div class="thinking-animation" data-v-0ee91b54><span class="thinking-dot" data-v-0ee91b54></span><span class="thinking-dot" data-v-0ee91b54></span><span class="thinking-dot" data-v-0ee91b54></span></div><p class="thinking-text" data-v-0ee91b54>AIæ­£åœ¨æ€è€ƒ...</p></div>',1)])])):((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createCommentVNode)(' ä¸»å†…å®¹æ˜¾ç¤º '),(0,l.createElementVNode)('div',{ref_key:'contentRef',ref:s,class:'content-display'},[(0,l.createCommentVNode)(' å†…å®¹å¤´éƒ¨ '),(0,l.createElementVNode)('div',Gl,[(0,l.createElementVNode)('div',Kl,[e.lastUpdateTime?((0,l.openBlock)(),(0,l.createElementBlock)('span',Jl,[a[1]||(a[1]=(0,l.createElementVNode)('span',{class:'meta-icon'},'ğŸ•',-1)),(0,l.createTextVNode)(' '+(0,l.toDisplayString)(e.lastUpdateTime),1)])):(0,l.createCommentVNode)('v-if',!0),e.isStreaming?((0,l.openBlock)(),(0,l.createElementBlock)('span',ql,[...a[2]||(a[2]=[(0,l.createElementVNode)('span',{class:'streaming-dot'},null,-1),(0,l.createTextVNode)(' æ­£åœ¨ç”Ÿæˆ... ',-1)])])):(0,l.createCommentVNode)('v-if',!0)]),(0,l.createCommentVNode)(' ç‰ˆæœ¬å¾½ç«  '),a[3]||(a[3]=(0,l.createElementVNode)('div',{class:'version-badge',title:'MClite v0.9.6'},[(0,l.createElementVNode)('span',{class:'version-tag'},'MClite v0.9.6')],-1))]),(0,l.createCommentVNode)(' å¾…åŠ & å…¬å‘Šå°çª—åœé æ  '),(0,l.createVNode)(Ul),(0,l.createCommentVNode)(' ä¸»æ–‡æœ¬å†…å®¹ - ä½¿ç”¨å†…å®¹å—å·®å¼‚åŒ–æ¸²æŸ“ç»„ä»¶ '),(0,l.createElementVNode)('div',Yl,[(0,l.createVNode)(x,{content:e.currentContent,'is-streaming':e.isStreaming,config:d,theme:'auto',onBlockClick:u,onParsed:m},null,8,['content','is-streaming'])]),(0,l.createCommentVNode)(' å˜é‡å˜åŒ–é¢æ¿ï¼ˆå¢å¼ºç‰ˆï¼‰ '),(0,l.createVNode)(Q,{ref_key:'variableChangesPanelRef',ref:r,changes:e.variableChanges,'default-expanded':c.value,onClear:v,onCopy:f},null,8,['changes','default-expanded'])],512)],2112))])],2112))]))}}),Zl=(0,B.A)(Xl,[['__scopeId','data-v-0ee91b54']]),Ql={maxItems:50,storageKey:'mclite_input_history',autoSave:!0,deduplicate:!0};const es=(0,l.reactive)({visible:!1,title:'ç¡®è®¤',message:'',confirmText:'ç¡®è®¤',cancelText:'å–æ¶ˆ',type:'info',icon:'â“',showCancel:!0,isProcessing:!1});let ts=null,as=null;const ns={info:'â„¹ï¸',warning:'âš ï¸',danger:'ğŸ—‘ï¸',success:'âœ…'},os=e=>new Promise(t=>{const a='string'==typeof e?{message:e}:e;es.title=a.title||'ç¡®è®¤',es.message=a.message,es.confirmText=a.confirmText||'ç¡®è®¤',es.cancelText=a.cancelText||'å–æ¶ˆ',es.type=a.type||'info',es.icon=a.icon||ns[a.type||'info']||'â“',es.showCancel=!1!==a.showCancel,es.isProcessing=!1,es.visible=!0,ts=t,as=a.beforeConfirm||null}),ls=async()=>{if(!es.isProcessing){if(as){es.isProcessing=!0;try{if(!await as())return void(es.isProcessing=!1)}catch(e){return console.error('[ConfirmDialog] beforeConfirm error:',e),void(es.isProcessing=!1)}}es.visible=!1,es.isProcessing=!1,ts&&(ts(!0),ts=null),as=null}},ss=()=>{es.isProcessing||(es.visible=!1,ts&&(ts(!1),ts=null),as=null)},rs=(e,t='å±é™©æ“ä½œ')=>os({title:t,message:e,type:'danger',confirmText:'ç¡®è®¤åˆ é™¤',cancelText:'å–æ¶ˆ',icon:'ğŸ—‘ï¸'}),cs=(e,t='è­¦å‘Š')=>os({title:t,message:e,type:'warning',confirmText:'ç»§ç»­',cancelText:'å–æ¶ˆ',icon:'âš ï¸'}),is=(e,t='æç¤º')=>os({title:t,message:e,type:'info',confirmText:'çŸ¥é“äº†',showCancel:!1,icon:'â„¹ï¸'});function ds(){return{state:(0,l.readonly)(es),confirm:os,confirmDanger:rs,confirmWarning:cs,confirmInfo:is,handleConfirm:ls,handleCancel:ss}}const us={class:'bottom-bar'},ms={key:0,class:'history-panel'},ps={class:'history-header'},vs={class:'history-count'},fs={class:'history-actions'},gs={class:'history-search'},hs={class:'history-list'},ys=['onClick'],Vs={class:'history-content'},Ns={class:'history-time'},Es=['onClick'],ks={key:0,class:'history-empty'},bs={class:'input-area'},Cs=['title'],ws=['placeholder','disabled'],Ss=['disabled','title'],Bs={key:0,class:'loading-icon'},Is={key:1,class:'send-icon'},Ms={key:0,class:'navigation-hint'},As={class:'hint-text'},Ds={key:1,class:'error-message'},xs={class:'error-text'},_s=(0,l.defineComponent)({__name:'BottomBar',props:{placeholder:{default:'è¾“å…¥ä½ æƒ³è¯´çš„è¯æˆ–æƒ³åšçš„äº‹...'},isLoading:{type:Boolean,default:!1},error:{default:null}},emits:['send','clearError'],setup(e,{expose:t,emit:a}){const n=e,o=a,{historyList:s,currentIndex:r,historyCount:c,hasHistory:i,isNavigating:d,addToHistory:u,navigateBack:m,navigateForward:p,resetNavigation:v,removeHistoryAt:f,clearHistory:g,searchHistory:h}=function(e={}){const t={...Ql,...e},a=(0,l.ref)([]),n=(0,l.ref)(-1),o=(0,l.ref)(''),s=(0,l.ref)(!1),r=(0,l.computed)(()=>a.value.length),c=(0,l.computed)(()=>a.value.length>0),i=(0,l.computed)(()=>n.value>=0),d=(0,l.computed)(()=>n.value<a.value.length-1),u=(0,l.computed)(()=>n.value>=0),m=(0,l.computed)(()=>n.value>=0&&n.value<a.value.length?a.value[n.value]:null),p=(0,l.computed)(()=>a.value.map(e=>e.content)),v=()=>{try{const e=localStorage.getItem(t.storageKey);if(e){const t=JSON.parse(e);Array.isArray(t)&&(a.value=t.map(e=>'string'==typeof e?{content:e,timestamp:Date.now()}:e),console.log('[useInputHistory] å·²åŠ è½½å†å²è®°å½•ï¼Œå…±',a.value.length,'æ¡'))}}catch(e){console.error('[useInputHistory] åŠ è½½å†å²è®°å½•å¤±è´¥:',e),a.value=[]}s.value=!0},f=()=>{try{localStorage.setItem(t.storageKey,JSON.stringify(a.value)),console.log('[useInputHistory] å†å²è®°å½•å·²ä¿å­˜')}catch(e){console.error('[useInputHistory] ä¿å­˜å†å²è®°å½•å¤±è´¥:',e)}},g=e=>c.value?(-1===n.value&&(o.value=e),n.value<a.value.length-1?(n.value++,a.value[n.value].content):null):null,h=()=>n.value<0?null:(n.value--,n.value>=0?a.value[n.value].content:o.value),y=()=>{n.value=-1,o.value=''},V=e=>e>=0&&e<a.value.length&&(a.value.splice(e,1),n.value>=e&&n.value>0&&n.value--,t.autoSave&&f(),!0);return(0,l.onMounted)(()=>{v()}),{historyList:a,currentIndex:n,tempInput:o,isInitialized:s,historyCount:r,hasHistory:c,isNavigating:i,canGoBack:d,canGoForward:u,currentHistoryItem:m,historyContents:p,addToHistory:e=>{if(!e||!e.trim())return;const n=e.trim();if(t.deduplicate){const e=a.value.findIndex(e=>e.content===n);e>=0&&a.value.splice(e,1)}a.value.unshift({content:n,timestamp:Date.now()}),a.value.length>t.maxItems&&(a.value=a.value.slice(0,t.maxItems)),y(),t.autoSave&&f(),console.log('[useInputHistory] æ–°è®°å½•å·²æ·»åŠ :',n.slice(0,50)+'...')},navigateBack:g,navigateForward:h,startNavigation:e=>{-1===n.value&&(o.value=e)},resetNavigation:y,handleKeyboardNavigation:(e,t)=>{if('ArrowUp'===e.key&&(!t.trim()||i.value)){const a=g(t);if(null!==a)return e.preventDefault(),a}if('ArrowDown'===e.key&&i.value){const t=h();if(null!==t)return e.preventDefault(),t}if('Escape'===e.key&&i.value){const t=o.value;return y(),e.preventDefault(),t}return null},getHistoryAt:e=>e>=0&&e<a.value.length?a.value[e]:null,removeHistoryAt:V,removeHistoryByContent:e=>{const t=a.value.findIndex(t=>t.content===e);return t>=0&&V(t)},clearHistory:()=>{a.value=[],y(),t.autoSave&&f(),console.log('[useInputHistory] å†å²è®°å½•å·²æ¸…ç©º')},searchHistory:e=>{if(!e||!e.trim())return a.value;const t=e.toLowerCase();return a.value.filter(e=>e.content.toLowerCase().includes(t))},loadFromStorage:v,saveToStorage:f,exportHistory:()=>JSON.stringify(a.value,null,2),importHistory:(e,n=!1)=>{try{const o=JSON.parse(e);if(!Array.isArray(o))throw new Error('æ— æ•ˆçš„å†å²è®°å½•æ ¼å¼');const l=o.map(e=>'string'==typeof e?{content:e,timestamp:Date.now()}:e);return n?(l.forEach(e=>{a.value.some(t=>t.content===e.content)||a.value.push(e)}),a.value.sort((e,t)=>t.timestamp-e.timestamp),a.value.length>t.maxItems&&(a.value=a.value.slice(0,t.maxItems))):a.value=l.slice(0,t.maxItems),t.autoSave&&f(),console.log('[useInputHistory] å†å²è®°å½•å·²å¯¼å…¥'),!0}catch(e){return console.error('[useInputHistory] å¯¼å…¥å†å²è®°å½•å¤±è´¥:',e),!1}},config:t}}(),y=(0,l.ref)(''),V=(0,l.ref)(null),N=(0,l.ref)(!1),E=(0,l.ref)(''),k=(0,l.computed)(()=>y.value.trim().length>0&&!n.isLoading),b=(0,l.computed)(()=>n.isLoading?'AIæ­£åœ¨æ€è€ƒä¸­ï¼Œè¯·ç¨å€™...':d.value?'ä½¿ç”¨ â†‘â†“ å¯¼èˆªå†å²ï¼ŒEsc å–æ¶ˆ':n.placeholder),C=(0,l.computed)(()=>E.value.trim()?h(E.value):s.value),w=()=>{if(!k.value)return;const e=y.value.trim();u(e),o('send',e),y.value='',N.value=!1,(0,l.nextTick)(()=>{V.value&&(V.value.style.height='auto')})},S=e=>{if('Enter'===e.key&&!e.shiftKey)return e.preventDefault(),void w();if('ArrowUp'===e.key&&B()){const t=m(y.value);null!==t&&(e.preventDefault(),y.value=t,(0,l.nextTick)(()=>{V.value&&(V.value.selectionStart=V.value.selectionEnd=y.value.length)}))}if('ArrowDown'===e.key&&d.value&&I()){const t=p();null!==t&&(e.preventDefault(),y.value=t,(0,l.nextTick)(()=>{V.value&&(V.value.selectionStart=V.value.selectionEnd=y.value.length)}))}'Escape'===e.key&&(d.value?(M(),e.preventDefault()):N.value&&(N.value=!1,e.preventDefault()))},B=()=>{if(!V.value)return!0;const e=V.value.selectionStart||0;return!y.value.substring(0,e).includes('\n')},I=()=>{if(!V.value)return!0;const e=V.value.selectionStart||0;return!y.value.substring(e).includes('\n')},M=()=>{v(),y.value=''},A=()=>{if(!V.value)return;V.value.style.height='auto';const e=V.value.scrollHeight;V.value.style.height=Math.min(e,120)+'px'},D=()=>{V.value?.focus()},x=()=>{N.value=!N.value,N.value&&(E.value='')},T=async()=>{await rs('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰å†å²è®°å½•å—ï¼Ÿ','æ¸…ç©ºå†å²')&&(g(),E.value='')},R=e=>{const t=new Date(e),a=new Date,n=a.getTime()-e;return n<6e4?'åˆšåˆš':n<36e5?`${Math.floor(n/6e4)}åˆ†é’Ÿå‰`:n<864e5?`${Math.floor(n/36e5)}å°æ—¶å‰`:t.getFullYear()===a.getFullYear()?`${t.getMonth()+1}/${t.getDate()} ${t.getHours()}:${String(t.getMinutes()).padStart(2,'0')}`:`${t.getFullYear()}/${t.getMonth()+1}/${t.getDate()}`};return t({focus:D,clear:()=>{y.value='',v(),V.value&&(V.value.style.height='auto')},addToHistory:u,clearHistory:g}),(0,l.onMounted)(()=>{D()}),(0,l.watch)(y,(e,t)=>{if(d.value&&e!==t){const t=s.value[r.value];t&&e!==t.content&&v()}}),(t,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('footer',us,[(0,l.createCommentVNode)(' å†å²è®°å½•é¢æ¿ '),(0,l.createVNode)(l.Transition,{name:'slide-up'},{default:(0,l.withCtx)(()=>[N.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',ms,[(0,l.createElementVNode)('div',ps,[a[4]||(a[4]=(0,l.createElementVNode)('span',{class:'history-title'},'ğŸ“œ å†å²è¾“å…¥è®°å½•',-1)),(0,l.createElementVNode)('span',vs,(0,l.toDisplayString)((0,l.unref)(c))+' æ¡',1),(0,l.createElementVNode)('div',fs,[(0,l.unref)(i)?((0,l.openBlock)(),(0,l.createElementBlock)('button',{key:0,class:'history-clear-btn',title:'æ¸…ç©ºå†å²',onClick:T},'ğŸ—‘ï¸')):(0,l.createCommentVNode)('v-if',!0),(0,l.createElementVNode)('button',{class:'history-close-btn',title:'å…³é—­',onClick:a[0]||(a[0]=e=>N.value=!1)},'âœ•')])]),(0,l.createCommentVNode)(' æœç´¢æ¡† '),(0,l.createElementVNode)('div',gs,[(0,l.withDirectives)((0,l.createElementVNode)('input',{'onUpdate:modelValue':a[1]||(a[1]=e=>E.value=e),type:'text',class:'history-search-input',placeholder:'æœç´¢å†å²è®°å½•...'},null,512),[[l.vModelText,E.value]])]),(0,l.createCommentVNode)(' å†å²è®°å½•åˆ—è¡¨ '),(0,l.createElementVNode)('div',hs,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(C.value,(e,t)=>{return(0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.timestamp,class:(0,l.normalizeClass)(['history-item',{'is-active':t===(0,l.unref)(r)}]),onClick:t=>{return a=e.content,y.value=a,N.value=!1,v(),D(),void(0,l.nextTick)(()=>{A()});var a}},[(0,l.createElementVNode)('span',Vs,(0,l.toDisplayString)((a=e.content,n=80,a.length<=n?a:a.substring(0,n)+'...')),1),(0,l.createElementVNode)('span',Ns,(0,l.toDisplayString)(R(e.timestamp)),1),(0,l.createElementVNode)('button',{class:'history-delete-btn',title:'åˆ é™¤',onClick:(0,l.withModifiers)(e=>(e=>{f(e)})(t),['stop'])},'âœ•',8,Es)],10,ys);var a,n}),128)),0===C.value.length?((0,l.openBlock)(),(0,l.createElementBlock)('div',ks,(0,l.toDisplayString)(E.value?'æœªæ‰¾åˆ°åŒ¹é…çš„è®°å½•':'æš‚æ— å†å²è®°å½•'),1)):(0,l.createCommentVNode)('v-if',!0)])])):(0,l.createCommentVNode)('v-if',!0)]),_:1}),(0,l.createCommentVNode)(' è¾“å…¥åŒºåŸŸ '),(0,l.createElementVNode)('div',bs,[(0,l.createElementVNode)('div',{class:(0,l.normalizeClass)(['input-container',{'is-loading':e.isLoading,'has-error':!!e.error}])},[(0,l.createCommentVNode)(' å†å²è®°å½•æŒ‰é’® '),(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['history-toggle-btn',{'has-history':(0,l.unref)(i),'is-active':N.value}]),title:(0,l.unref)(i)?`å†å²è®°å½• (${(0,l.unref)(c)})`:'æš‚æ— å†å²è®°å½•',onClick:x},[...a[5]||(a[5]=[(0,l.createElementVNode)('span',{class:'history-icon'},'ğŸ“œ',-1)])],10,Cs),(0,l.withDirectives)((0,l.createElementVNode)('textarea',{ref_key:'inputRef',ref:V,'onUpdate:modelValue':a[2]||(a[2]=e=>y.value=e),class:'message-input',placeholder:b.value,disabled:e.isLoading,rows:'1',onKeydown:S,onInput:A},null,40,ws),[[l.vModelText,y.value]]),(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['send-btn',{'is-loading':e.isLoading}]),disabled:!k.value,title:e.isLoading?'æ­£åœ¨ç”Ÿæˆ...':'å‘é€æ¶ˆæ¯ (Enter)',onClick:w},[e.isLoading?((0,l.openBlock)(),(0,l.createElementBlock)('span',Bs,'â³')):((0,l.openBlock)(),(0,l.createElementBlock)('span',Is,'ğŸ“¤'))],10,Ss)],2),(0,l.createCommentVNode)(' å†å²å¯¼èˆªæç¤º '),(0,l.unref)(d)?((0,l.openBlock)(),(0,l.createElementBlock)('div',Ms,[a[6]||(a[6]=(0,l.createElementVNode)('span',{class:'hint-icon'},'â¬†ï¸â¬‡ï¸',-1)),(0,l.createElementVNode)('span',As,(0,l.toDisplayString)((0,l.unref)(r)+1)+'/'+(0,l.toDisplayString)((0,l.unref)(c)),1),(0,l.createElementVNode)('button',{class:'hint-cancel',title:'å–æ¶ˆ (Esc)',onClick:M},'âœ•')])):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' é”™è¯¯æç¤º '),e.error?((0,l.openBlock)(),(0,l.createElementBlock)('div',Ds,[a[7]||(a[7]=(0,l.createElementVNode)('span',{class:'error-icon'},'âš ï¸',-1)),(0,l.createElementVNode)('span',xs,(0,l.toDisplayString)(e.error),1),(0,l.createElementVNode)('button',{class:'error-dismiss',onClick:a[3]||(a[3]=e=>t.$emit('clearError'))},'âœ•')])):(0,l.createCommentVNode)('v-if',!0)])]))}}),Ts=(0,B.A)(_s,[['__scopeId','data-v-3ec5b5a3']]),$s=t('app',()=>{const e=(0,l.ref)({isFullscreen:!1,theme:'dark',language:'zh-CN',volume:1,isMuted:!1}),t=(0,l.ref)(!0),a=(0,l.ref)(!1),n=(0,l.ref)(null),o=(0,l.ref)([]),s=()=>{try{if('undefined'!=typeof window){const e=window.SillyTavern;if(e){if(e.chatId)return String(e.chatId);if('function'==typeof e.getCurrentChatId){const t=e.getCurrentChatId();if(t)return String(t)}}if('function'==typeof window.getContext){const e=window.getContext();if(e?.chatId)return String(e.chatId)}}return null}catch{return null}},r=async()=>{const e=s();if(e===n.value)return void console.log('[AppStore] èŠå¤©IDæœªå˜åŒ–ï¼Œè·³è¿‡åˆ‡æ¢å¤„ç†');console.log('[AppStore] æ£€æµ‹åˆ°èŠå¤©åˆ‡æ¢:',n.value,'->',e),n.value=e;const t=sl();if(t.isMvuAvailable)try{await t.onChatSwitch(),console.log('[AppStore] MVU StoreèŠå¤©åˆ‡æ¢å¤„ç†å®Œæˆ')}catch(e){console.error('[AppStore] MVU StoreèŠå¤©åˆ‡æ¢å¤„ç†å¤±è´¥:',e)}for(const e of o.value)try{await e()}catch(e){console.error('[AppStore] èŠå¤©åˆ‡æ¢å›è°ƒæ‰§è¡Œå¤±è´¥:',e)}},c=(0,l.ref)(0);let i=null;const d=async(e=5e3,t=100)=>{const a=Date.now();for(console.log('[AppStore] ç­‰å¾…é…’é¦†ç¯å¢ƒå°±ç»ª...');Date.now()-a<e;){const e='function'==typeof window.eventOn,a=void 0!==window.Mvu,n='function'==typeof window.generate,o=void 0!==window.TavernHelper,l=s();if(e&&a&&n&&o&&!!l)return console.log('[AppStore] é…’é¦†ç¯å¢ƒå·²å°±ç»ª:',{eventOn:e,Mvu:a,generate:n,TavernHelper:o,chatId:l}),!0;await new Promise(e=>setTimeout(e,t))}return console.warn('[AppStore] ç­‰å¾…é…’é¦†ç¯å¢ƒè¶…æ—¶ï¼Œç»§ç»­åˆå§‹åŒ–ï¼ˆéƒ¨åˆ†åŠŸèƒ½å¯èƒ½ä¸å¯ç”¨ï¼‰'),!1},u=async()=>{const e=sl();if('undefined'!=typeof window)try{if(await e.initialize(),e.isMvuAvailable&&e.mvuData)return console.log('[AppStore] MVU Storeåˆå§‹åŒ–æˆåŠŸ'),void(c.value=0);e.isMvuAvailable||(console.warn('[AppStore] MVUæ¡†æ¶æš‚ä¸å¯ç”¨ï¼Œå°†å®‰æ’é‡è¯•...'),m())}catch(e){console.warn('[AppStore] MVUåˆå§‹åŒ–å¤±è´¥ï¼Œå°†å®‰æ’é‡è¯•:',e),m()}else console.log('[AppStore] éæµè§ˆå™¨ç¯å¢ƒï¼Œè·³è¿‡MVUåˆå§‹åŒ–')},m=()=>{if(c.value>=5)return console.error('[AppStore] MVUåˆå§‹åŒ–é‡è¯•å·²è¾¾æœ€å¤§æ¬¡æ•°ï¼Œæ”¾å¼ƒé‡è¯•'),void('undefined'!=typeof toastr&&toastr.warning('å˜é‡ç³»ç»Ÿåˆå§‹åŒ–å¤±è´¥ï¼Œéƒ¨åˆ†åŠŸèƒ½å¯èƒ½ä¸å¯ç”¨ã€‚è¯·å°è¯•åˆ·æ–°é¡µé¢ã€‚','åˆå§‹åŒ–è­¦å‘Š',{timeOut:5e3}));i&&clearTimeout(i),c.value++;const e=1e3*c.value;console.log(`[AppStore] å°†åœ¨ ${e}ms åè¿›è¡Œç¬¬ ${c.value} æ¬¡MVUåˆå§‹åŒ–é‡è¯•...`),i=setTimeout(async()=>{const e=sl();try{await e.initialize(),e.isMvuAvailable&&e.mvuData?(console.log('[AppStore] MVU Storeé‡è¯•åˆå§‹åŒ–æˆåŠŸ'),c.value=0,'undefined'!=typeof toastr&&toastr.success('å˜é‡ç³»ç»Ÿå·²å°±ç»ª','åˆå§‹åŒ–æˆåŠŸ',{timeOut:2e3})):m()}catch(e){console.warn(`[AppStore] ç¬¬ ${c.value} æ¬¡MVUåˆå§‹åŒ–é‡è¯•å¤±è´¥:`,e),m()}},e)};return{state:e,isInitialized:a,currentChatId:n,streamingEnabled:t,mvuInitRetryCount:c,initialize:async()=>{if(!a.value){console.log('[AppStore] æ­£åœ¨åˆå§‹åŒ–MCæˆ¿å­åº”ç”¨...');try{const a=localStorage.getItem('mc-app-theme');a&&(e.value.theme=a);const n=localStorage.getItem('mc-app-language');n&&(e.value.language=n);const o=localStorage.getItem('mc-app-volume');o&&(e.value.volume=parseFloat(o));const l=localStorage.getItem('mc-app-muted');l&&(e.value.isMuted='true'===l);const s=localStorage.getItem('mc-app-streaming');null!==s&&(t.value='true'===s)}catch(e){console.warn('[AppStore] åŠ è½½è®¾ç½®å¤±è´¥:',e)}n.value=s(),console.log('[AppStore] åˆå§‹èŠå¤©ID:',n.value),(()=>{try{if('undefined'==typeof window)return;if('function'==typeof window.eventOn)if(void 0!==window.iframe_events){const e=window.iframe_events;e.CHAT_CHANGED&&(window.eventOn(e.CHAT_CHANGED,r),console.log('[AppStore] å·²æ³¨å†ŒèŠå¤©åˆ‡æ¢äº‹ä»¶ç›‘å¬å™¨ (CHAT_CHANGED)'))}else window.eventOn('js_chat_changed',r),console.log('[AppStore] å·²æ³¨å†ŒèŠå¤©åˆ‡æ¢äº‹ä»¶ç›‘å¬å™¨ (js_chat_changed)');const e=window.SillyTavern;e?.eventSource?.on&&e.eventTypes?.CHAT_CHANGED&&(e.eventSource.on(e.eventTypes.CHAT_CHANGED,r),console.log('[AppStore] å·²é€šè¿‡SillyTavern.eventSourceæ³¨å†ŒèŠå¤©åˆ‡æ¢ç›‘å¬å™¨'))}catch(e){console.warn('[AppStore] è®¾ç½®èŠå¤©åˆ‡æ¢ç›‘å¬å™¨å¤±è´¥:',e)}})(),await d(),await u(),a.value=!0,console.log('[AppStore] MCæˆ¿å­åº”ç”¨åˆå§‹åŒ–å®Œæˆ')}},toggleFullscreen:()=>{e.value.isFullscreen=!e.value.isFullscreen},toggleTheme:()=>{e.value.theme='dark'===e.value.theme?'light':'dark',localStorage.setItem('mc-app-theme',e.value.theme),'light'===e.value.theme?document.documentElement.classList.add('light-theme'):document.documentElement.classList.remove('light-theme')},setTheme:t=>{e.value.theme=t,localStorage.setItem('mc-app-theme',t),'light'===t?document.documentElement.classList.add('light-theme'):document.documentElement.classList.remove('light-theme')},setLanguage:t=>{e.value.language=t,localStorage.setItem('mc-app-language',t)},setVolume:t=>{e.value.volume=Math.max(0,Math.min(1,t)),localStorage.setItem('mc-app-volume',String(e.value.volume))},toggleMute:()=>{e.value.isMuted=!e.value.isMuted,localStorage.setItem('mc-app-muted',String(e.value.isMuted))},setMuted:t=>{e.value.isMuted=t,localStorage.setItem('mc-app-muted',String(t))},toggleStreaming:()=>{t.value=!t.value,localStorage.setItem('mc-app-streaming',String(t.value)),console.log('[AppStore] æµå¼ä¼ è¾“:',t.value?'å¼€å¯':'å…³é—­')},setStreaming:e=>{t.value=e,localStorage.setItem('mc-app-streaming',String(e)),console.log('[AppStore] æµå¼ä¼ è¾“:',e?'å¼€å¯':'å…³é—­')},onChatSwitch:e=>(o.value.push(e),()=>{const t=o.value.indexOf(e);t>-1&&o.value.splice(t,1)}),handleChatSwitch:r,getCurrentChatId:s,retryMvuInitialization:async()=>{console.log('[AppStore] ç”¨æˆ·æ‰‹åŠ¨è§¦å‘MVUé‡æ–°åˆå§‹åŒ–...'),c.value=0;const e=sl();try{return await e.initialize(),!(!e.isMvuAvailable||!e.mvuData)&&(console.log('[AppStore] MVU Storeæ‰‹åŠ¨é‡æ–°åˆå§‹åŒ–æˆåŠŸ'),!0)}catch(e){return console.error('[AppStore] MVU Storeæ‰‹åŠ¨é‡æ–°åˆå§‹åŒ–å¤±è´¥:',e),!1}}}}),Rs=['title'],Ls={class:'collapse-icon'},Ps={class:'nav-menu'},Os=['onClick'],Fs={class:'nav-icon'},js={key:0,class:'nav-label'},Us={key:1,class:'lite-tag'},zs={key:0,class:'info-panels desktop-only'},Ws={class:'info-panel settings-panel'},Hs={class:'panel-body'},Gs={class:'setting-item'},Ks={class:'toggle-switch'},Js=['checked'],qs={class:'setting-hint'},Ys={class:'sidebar-footer'},Xs={class:'mobile-settings'},Zs={class:'mobile-setting-item'},Qs={class:'toggle-switch small'},er=['checked'],tr={key:0,class:'nav-label'},ar={key:0,class:'nav-label'},nr={key:0,class:'nav-label'},or={key:0,class:'nav-label'},lr={key:0,class:'nav-label'},sr={key:0,class:'nav-label'},rr=(0,l.defineComponent)({__name:'Sidebar',props:{activeMenu:{default:'workplace'},collapsed:{type:Boolean,default:!1},unreadNotifications:{default:0},mobileVisible:{type:Boolean,default:!1}},emits:['menu-change','update:collapsed','open-help','open-ai-filter','open-save-manager','open-context-manager','open-history-text','open-changelog','open-variable-manager','view-notice','close-mobile'],setup(e,{emit:t}){const a=e,n=t,o=(0,l.ref)(a.collapsed),s=$s(),r=(0,l.computed)(()=>s.streamingEnabled),c=()=>{s.toggleStreaming()},i=(0,l.computed)(()=>[{id:'workplace',icon:'ğŸ–¥ï¸',label:'æˆ‘çš„å·¥ä½'},{id:'personnel',icon:'ğŸ‘¥',label:'äººäº‹ç³»ç»Ÿ',liteTag:!0},{id:'handbook',icon:'ğŸ“–',label:'æ–‡æ¡£æŸ¥çœ‹'},{id:'forms',icon:'ğŸ“',label:'è¡¨å•ç”³è¯·'}]),d=()=>{o.value=!o.value,n('update:collapsed',o.value)};return(t,s)=>((0,l.openBlock)(),(0,l.createElementBlock)('aside',{class:(0,l.normalizeClass)(['sidebar',{'is-collapsed':o.value,'is-visible':e.mobileVisible}])},[(0,l.createCommentVNode)(' ç§»åŠ¨ç«¯å…³é—­æŒ‰é’® '),(0,l.createElementVNode)('button',{class:'mobile-close-btn',title:'å…³é—­èœå•',onClick:s[0]||(s[0]=e=>t.$emit('close-mobile'))},[...s[7]||(s[7]=[(0,l.createElementVNode)('span',{class:'close-icon'},'âœ•',-1)])]),(0,l.createCommentVNode)(' æŠ˜å æŒ‰é’®ï¼ˆä»…æ¡Œé¢ç«¯æ˜¾ç¤ºï¼‰ '),(0,l.createElementVNode)('button',{class:'collapse-btn',title:o.value?'å±•å¼€èœå•':'æ”¶èµ·èœå•',onClick:d},[(0,l.createElementVNode)('span',Ls,(0,l.toDisplayString)(o.value?'â—€':'â–¶'),1)],8,Rs),(0,l.createCommentVNode)(' å¯¼èˆªèœå• '),(0,l.createElementVNode)('nav',Ps,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(i.value,t=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:t.id,class:(0,l.normalizeClass)(['nav-item',{'is-active':e.activeMenu===t.id,'is-disabled':t.disabled}]),onClick:e=>{return o=t.id,void(t.disabled||(n('menu-change',o),a.mobileVisible&&n('close-mobile')));var o}},[(0,l.createElementVNode)('span',Fs,(0,l.toDisplayString)(t.icon),1),o.value?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('span',js,(0,l.toDisplayString)(t.label),1)),!o.value&&t.liteTag?((0,l.openBlock)(),(0,l.createElementBlock)('span',Us,'Lite')):(0,l.createCommentVNode)('v-if',!0)],10,Os))),128))]),(0,l.createCommentVNode)(' ä¿¡æ¯é¢æ¿åŒºåŸŸï¼ˆå±•å¼€æ—¶æ˜¾ç¤ºï¼Œæ¡Œé¢ç«¯ï¼‰ '),o.value?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('div',zs,[(0,l.createCommentVNode)(' è®¾ç½®é¢æ¿ '),(0,l.createElementVNode)('div',Ws,[s[10]||(s[10]=(0,l.createElementVNode)('div',{class:'panel-header'},[(0,l.createElementVNode)('span',{class:'panel-icon'},'âš™ï¸'),(0,l.createElementVNode)('span',{class:'panel-title'},'è®¾ç½®')],-1)),(0,l.createElementVNode)('div',Hs,[(0,l.createCommentVNode)(' æµå¼ä¼ è¾“å¼€å…³ '),(0,l.createElementVNode)('div',Gs,[s[9]||(s[9]=(0,l.createElementVNode)('div',{class:'setting-label'},[(0,l.createElementVNode)('span',{class:'setting-icon'},'ğŸ“¡'),(0,l.createElementVNode)('span',{class:'setting-text'},'æµå¼ä¼ è¾“')],-1)),(0,l.createElementVNode)('label',Ks,[(0,l.createElementVNode)('input',{type:'checkbox',checked:r.value,onChange:c},null,40,Js),s[8]||(s[8]=(0,l.createElementVNode)('span',{class:'toggle-slider'},null,-1))])]),(0,l.createElementVNode)('div',qs,(0,l.toDisplayString)(r.value?'å®æ—¶æ˜¾ç¤ºAIå›å¤':'ç­‰å¾…å®Œæ•´å›å¤'),1)])]),(0,l.createCommentVNode)(' Liteç‰ˆæœ¬æç¤º '),s[11]||(s[11]=(0,l.createStaticVNode)('<div class="info-panel lite-info-panel" data-v-08e8a59e><div class="panel-header" data-v-08e8a59e><span class="panel-icon" data-v-08e8a59e>ğŸ’¡</span><span class="panel-title" data-v-08e8a59e>Liteç‰ˆæœ¬</span></div><div class="panel-body" data-v-08e8a59e><div class="lite-notice" data-v-08e8a59e><p data-v-08e8a59e>å½“å‰ä¸ºMCliteç®€åŒ–ç‰ˆ</p><p class="lite-detail" data-v-08e8a59e>éƒ¨åˆ†åŠŸèƒ½å·²ç®€åŒ–æˆ–ç¦ç”¨</p></div></div></div>',1))])),(0,l.createCommentVNode)(' åº•éƒ¨å¿«æ·æ“ä½œ '),(0,l.createElementVNode)('div',Ys,[(0,l.createCommentVNode)(' ç§»åŠ¨ç«¯æµå¼ä¼ è¾“è®¾ç½®ï¼ˆç´§å‡‘ç‰ˆï¼‰ '),(0,l.createElementVNode)('div',Xs,[(0,l.createElementVNode)('div',Zs,[s[13]||(s[13]=(0,l.createElementVNode)('span',{class:'setting-icon'},'ğŸ“¡',-1)),s[14]||(s[14]=(0,l.createElementVNode)('span',{class:'setting-text'},'æµå¼',-1)),(0,l.createElementVNode)('label',Qs,[(0,l.createElementVNode)('input',{type:'checkbox',checked:r.value,onChange:c},null,40,er),s[12]||(s[12]=(0,l.createElementVNode)('span',{class:'toggle-slider'},null,-1))])])]),s[21]||(s[21]=(0,l.createElementVNode)('div',{class:'divider'},null,-1)),(0,l.createCommentVNode)(' æ ¸å¿ƒåŠŸèƒ½æŒ‰é’® '),(0,l.createElementVNode)('div',{class:'nav-item footer-item highlight-item',onClick:s[1]||(s[1]=e=>t.$emit('open-save-manager'))},[s[15]||(s[15]=(0,l.createElementVNode)('span',{class:'nav-icon'},'ğŸ’¾',-1)),o.value?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('span',tr,'å­˜æ¡£ç®¡ç†'))]),(0,l.createElementVNode)('div',{class:'nav-item footer-item highlight-item',onClick:s[2]||(s[2]=e=>t.$emit('open-context-manager'))},[s[16]||(s[16]=(0,l.createElementVNode)('span',{class:'nav-icon'},'ğŸ“š',-1)),o.value?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('span',ar,'ä¸Šä¸‹æ–‡ç®¡ç†'))]),(0,l.createElementVNode)('div',{class:'nav-item footer-item highlight-item secondary',onClick:s[3]||(s[3]=e=>t.$emit('open-history-text'))},[s[17]||(s[17]=(0,l.createElementVNode)('span',{class:'nav-icon'},'ğŸ“œ',-1)),o.value?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('span',nr,'å†å²æ­£æ–‡'))]),(0,l.createElementVNode)('div',{class:'nav-item footer-item highlight-item dev-tool',onClick:s[4]||(s[4]=e=>t.$emit('open-variable-manager'))},[s[18]||(s[18]=(0,l.createElementVNode)('span',{class:'nav-icon'},'ğŸ”§',-1)),o.value?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('span',or,'å˜é‡ç®¡ç†å™¨'))]),s[22]||(s[22]=(0,l.createElementVNode)('div',{class:'divider'},null,-1)),(0,l.createElementVNode)('div',{class:'nav-item footer-item',onClick:s[5]||(s[5]=e=>t.$emit('open-changelog'))},[s[19]||(s[19]=(0,l.createElementVNode)('span',{class:'nav-icon'},'ğŸ“‹',-1)),o.value?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('span',lr,'æ›´æ–°æ—¥å¿—'))]),(0,l.createElementVNode)('div',{class:'nav-item footer-item',onClick:s[6]||(s[6]=e=>t.$emit('open-help'))},[s[20]||(s[20]=(0,l.createElementVNode)('span',{class:'nav-icon'},'â“',-1)),o.value?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('span',sr,'å¸®åŠ©è¯´æ˜'))]),(0,l.createCommentVNode)(' AIè¿‡æ»¤æµ‹è¯•æŒ‰é’®å·²éšè—ï¼ˆåŠŸèƒ½å·²ç¦ç”¨ï¼‰\r\n      <div class="nav-item footer-item debug-item" @click="$emit(\'open-ai-filter\')">\r\n        <span class="nav-icon">ğŸ”¬</span>\r\n        <span v-if="!isCollapsed" class="nav-label">AIè¿‡æ»¤æµ‹è¯•</span>\r\n      </div>\r\n      ')])],2))}}),cr=(0,B.A)(rr,[['__scopeId','data-v-08e8a59e']]),ir='MC.èŠ±åå†Œ',dr={$meta:{extensible:!0}},ur={primaryKey:'id',displayField:'name',groupByField:'',fields:{}};function mr(e){return e.startsWith('$')}const pr=t('roster',()=>{const e=sl(),t=(0,l.ref)(!1),a=(0,l.ref)(!1),n=(0,l.ref)(null),o=(0,l.ref)(null),s=(0,l.ref)(0);let r=null;const c=(0,l.computed)(()=>{const t=(s.value,e.getVariable(ir,null));return t&&'object'==typeof t?t:dr}),i=(0,l.computed)(()=>c.value.$schema||ur),d=(0,l.computed)(()=>function(e){return Object.entries(e.fields).map(([e,t])=>({id:e,label:t}))}(i.value)),u=(0,l.computed)(()=>function(e){const t={},a=e.entries;if(!a||'object'!=typeof a)return t;for(const e of Object.keys(a)){if(mr(e))continue;const n=a[e];n&&'object'==typeof n&&!('extensible'in n)&&(t[e]=n)}return t}(c.value)),m=(0,l.computed)(()=>Object.values(u.value)),p=(0,l.computed)(()=>m.value.length),v=(0,l.computed)(()=>0===p.value),f=(0,l.computed)(()=>{const e=i.value.groupByField;if(!e)return{å…¨éƒ¨:m.value};const t={};for(const a of m.value){const n=String(a[e]||'æœªåˆ†ç»„');t[n]||(t[n]=[]),t[n].push(a)}return t}),g=(0,l.computed)(()=>Object.keys(f.value)),h=(0,l.computed)(()=>o.value?u.value[o.value]:null),y=e=>u.value[e];return{isInitialized:t,isLoading:a,error:n,selectedEntryId:o,updateVersion:s,roster:c,schema:i,schemaFields:d,entries:u,entriesArray:m,entryCount:p,isEmpty:v,entriesByGroup:f,groupNames:g,selectedEntry:h,initialize:async()=>{if(!t.value)try{a.value=!0,e.isMvuAvailable||await e.initialize(),r||(r=e.onUpdateEnd(()=>{console.log('[RosterStore] æ”¶åˆ° MVU æ›´æ–°ç»“æŸäº‹ä»¶ï¼Œè§¦å‘åˆ·æ–°'),s.value++})),t.value=!0,console.log('[RosterStore] åˆå§‹åŒ–å®Œæˆï¼Œå½“å‰æ¡ç›®æ•°:',p.value)}catch(e){n.value=e instanceof Error?e.message:'åˆå§‹åŒ–å¤±è´¥'}finally{a.value=!1}},refresh:async()=>{await e.refresh(),s.value++},destroy:()=>{r&&(r(),r=null)},selectEntry:e=>{o.value=e},getEntry:y,getEntryDisplayValue:e=>{const t=i.value.displayField;return t?String(e[t]||''):''},getEntryPrimaryKey:e=>{const t=i.value.primaryKey;return t?String(e[t]||''):''},addEntry:async(t,a)=>{const n=`${ir}.entries.${t}`;return await e.setVariable(n,a,'æ·»åŠ æ¡ç›®')},updateEntry:async(t,a)=>{const n=y(t);if(!n)return!1;const o=`${ir}.entries.${t}`;return await e.setVariable(o,{...n,...a},'æ›´æ–°æ¡ç›®')},removeEntry:async t=>{const a={...u.value};return delete a[t],await e.setVariable(`${ir}.entries`,a,'åˆ é™¤æ¡ç›®')}}}),vr={class:'roster-panel'},fr={class:'panel-header'},gr={class:'header-right'},hr={class:'entry-count'},yr={class:'panel-main'},Vr={class:'category-sidebar'},Nr={class:'category-list'},Er=['onClick'],kr={class:'category-name'},br={class:'category-count'},Cr={class:'panel-body'},wr={key:0,class:'state-container loading-state'},Sr={class:'state-container error-state'},Br={class:'content-area'},Ir={class:'group-header'},Mr={class:'group-title'},Ar={class:'group-count'},Dr={class:'entry-table'},xr={class:'table-header'},_r={class:'col-name'},Tr={class:'table-body'},$r=['onClick'],Rr={class:'col-name'},Lr={class:'person-avatar'},Pr={class:'person-name'},Or={class:'summary-value'},Fr={class:'col-action'},jr={class:'expand-btn'},Ur={key:0,class:'row-details'},zr={class:'details-content'},Wr={class:'field-grid'},Hr={class:'field-label'},Gr={class:'field-value'},Kr=(0,l.defineComponent)({__name:'RosterPanel',emits:['close'],setup(e){const t=pr(),{isEmpty:n,entryCount:o,entriesByGroup:s,schemaFields:r,schema:c,selectedEntryId:i,isLoading:d,error:u,updateVersion:m}=a(t),{selectEntry:p,getEntryPrimaryKey:v,getEntryDisplayValue:f,refresh:g,initialize:h}=t,y=(0,l.ref)(null),V=(0,l.computed)(()=>{const e=c.value.displayField;return c.value.fields[e]||'å§“å'}),N=(0,l.computed)(()=>{const e=c.value.primaryKey,t=c.value.displayField;return r.value.filter(a=>a.id!==e&&a.id!==t).slice(0,3)});(0,l.watch)(m,e=>{console.log('[RosterPanel] updateVersion:',e,'æ¡ç›®æ•°:',o.value)},{immediate:!1});const E=(0,l.computed)(()=>y.value?s.value[y.value]||[]:Object.values(s.value).flat()),k=e=>{const t=f(e);return t?t.charAt(0):'?'},b=e=>null==e?'-':Array.isArray(e)?e.length>0?e.join(', '):'-':String(e);return(0,l.onMounted)(async()=>{await h();const e=Object.keys(s.value);e.length>0&&(y.value=e[0])}),(0,l.onUnmounted)(()=>{console.log('[RosterPanel] é¢æ¿å·²å¸è½½')}),(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',vr,[(0,l.createCommentVNode)(' é¡¶éƒ¨å¤´æ  '),(0,l.createElementVNode)('div',fr,[t[2]||(t[2]=(0,l.createElementVNode)('div',{class:'header-left'},[(0,l.createElementVNode)('span',{class:'panel-icon'},'ğŸ‘¥'),(0,l.createElementVNode)('h2',null,'èŠ±åå†Œ')],-1)),(0,l.createElementVNode)('div',gr,[(0,l.createElementVNode)('span',hr,(0,l.toDisplayString)((0,l.unref)(o))+' äºº',1),(0,l.createElementVNode)('button',{class:'close-btn',title:'å…³é—­',onClick:t[0]||(t[0]=t=>e.$emit('close'))},'âœ•')])]),(0,l.createCommentVNode)(' ä¸»ä½“åŒºåŸŸ '),(0,l.createElementVNode)('div',yr,[(0,l.createCommentVNode)(' å·¦ä¾§åˆ†ç±»å¯¼èˆª '),(0,l.createElementVNode)('aside',Vr,[t[3]||(t[3]=(0,l.createElementVNode)('div',{class:'sidebar-header'},[(0,l.createElementVNode)('span',{class:'sidebar-title'},'åˆ†ç±»')],-1)),(0,l.createElementVNode)('div',Nr,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)((0,l.unref)(s),(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:t,class:(0,l.normalizeClass)(['category-item',{active:y.value===t}]),onClick:e=>(e=>{y.value=y.value===e?null:e})(t)},[(0,l.createElementVNode)('span',kr,(0,l.toDisplayString)(t),1),(0,l.createElementVNode)('span',br,(0,l.toDisplayString)(e.length),1)],10,Er))),128))])]),(0,l.createCommentVNode)(' å³ä¾§å†…å®¹åŒº '),(0,l.createElementVNode)('div',Cr,[(0,l.createCommentVNode)(' åŠ è½½çŠ¶æ€ '),(0,l.unref)(d)?((0,l.openBlock)(),(0,l.createElementBlock)('div',wr,[...t[4]||(t[4]=[(0,l.createElementVNode)('div',{class:'state-icon'},'â³',-1),(0,l.createElementVNode)('p',null,'åŠ è½½ä¸­...',-1)])])):(0,l.unref)(u)?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createCommentVNode)(' é”™è¯¯çŠ¶æ€ '),(0,l.createElementVNode)('div',Sr,[t[5]||(t[5]=(0,l.createElementVNode)('div',{class:'state-icon'},'âš ï¸',-1)),(0,l.createElementVNode)('p',null,(0,l.toDisplayString)((0,l.unref)(u)),1),(0,l.createElementVNode)('button',{class:'retry-btn',onClick:t[1]||(t[1]=(...e)=>(0,l.unref)(g)&&(0,l.unref)(g)(...e))},'é‡è¯•')])],2112)):(0,l.unref)(n)?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:2},[(0,l.createCommentVNode)(' ç©ºçŠ¶æ€ '),t[6]||(t[6]=(0,l.createElementVNode)('div',{class:'state-container empty-state'},[(0,l.createElementVNode)('div',{class:'state-icon'},'ğŸ“­'),(0,l.createElementVNode)('p',null,'æš‚æ— äººå‘˜æ•°æ®'),(0,l.createElementVNode)('p',{class:'empty-hint'},[(0,l.createTextVNode)('æ•°æ®ä» '),(0,l.createElementVNode)('code',null,'MC.èŠ±åå†Œ'),(0,l.createTextVNode)(' å˜é‡ä¸­è¯»å–')])],-1))],2112)):((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:3},[(0,l.createCommentVNode)(' äººå‘˜åˆ—è¡¨ '),(0,l.createElementVNode)('div',Br,[(0,l.createCommentVNode)(' å½“å‰åˆ†ç»„æ ‡é¢˜ '),(0,l.createElementVNode)('div',Ir,[(0,l.createElementVNode)('h3',Mr,(0,l.toDisplayString)(y.value||'å…¨éƒ¨äººå‘˜'),1),(0,l.createElementVNode)('span',Ar,'å…± '+(0,l.toDisplayString)(E.value.length)+' äºº',1)]),(0,l.createCommentVNode)(' æ¡ç›®è¡¨æ ¼ '),(0,l.createElementVNode)('div',Dr,[(0,l.createCommentVNode)(' è¡¨å¤´ '),(0,l.createElementVNode)('div',xr,[(0,l.createElementVNode)('div',_r,(0,l.toDisplayString)(V.value),1),((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(N.value,e=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.id,class:'col-summary'},(0,l.toDisplayString)(e.label),1))),128)),t[7]||(t[7]=(0,l.createElementVNode)('div',{class:'col-action'},'æ“ä½œ',-1))]),(0,l.createCommentVNode)(' è¡¨æ ¼å†…å®¹ '),(0,l.createElementVNode)('div',Tr,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(E.value,e=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:(0,l.unref)(v)(e),class:(0,l.normalizeClass)(['table-row',{'is-expanded':(0,l.unref)(i)===(0,l.unref)(v)(e)}])},[(0,l.createCommentVNode)(' ä¸»è¡Œ '),(0,l.createElementVNode)('div',{class:'row-main',onClick:t=>{return a=(0,l.unref)(v)(e),void p(i.value===a?null:a);var a}},[(0,l.createElementVNode)('div',Rr,[(0,l.createElementVNode)('span',Lr,(0,l.toDisplayString)(k(e)),1),(0,l.createElementVNode)('span',Pr,(0,l.toDisplayString)((0,l.unref)(f)(e)),1)]),((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(N.value,t=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:t.id,class:'col-summary'},[(0,l.createElementVNode)('span',Or,(0,l.toDisplayString)(b(e[t.id])),1)]))),128)),(0,l.createElementVNode)('div',Fr,[(0,l.createElementVNode)('span',jr,(0,l.toDisplayString)((0,l.unref)(i)===(0,l.unref)(v)(e)?'æ”¶èµ· â–²':'è¯¦æƒ… â–¼'),1)])],8,$r),(0,l.createCommentVNode)(' å±•å¼€çš„è¯¦æƒ…é¢æ¿ '),(0,l.unref)(i)===(0,l.unref)(v)(e)?((0,l.openBlock)(),(0,l.createElementBlock)('div',Ur,[(0,l.createElementVNode)('div',zr,[(0,l.createElementVNode)('div',Wr,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)((0,l.unref)(r),t=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:t.id,class:'field-item'},[(0,l.createElementVNode)('span',Hr,(0,l.toDisplayString)(t.label),1),(0,l.createElementVNode)('span',Gr,(0,l.toDisplayString)(b(e[t.id])),1)]))),128))])])])):(0,l.createCommentVNode)('v-if',!0)],2))),128))])])])],2112))])])]))}}),Jr=(0,B.A)(Kr,[['__scopeId','data-v-484d301b']]);function qr(e){if('string'!=typeof e)return e;const t=e.trim();if(!(t.startsWith('{')&&t.endsWith('}')||t.startsWith('[')&&t.endsWith(']')))return e;try{const t=JSON.parse(e);return console.log('[DocumentStore] æˆåŠŸè§£æå­—ç¬¦ä¸²åŒ–çš„æ–‡æ¡£æ•°æ®'),t}catch(t){try{const t=e.replace(/\\"/g,'"').replace(/\\\\/g,'\\');if(t!==e){const e=JSON.parse(t);return console.log('[DocumentStore] æˆåŠŸè§£æåŒé‡è½¬ä¹‰çš„æ–‡æ¡£æ•°æ®'),e}}catch{}return console.warn('[DocumentStore] æ— æ³•è§£æå­—ç¬¦ä¸²åŒ–çš„æ–‡æ¡£æ•°æ®:',t),e}}function Yr(e){const t={title:String(e.title||''),description:String(e.description||'')};if(e.$meta&&(t.$meta=e.$meta),e.$formMeta&&(t.$formMeta=e.$formMeta),e.sections&&'object'==typeof e.sections){const a=e.sections;for(const[e,n]of Object.entries(a)){if('$meta'===e||e.startsWith('$'))continue;if(!n||'object'!=typeof n)continue;const a=n;t[e]=Xr(a)}}return t}function Xr(e){const t=e.content,a=e.children,n=e.$fieldDef,o=a&&'object'==typeof a&&Object.keys(a).filter(e=>!e.startsWith('$')).length>0;if(!o&&!n)return t||'';const l={};if(t&&(l._t=t),n&&(l.$fieldDef=n),o){const e={},t=Object.entries(a).filter(([e])=>!e.startsWith('$')).sort(([,e],[,t])=>(e?.order??999)-(t?.order??999));for(const[a,n]of t)n&&'object'==typeof n&&(e[a]=Xr(n));Object.keys(e).length>0&&(l._s=e)}return l}const Zr=t('document',()=>{const e=sl(),t=(0,l.ref)(!1),a=(0,l.ref)(!1),n=(0,l.ref)(null),o=(0,l.ref)(null),s=(0,l.ref)(0);let r=null;const c=(0,l.computed)(()=>{const t=s.value,a=e.getVariable(ga,ha);if(console.log('[DocumentStore] è¯»å– MC.æ–‡æ¡£ å˜é‡ (version='+t+'):',{path:ga,rawDataType:typeof a,rawDataKeys:a&&'object'==typeof a?Object.keys(a):[],hasData:null!=a}),function(e){if(!e||'object'!=typeof e)return!1;const t=e;return'string'==typeof t.title&&'object'==typeof t.sections&&null!==t.sections&&!t.$meta}(a)){console.log('[DocumentStore] æ£€æµ‹åˆ°æ—§ç‰ˆå•æ–‡æ¡£ç»“æ„ï¼Œè¿›è¡Œè½¬æ¢');return{$meta:{extensible:!0},default:Yr(a)}}if(a&&'object'==typeof a&&function(e){if(!e||'object'!=typeof e)return!1;const t=e;for(const e of Object.keys(t)){if('$meta'===e)continue;const a=t[e];if(a&&'object'==typeof a&&'sections'in a)return!0}return!1}(a))return console.log('[DocumentStore] æ£€æµ‹åˆ°æ—§ç‰ˆå¤šæ–‡æ¡£ç»“æ„ï¼Œè¿›è¡Œè½¬æ¢'),function(e){const t={$meta:{extensible:!0}};for(const[a,n]of Object.entries(e)){if('$meta'===a){t.$meta=n;continue}if(!n||'object'!=typeof n)continue;const e=n;'string'==typeof e.title&&(t[a]=Yr(e))}return t}(a);if(a&&'object'==typeof a){return function(e){const t={};let a=!1;for(const[n,o]of Object.entries(e))if('$meta'!==n)if('string'==typeof o){console.warn(`[DocumentStore] æ£€æµ‹åˆ°å­—ç¬¦ä¸²åŒ–çš„æ–‡æ¡£: "${n}"ï¼Œå°è¯•ä¿®å¤...`),a=!0;const e=qr(o);e&&'object'==typeof e&&'title'in e?(console.log(`[DocumentStore] æ–‡æ¡£ "${n}" ä¿®å¤æˆåŠŸ`),t[n]=e):(console.error(`[DocumentStore] æ–‡æ¡£ "${n}" ä¿®å¤å¤±è´¥ï¼Œä¿æŒåŸå€¼`),t[n]=o)}else t[n]=o;else t[n]=o;return a&&console.log('[DocumentStore] å·²å®Œæˆå­—ç¬¦ä¸²åŒ–æ–‡æ¡£çš„ä¿®å¤å¤„ç†'),t}(a)}return a}),i=(0,l.computed)(()=>{return e=c.value,Object.keys(e).filter(e=>!Va(e)).map(t=>({id:t,...e[t]})).filter(e=>'string'==typeof e.title);var e}),d=(0,l.computed)(()=>i.value.length),u=(0,l.computed)(()=>0===d.value),m=(0,l.computed)(()=>{const e=o.value;if(e)return e;const t=i.value;return t.length>0?t[0].id:null}),p=(0,l.computed)(()=>{const e=m.value;if(!e)return null;const t=c.value[e];return t&&'object'==typeof t&&'title'in t?t:null}),v=(0,l.computed)(()=>p.value?.title||''),f=(0,l.computed)(()=>{const e=p.value;return e&&e.description||''}),g=(0,l.computed)(()=>{const e=p.value;return e?function(e){const t=[];for(const a of Object.keys(e)){if(Na(a))continue;const n=e[a];'string'!=typeof n&&('object'!=typeof n||null===n||'extensible'in n||'formName'in n)||t.push([a,n])}return t}(e):[]}),h=(0,l.computed)(()=>ba(g.value)),y=(0,l.computed)(()=>0===g.value.length),V=()=>m.value;return{isInitialized:t,isLoading:a,error:n,currentDocId:o,documentsContainer:c,documentList:i,documentCount:d,hasNoDocuments:u,effectiveDocId:m,currentDocument:p,title:v,description:f,chapterEntries:g,nodeCount:h,isEmpty:y,initialize:async()=>{if(!t.value)try{a.value=!0,e.isMvuAvailable||await e.initialize(),r||(r=e.onUpdateEnd(()=>{console.log('[DocumentStore] æ”¶åˆ° MVU æ›´æ–°ç»“æŸäº‹ä»¶ï¼Œé€’å¢ dataVersion'),s.value++})),i.value.length>0&&!o.value&&(o.value=i.value[0].id),t.value=!0}catch(e){n.value=e instanceof Error?e.message:'åˆå§‹åŒ–å¤±è´¥'}finally{a.value=!1}},refresh:async()=>{await e.refresh(),s.value++},selectDocument:e=>{console.log('[DocumentStore] selectDocument è¢«è°ƒç”¨, docId:',e);let t=c.value[e];if('string'==typeof t){console.warn('[DocumentStore] æ£€æµ‹åˆ°å­—ç¬¦ä¸²ç±»å‹çš„æ–‡æ¡£ï¼Œå°è¯•è§£æ...');const e=qr(t);e&&'object'==typeof e&&'title'in e&&(t=e)}t&&'object'==typeof t&&'title'in t?o.value!==e&&(o.value=e,console.log('[DocumentStore] æ–‡æ¡£åˆ‡æ¢å®Œæˆï¼Œæ–°çš„æ–‡æ¡£ID:',o.value)):console.warn('[DocumentStore] å°è¯•é€‰æ‹©ä¸å­˜åœ¨çš„æ–‡æ¡£:',e)},getEffectiveDocId:V,updateTitle:async t=>{const a=V();return!!a&&await e.setVariable(`${ga}.${a}.title`,t,'æ›´æ–°æ ‡é¢˜')},updateDescription:async t=>{const a=V();return!!a&&await e.setVariable(`${ga}.${a}.description`,t,'æ›´æ–°æè¿°')},addDocument:async(t,a)=>await e.setVariable(`${ga}.${t}`,a,'æ·»åŠ æ–‡æ¡£'),removeDocument:async t=>{const a={...e.getVariable(ga,{})};if(delete a[t],o.value===t){const e=Object.keys(a).filter(e=>'$meta'!==e);o.value=e.length>0?e[0]:null}return await e.setVariable(ga,a,'åˆ é™¤æ–‡æ¡£')},DEFAULT_DOCUMENT_ENTRY:ya,destroy:()=>{r&&(r(),r=null)},dataVersion:s}}),Qr={key:0,class:'expand-icon'},ec={key:1,class:'expand-placeholder'},tc={class:'node-title'},ac={key:2,class:'node-inline-content'},nc={key:0,class:'node-content'},oc={key:1,class:'node-content'},lc={key:2,class:'node-children'},sc=(0,l.defineComponent)({__name:'TreeNodeRenderer',props:{nodeKey:{},nodeValue:{},depth:{default:0},defaultExpanded:{type:Boolean,default:!0}},setup(e){const t=e,a=(0,l.ref)(t.defaultExpanded),n=(0,l.computed)(()=>Ea(t.nodeValue)),o=(0,l.computed)(()=>Ea(t.nodeValue)?t.nodeValue:''),s=(0,l.computed)(()=>{if(!ka(t.nodeValue))return!1;const e=t.nodeValue;return'_t'in e||'_s'in e}),r=(0,l.computed)(()=>!!ka(t.nodeValue)&&!s.value),c=(0,l.computed)(()=>s.value?t.nodeValue:null),i=(0,l.computed)(()=>c.value?._t||''),d=(0,l.computed)(()=>{if(c.value?._s)return Object.keys(c.value._s).length>0;if(r.value){const e=t.nodeValue;return Object.keys(e).filter(e=>!Na(e)).length>0}return!1}),u=(0,l.computed)(()=>{if(c.value?._s)return Object.entries(c.value._s).filter(([e])=>!Va(e));if(r.value){const e=t.nodeValue;return Object.entries(e).filter(([e])=>!Na(e)).map(([e,t])=>[e,t])}return[]}),m=()=>{d.value&&(a.value=!a.value)};return(t,s)=>{const r=(0,l.resolveComponent)('TreeNodeRenderer',!0);return(0,l.openBlock)(),(0,l.createElementBlock)('div',{class:(0,l.normalizeClass)(['tree-node',`depth-${e.depth}`])},[(0,l.createCommentVNode)(' èŠ‚ç‚¹æ ‡é¢˜è¡Œ '),(0,l.createElementVNode)('div',{class:'node-header',onClick:m},[d.value?((0,l.openBlock)(),(0,l.createElementBlock)('span',Qr,(0,l.toDisplayString)(a.value?'â–¼':'â–¶'),1)):((0,l.openBlock)(),(0,l.createElementBlock)('span',ec)),(0,l.createElementVNode)('span',tc,(0,l.toDisplayString)(e.nodeKey),1),(0,l.createCommentVNode)(' å¶å­èŠ‚ç‚¹çš„å†…å®¹ç›´æ¥è·Ÿåœ¨æ ‡é¢˜åé¢ï¼ˆå¦‚æœå†…å®¹ä¸é•¿ï¼‰ '),n.value&&o.value.length<=80?((0,l.openBlock)(),(0,l.createElementBlock)('span',ac,(0,l.toDisplayString)(o.value),1)):(0,l.createCommentVNode)('v-if',!0)]),(0,l.createCommentVNode)(' å¶å­èŠ‚ç‚¹çš„é•¿å†…å®¹ï¼ˆå•ç‹¬ä¸€è¡Œï¼‰ '),n.value&&o.value.length>80?((0,l.openBlock)(),(0,l.createElementBlock)('div',nc,(0,l.toDisplayString)(o.value),1)):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' åˆ†æ”¯èŠ‚ç‚¹çš„æ­£æ–‡ (_t) '),!i.value||!a.value&&d.value?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('div',oc,(0,l.toDisplayString)(i.value),1)),(0,l.createCommentVNode)(' å­èŠ‚ç‚¹ï¼ˆé€’å½’æ¸²æŸ“ï¼‰ '),d.value&&a.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',lc,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(u.value,([t,a])=>((0,l.openBlock)(),(0,l.createBlock)(r,{key:t,'node-key':t,'node-value':a,depth:e.depth+1,'default-expanded':e.defaultExpanded},null,8,['node-key','node-value','depth','default-expanded']))),128))])):(0,l.createCommentVNode)('v-if',!0)],2)}}}),rc=(0,B.A)(sc,[['__scopeId','data-v-77df52ff']]),cc={class:'panel-header'},ic={class:'doc-count'},dc={class:'panel-main'},uc={class:'sidebar-header'},mc={key:0,class:'sidebar-title'},pc=['title'],vc={key:0,class:'document-list'},fc=['onClick','onKeydown'],gc={class:'doc-info'},hc={class:'doc-title'},yc={key:0,class:'doc-desc'},Vc={key:1,class:'sidebar-empty'},Nc={key:2,class:'collapsed-list'},Ec=['title','onClick','onKeydown'],kc={class:'panel-body'},bc={key:0,class:'loading-state'},Cc={class:'error-state'},wc={class:'document-content'},Sc={class:'current-doc-header'},Bc={class:'current-doc-title'},Ic={class:'section-count'},Mc={key:0,class:'document-description'},Ac=(0,l.defineComponent)({__name:'DocumentPanel',emits:['close'],setup(e){const t=Zr(),{documentList:n,documentCount:o,hasNoDocuments:s,currentDocId:r,isLoading:c,error:i}=a(t),{refresh:d,initialize:u,selectDocument:m}=t,p=(0,l.computed)(()=>t.effectiveDocId),v=(0,l.computed)(()=>t.title),f=(0,l.computed)(()=>t.description),g=(0,l.computed)(()=>t.isEmpty),h=(0,l.computed)(()=>t.chapterEntries),y=(0,l.computed)(()=>h.value.length),V=(0,l.ref)(!1),N=()=>{V.value=!V.value},E=(e,t=30)=>e.length>t?e.slice(0,t)+'...':e,k=e=>p.value===e,b=e=>{console.log('[DocumentPanel] ç‚¹å‡»é€‰æ‹©æ–‡æ¡£:',e,'å½“å‰æœ‰æ•ˆæ–‡æ¡£:',p.value),console.log('[DocumentPanel] currentDocId.value:',r.value),console.log('[DocumentPanel] å¯ç”¨æ–‡æ¡£åˆ—è¡¨:',n.value.map(e=>e.id)),m(e),console.log('[DocumentPanel] é€‰æ‹©å currentDocId:',r.value),console.log('[DocumentPanel] é€‰æ‹©å effectiveDocId:',p.value),console.log('[DocumentPanel] é€‰æ‹©å title:',v.value)};return(0,l.watch)(r,(e,t)=>{console.log('[DocumentPanel] currentDocId å˜åŒ–:',t,'->',e)}),(0,l.watch)(p,(e,t)=>{console.log('[DocumentPanel] effectiveDocId å˜åŒ–:',t,'->',e)}),(0,l.watch)(v,(e,t)=>{console.log('[DocumentPanel] title å˜åŒ–:',t,'->',e)}),(0,l.watch)(h,e=>{console.log('[DocumentPanel] chapterEntries å˜åŒ–, ç« èŠ‚æ•°:',e.length)},{deep:!0}),(0,l.onMounted)(()=>{u()}),(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{class:(0,l.normalizeClass)(['document-panel',{'sidebar-collapsed':V.value}])},[(0,l.createCommentVNode)(' é¡¶éƒ¨å¤´æ  '),(0,l.createElementVNode)('div',cc,[t[2]||(t[2]=(0,l.createElementVNode)('h2',null,'ğŸ“„ æ–‡æ¡£æŸ¥çœ‹',-1)),(0,l.createElementVNode)('span',ic,(0,l.toDisplayString)((0,l.unref)(o))+' ä»½æ–‡æ¡£',1),(0,l.createElementVNode)('button',{class:'close-btn',onClick:t[0]||(t[0]=t=>e.$emit('close'))},'âœ•')]),(0,l.createElementVNode)('div',dc,[(0,l.createCommentVNode)(' å·¦ä¾§æ–‡æ¡£åˆ—è¡¨ä¾§æ  '),(0,l.createElementVNode)('aside',{class:(0,l.normalizeClass)(['document-sidebar',{collapsed:V.value}])},[(0,l.createElementVNode)('div',uc,[V.value?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('span',mc,'æ–‡æ¡£åˆ—è¡¨')),(0,l.createElementVNode)('button',{class:'toggle-btn',title:V.value?'å±•å¼€ä¾§æ ':'æ”¶èµ·ä¾§æ ',onClick:N},(0,l.toDisplayString)(V.value?'â–¶':'â—€'),9,pc)]),!V.value&&(0,l.unref)(o)>0?((0,l.openBlock)(),(0,l.createElementBlock)('div',vc,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)((0,l.unref)(n),e=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.id,class:(0,l.normalizeClass)(['doc-item',{active:k(e.id)}]),role:'button',tabindex:'0',onClick:(0,l.withModifiers)(t=>b(e.id),['stop','prevent']),onKeydown:(0,l.withKeys)(t=>b(e.id),['enter'])},[t[3]||(t[3]=(0,l.createElementVNode)('span',{class:'doc-icon'},'ğŸ“–',-1)),(0,l.createElementVNode)('div',gc,[(0,l.createElementVNode)('span',hc,(0,l.toDisplayString)(e.title||e.id),1),e.description?((0,l.openBlock)(),(0,l.createElementBlock)('span',yc,(0,l.toDisplayString)(E(e.description)),1)):(0,l.createCommentVNode)('v-if',!0)])],42,fc))),128))])):(0,l.createCommentVNode)('v-if',!0),V.value||0!==(0,l.unref)(o)?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('div',Vc,[...t[4]||(t[4]=[(0,l.createElementVNode)('span',null,'æš‚æ— æ–‡æ¡£',-1)])])),(0,l.createCommentVNode)(' æ”¶ç¼©çŠ¶æ€ä¸‹çš„å›¾æ ‡åˆ—è¡¨ '),V.value&&(0,l.unref)(o)>0?((0,l.openBlock)(),(0,l.createElementBlock)('div',Nc,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)((0,l.unref)(n),e=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.id,class:(0,l.normalizeClass)(['collapsed-item',{active:k(e.id)}]),title:e.title||e.id,role:'button',tabindex:'0',onClick:(0,l.withModifiers)(t=>b(e.id),['stop','prevent']),onKeydown:(0,l.withKeys)(t=>b(e.id),['enter'])},' ğŸ“– ',42,Ec))),128))])):(0,l.createCommentVNode)('v-if',!0)],2),(0,l.createCommentVNode)(' å³ä¾§æ–‡æ¡£å†…å®¹åŒº '),(0,l.createElementVNode)('div',kc,[(0,l.createCommentVNode)(' åŠ è½½çŠ¶æ€ '),(0,l.unref)(c)?((0,l.openBlock)(),(0,l.createElementBlock)('div',bc,[...t[5]||(t[5]=[(0,l.createElementVNode)('p',null,'åŠ è½½ä¸­...',-1)])])):(0,l.unref)(i)?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createCommentVNode)(' é”™è¯¯çŠ¶æ€ '),(0,l.createElementVNode)('div',Cc,[(0,l.createElementVNode)('p',null,(0,l.toDisplayString)((0,l.unref)(i)),1),(0,l.createElementVNode)('button',{onClick:t[1]||(t[1]=(...e)=>(0,l.unref)(d)&&(0,l.unref)(d)(...e))},'é‡è¯•')])],2112)):(0,l.unref)(s)?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:2},[(0,l.createCommentVNode)(' æ— æ–‡æ¡£çŠ¶æ€ '),t[6]||(t[6]=(0,l.createElementVNode)('div',{class:'empty-state'},[(0,l.createElementVNode)('p',null,'ğŸ“­ æš‚æ— æ–‡æ¡£'),(0,l.createElementVNode)('p',{class:'empty-hint'},[(0,l.createTextVNode)('æ–‡æ¡£æ•°æ®ä» '),(0,l.createElementVNode)('code',null,'MC.æ–‡æ¡£'),(0,l.createTextVNode)(' å˜é‡ä¸­è¯»å–')]),(0,l.createElementVNode)('p',{class:'empty-hint'},'AI ä¼šåœ¨æ¸¸æˆè¿›ç¨‹ä¸­è‡ªåŠ¨æ›´æ–°æ–‡æ¡£å†…å®¹')],-1))],2112)):g.value?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:3},[(0,l.createCommentVNode)(' å½“å‰æ–‡æ¡£ä¸ºç©º '),t[7]||(t[7]=(0,l.createElementVNode)('div',{class:'empty-state'},[(0,l.createElementVNode)('p',null,'ğŸ“ è¯¥æ–‡æ¡£æš‚æ— å†…å®¹')],-1))],2112)):((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:4},[(0,l.createCommentVNode)(' æ–‡æ¡£å†…å®¹ '),(0,l.createElementVNode)('div',wc,[(0,l.createElementVNode)('div',Sc,[(0,l.createElementVNode)('h3',Bc,(0,l.toDisplayString)(v.value),1),(0,l.createElementVNode)('span',Ic,(0,l.toDisplayString)(y.value)+' ç« ',1)]),f.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',Mc,(0,l.toDisplayString)(f.value),1)):(0,l.createCommentVNode)('v-if',!0),((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(h.value,([e,t])=>((0,l.openBlock)(),(0,l.createBlock)(rc,{key:e,'node-key':e,'node-value':t,depth:0},null,8,['node-key','node-value']))),128))])],2112))])])],2))}}),Dc=(0,B.A)(Ac,[['__scopeId','data-v-58f812ad']]),xc='MC.ç”³è¯·è®°å½•',_c=t('form',()=>{const e=sl(),t=(0,l.ref)(!1),a=(0,l.ref)(!1),n=(0,l.ref)(null),o=(0,l.ref)(null),s=(0,l.ref)({}),r=(0,l.ref)(0);let c=null;const i=(0,l.computed)(()=>{r.value;return e.getVariable('MC.æ–‡æ¡£',{})}),d=(0,l.computed)(()=>Ma.parseDocuments(i.value)),u=(0,l.computed)(()=>{const e=d.value.forms;return Object.entries(e).map(([e,t])=>({formId:e,formName:t.meta.formName,description:t.meta.description,sourceDocId:t.sourceDocId}))}),m=(0,l.computed)(()=>u.value.length),p=(0,l.computed)(()=>0===m.value),v=(0,l.computed)(()=>{r.value;const e=o.value,t=d.value.forms,a=Object.keys(t);return e&&t[e]?e:a.length>0?a[0]:null}),f=(0,l.computed)(()=>{const e=v.value;return e&&d.value.forms[e]||null}),g=(0,l.computed)(()=>f.value?.fields||[]),h=(0,l.computed)(()=>f.value?.meta||null),y=()=>{const t=g.value,a={};for(const n of t)if(void 0!==n.defaultValue&&('string'==typeof n.defaultValue&&n.defaultValue.startsWith('{{')?'{{currentDate}}'===n.defaultValue&&(a[n.fieldId]=(new Date).toISOString().split('T')[0]):a[n.fieldId]=n.defaultValue),n.source){const t=e.getVariable(n.source,null);null!==t&&(a[n.fieldId]=t)}s.value=a},V=()=>{const e={},t=g.value,a=s.value;for(const n of t){const t=a[n.fieldId];if(!n.required||null!=t&&''!==t){if(n.conditionalRequired){const o=n.conditionalRequired,l=a[o.when.field];let s=!1;if(void 0!==o.when.equals?s=l===o.when.equals:void 0!==o.when.in&&(s=o.when.in.includes(l)),s&&o.required&&(null==t||''===t)){e[n.fieldId]=`${n.label}ä¸èƒ½ä¸ºç©º`;continue}}'string'==typeof t&&(n.minLength&&t.length<n.minLength&&(e[n.fieldId]=`${n.label}è‡³å°‘éœ€è¦${n.minLength}ä¸ªå­—ç¬¦`),n.maxLength&&t.length>n.maxLength&&(e[n.fieldId]=`${n.label}ä¸èƒ½è¶…è¿‡${n.maxLength}ä¸ªå­—ç¬¦`)),'number'==typeof t&&(void 0!==n.min&&t<n.min&&(e[n.fieldId]=`${n.label}ä¸èƒ½å°äº${n.min}`),void 0!==n.max&&t>n.max&&(e[n.fieldId]=`${n.label}ä¸èƒ½å¤§äº${n.max}`)),n.mustBeTrue&&!0!==t&&(e[n.fieldId]=`è¯·å‹¾é€‰${n.label}`)}else e[n.fieldId]=`${n.label}ä¸èƒ½ä¸ºç©º`}return{valid:0===Object.keys(e).length,errors:e}},N=(0,l.computed)(()=>{r.value;return e.getVariable(xc,{})}),E=(e,t)=>{const a={appId:e,summary:t,formType:'',applicant:'',date:'',status:'å¾…å®¡æ‰¹',details:{}},n=t.match(/ã€(.+?)ã€‘/);n&&(a.formType=n[1]);const o=t.split('|').map(e=>e.trim());for(const e of o)if(e.startsWith('ç”³è¯·äººï¼š')){const t=e.match(/ç”³è¯·äººï¼š(.+?)(?:ï¼ˆ(.+?)ï¼‰)?$/);t&&(a.applicant=t[1],t[2]&&(a.details['éƒ¨é—¨']=t[2]))}else if(e.startsWith('æ—¥æœŸï¼š'))a.date=e.replace('æ—¥æœŸï¼š','');else if(e.startsWith('çŠ¶æ€ï¼š'))a.status=e.replace('çŠ¶æ€ï¼š','');else if(e.includes('ï¼š')){const[t,n]=e.split('ï¼š');t&&n&&!t.startsWith('ã€')&&(a.details[t]=n)}return a},k=(0,l.computed)(()=>{const e=h.value;if(!e?.targetPath)return[];const t=e.targetPath.split('.'),a=t[t.length-1],n=N.value[a];if(!n)return[];const o=[];for(const[e,t]of Object.entries(n))e.startsWith('$')||'string'!=typeof t||o.push(E(e,t));return o.sort((e,t)=>t.appId.localeCompare(e.appId))}),b=(0,l.computed)(()=>{const e=N.value,t=[];for(const[a,n]of Object.entries(e))if(!a.startsWith('$')&&n&&'object'==typeof n)for(const[e,a]of Object.entries(n))e.startsWith('$')||'string'!=typeof a||t.push(E(e,a));return t.sort((e,t)=>t.appId.localeCompare(e.appId))}),C=(0,l.computed)(()=>k.value.length),w=(0,l.computed)(()=>b.value.length),S=async(t,a)=>{try{let n=a;if(!n){const e=h.value;if(!e?.targetPath)return{success:!1,error:'æ— æ³•ç¡®å®šç”³è¯·ç±»åˆ«'};const t=e.targetPath.split('.');n=t[t.length-1]}const o=N.value[n];if(!o)return{success:!1,error:'æ‰¾ä¸åˆ°ç”³è¯·ç±»åˆ«'};const l=o[t];if('string'!=typeof l)return{success:!1,error:'æ‰¾ä¸åˆ°è¯¥ç”³è¯·è®°å½•'};let s=l;const c=[/çŠ¶æ€ï¼š[^|]+$/,/çŠ¶æ€ï¼š[^|]+\|/];let i=!1;for(const e of c)if(e.test(s)){s=s.replace(e,e=>e.endsWith('|')?'çŠ¶æ€ï¼šå·²æ‰¹å‡†ï¼ˆå¿«é€Ÿé€šè¿‡ï¼‰|':'çŠ¶æ€ï¼šå·²æ‰¹å‡†ï¼ˆå¿«é€Ÿé€šè¿‡ï¼‰'),i=!0;break}i||(s+=' | çŠ¶æ€ï¼šå·²æ‰¹å‡†ï¼ˆå¿«é€Ÿé€šè¿‡ï¼‰');const d=`${xc}.${n}.${t}`;return await e.setVariable(d,s,`å¿«é€Ÿé€šè¿‡ç”³è¯· ${t}`),r.value++,{success:!0}}catch(e){return{success:!1,error:e instanceof Error?e.message:'æ“ä½œå¤±è´¥'}}},B=async(t,a)=>{try{let n=a;if(!n){const e=h.value;if(!e?.targetPath)return{success:!1,error:'æ— æ³•ç¡®å®šç”³è¯·ç±»åˆ«'};const t=e.targetPath.split('.');n=t[t.length-1]}const o=N.value[n];if(!o||'string'!=typeof o[t])return{success:!1,error:'æ‰¾ä¸åˆ°è¯¥ç”³è¯·è®°å½•'};const l={...o};delete l[t];const s=`${xc}.${n}`;return await e.setVariable(s,l,`åˆ é™¤ç”³è¯·è®°å½• ${t}`),r.value++,{success:!0}}catch(e){return{success:!1,error:e instanceof Error?e.message:'åˆ é™¤å¤±è´¥'}}};return{isInitialized:t,isLoading:a,error:n,currentFormId:o,formData:s,dataVersion:r,availableForms:u,formCount:m,hasNoForms:p,effectiveFormId:v,currentForm:f,currentFields:g,currentFormMeta:h,getCurrentFormApplications:k,getAllApplications:b,applicationCount:C,totalApplicationCount:w,initialize:async()=>{if(!t.value)try{a.value=!0,e.isMvuAvailable||await e.initialize(),c||(c=e.onUpdateEnd(()=>{r.value++})),u.value.length>0&&!o.value&&(o.value=u.value[0].formId),t.value=!0}catch(e){n.value=e instanceof Error?e.message:'åˆå§‹åŒ–å¤±è´¥'}finally{a.value=!1}},refresh:async()=>{await e.refresh(),r.value++},destroy:()=>{c&&(c(),c=null)},selectForm:async e=>{o.value!==e&&(s.value={},o.value=e,r.value++,await(0,l.nextTick)(),await(0,l.nextTick)(),y())},initializeFormData:y,autoFillFormData:()=>{const t=g.value,a={...s.value};for(const n of t){if(n.source){const t=e.getVariable(n.source,null);if(null!=t&&''!==t){a[n.fieldId]=t;continue}}const t={ç”³è¯·äººå§“å:'MC.ç©å®¶.å§“å',æ‰€å±éƒ¨é—¨:'MC.ç©å®¶.éƒ¨é—¨',èŒåŠ¡:'MC.ç©å®¶.èŒä½',èŒä½:'MC.ç©å®¶.èŒä½'}[n.label];if(t&&!a[n.fieldId]){const o=e.getVariable(t,null);if(null!=o&&''!==o){a[n.fieldId]=o;continue}}'date'!==n.inputType&&'datetime'!==n.inputType?void 0!==a[n.fieldId]&&null!==a[n.fieldId]&&''!==a[n.fieldId]||void 0!==n.defaultValue&&('string'==typeof n.defaultValue&&n.defaultValue.startsWith('{{')?'{{currentDate}}'===n.defaultValue&&(a[n.fieldId]=(new Date).toISOString().split('T')[0]):a[n.fieldId]=n.defaultValue):a[n.fieldId]||('{{currentDate}}'===n.defaultValue||n.label.includes('æ—¥æœŸ')&&!n.defaultValue)&&(a[n.fieldId]=(new Date).toISOString().split('T')[0])}s.value=a},updateField:(e,t)=>{s.value={...s.value,[e]:t}},validateForm:V,submitForm:async()=>{const t=h.value;if(!t)return{success:!1,error:'æœªé€‰æ‹©è¡¨å•'};const a=V();if(!a.valid){return{success:!1,error:Object.values(a.errors)[0]}}try{const a=(()=>{const e=new Date;return`APP${[e.getFullYear(),String(e.getMonth()+1).padStart(2,'0'),String(e.getDate()).padStart(2,'0')].join('')}${String(Math.floor(900*Math.random())+100)}`})(),n=(()=>{const e=h.value;if(!e)return'';const t=s.value,a=[];a.push(`ã€${e.formName}ã€‘`);const n=g.value;let o='<user>',l='',r='';for(const e of n){const a=t[e.fieldId];'MC.ç©å®¶.å§“å'===e.source||'ç”³è¯·äººå§“å'===e.label?a&&(o=String(a)):'MC.ç©å®¶.éƒ¨é—¨'===e.source||'æ‰€å±éƒ¨é—¨'===e.label?a&&(l=String(a)):'ç”³è¯·æ—¥æœŸ'!==e.label&&'date'!==e.inputType||a&&!r&&(r=String(a))}a.push(`ç”³è¯·äººï¼š${o}${l?`ï¼ˆ${l}ï¼‰`:''}`),r&&a.push(`æ—¥æœŸï¼š${r}`);for(const e of n){if('MC.ç©å®¶.å§“å'===e.source||'ç”³è¯·äººå§“å'===e.label)continue;if('MC.ç©å®¶.éƒ¨é—¨'===e.source||'æ‰€å±éƒ¨é—¨'===e.label)continue;if('ç”³è¯·æ—¥æœŸ'===e.label&&r)continue;if('checkbox'===e.inputType&&e.mustBeTrue)continue;const n=t[e.fieldId];if(null==n||''===n||!1===n)continue;let o;if(Array.isArray(n)){if(0===n.length)continue;o=n.map(e=>'object'==typeof e?Object.values(e).filter(e=>e).join(' '):String(e)).join('ã€')}else o='object'==typeof n?`[${n.length||0}æ¡è®°å½•]`:'boolean'==typeof n?n?'æ˜¯':'å¦':String(n);a.push(`${e.label}ï¼š${o}`)}return a.push('çŠ¶æ€ï¼šå¾…å®¡æ‰¹'),a.join(' | ')})(),o=`${t.targetPath}.${a}`;return await e.setVariable(o,n,`æäº¤${t.formName}`),s.value={},{success:!0,appId:a}}catch(e){return{success:!1,error:e instanceof Error?e.message:'æäº¤å¤±è´¥'}}},shouldShowField:e=>{if(!e.showWhen)return!0;const t=e.showWhen,a=s.value[t.field];return void 0!==t.equals?a===t.equals:void 0===t.in||t.in.includes(a)},getRosterEntries:t=>{const a=e.getVariable(t,{}),n=[],o=a.$schema,l=String(o?.primaryKey||'id'),s=String(o?.displayField||'name'),r=a.entries||a;for(const[e,t]of Object.entries(r)){if(e.startsWith('$')||!t||'object'!=typeof t)continue;const a=t;n.push({id:String(a[l]||e),name:String(a[s]||e)})}return n},quickApproveApplication:S,quickApproveAllPending:async()=>{const e=k.value.filter(e=>e.status.includes('å¾…')||e.status.includes('å®¡æ‰¹ä¸­'));if(0===e.length)return{success:!0,count:0};let t=0;for(const a of e){(await S(a.appId)).success&&t++}return{success:!0,count:t}},deleteApplication:B,deleteAllApplications:async()=>{const e=k.value;if(0===e.length)return{success:!0,count:0};let t=0;for(const a of e){(await B(a.appId)).success&&t++}return{success:!0,count:t}}}}),Tc={class:'field-label'},$c={key:0,class:'required-mark'},Rc={key:0,class:'readonly-value'},Lc=['value','placeholder','maxlength'],Pc=['value','placeholder','maxlength'],Oc={key:0,class:'char-count'},Fc=['value','min','max'],jc=['value'],Uc=['value'],zc=['value'],Wc=['value'],Hc=['value'],Gc={class:'radio-group'},Kc=['name','value','checked','onChange'],Jc={class:'radio-label'},qc={class:'checkbox-option'},Yc=['checked'],Xc={class:'checkbox-label'},Zc={class:'table-input'},Qc={class:'data-table'},ei={key:0,class:'required-mark'},ti=['value','onInput'],ai=['type','value','min','max','onInput'],ni=['value','onChange'],oi=['value'],li=['value','onInput'],si={class:'action-col'},ri=['onClick'],ci={key:10,class:'help-text'},ii={key:11,class:'error-text'},di=(0,l.defineComponent)({__name:'FormFieldRenderer',props:{field:{},value:{},error:{}},emits:['update'],setup(e,{emit:t}){const a=e,n=t,o=_c(),s=(0,l.computed)(()=>a.value),r=e=>e.columnId||e.key||e.label,c=(0,l.computed)(()=>'roster'===a.field.sourceType),i=(0,l.computed)(()=>c.value&&a.field.sourcePath?o.getRosterEntries(a.field.sourcePath):[]),d=(0,l.computed)(()=>a.field.options||[]),u=(0,l.ref)([{}]);(0,l.watch)(()=>a.value,e=>{'table'===a.field.inputType&&Array.isArray(e)&&(u.value=e.length>0?[...e]:[{}])},{immediate:!0});const m=e=>'string'==typeof e?e:e.value,p=e=>'string'==typeof e?e:e.label,v=e=>{const t=e.target;n('update',a.field.fieldId,t.value)},f=(e,t,o)=>{const l=o.target,s=[...u.value];s[e]={...s[e],[t]:l.value},u.value=s,n('update',a.field.fieldId,s)},g=()=>{u.value=[...u.value,{}],n('update',a.field.fieldId,u.value)};return(t,o)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{class:(0,l.normalizeClass)(['form-field',{'has-error':e.error}])},[(0,l.createElementVNode)('label',Tc,[(0,l.createTextVNode)((0,l.toDisplayString)(e.field.label)+' ',1),e.field.required?((0,l.openBlock)(),(0,l.createElementBlock)('span',$c,'*')):(0,l.createCommentVNode)('v-if',!0)]),(0,l.createCommentVNode)(' åªè¯»å­—æ®µ '),'readonly'===e.field.inputType?((0,l.openBlock)(),(0,l.createElementBlock)('div',Rc,(0,l.toDisplayString)(s.value||'-'),1)):'text'===e.field.inputType?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createCommentVNode)(' æ–‡æœ¬è¾“å…¥ '),(0,l.createElementVNode)('input',{type:'text',class:'text-input',value:s.value,placeholder:e.field.placeholder,maxlength:e.field.maxLength,onInput:o[0]||(o[0]=e=>v(e))},null,40,Lc)],64)):'textarea'===e.field.inputType?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:2},[(0,l.createCommentVNode)(' å¤šè¡Œæ–‡æœ¬ '),(0,l.createElementVNode)('textarea',{class:'textarea-input',value:s.value,placeholder:e.field.placeholder,maxlength:e.field.maxLength,rows:'4',onInput:o[1]||(o[1]=e=>v(e))},null,40,Pc),e.field.maxLength?((0,l.openBlock)(),(0,l.createElementBlock)('div',Oc,(0,l.toDisplayString)(s.value?.length||0)+' / '+(0,l.toDisplayString)(e.field.maxLength),1)):(0,l.createCommentVNode)('v-if',!0)],64)):'number'===e.field.inputType?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:3},[(0,l.createCommentVNode)(' æ•°å­—è¾“å…¥ '),(0,l.createElementVNode)('input',{type:'number',class:'number-input',value:s.value,min:e.field.min,max:e.field.max,onInput:o[2]||(o[2]=e=>(e=>{const t=e.target,o=t.value?Number(t.value):void 0;n('update',a.field.fieldId,o)})(e))},null,40,Fc)],64)):'date'===e.field.inputType?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:4},[(0,l.createCommentVNode)(' æ—¥æœŸé€‰æ‹© '),(0,l.createElementVNode)('input',{type:'date',class:'date-input',value:s.value,onInput:o[3]||(o[3]=e=>v(e))},null,40,jc)],64)):'datetime'===e.field.inputType?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:5},[(0,l.createCommentVNode)(' æ—¥æœŸæ—¶é—´é€‰æ‹© '),(0,l.createElementVNode)('input',{type:'datetime-local',class:'datetime-input',value:s.value,onInput:o[4]||(o[4]=e=>v(e))},null,40,Uc)],64)):'select'===e.field.inputType?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:6},[(0,l.createCommentVNode)(' ä¸‹æ‹‰é€‰æ‹© '),(0,l.createElementVNode)('select',{class:'select-input',value:s.value,onChange:o[5]||(o[5]=e=>(e=>{const t=e.target;n('update',a.field.fieldId,t.value)})(e))},[o[7]||(o[7]=(0,l.createElementVNode)('option',{value:''},'è¯·é€‰æ‹©...',-1)),c.value?((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,{key:0},(0,l.renderList)(i.value,e=>((0,l.openBlock)(),(0,l.createElementBlock)('option',{key:e.id,value:e.name},(0,l.toDisplayString)(e.name),9,Wc))),128)):((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,{key:1},(0,l.renderList)(d.value,e=>((0,l.openBlock)(),(0,l.createElementBlock)('option',{key:m(e),value:m(e)},(0,l.toDisplayString)(p(e)),9,Hc))),128))],40,zc)],64)):'radio'===e.field.inputType?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:7},[(0,l.createCommentVNode)(' å•é€‰æŒ‰é’®ç»„ '),(0,l.createElementVNode)('div',Gc,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(d.value,t=>((0,l.openBlock)(),(0,l.createElementBlock)('label',{key:m(t),class:'radio-option'},[(0,l.createElementVNode)('input',{type:'radio',name:e.field.fieldId,value:m(t),checked:s.value===m(t),onChange:e=>{return o=m(t),void n('update',a.field.fieldId,o);var o}},null,40,Kc),(0,l.createElementVNode)('span',Jc,(0,l.toDisplayString)(p(t)),1)]))),128))])],64)):'checkbox'===e.field.inputType?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:8},[(0,l.createCommentVNode)(' å¤é€‰æ¡† '),(0,l.createElementVNode)('label',qc,[(0,l.createElementVNode)('input',{type:'checkbox',checked:!0===s.value,onChange:o[6]||(o[6]=e=>(e=>{const t=e.target;n('update',a.field.fieldId,t.checked)})(e))},null,40,Yc),(0,l.createElementVNode)('span',Xc,(0,l.toDisplayString)(e.field.checkboxLabel||e.field.label),1)])],64)):'table'===e.field.inputType?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:9},[(0,l.createCommentVNode)(' è¡¨æ ¼è¾“å…¥ '),(0,l.createElementVNode)('div',Zc,[(0,l.createElementVNode)('table',Qc,[(0,l.createElementVNode)('thead',null,[(0,l.createElementVNode)('tr',null,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.field.columns,e=>((0,l.openBlock)(),(0,l.createElementBlock)('th',{key:r(e),style:(0,l.normalizeStyle)(e.width?{width:e.width}:{})},[(0,l.createTextVNode)((0,l.toDisplayString)(e.label)+' ',1),e.required?((0,l.openBlock)(),(0,l.createElementBlock)('span',ei,'*')):(0,l.createCommentVNode)('v-if',!0)],4))),128)),o[8]||(o[8]=(0,l.createElementVNode)('th',{class:'action-col'},'æ“ä½œ',-1))])]),(0,l.createElementVNode)('tbody',null,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(u.value,(t,s)=>((0,l.openBlock)(),(0,l.createElementBlock)('tr',{key:s},[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.field.columns,e=>((0,l.openBlock)(),(0,l.createElementBlock)('td',{key:r(e)},['date'===e.type?((0,l.openBlock)(),(0,l.createElementBlock)('input',{key:0,type:'date',class:'table-cell-input',value:t[r(e)],onInput:t=>f(s,r(e),t)},null,40,ti)):'text'===e.type||'number'===e.type?((0,l.openBlock)(),(0,l.createElementBlock)('input',{key:1,type:e.type,class:'table-cell-input',value:t[r(e)],min:e.min,max:e.max,onInput:t=>f(s,r(e),t)},null,40,ai)):'select'===e.type?((0,l.openBlock)(),(0,l.createElementBlock)('select',{key:2,class:'table-cell-select',value:t[r(e)],onChange:t=>((e,t,o)=>{const l=o.target,s=[...u.value];s[e]={...s[e],[t]:l.value},u.value=s,n('update',a.field.fieldId,s)})(s,r(e),t)},[o[9]||(o[9]=(0,l.createElementVNode)('option',{value:''},'-',-1)),((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.options,e=>((0,l.openBlock)(),(0,l.createElementBlock)('option',{key:e,value:e},(0,l.toDisplayString)(e),9,oi))),128))],40,ni)):((0,l.openBlock)(),(0,l.createElementBlock)('input',{key:3,type:'text',class:'table-cell-input',value:t[r(e)],onInput:t=>f(s,r(e),t)},null,40,li))]))),128)),(0,l.createElementVNode)('td',si,[u.value.length>(e.field.minRows||1)?((0,l.openBlock)(),(0,l.createElementBlock)('button',{key:0,class:'remove-row-btn',title:'åˆ é™¤è¡Œ',onClick:e=>(e=>{const t=u.value.filter((_,t)=>t!==e);u.value=t,n('update',a.field.fieldId,t)})(s)},' âœ• ',8,ri)):(0,l.createCommentVNode)('v-if',!0)])]))),128))])]),u.value.length<(e.field.maxRows||10)?((0,l.openBlock)(),(0,l.createElementBlock)('button',{key:0,class:'add-row-btn',onClick:g},' + æ·»åŠ è¡Œ ')):(0,l.createCommentVNode)('v-if',!0)])],64)):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' å¸®åŠ©æ–‡æœ¬ '),e.field.helpText?((0,l.openBlock)(),(0,l.createElementBlock)('div',ci,(0,l.toDisplayString)(e.field.helpText),1)):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' é”™è¯¯ä¿¡æ¯ '),e.error?((0,l.openBlock)(),(0,l.createElementBlock)('div',ii,(0,l.toDisplayString)(e.error),1)):(0,l.createCommentVNode)('v-if',!0)],2))}}),ui=(0,B.A)(di,[['__scopeId','data-v-7a3b8962']]),mi={class:'dialog-header'},pi={class:'dialog-icon'},vi={class:'dialog-title'},fi={class:'dialog-body'},gi={class:'dialog-message'},hi={class:'dialog-footer'},yi=['disabled'],Vi=['disabled'],Ni={key:0,class:'loading-spinner'},Ei=(0,l.defineComponent)({__name:'ConfirmDialog',setup(e){const{state:t,handleConfirm:a,handleCancel:n}=ds(),o=()=>{t.showCancel&&!t.isProcessing&&n()};return(e,s)=>((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,null,[(0,l.createCommentVNode)(' ç§»é™¤ Teleportï¼Œç›´æ¥åœ¨å½“å‰å®¹å™¨ä¸­æ¸²æŸ“ï¼Œä»¥æ”¯æŒå…¨å±æ¨¡å¼ '),(0,l.createVNode)(l.Transition,{name:'confirm-dialog'},{default:(0,l.withCtx)(()=>[(0,l.unref)(t).visible?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'confirm-dialog-overlay',onClick:(0,l.withModifiers)(o,['self'])},[(0,l.createElementVNode)('div',{class:(0,l.normalizeClass)(['confirm-dialog',[`type-${(0,l.unref)(t).type}`]]),role:'dialog','aria-modal':'true'},[(0,l.createCommentVNode)(' å¯¹è¯æ¡†å¤´éƒ¨ '),(0,l.createElementVNode)('div',mi,[(0,l.createElementVNode)('span',pi,(0,l.toDisplayString)((0,l.unref)(t).icon),1),(0,l.createElementVNode)('h3',vi,(0,l.toDisplayString)((0,l.unref)(t).title),1)]),(0,l.createCommentVNode)(' å¯¹è¯æ¡†å†…å®¹ '),(0,l.createElementVNode)('div',fi,[(0,l.createElementVNode)('p',gi,(0,l.toDisplayString)((0,l.unref)(t).message),1)]),(0,l.createCommentVNode)(' å¯¹è¯æ¡†åº•éƒ¨æŒ‰é’® '),(0,l.createElementVNode)('div',hi,[(0,l.unref)(t).showCancel?((0,l.openBlock)(),(0,l.createElementBlock)('button',{key:0,class:'btn btn-cancel',disabled:(0,l.unref)(t).isProcessing,onClick:s[0]||(s[0]=(...e)=>(0,l.unref)(n)&&(0,l.unref)(n)(...e))},(0,l.toDisplayString)((0,l.unref)(t).cancelText),9,yi)):(0,l.createCommentVNode)('v-if',!0),(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['btn btn-confirm',[`btn-${(0,l.unref)(t).type}`]]),disabled:(0,l.unref)(t).isProcessing,onClick:s[1]||(s[1]=(...e)=>(0,l.unref)(a)&&(0,l.unref)(a)(...e))},[(0,l.unref)(t).isProcessing?((0,l.openBlock)(),(0,l.createElementBlock)('span',Ni)):(0,l.createCommentVNode)('v-if',!0),(0,l.createElementVNode)('span',null,(0,l.toDisplayString)((0,l.unref)(t).confirmText),1)],10,Vi)])],2)])):(0,l.createCommentVNode)('v-if',!0)]),_:1})],2112))}}),ki=(0,B.A)(Ei,[['__scopeId','data-v-6545ddc8']]),bi={class:'records-viewer'},Ci={class:'viewer-header'},wi={class:'header-left'},Si={class:'record-count'},Bi={class:'header-right'},Ii=['disabled'],Mi={class:'pending-badge'},Ai=['disabled'],Di={class:'filter-bar'},xi={class:'filter-item'},_i={class:'filter-item search-item'},Ti={class:'records-list'},$i=['onClick'],Ri={class:'card-header'},Li={class:'card-title'},Pi={class:'app-id'},Oi={class:'form-type'},Fi={class:'card-status'},ji={class:'card-summary'},Ui={class:'summary-row'},zi={class:'summary-value'},Wi={key:0,class:'summary-dept'},Hi={class:'summary-row'},Gi={class:'summary-value'},Ki={key:0,class:'card-details'},Ji={class:'detail-label'},qi={class:'detail-value'},Yi={class:'detail-row full-summary'},Xi={class:'detail-value'},Zi={class:'card-actions'},Qi=['disabled','onClick'],ed=['disabled','onClick'],td={class:'expand-indicator'},ad={class:'empty-state'},nd={key:0},od={key:1},ld={class:'toast-icon'},sd={class:'toast-text'},rd=(0,l.defineComponent)({__name:'ApplicationRecordsViewer',props:{records:{}},emits:['close'],setup(e){const t=e,a=_c(),{confirm:n}=ds(),o=(0,l.ref)(''),s=(0,l.ref)(''),r=(0,l.ref)(null),c=(0,l.ref)(!1),i=(0,l.ref)(null),d=(0,l.computed)(()=>t.records.filter(e=>u(e.status)).length),u=e=>e.includes('å¾…')||e.includes('å®¡æ‰¹ä¸­'),m=(e,t)=>{i.value={type:e,text:t},setTimeout(()=>{i.value=null},3e3)},p=async()=>{if(c.value)return;const e=d.value;if(0===e)return;if(await n({title:'æ‰¹é‡å¿«é€Ÿé€šè¿‡',message:`ç¡®å®šè¦å°† ${e} æ¡å¾…å®¡æ‰¹çš„ç”³è¯·å…¨éƒ¨å¿«é€Ÿé€šè¿‡å—ï¼Ÿ\n\næ­¤æ“ä½œå°†è·³è¿‡æ­£å¸¸å®¡æ‰¹æµç¨‹ï¼Œç›´æ¥å°†æ‰€æœ‰å¾…å®¡æ‰¹ç”³è¯·æ ‡è®°ä¸º"å·²æ‰¹å‡†"ã€‚`,type:'warning',icon:'âš¡',confirmText:'å…¨éƒ¨é€šè¿‡',cancelText:'å–æ¶ˆ'})){c.value=!0;try{const e=await a.quickApproveAllPending();e.success?m('success',`å·²æˆåŠŸé€šè¿‡ ${e.count} æ¡ç”³è¯·`):m('error',`æ“ä½œå¤±è´¥: ${e.error}`)}finally{c.value=!1}}},v=async()=>{if(c.value)return;const e=t.records.length;if(0===e)return;if(await n({title:'æ¸…ç©ºæ‰€æœ‰è®°å½•',message:`ç¡®å®šè¦åˆ é™¤å…¨éƒ¨ ${e} æ¡ç”³è¯·è®°å½•å—ï¼Ÿ\n\nâš ï¸ æ­¤æ“ä½œä¸å¯æ’¤é”€ï¼Œæ‰€æœ‰è®°å½•å°†è¢«æ°¸ä¹…åˆ é™¤ï¼`,type:'danger',icon:'ğŸ—‘ï¸',confirmText:'å…¨éƒ¨åˆ é™¤',cancelText:'å–æ¶ˆ'})){c.value=!0;try{const e=await a.deleteAllApplications();e.success?(m('success',`å·²åˆ é™¤ ${e.count} æ¡ç”³è¯·è®°å½•`),r.value=null):m('error',`æ“ä½œå¤±è´¥: ${e.error}`)}finally{c.value=!1}}},f=(0,l.computed)(()=>{let e=t.records;if(o.value&&(e=e.filter(e=>e.status.includes(o.value))),s.value.trim()){const t=s.value.toLowerCase();e=e.filter(e=>e.appId.toLowerCase().includes(t)||e.summary.toLowerCase().includes(t)||e.applicant.toLowerCase().includes(t))}return e}),g=e=>e.includes('å·²æ‰¹å‡†')||e.includes('å·²é€šè¿‡')?'status-approved':e.includes('å·²æ‹’ç»')||e.includes('å·²é©³å›')?'status-rejected':e.includes('å®¡æ‰¹ä¸­')||e.includes('å¾…')?'status-pending':'status-default';return(t,h)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',bi,[(0,l.createCommentVNode)(' å¤´éƒ¨ '),(0,l.createElementVNode)('div',Ci,[(0,l.createElementVNode)('div',wi,[h[3]||(h[3]=(0,l.createElementVNode)('span',{class:'viewer-icon'},'ğŸ“‹',-1)),h[4]||(h[4]=(0,l.createElementVNode)('h3',null,'ç”³è¯·è®°å½•',-1)),(0,l.createElementVNode)('span',Si,(0,l.toDisplayString)(e.records.length)+' æ¡',1)]),(0,l.createElementVNode)('div',Bi,[(0,l.createCommentVNode)(' æ‰¹é‡å¿«é€Ÿé€šè¿‡æŒ‰é’® '),d.value>0?((0,l.openBlock)(),(0,l.createElementBlock)('button',{key:0,class:'quick-approve-all-btn',disabled:c.value,title:'å°†æ‰€æœ‰å¾…å®¡æ‰¹çš„ç”³è¯·å¿«é€Ÿé€šè¿‡',onClick:(0,l.withModifiers)(p,['stop'])},[h[5]||(h[5]=(0,l.createElementVNode)('span',{class:'btn-icon'},'âš¡',-1)),h[6]||(h[6]=(0,l.createElementVNode)('span',{class:'btn-text'},'å…¨éƒ¨é€šè¿‡',-1)),(0,l.createElementVNode)('span',Mi,(0,l.toDisplayString)(d.value),1)],8,Ii)):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' æ‰¹é‡åˆ é™¤æŒ‰é’® '),e.records.length>0?((0,l.openBlock)(),(0,l.createElementBlock)('button',{key:1,class:'delete-all-btn',disabled:c.value,title:'åˆ é™¤æ‰€æœ‰ç”³è¯·è®°å½•',onClick:(0,l.withModifiers)(v,['stop'])},[...h[7]||(h[7]=[(0,l.createElementVNode)('span',{class:'btn-icon'},'ğŸ—‘ï¸',-1),(0,l.createElementVNode)('span',{class:'btn-text'},'æ¸…ç©ºè®°å½•',-1)])],8,Ai)):(0,l.createCommentVNode)('v-if',!0),(0,l.createElementVNode)('button',{class:'close-btn',title:'å…³é—­',onClick:h[0]||(h[0]=e=>t.$emit('close'))},'âœ•')])]),(0,l.createCommentVNode)(' ç­›é€‰æ  '),(0,l.createElementVNode)('div',Di,[(0,l.createElementVNode)('div',xi,[h[9]||(h[9]=(0,l.createElementVNode)('label',null,'çŠ¶æ€ç­›é€‰ï¼š',-1)),(0,l.withDirectives)((0,l.createElementVNode)('select',{'onUpdate:modelValue':h[1]||(h[1]=e=>o.value=e),class:'filter-select'},[...h[8]||(h[8]=[(0,l.createStaticVNode)('<option value="" data-v-57f14fb3>å…¨éƒ¨</option><option value="å¾…å®¡æ‰¹" data-v-57f14fb3>å¾…å®¡æ‰¹</option><option value="å®¡æ‰¹ä¸­" data-v-57f14fb3>å®¡æ‰¹ä¸­</option><option value="å·²æ‰¹å‡†" data-v-57f14fb3>å·²æ‰¹å‡†</option><option value="å·²æ‹’ç»" data-v-57f14fb3>å·²æ‹’ç»</option>',5)])],512),[[l.vModelSelect,o.value]])]),(0,l.createElementVNode)('div',_i,[(0,l.withDirectives)((0,l.createElementVNode)('input',{'onUpdate:modelValue':h[2]||(h[2]=e=>s.value=e),type:'text',class:'search-input',placeholder:'æœç´¢ç”³è¯·ç¼–å·æˆ–å†…å®¹...'},null,512),[[l.vModelText,s.value]]),h[10]||(h[10]=(0,l.createElementVNode)('span',{class:'search-icon'},'ğŸ”',-1))])]),(0,l.createCommentVNode)(' è®°å½•åˆ—è¡¨ '),(0,l.createElementVNode)('div',Ti,[f.value.length>0?((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,{key:0},(0,l.renderList)(f.value,e=>{return(0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.appId,class:(0,l.normalizeClass)(['record-card',g(e.status)]),onClick:t=>{return a=e.appId,void(r.value=r.value===a?null:a);var a}},[(0,l.createCommentVNode)(' å¡ç‰‡å¤´éƒ¨ '),(0,l.createElementVNode)('div',Ri,[(0,l.createElementVNode)('div',Li,[(0,l.createElementVNode)('span',Pi,(0,l.toDisplayString)(e.appId),1),(0,l.createElementVNode)('span',Oi,(0,l.toDisplayString)(e.formType),1)]),(0,l.createElementVNode)('div',Fi,[(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(['status-badge',g(e.status)])},(0,l.toDisplayString)((t=e.status,t.includes('å·²æ‰¹å‡†')||t.includes('å·²é€šè¿‡')?'âœ“ å·²æ‰¹å‡†':t.includes('å·²æ‹’ç»')||t.includes('å·²é©³å›')?'âœ— å·²æ‹’ç»':t.includes('å®¡æ‰¹ä¸­')?'â³ å®¡æ‰¹ä¸­':t.includes('å¾…')?'â³ å¾…å®¡æ‰¹':t)),3)])]),(0,l.createCommentVNode)(' å¡ç‰‡æ‘˜è¦ '),(0,l.createElementVNode)('div',ji,[(0,l.createElementVNode)('div',Ui,[h[11]||(h[11]=(0,l.createElementVNode)('span',{class:'summary-label'},'ç”³è¯·äººï¼š',-1)),(0,l.createElementVNode)('span',zi,(0,l.toDisplayString)(e.applicant),1),e.details['éƒ¨é—¨']?((0,l.openBlock)(),(0,l.createElementBlock)('span',Wi,'ï¼ˆ'+(0,l.toDisplayString)(e.details['éƒ¨é—¨'])+'ï¼‰',1)):(0,l.createCommentVNode)('v-if',!0)]),(0,l.createElementVNode)('div',Hi,[h[12]||(h[12]=(0,l.createElementVNode)('span',{class:'summary-label'},'æ—¥æœŸï¼š',-1)),(0,l.createElementVNode)('span',Gi,(0,l.toDisplayString)(e.date),1)])]),(0,l.createCommentVNode)(' å±•å¼€è¯¦æƒ… '),r.value===e.appId?((0,l.openBlock)(),(0,l.createElementBlock)('div',Ki,[h[16]||(h[16]=(0,l.createElementVNode)('div',{class:'details-divider'},null,-1)),((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.details,(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:t,class:'detail-row'},[(0,l.createElementVNode)('span',Ji,(0,l.toDisplayString)(t)+'ï¼š',1),(0,l.createElementVNode)('span',qi,(0,l.toDisplayString)(e),1)]))),128)),(0,l.createElementVNode)('div',Yi,[h[13]||(h[13]=(0,l.createElementVNode)('span',{class:'detail-label'},'å®Œæ•´æ‘˜è¦ï¼š',-1)),(0,l.createElementVNode)('span',Xi,(0,l.toDisplayString)(e.summary),1)]),(0,l.createCommentVNode)(' æ“ä½œæŒ‰é’® '),(0,l.createElementVNode)('div',Zi,[(0,l.createCommentVNode)(' å¿«é€Ÿé€šè¿‡æŒ‰é’®ï¼ˆä»…å¯¹å¾…å®¡æ‰¹/å®¡æ‰¹ä¸­çš„è®°å½•æ˜¾ç¤ºï¼‰ '),u(e.status)?((0,l.openBlock)(),(0,l.createElementBlock)('button',{key:0,class:'quick-approve-btn',disabled:c.value,onClick:(0,l.withModifiers)(t=>(async e=>{if(!c.value){c.value=!0;try{const t=await a.quickApproveApplication(e);t.success?m('success','ç”³è¯·å·²å¿«é€Ÿé€šè¿‡'):(console.error('å¿«é€Ÿé€šè¿‡å¤±è´¥:',t.error),m('error',`å¿«é€Ÿé€šè¿‡å¤±è´¥: ${t.error}`))}finally{c.value=!1}}})(e.appId),['stop'])},[h[14]||(h[14]=(0,l.createElementVNode)('span',{class:'btn-icon'},'âš¡',-1)),(0,l.createElementVNode)('span',null,(0,l.toDisplayString)(c.value?'å¤„ç†ä¸­...':'å¿«é€Ÿé€šè¿‡'),1)],8,Qi)):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' åˆ é™¤æŒ‰é’® '),(0,l.createElementVNode)('button',{class:'delete-btn',disabled:c.value,onClick:(0,l.withModifiers)(t=>(async e=>{if(c.value)return;if(await n({title:'åˆ é™¤ç”³è¯·è®°å½•',message:`ç¡®å®šè¦åˆ é™¤ç”³è¯·è®°å½• "${e}" å—ï¼Ÿ\n\næ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚`,type:'danger',icon:'ğŸ—‘ï¸',confirmText:'ç¡®è®¤åˆ é™¤',cancelText:'å–æ¶ˆ'})){c.value=!0;try{const t=await a.deleteApplication(e);t.success?(m('success','ç”³è¯·è®°å½•å·²åˆ é™¤'),r.value===e&&(r.value=null)):(console.error('åˆ é™¤å¤±è´¥:',t.error),m('error',`åˆ é™¤å¤±è´¥: ${t.error}`))}finally{c.value=!1}}})(e.appId),['stop'])},[h[15]||(h[15]=(0,l.createElementVNode)('span',{class:'btn-icon'},'ğŸ—‘ï¸',-1)),(0,l.createElementVNode)('span',null,(0,l.toDisplayString)(c.value?'å¤„ç†ä¸­...':'åˆ é™¤'),1)],8,ed)])])):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' å±•å¼€æŒ‡ç¤ºå™¨ '),(0,l.createElementVNode)('div',td,[(0,l.createElementVNode)('span',null,(0,l.toDisplayString)(r.value===e.appId?'â–² æ”¶èµ·':'â–¼ å±•å¼€è¯¦æƒ…'),1)])],10,$i);var t}),128)):((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createCommentVNode)(' ç©ºçŠ¶æ€ '),(0,l.createElementVNode)('div',ad,[h[17]||(h[17]=(0,l.createElementVNode)('div',{class:'empty-icon'},'ğŸ“­',-1)),0===e.records.length?((0,l.openBlock)(),(0,l.createElementBlock)('p',nd,'æš‚æ— ç”³è¯·è®°å½•')):((0,l.openBlock)(),(0,l.createElementBlock)('p',od,'æ²¡æœ‰ç¬¦åˆç­›é€‰æ¡ä»¶çš„è®°å½•'))])],2112))]),(0,l.createCommentVNode)(' æ“ä½œç»“æœæç¤º '),(0,l.createVNode)(l.Transition,{name:'result-toast'},{default:(0,l.withCtx)(()=>[i.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:(0,l.normalizeClass)(['result-toast',i.value.type])},[(0,l.createElementVNode)('span',ld,(0,l.toDisplayString)('success'===i.value.type?'âœ…':'âŒ'),1),(0,l.createElementVNode)('span',sd,(0,l.toDisplayString)(i.value.text),1)],2)):(0,l.createCommentVNode)('v-if',!0)]),_:1}),(0,l.createCommentVNode)(' ç¡®è®¤å¯¹è¯æ¡† '),(0,l.createVNode)(ki)]))}}),cd=(0,B.A)(rd,[['__scopeId','data-v-57f14fb3']]),id={class:'panel-header'},dd={class:'header-center'},ud={class:'view-toggle'},md={key:0,class:'record-badge'},pd={class:'header-right'},vd={class:'form-count'},fd={class:'panel-main'},gd={class:'sidebar-header'},hd={key:0,class:'sidebar-title'},yd=['title'],Vd={key:0,class:'form-list'},Nd=['onClick'],Ed={class:'form-info'},kd={class:'form-title'},bd={key:0,class:'form-desc'},Cd={key:1,class:'sidebar-empty'},wd={key:2,class:'collapsed-list'},Sd=['title','onClick'],Bd={class:'panel-body'},Id={key:0,class:'state-container loading-state'},Md={class:'state-container error-state'},Ad={class:'form-header'},Dd={class:'form-header-top'},xd={class:'form-title-section'},_d={class:'form-title'},Td={key:0,class:'form-description'},$d={class:'form-header-actions'},Rd=['disabled'],Ld={key:0,class:'workflow-hint'},Pd={key:0,class:'workflow-arrow'},Od={class:'form-fields'},Fd={class:'form-actions'},jd=['disabled'],Ud=['disabled'],zd={key:1,class:'submit-success'},Wd=(0,l.defineComponent)({__name:'FormPanel',emits:['close'],setup(e){const t=_c(),{isLoading:n,error:o,formData:s}=a(t),r=(0,l.computed)(()=>t.availableForms),c=(0,l.computed)(()=>t.formCount),i=(0,l.computed)(()=>t.hasNoForms),d=(0,l.computed)(()=>t.effectiveFormId),u=(0,l.computed)(()=>t.currentForm),m=(0,l.computed)(()=>t.currentFields),p=(0,l.computed)(()=>t.currentFormMeta),v=(0,l.computed)(()=>t.getCurrentFormApplications),f=(0,l.computed)(()=>t.applicationCount),{initialize:g,refresh:h,selectForm:y,updateField:V,validateForm:N,submitForm:E,shouldShowField:k,initializeFormData:b,autoFillFormData:C}=t,w=(0,l.ref)('form'),S=(0,l.ref)(!1),B=(0,l.ref)({}),I=(0,l.ref)(!1),M=(0,l.ref)(!1),A=(0,l.ref)(''),D=()=>{S.value=!S.value},x=(e,t=30)=>e.length>t?e.slice(0,t)+'...':e,T=e=>d.value===e,R=async e=>{console.log('[FormPanel] handleSelectForm è¢«è°ƒç”¨:',e),await y(e),console.log('[FormPanel] selectForm å®Œæˆ'),B.value={},M.value=!1},L=(e,t)=>{if(V(e,t),B.value[e]){const t={...B.value};delete t[e],B.value=t}},P=()=>{C(),B.value={}},O=()=>{b(),B.value={},M.value=!1},F=async()=>{I.value=!0,M.value=!1;const e=N();if(!e.valid)return B.value=e.errors,void(I.value=!1);const t=await E();I.value=!1,t.success?(M.value=!0,A.value=t.appId||'',B.value={},setTimeout(()=>{M.value=!1},5e3)):t.error&&(B.value={_global:t.error})};return(0,l.watch)(d,(e,t)=>{console.log('[FormPanel] effectiveFormId å˜åŒ–:',t,'->',e),e&&b()}),(0,l.watch)(u,(e,t)=>{console.log('[FormPanel] currentForm å˜åŒ–:',t?.meta?.formName,'->',e?.meta?.formName)}),(0,l.watch)(m,e=>{console.log('[FormPanel] currentFields å˜åŒ–, å­—æ®µæ•°:',e.length)},{deep:!0}),(0,l.watch)(p,(e,t)=>{console.log('[FormPanel] currentFormMeta å˜åŒ–:',t?.formName,'->',e?.formName)}),(0,l.onMounted)(()=>{g()}),(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{class:(0,l.normalizeClass)(['form-panel',{'sidebar-collapsed':S.value}])},[(0,l.createCommentVNode)(' é¡¶éƒ¨å¤´æ  '),(0,l.createElementVNode)('div',id,[t[8]||(t[8]=(0,l.createElementVNode)('div',{class:'header-left'},[(0,l.createElementVNode)('span',{class:'panel-icon'},'ğŸ“'),(0,l.createElementVNode)('h2',null,'è¡¨å•ç”³è¯·')],-1)),(0,l.createElementVNode)('div',dd,[(0,l.createCommentVNode)(' è§†å›¾åˆ‡æ¢æŒ‰é’® '),(0,l.createElementVNode)('div',ud,[(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['toggle-btn',{active:'form'===w.value}]),onClick:t[0]||(t[0]=e=>w.value='form')},[...t[5]||(t[5]=[(0,l.createElementVNode)('span',{class:'btn-icon'},'ğŸ“',-1),(0,l.createElementVNode)('span',{class:'btn-text'},'å¡«å†™ç”³è¯·',-1)])],2),(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['toggle-btn',{active:'records'===w.value}]),onClick:t[1]||(t[1]=e=>w.value='records')},[t[6]||(t[6]=(0,l.createElementVNode)('span',{class:'btn-icon'},'ğŸ“‹',-1)),t[7]||(t[7]=(0,l.createElementVNode)('span',{class:'btn-text'},'ç”³è¯·è®°å½•',-1)),f.value>0?((0,l.openBlock)(),(0,l.createElementBlock)('span',md,(0,l.toDisplayString)(f.value),1)):(0,l.createCommentVNode)('v-if',!0)],2)])]),(0,l.createElementVNode)('div',pd,[(0,l.createElementVNode)('span',vd,(0,l.toDisplayString)(c.value)+' ç§è¡¨å•',1),(0,l.createElementVNode)('button',{class:'close-btn',title:'å…³é—­',onClick:t[2]||(t[2]=t=>e.$emit('close'))},'âœ•')])]),(0,l.createElementVNode)('div',fd,[(0,l.createCommentVNode)(' å·¦ä¾§è¡¨å•åˆ—è¡¨ä¾§æ  '),(0,l.createElementVNode)('aside',{class:(0,l.normalizeClass)(['form-sidebar',{collapsed:S.value}])},[(0,l.createElementVNode)('div',gd,[S.value?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('span',hd,'è¡¨å•åˆ—è¡¨')),(0,l.createElementVNode)('button',{class:'toggle-btn',title:S.value?'å±•å¼€ä¾§æ ':'æ”¶èµ·ä¾§æ ',onClick:D},(0,l.toDisplayString)(S.value?'â–¶':'â—€'),9,yd)]),!S.value&&c.value>0?((0,l.openBlock)(),(0,l.createElementBlock)('div',Vd,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(r.value,e=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.formId,class:(0,l.normalizeClass)(['form-item',{active:T(e.formId)}]),onClick:t=>R(e.formId)},[t[9]||(t[9]=(0,l.createElementVNode)('span',{class:'form-icon'},'ğŸ“‹',-1)),(0,l.createElementVNode)('div',Ed,[(0,l.createElementVNode)('span',kd,(0,l.toDisplayString)(e.formName),1),e.description?((0,l.openBlock)(),(0,l.createElementBlock)('span',bd,(0,l.toDisplayString)(x(e.description)),1)):(0,l.createCommentVNode)('v-if',!0)])],10,Nd))),128))])):(0,l.createCommentVNode)('v-if',!0),S.value||0!==c.value?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('div',Cd,[...t[10]||(t[10]=[(0,l.createElementVNode)('span',null,'æš‚æ— è¡¨å•',-1)])])),(0,l.createCommentVNode)(' æ”¶ç¼©çŠ¶æ€ä¸‹çš„å›¾æ ‡åˆ—è¡¨ '),S.value&&c.value>0?((0,l.openBlock)(),(0,l.createElementBlock)('div',wd,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(r.value,e=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.formId,class:(0,l.normalizeClass)(['collapsed-item',{active:T(e.formId)}]),title:e.formName,onClick:t=>R(e.formId)},' ğŸ“‹ ',10,Sd))),128))])):(0,l.createCommentVNode)('v-if',!0)],2),(0,l.createCommentVNode)(' å³ä¾§å†…å®¹åŒº '),(0,l.createElementVNode)('div',Bd,[(0,l.createCommentVNode)(' è¡¨å•å¡«å†™è§†å›¾ '),'form'===w.value?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:0},[(0,l.createCommentVNode)(' åŠ è½½çŠ¶æ€ '),(0,l.unref)(n)?((0,l.openBlock)(),(0,l.createElementBlock)('div',Id,[...t[11]||(t[11]=[(0,l.createElementVNode)('div',{class:'state-icon'},'â³',-1),(0,l.createElementVNode)('p',null,'åŠ è½½ä¸­...',-1)])])):(0,l.unref)(o)?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createCommentVNode)(' é”™è¯¯çŠ¶æ€ '),(0,l.createElementVNode)('div',Md,[t[12]||(t[12]=(0,l.createElementVNode)('div',{class:'state-icon'},'âš ï¸',-1)),(0,l.createElementVNode)('p',null,(0,l.toDisplayString)((0,l.unref)(o)),1),(0,l.createElementVNode)('button',{class:'retry-btn',onClick:t[3]||(t[3]=(...e)=>(0,l.unref)(h)&&(0,l.unref)(h)(...e))},'é‡è¯•')])],2112)):i.value?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:2},[(0,l.createCommentVNode)(' æ— è¡¨å•çŠ¶æ€ '),t[13]||(t[13]=(0,l.createElementVNode)('div',{class:'state-container empty-state'},[(0,l.createElementVNode)('div',{class:'state-icon'},'ğŸ“­'),(0,l.createElementVNode)('p',null,'æš‚æ— å¯ç”¨è¡¨å•'),(0,l.createElementVNode)('p',{class:'empty-hint'},[(0,l.createTextVNode)('è¡¨å•å®šä¹‰ä» '),(0,l.createElementVNode)('code',null,'MC.æ–‡æ¡£'),(0,l.createTextVNode)(' ä¸­çš„è§„ç« åˆ¶åº¦è§£æ')]),(0,l.createElementVNode)('p',{class:'empty-hint'},[(0,l.createTextVNode)('åœ¨è§„ç« åˆ¶åº¦ä¸­æ·»åŠ  '),(0,l.createElementVNode)('code',null,'$formMeta'),(0,l.createTextVNode)(' å’Œ '),(0,l.createElementVNode)('code',null,'$fieldDef'),(0,l.createTextVNode)(' å³å¯åˆ›å»ºè¡¨å•')])],-1))],2112)):u.value?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:3},[(0,l.createCommentVNode)(' è¡¨å•å†…å®¹ '),((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:d.value,class:'form-content'},[(0,l.createCommentVNode)(' è¡¨å•æ ‡é¢˜ '),(0,l.createElementVNode)('div',Ad,[(0,l.createElementVNode)('div',Dd,[(0,l.createElementVNode)('div',xd,[(0,l.createElementVNode)('h3',_d,(0,l.toDisplayString)(p.value?.formName),1),p.value?.description?((0,l.openBlock)(),(0,l.createElementBlock)('span',Td,(0,l.toDisplayString)(p.value.description),1)):(0,l.createCommentVNode)('v-if',!0)]),(0,l.createElementVNode)('div',$d,[(0,l.createElementVNode)('button',{class:'auto-fill-btn',disabled:I.value,title:'ä»å˜é‡ç³»ç»Ÿè‡ªåŠ¨å¡«å†™ç”³è¯·äººã€éƒ¨é—¨ã€æ—¥æœŸç­‰å›ºå®šä¿¡æ¯',onClick:P},[...t[14]||(t[14]=[(0,l.createElementVNode)('span',{class:'btn-icon'},'âœ¨',-1),(0,l.createElementVNode)('span',{class:'btn-text'},'è‡ªåŠ¨å¡«å†™',-1)])],8,Rd)])])]),(0,l.createCommentVNode)(' å·¥ä½œæµæç¤º '),p.value?.workflow?((0,l.openBlock)(),(0,l.createElementBlock)('div',Ld,[t[15]||(t[15]=(0,l.createElementVNode)('span',{class:'workflow-label'},'å®¡æ‰¹æµç¨‹ï¼š',-1)),((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(p.value.workflow,(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('span',{key:e.step,class:'workflow-step'},[(0,l.createTextVNode)((0,l.toDisplayString)(e.name)+' ',1),t<p.value.workflow.length-1?((0,l.openBlock)(),(0,l.createElementBlock)('span',Pd,'â†’')):(0,l.createCommentVNode)('v-if',!0)]))),128))])):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' è¡¨å•å­—æ®µ '),(0,l.createElementVNode)('div',Od,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(m.value,e=>((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:e.fieldId},[(0,l.unref)(k)(e)?((0,l.openBlock)(),(0,l.createBlock)(ui,{key:0,field:e,value:(0,l.unref)(s)[e.fieldId],error:B.value[e.fieldId],onUpdate:L},null,8,['field','value','error'])):(0,l.createCommentVNode)('v-if',!0)],64))),128))]),(0,l.createCommentVNode)(' æäº¤æŒ‰é’® '),(0,l.createElementVNode)('div',Fd,[(0,l.createElementVNode)('button',{class:'reset-btn',disabled:I.value,onClick:O},'é‡ç½®',8,jd),(0,l.createElementVNode)('button',{class:'submit-btn',disabled:I.value,onClick:F},(0,l.toDisplayString)(I.value?'æäº¤ä¸­...':'æäº¤ç”³è¯·'),9,Ud)]),(0,l.createCommentVNode)(' æäº¤æˆåŠŸæç¤º '),M.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',zd,[t[16]||(t[16]=(0,l.createElementVNode)('span',{class:'success-icon'},'âœ…',-1)),(0,l.createElementVNode)('span',null,'ç”³è¯·å·²æäº¤ï¼Œç¼–å·ï¼š'+(0,l.toDisplayString)(A.value),1)])):(0,l.createCommentVNode)('v-if',!0)]))],2112)):(0,l.createCommentVNode)('v-if',!0)],64)):'records'===w.value?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createCommentVNode)(' ç”³è¯·è®°å½•è§†å›¾ '),(0,l.createVNode)(cd,{records:v.value,onClose:t[4]||(t[4]=e=>w.value='form')},null,8,['records'])],64)):(0,l.createCommentVNode)('v-if',!0)])])],2))}}),Hd=(0,B.A)(Wd,[['__scopeId','data-v-27cdd179']]),Gd={HISTORY_TEXT:'å†å²æ­£æ–‡',HISTORY_RECORD:'å†å²è®°å½•',SEGMENTED_TEXT:'åˆ†æ®µæ­£æ–‡',SMALL_SUMMARY:'å°æ€»ç»“',LARGE_SUMMARY:'å¤§æ€»ç»“'},Kd={segmentCount:3,smallSummaryCount:25},Jd={[Gd.HISTORY_TEXT]:{name:Gd.HISTORY_TEXT,enabled:!1,depth:2,order:100,role:'system'},[Gd.HISTORY_RECORD]:{name:Gd.HISTORY_RECORD,enabled:!1,depth:2,order:99,role:'system'},[Gd.SEGMENTED_TEXT]:{name:Gd.SEGMENTED_TEXT,enabled:!0,depth:2,order:100,role:'system'},[Gd.SMALL_SUMMARY]:{name:Gd.SMALL_SUMMARY,enabled:!0,depth:4,order:90,role:'system'},[Gd.LARGE_SUMMARY]:{name:Gd.LARGE_SUMMARY,enabled:!0,depth:6,order:80,role:'system'}},qd='\nâ€”â€”â€”â€”â€”â€”\n',Yd='\n\n---\n\n';class Xd{static extractHistoryRecordTag(e){if(!e||'string'!=typeof e)return null;const t=[...e.matchAll(/<å†å²è®°å½•>([\s\S]*?)<\/å†å²è®°å½•>/gi)];return t.length>0?t[t.length-1][1].trim():null}static extractGameTextTag(e){if(!e||'string'!=typeof e)return null;const t=[...e.matchAll(/<gametxt>([\s\S]*?)<\/gametxt>/gi)];if(t.length>0){return t[t.length-1][1].trim().replace(/<!--[\s\S]*?-->/g,'').trim()}return null}static KNOWN_FIELDS=['åºå·','æ—¥æœŸ','åœ°ç‚¹','æè¿°','æ ‡ç­¾','é‡è¦ä¿¡æ¯','è‡ªåŠ¨åŒ–ç³»ç»Ÿ'];static isFieldLine(e){const t=e.indexOf('|');if(-1===t)return null;const a=e.substring(0,t).trim();return this.KNOWN_FIELDS.includes(a)?a:null}static parseRecord(e){if(!e||'string'!=typeof e)return null;const t={_raw:e},a=e.split('\n');let n=null,o=[];const l=()=>{if(n&&o.length>0){const e=o.join('\n').trim();this.setFieldValue(t,n,e)}n=null,o=[]};for(const e of a){const t=e.trim(),a=this.isFieldLine(t);if(a){l(),n=a;const e=t.indexOf('|'),s=t.substring(e+1).trim();s&&o.push(s)}else n&&t&&o.push(t)}return l(),'number'!=typeof t.åºå·||isNaN(t.åºå·)?(console.warn('[HistoryRecordParser] è§£æå¤±è´¥ï¼šç¼ºå°‘æœ‰æ•ˆçš„åºå·å­—æ®µ'),null):{åºå·:t.åºå·,æ—¥æœŸ:t.æ—¥æœŸ||'',åœ°ç‚¹:t.åœ°ç‚¹||'',æè¿°:t.æè¿°||'',æ ‡ç­¾:t.æ ‡ç­¾||[],é‡è¦ä¿¡æ¯:t.é‡è¦ä¿¡æ¯||'',è‡ªåŠ¨åŒ–ç³»ç»Ÿ:t.è‡ªåŠ¨åŒ–ç³»ç»Ÿ||'',_raw:t._raw}}static setFieldValue(e,t,a){switch(t){case'åºå·':e.åºå·=parseInt(a,10);break;case'æ—¥æœŸ':e.æ—¥æœŸ=a;break;case'åœ°ç‚¹':e.åœ°ç‚¹=a;break;case'æè¿°':e.æè¿°=a;break;case'æ ‡ç­¾':e.æ ‡ç­¾=a.split('|').map(e=>e.trim()).filter(e=>e);break;case'é‡è¦ä¿¡æ¯':e.é‡è¦ä¿¡æ¯=a;break;case'è‡ªåŠ¨åŒ–ç³»ç»Ÿ':e.è‡ªåŠ¨åŒ–ç³»ç»Ÿ=a}}static parseRecords(e){if(!e||'string'!=typeof e)return[];const t=[],a=e.split(qd).filter(e=>e.trim());for(const e of a){const a=this.parseRecord(e.trim());a&&t.push(a)}if(0===t.length){const a=/<å†å²è®°å½•>([\s\S]*?)<\/å†å²è®°å½•>/gi,n=[...e.matchAll(a)];for(const e of n){const a=this.parseRecord(e[1].trim());a&&t.push(a)}}return t.sort((e,t)=>e.åºå·-t.åºå·),t}static parseHistoryTexts(e){if(!e||'string'!=typeof e)return[];const t=[],a=e.split(Yd).filter(e=>e.trim());for(let e=0;e<a.length;e++){const n=a[e].trim().replace(/<!--[\s\S]*?-->/g,'').trim();n&&t.push({åºå·:e+1,å†…å®¹:n})}if(0===t.length){const a=/<gametxt>([\s\S]*?)<\/gametxt>/gi,n=[...e.matchAll(a)];for(let e=0;e<n.length;e++){const a=n[e][1].trim().replace(/<!--[\s\S]*?-->/g,'').trim();a&&t.push({åºå·:e+1,å†…å®¹:a})}}return t}static formatRecordFields(e,t){const a=[];for(const n of t){if('_raw'===n)continue;const t=e[n];null!=t&&''!==t&&('æ ‡ç­¾'===n&&Array.isArray(t)?t.length>0&&a.push(t.join('|')):'æ—¥æœŸ'===n||'æè¿°'===n?a.push(String(t)):'è‡ªåŠ¨åŒ–ç³»ç»Ÿ'===n?a.push(`è‡ªåŠ¨åŒ–ç³»ç»Ÿ|${t}`):a.push(String(t)))}return a.join(' ')}static formatSmallSummary(e){if(!e||0===e.length)return'';return e.map(e=>{const t=[];return e.æ—¥æœŸ&&t.push(e.æ—¥æœŸ),e.é‡è¦ä¿¡æ¯&&t.push(e.é‡è¦ä¿¡æ¯),e.è‡ªåŠ¨åŒ–ç³»ç»Ÿ&&t.push(`è‡ªåŠ¨åŒ–ç³»ç»Ÿ|${e.è‡ªåŠ¨åŒ–ç³»ç»Ÿ}`),t.join(' ')}).join(qd)}static formatLargeSummary(e){if(!e||0===e.length)return'';return e.map(e=>{const t=[];return e.æ—¥æœŸ&&t.push(e.æ—¥æœŸ),e.æè¿°&&t.push(e.æè¿°),t.join(' ')}).join(qd)}static formatSegmentedText(e){return e&&0!==e.length?e.map(e=>e.å†…å®¹).join(Yd):''}static serializeRecords(e){return e&&0!==e.length?e.map(e=>{const t=[];return t.push(`åºå·|${e.åºå·}`),e.æ—¥æœŸ&&t.push(`æ—¥æœŸ|${e.æ—¥æœŸ}`),e.åœ°ç‚¹&&t.push(`åœ°ç‚¹|${e.åœ°ç‚¹}`),e.æè¿°&&t.push(`æè¿°|${e.æè¿°}`),e.æ ‡ç­¾&&e.æ ‡ç­¾.length>0&&t.push(`æ ‡ç­¾|${e.æ ‡ç­¾.join('|')}`),e.é‡è¦ä¿¡æ¯&&t.push(`é‡è¦ä¿¡æ¯|${e.é‡è¦ä¿¡æ¯}`),e.è‡ªåŠ¨åŒ–ç³»ç»Ÿ&&t.push(`è‡ªåŠ¨åŒ–ç³»ç»Ÿ|${e.è‡ªåŠ¨åŒ–ç³»ç»Ÿ}`),t.join('\n')}).join(qd):''}static serializeTexts(e){return e&&0!==e.length?e.map(e=>e.å†…å®¹).join(Yd):''}static getRecordCount(e){if(!e)return 0;const t=e.split(qd).filter(e=>e.trim());if(t.length>0)return t.length;const a=e.match(/<å†å²è®°å½•>/gi);return a&&a.length>0?a.length:0}static getTextCount(e){if(!e)return 0;const t=e.split(Yd).filter(e=>e.trim());if(t.length>0)return t.length;const a=e.match(/<gametxt>/gi);return a&&a.length>0?a.length:0}static getLatestSequence(e){return e&&0!==e.length?Math.max(...e.map(e=>e.åºå·)):0}static appendRecord(e,t){return e&&e.trim()?`${e}${qd}${t}`:t}static appendText(e,t){return e&&e.trim()?`${e}${Yd}${t}`:t}}const Zd=new class{lorebook='ã€MCæˆ¿å­ã€‘';initialized=!1;isAvailable(){return'function'==typeof getWorldbook&&'function'==typeof updateWorldbookWith}async initialize(e){try{if(e&&(this.lorebook=e),!this.isAvailable())return console.warn('[WorldbookService] ä¸–ç•Œä¹¦å…¨å±€APIä¸å¯ç”¨ï¼Œå¯èƒ½ä¸åœ¨é…’é¦†ç¯å¢ƒä¸­'),this.initialized=!0,!0;try{const e=await getWorldbook(this.lorebook);console.log(`[WorldbookService] ä¸–ç•Œä¹¦"${this.lorebook}"å·²å­˜åœ¨ï¼ŒåŒ…å«${e.length}ä¸ªæ¡ç›®`)}catch{console.log(`[WorldbookService] ä¸–ç•Œä¹¦"${this.lorebook}"ä¸å­˜åœ¨ï¼Œå°†åœ¨éœ€è¦æ—¶åˆ›å»º`)}return this.initialized=!0,console.log('[WorldbookService] åˆå§‹åŒ–å®Œæˆï¼Œä¸–ç•Œä¹¦:',this.lorebook),!0}catch(e){return console.error('[WorldbookService] åˆå§‹åŒ–å¤±è´¥:',e),!1}}async getEntry(e){try{if(!this.isAvailable())return console.warn('[WorldbookService] ä¸–ç•Œä¹¦APIä¸å¯ç”¨'),null;const t=await getWorldbook(this.lorebook);if(!t||!Array.isArray(t))return null;return t.find(t=>t.name===e)||null}catch(t){return console.error(`[WorldbookService] è·å–æ¡ç›®"${e}"å¤±è´¥:`,t),null}}async getEntryContent(e){const t=await this.getEntry(e);return t?.content||''}async setEntryContent(e,t){try{if(!this.isAvailable())return console.warn('[WorldbookService] ä¸–ç•Œä¹¦APIä¸å¯ç”¨'),!1;return await this.getEntry(e)?(await updateWorldbookWith(this.lorebook,a=>a.map(a=>a.name===e?{...a,content:t}:a)),console.log(`[WorldbookService] æ›´æ–°æ¡ç›®"${e}"æˆåŠŸï¼Œå†…å®¹é•¿åº¦: ${t.length}`),!0):(console.log(`[WorldbookService] æ¡ç›®"${e}"ä¸å­˜åœ¨ï¼Œè·³è¿‡æ›´æ–°ï¼ˆä¸è‡ªåŠ¨åˆ›å»ºï¼‰`),!1)}catch(t){return console.error(`[WorldbookService] è®¾ç½®æ¡ç›®"${e}"å†…å®¹å¤±è´¥:`,t),!1}}async appendToEntry(e,t,a='\n'){try{const n=await this.getEntryContent(e),o=n?`${n}${a}${t}`:t;return await this.setEntryContent(e,o)}catch(t){return console.error(`[WorldbookService] è¿½åŠ å†…å®¹åˆ°"${e}"å¤±è´¥:`,t),!1}}async ensureWorldbookExists(){try{if(!this.isAvailable())return!1;try{return await getWorldbook(this.lorebook),!0}catch{return console.log(`[WorldbookService] æ‡’åˆ›å»ºä¸–ç•Œä¹¦"${this.lorebook}"`),await createWorldbook(this.lorebook,[]),!0}}catch(e){return console.error('[WorldbookService] ç¡®ä¿ä¸–ç•Œä¹¦å­˜åœ¨å¤±è´¥:',e),!1}}async createEntry(e,t,a){try{return this.isAvailable()?(await this.ensureWorldbookExists(),await createWorldbookEntries(this.lorebook,[{name:e,content:t,enabled:a.enabled,strategy:{type:'constant',keys:[],keys_secondary:{logic:'and_any',keys:[]},scan_depth:'same_as_global'},position:{type:'at_depth',role:a.role,depth:a.depth,order:a.order},probability:100,recursion:{prevent_incoming:!1,prevent_outgoing:!1,delay_until:null},effect:{sticky:null,cooldown:null,delay:null}}]),console.log(`[WorldbookService] åˆ›å»ºæ¡ç›®"${e}"æˆåŠŸ`),!0):(console.warn('[WorldbookService] ä¸–ç•Œä¹¦APIä¸å¯ç”¨'),!1)}catch(t){return console.error(`[WorldbookService] åˆ›å»ºæ¡ç›®"${e}"å¤±è´¥:`,t),!1}}async setEntryEnabled(e,t){try{if(!this.isAvailable())return!1;return await this.getEntry(e)?(await updateWorldbookWith(this.lorebook,a=>a.map(a=>a.name===e?{...a,enabled:t}:a)),console.log(`[WorldbookService] ${t?'å¯ç”¨':'ç¦ç”¨'}æ¡ç›®"${e}"`),!0):(console.warn(`[WorldbookService] æ¡ç›®"${e}"ä¸å­˜åœ¨`),!1)}catch(t){return console.error(`[WorldbookService] è®¾ç½®æ¡ç›®"${e}"å¯ç”¨çŠ¶æ€å¤±è´¥:`,t),!1}}async entryExists(e){return null!==await this.getEntry(e)}async ensureAllEntries(){try{const e=Object.values(Gd);for(const t of e){if(!await this.entryExists(t)){const e=Jd[t];e&&(await this.createEntry(t,'',e),console.log(`[WorldbookService] åˆ›å»ºç¼ºå¤±çš„æ¡ç›®: ${t}`))}}return!0}catch(e){return console.error('[WorldbookService] ç¡®ä¿æ¡ç›®å­˜åœ¨å¤±è´¥:',e),!1}}async switchToFullMode(){try{return await this.setEntryEnabled(Gd.HISTORY_TEXT,!0),await this.setEntryEnabled(Gd.HISTORY_RECORD,!0),await this.setEntryEnabled(Gd.SEGMENTED_TEXT,!1),await this.setEntryEnabled(Gd.SMALL_SUMMARY,!1),await this.setEntryEnabled(Gd.LARGE_SUMMARY,!1),console.log('[WorldbookService] å·²åˆ‡æ¢åˆ°å…¨é‡æ¨¡å¼'),!0}catch(e){return console.error('[WorldbookService] åˆ‡æ¢åˆ°å…¨é‡æ¨¡å¼å¤±è´¥:',e),!1}}async switchToSegmentedMode(){try{return await this.setEntryEnabled(Gd.HISTORY_TEXT,!1),await this.setEntryEnabled(Gd.HISTORY_RECORD,!1),await this.setEntryEnabled(Gd.SEGMENTED_TEXT,!0),await this.setEntryEnabled(Gd.SMALL_SUMMARY,!0),await this.setEntryEnabled(Gd.LARGE_SUMMARY,!0),console.log('[WorldbookService] å·²åˆ‡æ¢åˆ°åˆ†æ®µæ¨¡å¼'),!0}catch(e){return console.error('[WorldbookService] åˆ‡æ¢åˆ°åˆ†æ®µæ¨¡å¼å¤±è´¥:',e),!1}}async getContextSnapshot(){const e={};for(const t of Object.values(Gd))e[t]=await this.getEntryContent(t);return e}async restoreFromSnapshot(e){try{for(const[t,a]of Object.entries(e))await this.setEntryContent(t,a);return console.log('[WorldbookService] ä»å¿«ç…§æ¢å¤å®Œæˆ'),!0}catch(e){return console.error('[WorldbookService] ä»å¿«ç…§æ¢å¤å¤±è´¥:',e),!1}}async clearAllContextEntries(){try{for(const e of Object.values(Gd))await this.setEntryContent(e,'');return console.log('[WorldbookService] å·²æ¸…ç©ºæ‰€æœ‰ä¸Šä¸‹æ–‡æ¡ç›®'),!0}catch(e){return console.error('[WorldbookService] æ¸…ç©ºæ¡ç›®å¤±è´¥:',e),!1}}},Qd={class:'history-text-panel'},eu={class:'panel-header'},tu={class:'header-left'},au={key:0,class:'text-count'},nu={class:'header-actions'},ou=['disabled'],lu={class:'search-bar'},su={key:0,class:'search-result-count'},ru={class:'panel-body'},cu={key:0,class:'state-container loading-state'},iu={class:'state-container error-state'},du={class:'state-text'},uu={class:'text-list'},mu=['onClick'],pu={class:'text-meta'},vu={class:'text-number'},fu={key:0,class:'text-preview'},gu={class:'expand-icon'},hu={key:0,class:'text-content'},yu=['innerHTML'],Vu={class:'content-actions'},Nu=['onClick'],Eu={key:0,class:'panel-footer'},ku={class:'footer-info'},bu={class:'info-text'},Cu=(0,l.defineComponent)({__name:'HistoryTextPanel',emits:['close'],setup(e){const t=(0,l.ref)(!1),a=(0,l.ref)(null),n=(0,l.ref)([]),o=(0,l.ref)(''),s=(0,l.ref)(new Set),r=(0,l.computed)(()=>{if(!o.value.trim())return n.value;const e=o.value.toLowerCase();return n.value.filter(t=>t.å†…å®¹.toLowerCase().includes(e))}),c=async()=>{t.value=!0,a.value=null;try{await Zd.initialize();const e=await Zd.getEntryContent(Gd.HISTORY_TEXT);n.value=Xd.parseHistoryTexts(e),console.log('[HistoryTextPanel] å·²åŠ è½½',n.value.length,'æ¡å†å²æ­£æ–‡')}catch(e){console.error('[HistoryTextPanel] åŠ è½½å¤±è´¥:',e),a.value=e instanceof Error?e.message:'åŠ è½½å†å²æ­£æ–‡å¤±è´¥'}finally{t.value=!1}},i=()=>{},d=()=>{r.value.forEach(e=>{s.value.add(e.åºå·)})},u=()=>{s.value.clear()},m=e=>{const t=e.replace(/\n/g,' ').replace(/\s+/g,' ').trim();return t.length<=60?t:t.substring(0,60)+'...'};return(0,l.onMounted)(()=>{c()}),(e,p)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',Qd,[(0,l.createCommentVNode)(' é¢æ¿å¤´éƒ¨ '),(0,l.createElementVNode)('div',eu,[(0,l.createElementVNode)('div',tu,[p[2]||(p[2]=(0,l.createElementVNode)('span',{class:'panel-icon'},'ğŸ“œ',-1)),p[3]||(p[3]=(0,l.createElementVNode)('h2',{class:'panel-title'},'å†å²æ­£æ–‡',-1)),n.value.length>0?((0,l.openBlock)(),(0,l.createElementBlock)('span',au,' å…± '+(0,l.toDisplayString)(n.value.length)+' æ¡ ',1)):(0,l.createCommentVNode)('v-if',!0)]),(0,l.createElementVNode)('div',nu,[(0,l.createElementVNode)('button',{class:'btn-refresh',onClick:c,disabled:t.value,title:'åˆ·æ–°'},'ğŸ”„',8,ou),(0,l.createElementVNode)('button',{class:'btn-close',onClick:p[0]||(p[0]=t=>e.$emit('close'))},'âœ•')])]),(0,l.createCommentVNode)(' æœç´¢æ  '),(0,l.createElementVNode)('div',lu,[(0,l.withDirectives)((0,l.createElementVNode)('input',{'onUpdate:modelValue':p[1]||(p[1]=e=>o.value=e),type:'text',class:'search-input',placeholder:'æœç´¢æ­£æ–‡å†…å®¹...',onInput:i},null,544),[[l.vModelText,o.value]]),o.value?((0,l.openBlock)(),(0,l.createElementBlock)('span',su,' æ‰¾åˆ° '+(0,l.toDisplayString)(r.value.length)+' æ¡ ',1)):(0,l.createCommentVNode)('v-if',!0)]),(0,l.createCommentVNode)(' é¢æ¿ä¸»ä½“ '),(0,l.createElementVNode)('div',ru,[(0,l.createCommentVNode)(' åŠ è½½çŠ¶æ€ '),t.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',cu,[...p[4]||(p[4]=[(0,l.createElementVNode)('span',{class:'state-icon loading-spinner'},'â³',-1),(0,l.createElementVNode)('span',{class:'state-text'},'åŠ è½½ä¸­...',-1)])])):a.value?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createCommentVNode)(' é”™è¯¯æç¤º '),(0,l.createElementVNode)('div',iu,[p[5]||(p[5]=(0,l.createElementVNode)('span',{class:'state-icon error-icon'},'âš ï¸',-1)),(0,l.createElementVNode)('span',du,(0,l.toDisplayString)(a.value),1),(0,l.createElementVNode)('button',{class:'btn btn-secondary',onClick:c},'é‡æ–°åŠ è½½')])],2112)):0===n.value.length?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:2},[(0,l.createCommentVNode)(' ç©ºçŠ¶æ€ '),p[6]||(p[6]=(0,l.createElementVNode)('div',{class:'state-container empty-state'},[(0,l.createElementVNode)('span',{class:'state-icon'},'ğŸ“'),(0,l.createElementVNode)('span',{class:'state-text'},'æš‚æ— å†å²æ­£æ–‡'),(0,l.createElementVNode)('p',{class:'state-hint'},'å†å²æ­£æ–‡ä¼šåœ¨æ¸¸æˆè¿›è¡Œè¿‡ç¨‹ä¸­è‡ªåŠ¨è®°å½•')],-1))],2112)):0===r.value.length?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:3},[(0,l.createCommentVNode)(' æœç´¢æ— ç»“æœ '),p[7]||(p[7]=(0,l.createElementVNode)('div',{class:'state-container empty-state'},[(0,l.createElementVNode)('span',{class:'state-icon'},'ğŸ”'),(0,l.createElementVNode)('span',{class:'state-text'},'æœªæ‰¾åˆ°åŒ¹é…å†…å®¹'),(0,l.createElementVNode)('p',{class:'state-hint'},'å°è¯•ä½¿ç”¨å…¶ä»–å…³é”®è¯æœç´¢')],-1))],2112)):((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:4},[(0,l.createCommentVNode)(' å†å²æ­£æ–‡åˆ—è¡¨ '),(0,l.createElementVNode)('div',uu,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(r.value,(e,t)=>{return(0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.åºå·,class:(0,l.normalizeClass)(['text-item',{'is-expanded':s.value.has(e.åºå·)}])},[(0,l.createCommentVNode)(' æ¡ç›®å¤´éƒ¨ '),(0,l.createElementVNode)('div',{class:'text-header',onClick:t=>{return a=e.åºå·,void(s.value.has(a)?s.value.delete(a):s.value.add(a));var a}},[(0,l.createElementVNode)('div',pu,[(0,l.createElementVNode)('span',vu,'#'+(0,l.toDisplayString)(e.åºå·),1),s.value.has(e.åºå·)?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('span',fu,(0,l.toDisplayString)(m(e.å†…å®¹)),1))]),(0,l.createElementVNode)('span',gu,(0,l.toDisplayString)(s.value.has(e.åºå·)?'â–¼':'â–¶'),1)],8,mu),(0,l.createCommentVNode)(' æ¡ç›®å†…å®¹ï¼ˆå±•å¼€æ—¶æ˜¾ç¤ºï¼‰ '),s.value.has(e.åºå·)?((0,l.openBlock)(),(0,l.createElementBlock)('div',hu,[(0,l.createElementVNode)('div',{class:'content-body',innerHTML:(a=e.å†…å®¹,a.replace(/\n/g,'<br>'))},null,8,yu),(0,l.createElementVNode)('div',Vu,[(0,l.createElementVNode)('button',{class:'btn-action',onClick:t=>(async e=>{try{await navigator.clipboard.writeText(e),'undefined'!=typeof toastr&&toastr.success('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿')}catch(e){console.error('[HistoryTextPanel] å¤åˆ¶å¤±è´¥:',e),'undefined'!=typeof toastr&&toastr.error('å¤åˆ¶å¤±è´¥')}})(e.å†…å®¹),title:'å¤åˆ¶å†…å®¹'},'ğŸ“‹ å¤åˆ¶',8,Nu)])])):(0,l.createCommentVNode)('v-if',!0)],2);var a}),128))])],2112))]),(0,l.createCommentVNode)(' åº•éƒ¨å·¥å…·æ  '),n.value.length>0?((0,l.openBlock)(),(0,l.createElementBlock)('div',Eu,[(0,l.createElementVNode)('div',ku,[(0,l.createElementVNode)('span',bu,' æ˜¾ç¤º '+(0,l.toDisplayString)(r.value.length)+' / '+(0,l.toDisplayString)(n.value.length)+' æ¡ ',1)]),(0,l.createElementVNode)('div',{class:'footer-actions'},[(0,l.createElementVNode)('button',{class:'btn btn-secondary',onClick:d},'å…¨éƒ¨å±•å¼€'),(0,l.createElementVNode)('button',{class:'btn btn-secondary',onClick:u},'å…¨éƒ¨æ”¶èµ·')])])):(0,l.createCommentVNode)('v-if',!0)]))}}),wu=(0,B.A)(Cu,[['__scopeId','data-v-e34eebd4']]),Su={class:'changelog-panel'},Bu={class:'panel-header'},Iu={class:'header-right'},Mu=['disabled'],Au={class:'panel-body'},Du={key:0,class:'loading-state'},xu={class:'error-state'},_u={class:'error-message'},Tu=['innerHTML'],$u={class:'panel-footer'},Ru={class:'footer-info'},Lu={key:0,class:'update-time'},Pu={key:1,class:'cache-status'},Ou={class:'footer-actions'},Fu=['disabled'],ju=['href'],Uu={class:'cache-dialog'},zu={class:'dialog-body'},Wu={class:'cache-options'},Hu={class:'cache-option'},Gu={class:'cache-option'},Ku={class:'dialog-footer'},Ju=['disabled'],qu='CrHouse815',Yu='-MC-_lite-',Xu=(0,l.defineComponent)({__name:'ChangelogPanel',emits:['close'],setup(e,{emit:t}){const a=`https://cdn.jsdelivr.net/gh/${qu}/${Yu}@main`,n=`https://github.com/${qu}/${Yu}`,o=(0,l.ref)(!1),s=(0,l.ref)('æ­£åœ¨åŠ è½½æ›´æ–°æ—¥å¿—...'),r=(0,l.ref)(null),c=(0,l.ref)(''),i=(0,l.ref)(null),d=(0,l.ref)(!1),u=(0,l.ref)(!1),m=(0,l.ref)({browserCache:!0,forceRefresh:!0}),p=(0,l.computed)(()=>n),v=(0,l.computed)(()=>c.value?E(c.value):''),f=(0,l.computed)(()=>m.value.browserCache||m.value.forceRefresh),g=async(e=!1)=>{o.value=!0,s.value='æ­£åœ¨åŠ è½½æ›´æ–°æ—¥å¿—...',r.value=null;try{const t=Date.now(),n=`${a}/CHANGELOG.md?t=${t}`;console.log('[ChangelogPanel] æ­£åœ¨è·å–æ›´æ–°æ—¥å¿—:',n,e?'(å¼ºåˆ¶æ— ç¼“å­˜)':'');const o=e?{cache:'no-store',headers:{'Cache-Control':'no-cache, no-store, must-revalidate',Pragma:'no-cache'}}:{},l=await fetch(n,o);if(!l.ok)throw new Error(`HTTP ${l.status}: ${l.statusText}`);c.value=await l.text(),i.value=new Date,console.log('[ChangelogPanel] æ›´æ–°æ—¥å¿—è·å–æˆåŠŸ, é•¿åº¦:',c.value.length)}catch(e){console.error('[ChangelogPanel] è·å–æ›´æ–°æ—¥å¿—å¤±è´¥:',e),r.value=`è·å–æ›´æ–°æ—¥å¿—å¤±è´¥: ${e.message||'ç½‘ç»œé”™è¯¯'}`,c.value=N(),c.value&&(r.value=null,console.log('[ChangelogPanel] ä½¿ç”¨æœ¬åœ°æ›´æ–°æ—¥å¿—'))}finally{o.value=!1}},h=()=>{u.value=!0},y=async()=>{u.value=!1,o.value=!0,d.value=!1;const e=[];try{m.value.browserCache&&(s.value='æ­£åœ¨æ¸…ç†æµè§ˆå™¨ç¼“å­˜...',await V(),e.push('æµè§ˆå™¨ç¼“å­˜'),console.log('[ChangelogPanel] æµè§ˆå™¨ç¼“å­˜å·²æ¸…ç†')),m.value.forceRefresh?(s.value='æ­£åœ¨å¼ºåˆ¶åˆ·æ–°å†…å®¹...',await g(!0)):await g(!1),d.value=!0,setTimeout(()=>{d.value=!1},3e3),e.length>0&&console.log('[ChangelogPanel] å·²æ¸…ç†:',e.join(', '))}catch(e){console.error('[ChangelogPanel] ç¼“å­˜æ¸…ç†å¤±è´¥:',e),r.value=`ç¼“å­˜æ¸…ç†å¤±è´¥: ${e.message||'æœªçŸ¥é”™è¯¯'}`}finally{o.value=!1,s.value='æ­£åœ¨åŠ è½½æ›´æ–°æ—¥å¿—...'}},V=async()=>{try{if('caches'in window){const e=await caches.keys(),t=e.filter(e=>e.includes('jsdelivr')||e.includes('workbox')||e.includes('runtime'));for(const e of t)await caches.delete(e),console.log('[ChangelogPanel] å·²åˆ é™¤ç¼“å­˜:',e);for(const t of e)try{const e=await caches.open(t),a=await e.keys();for(const t of a)(t.url.includes('jsdelivr.net')||t.url.includes(qu))&&(await e.delete(t),console.log('[ChangelogPanel] å·²åˆ é™¤ç¼“å­˜æ¡ç›®:',t.url))}catch(e){}}const e=[];for(let t=0;t<localStorage.length;t++){const a=localStorage.key(t);a&&(a.includes('jsdelivr')||a.includes('changelog')||a.includes('CHANGELOG'))&&e.push(a)}e.forEach(e=>{localStorage.removeItem(e),console.log('[ChangelogPanel] å·²åˆ é™¤ localStorage:',e)});const t=[];for(let e=0;e<sessionStorage.length;e++){const a=sessionStorage.key(e);a&&(a.includes('jsdelivr')||a.includes('changelog')||a.includes('CHANGELOG'))&&t.push(a)}t.forEach(e=>{sessionStorage.removeItem(e),console.log('[ChangelogPanel] å·²åˆ é™¤ sessionStorage:',e)})}catch(e){console.warn('[ChangelogPanel] æ¸…ç†æµè§ˆå™¨ç¼“å­˜æ—¶å‡ºç°è­¦å‘Š:',e)}},N=()=>`# MClite æ›´æ–°æ—¥å¿—\n\n> æ­¤ä¸ºæœ¬åœ°ç¼“å­˜ç‰ˆæœ¬ï¼Œå¦‚éœ€æŸ¥çœ‹æœ€æ–°æ›´æ–°æ—¥å¿—ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥åé‡è¯•ã€‚\n\n**ä¸»è¦æ›´æ–°**ï¼š\n- æ–°å¢æ›´æ–°æ—¥å¿—é¢æ¿\n- æ·»åŠ ç‰ˆæœ¬å·æ˜¾ç¤º\n- æ”¯æŒä» GitHub è¿œç¨‹è·å–æ›´æ–°æ—¥å¿—\n\n---\n\n*å®Œæ•´æ›´æ–°æ—¥å¿—è¯·è®¿é—® [GitHub ä»“åº“](${n})*\n`,E=e=>{const t=e.split('\n'),a=[];let n=!1,o=[],l='';for(let e=0;e<t.length;e++){let s=t[e];if(s.startsWith('```')){if(n){n=!1;const e=l?' language-'+l:'',t=k(o.join('\n'));a.push('<pre class="code-block'+e+'"><code>'+t+'</code></pre>'),l=''}else n=!0,l=s.slice(3).trim(),o=[];continue}if(n){o.push(s);continue}if(s=k(s),s.startsWith('### ')){a.push('<h4 class="md-h4">'+w(s.slice(4))+'</h4>');continue}if(s.startsWith('## ')){a.push('<h3 class="md-h3">'+w(s.slice(3))+'</h3>');continue}if(s.startsWith('# ')){a.push('<h2 class="md-h2">'+w(s.slice(2))+'</h2>');continue}if('---'===s||'----'===s||'-----'===s){a.push('<hr class="md-hr">');continue}if(s.startsWith('&gt; ')){a.push('<blockquote class="md-quote">'+w(s.slice(5))+'</blockquote>');continue}if(s.startsWith('- ')){a.push('<li class="md-li">'+w(s.slice(2))+'</li>');continue}const r=b(s);r?a.push('<li class="md-li-ordered">'+w(r)+'</li>'):s.trim()?a.push('<p class="md-p">'+w(s)+'</p>'):a.push('')}let s=a.join('\n');return s=s.split('</blockquote>\n<blockquote class="md-quote">').join('<br>'),s},k=e=>e.split('&').join('&amp;').split('<').join('&lt;').split('>').join('&gt;').split('"').join('&quot;'),b=e=>{for(let t=1;t<=3;t++){const a=e.slice(0,t);if(C(a)&&'.'===e.charAt(t)&&' '===e.charAt(t+1))return e.slice(t+2)}return null},C=e=>{for(let t=0;t<e.length;t++){const a=e.charCodeAt(t);if(a<48||a>57)return!1}return e.length>0},w=e=>{let t='',a=0;for(;a<e.length;){if('`'===e.charAt(a)){const n=e.indexOf('`',a+1);if(n>a){t+='<code class="inline-code">'+e.slice(a+1,n)+'</code>',a=n+1;continue}}if('*'===e.charAt(a)&&'*'===e.charAt(a+1)){const n=S(e,a+2);if(n>a){t+='<strong>'+e.slice(a+2,n)+'</strong>',a=n+2;continue}}if('*'===e.charAt(a)&&'*'!==e.charAt(a+1)){const n=B(e,a+1);if(n>a){t+='<em>'+e.slice(a+1,n)+'</em>',a=n+1;continue}}if('['===e.charAt(a)){const n=e.indexOf(']',a+1);if(n>a&&'('===e.charAt(n+1)){const o=e.indexOf(')',n+2);if(o>n){const l=e.slice(a+1,n);t+='<a href="'+e.slice(n+2,o)+'" target="_blank" rel="noopener">'+l+'</a>',a=o+1;continue}}}if('v'===e.charAt(a)&&I(e.charAt(a+1))){const n=M(e,a+1);if(n>a+1){const o=e.slice(a,n);if(A(o)){t+='<span class="version-highlight">'+o+'</span>',a=n;continue}}}t+=e.charAt(a),a++}return t},S=(e,t)=>{for(let a=t;a<e.length-1;a++)if('*'===e.charAt(a)&&'*'===e.charAt(a+1))return a;return-1},B=(e,t)=>{for(let a=t;a<e.length;a++)if('*'===e.charAt(a)&&'*'!==e.charAt(a+1)&&(0===a||'*'!==e.charAt(a-1)))return a;return-1},I=e=>{const t=e.charCodeAt(0);return t>=48&&t<=57},M=(e,t)=>{let a=t,n=0;for(;a<e.length;){const o=e.charAt(a);if(I(o))a++;else{if(!('.'===o&&n<2&&a>t&&I(e.charAt(a-1))))break;n++,a++}}return a},A=e=>{let t=0;for(let a=0;a<e.length;a++)'.'===e.charAt(a)&&t++;return t>=1};return(0,l.onMounted)(()=>{g()}),(e,t)=>{return(0,l.openBlock)(),(0,l.createElementBlock)('div',Su,[(0,l.createCommentVNode)(' é¢æ¿å¤´éƒ¨ '),(0,l.createElementVNode)('div',Bu,[t[5]||(t[5]=(0,l.createElementVNode)('div',{class:'header-left'},[(0,l.createElementVNode)('span',{class:'header-icon'},'ğŸ“‹'),(0,l.createElementVNode)('h3',{class:'header-title'},'æ›´æ–°æ—¥å¿—')],-1)),(0,l.createElementVNode)('div',Iu,[(0,l.createElementVNode)('button',{class:'btn-refresh',onClick:g,disabled:o.value,title:'åˆ·æ–°'},[(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(['refresh-icon',{spinning:o.value}])},'ğŸ”„',2)],8,Mu),(0,l.createElementVNode)('button',{class:'btn-close',onClick:t[0]||(t[0]=t=>e.$emit('close')),title:'å…³é—­'},'âœ•')])]),(0,l.createCommentVNode)(' é¢æ¿å†…å®¹ '),(0,l.createElementVNode)('div',Au,[(0,l.createCommentVNode)(' åŠ è½½çŠ¶æ€ '),o.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',Du,[t[6]||(t[6]=(0,l.createElementVNode)('div',{class:'loading-spinner'},null,-1)),(0,l.createElementVNode)('p',null,(0,l.toDisplayString)(s.value),1)])):r.value?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createCommentVNode)(' é”™è¯¯çŠ¶æ€ '),(0,l.createElementVNode)('div',xu,[t[7]||(t[7]=(0,l.createElementVNode)('span',{class:'error-icon'},'âš ï¸',-1)),(0,l.createElementVNode)('p',_u,(0,l.toDisplayString)(r.value),1),(0,l.createElementVNode)('button',{class:'btn-retry',onClick:g},'é‡è¯•')])],2112)):((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:2},[(0,l.createCommentVNode)(' æ›´æ–°æ—¥å¿—å†…å®¹ '),(0,l.createElementVNode)('div',{class:'changelog-content',innerHTML:v.value},null,8,Tu)],2112))]),(0,l.createCommentVNode)(' é¢æ¿åº•éƒ¨ '),(0,l.createElementVNode)('div',$u,[(0,l.createElementVNode)('div',Ru,[i.value?((0,l.openBlock)(),(0,l.createElementBlock)('span',Lu,' æœ€åæ›´æ–°ï¼š'+(0,l.toDisplayString)((a=i.value,a.toLocaleString('zh-CN',{year:'numeric',month:'2-digit',day:'2-digit',hour:'2-digit',minute:'2-digit'}))),1)):(0,l.createCommentVNode)('v-if',!0),d.value?((0,l.openBlock)(),(0,l.createElementBlock)('span',Pu,' âœ“ ç¼“å­˜å·²æ¸…ç† ')):(0,l.createCommentVNode)('v-if',!0)]),(0,l.createElementVNode)('div',Ou,[(0,l.createElementVNode)('button',{class:'btn-clear-cache',onClick:h,disabled:o.value,title:'æ¸…ç†æµè§ˆå™¨ç¼“å­˜å¹¶ä» CDN è·å–æœ€æ–°ç‰ˆæœ¬'},[...t[8]||(t[8]=[(0,l.createElementVNode)('span',{class:'cache-icon'},'ğŸ—‘ï¸',-1),(0,l.createElementVNode)('span',null,'æ¸…ç†ç¼“å­˜',-1)])],8,Fu),(0,l.createElementVNode)('a',{class:'btn-github',href:p.value,target:'_blank',rel:'noopener noreferrer',title:'åœ¨ GitHub ä¸ŠæŸ¥çœ‹'},[...t[9]||(t[9]=[(0,l.createElementVNode)('span',{class:'github-icon'},'ğŸ“‚',-1),(0,l.createElementVNode)('span',null,'GitHub',-1)])],8,ju)])]),(0,l.createCommentVNode)(' ç¼“å­˜æ¸…ç†ç¡®è®¤å¯¹è¯æ¡† '),u.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'cache-dialog-overlay',onClick:t[4]||(t[4]=(0,l.withModifiers)(e=>u.value=!1,['self']))},[(0,l.createElementVNode)('div',Uu,[t[13]||(t[13]=(0,l.createElementVNode)('div',{class:'dialog-header'},[(0,l.createElementVNode)('span',{class:'dialog-icon'},'ğŸ—‘ï¸'),(0,l.createElementVNode)('h4',null,'æ¸…ç†ç¼“å­˜')],-1)),(0,l.createElementVNode)('div',zu,[t[12]||(t[12]=(0,l.createElementVNode)('p',null,'é€‰æ‹©è¦æ‰§è¡Œçš„ç¼“å­˜æ¸…ç†æ“ä½œï¼š',-1)),(0,l.createElementVNode)('div',Wu,[(0,l.createElementVNode)('label',Hu,[(0,l.withDirectives)((0,l.createElementVNode)('input',{type:'checkbox','onUpdate:modelValue':t[1]||(t[1]=e=>m.value.browserCache=e)},null,512),[[l.vModelCheckbox,m.value.browserCache]]),t[10]||(t[10]=(0,l.createElementVNode)('span',{class:'option-text'},[(0,l.createElementVNode)('strong',null,'æµè§ˆå™¨ç¼“å­˜'),(0,l.createElementVNode)('small',null,'æ¸…ç†æœ¬åœ°æµè§ˆå™¨å­˜å‚¨çš„ jsdelivr èµ„æºç¼“å­˜')],-1))]),(0,l.createElementVNode)('label',Gu,[(0,l.withDirectives)((0,l.createElementVNode)('input',{type:'checkbox','onUpdate:modelValue':t[2]||(t[2]=e=>m.value.forceRefresh=e)},null,512),[[l.vModelCheckbox,m.value.forceRefresh]]),t[11]||(t[11]=(0,l.createElementVNode)('span',{class:'option-text'},[(0,l.createElementVNode)('strong',null,'å¼ºåˆ¶åˆ·æ–°'),(0,l.createElementVNode)('small',null,'ä½¿ç”¨ no-cache æ¨¡å¼é‡æ–°è·å–èµ„æº')],-1))])])]),(0,l.createElementVNode)('div',Ku,[(0,l.createElementVNode)('button',{class:'btn-cancel',onClick:t[3]||(t[3]=e=>u.value=!1)},'å–æ¶ˆ'),(0,l.createElementVNode)('button',{class:'btn-confirm',onClick:y,disabled:!f.value},'ç¡®è®¤æ¸…ç†',8,Ju)])])])):(0,l.createCommentVNode)('v-if',!0)]);var a}}}),Zu=(0,B.A)(Xu,[['__scopeId','data-v-6b6680e9']]),Qu={key:0,viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'2'},em={key:1,viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'2'},tm={key:1,class:'toggle-placeholder'},am={key:3,class:'edit-actions'},nm={key:4,class:'children-hint'},om={class:'item-actions'},lm={key:0,class:'item-children'},sm=(0,l.defineComponent)({__name:'TreeItem',props:{name:{},value:{},path:{},depth:{},expandedPaths:{},editingPath:{},searchQuery:{default:''}},emits:['toggle','edit','save','cancel','delete','add-child','copy-path'],setup(e,{emit:t}){const a=e,n=t,o=(0,l.ref)(null),s=(0,l.ref)(!1),r=(0,l.ref)(null),c=(0,l.computed)(()=>null===a.value?'null':void 0===a.value?'undefined':Array.isArray(a.value)?'array':typeof a.value),i=(0,l.computed)(()=>'object'===c.value||'array'===c.value),d=(0,l.computed)(()=>a.expandedPaths.has(a.path)),u=(0,l.computed)(()=>a.editingPath===a.path),m=(0,l.computed)(()=>{if(!a.searchQuery)return!1;const e=a.searchQuery.toLowerCase();return a.path.toLowerCase().includes(e)||a.name.toLowerCase().includes(e)||!i.value&&String(a.value).toLowerCase().includes(e)}),p=(0,l.computed)(()=>/^\d+$/.test(a.name)?`[${a.name}]`:a.name),v=(0,l.computed)(()=>{if(null===a.value)return'null';if(void 0===a.value)return'undefined';switch(c.value){case'string':{const e=String(a.value),t=80;return`"${e.length>t?e.substring(0,t)+'...':e}"`}case'number':default:return String(a.value);case'boolean':return a.value?'true':'false';case'array':return`Array(${a.value.length})`;case'object':return`Object {${Object.keys(a.value).length}}`}}),f=(0,l.computed)(()=>'array'===c.value?`[${a.value.length}]`:'object'===c.value?`{${Object.keys(a.value).length}}`:''),g=(0,l.computed)(()=>'array'===c.value||'object'===c.value?a.value:{});function h(e){return'array'===c.value?`${a.path}[${e}]`:`${a.path}.${e}`}function y(){i.value&&n('toggle',a.path)}function V(){i.value||(r.value=a.value,n('edit',a.path),(0,l.nextTick)(()=>{o.value?.focus(),o.value instanceof HTMLInputElement&&o.value.select()}))}function N(){n('save',a.path,r.value)}return(0,l.watch)(()=>a.editingPath,e=>{e===a.path&&(r.value=a.value,(0,l.nextTick)(()=>{o.value?.focus(),o.value instanceof HTMLInputElement&&o.value.select()}))}),(t,a)=>{const n=(0,l.resolveComponent)('TreeItem',!0);return(0,l.openBlock)(),(0,l.createElementBlock)('div',{class:(0,l.normalizeClass)(['tree-item',{'is-expanded':d.value,'is-match':m.value}])},[(0,l.createCommentVNode)(' èŠ‚ç‚¹è¡Œ '),(0,l.createElementVNode)('div',{class:'item-row',style:(0,l.normalizeStyle)({paddingLeft:16*e.depth+8+'px'}),onClick:y,onMouseenter:a[11]||(a[11]=e=>s.value=!0),onMouseleave:a[12]||(a[12]=e=>s.value=!1)},[(0,l.createCommentVNode)(' å±•å¼€/æŠ˜å å›¾æ ‡ '),i.value?((0,l.openBlock)(),(0,l.createElementBlock)('span',{key:0,class:'toggle-btn',onClick:a[0]||(a[0]=(0,l.withModifiers)(a=>t.$emit('toggle',e.path),['stop']))},[d.value?((0,l.openBlock)(),(0,l.createElementBlock)('svg',Qu,[...a[20]||(a[20]=[(0,l.createElementVNode)('path',{d:'M19 9l-7 7-7-7'},null,-1)])])):((0,l.openBlock)(),(0,l.createElementBlock)('svg',em,[...a[21]||(a[21]=[(0,l.createElementVNode)('path',{d:'M9 5l7 7-7 7'},null,-1)])]))])):((0,l.openBlock)(),(0,l.createElementBlock)('span',tm)),(0,l.createCommentVNode)(' é”®å '),(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(['item-key',{'is-meta':'$meta'===e.name}])},(0,l.toDisplayString)(p.value),3),(0,l.createCommentVNode)(' åˆ†éš”ç¬¦ '),a[27]||(a[27]=(0,l.createElementVNode)('span',{class:'separator'},':',-1)),(0,l.createCommentVNode)(' å€¼æ˜¾ç¤º/ç¼–è¾‘ '),u.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:2,class:'inline-editor',onClick:a[7]||(a[7]=(0,l.withModifiers)(()=>{},['stop']))},['string'===c.value?(0,l.withDirectives)(((0,l.openBlock)(),(0,l.createElementBlock)('input',{key:0,ref_key:'editorInput',ref:o,type:'text','onUpdate:modelValue':a[1]||(a[1]=e=>r.value=e),class:'edit-input',onKeydown:[(0,l.withKeys)(N,['enter']),a[2]||(a[2]=(0,l.withKeys)(e=>t.$emit('cancel'),['escape']))]},null,544)),[[l.vModelText,r.value]]):'number'===c.value?(0,l.withDirectives)(((0,l.openBlock)(),(0,l.createElementBlock)('input',{key:1,ref_key:'editorInput',ref:o,type:'number','onUpdate:modelValue':a[3]||(a[3]=e=>r.value=e),class:'edit-input',step:'any',onKeydown:[(0,l.withKeys)(N,['enter']),a[4]||(a[4]=(0,l.withKeys)(e=>t.$emit('cancel'),['escape']))]},null,544)),[[l.vModelText,r.value,void 0,{number:!0}]]):'boolean'===c.value?(0,l.withDirectives)(((0,l.openBlock)(),(0,l.createElementBlock)('select',{key:2,ref_key:'editorInput',ref:o,'onUpdate:modelValue':a[5]||(a[5]=e=>r.value=e),class:'edit-select',onChange:N},[...a[22]||(a[22]=[(0,l.createElementVNode)('option',{value:!0},'true',-1),(0,l.createElementVNode)('option',{value:!1},'false',-1)])],544)),[[l.vModelSelect,r.value]]):((0,l.openBlock)(),(0,l.createElementBlock)('div',am,[(0,l.createElementVNode)('button',{class:'btn-edit-save',onClick:N},'âœ“'),(0,l.createElementVNode)('button',{class:'btn-edit-cancel',onClick:a[6]||(a[6]=e=>t.$emit('cancel'))},'âœ—')]))])):((0,l.openBlock)(),(0,l.createElementBlock)('span',{key:3,class:(0,l.normalizeClass)(['item-value',[`type-${c.value}`]]),onDblclick:(0,l.withModifiers)(V,['stop'])},(0,l.toDisplayString)(v.value),35)),(0,l.createCommentVNode)(' å­èŠ‚ç‚¹æ•°é‡æç¤º '),i.value&&!d.value?((0,l.openBlock)(),(0,l.createElementBlock)('span',nm,(0,l.toDisplayString)(f.value),1)):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' æ“ä½œæŒ‰é’® '),(0,l.withDirectives)((0,l.createElementVNode)('div',om,[(0,l.createElementVNode)('button',{class:'action-btn',onClick:a[8]||(a[8]=(0,l.withModifiers)(a=>t.$emit('copy-path',e.path),['stop'])),title:'å¤åˆ¶è·¯å¾„'},[...a[23]||(a[23]=[(0,l.createElementVNode)('svg',{viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'2'},[(0,l.createElementVNode)('rect',{x:'9',y:'9',width:'13',height:'13',rx:'2'}),(0,l.createElementVNode)('path',{d:'M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1'})],-1)])]),i.value?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('button',{key:0,class:'action-btn',onClick:(0,l.withModifiers)(V,['stop']),title:'ç¼–è¾‘'},[...a[24]||(a[24]=[(0,l.createElementVNode)('svg',{viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'2'},[(0,l.createElementVNode)('path',{d:'M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7'}),(0,l.createElementVNode)('path',{d:'M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z'})],-1)])])),i.value?((0,l.openBlock)(),(0,l.createElementBlock)('button',{key:1,class:'action-btn',onClick:a[9]||(a[9]=(0,l.withModifiers)(a=>t.$emit('add-child',e.path),['stop'])),title:'æ·»åŠ å­é¡¹'},[...a[25]||(a[25]=[(0,l.createElementVNode)('svg',{viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'2'},[(0,l.createElementVNode)('circle',{cx:'12',cy:'12',r:'10'}),(0,l.createElementVNode)('path',{d:'M12 8v8M8 12h8'})],-1)])])):(0,l.createCommentVNode)('v-if',!0),(0,l.createElementVNode)('button',{class:'action-btn action-delete',onClick:a[10]||(a[10]=(0,l.withModifiers)(a=>t.$emit('delete',e.path),['stop'])),title:'åˆ é™¤'},[...a[26]||(a[26]=[(0,l.createElementVNode)('svg',{viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'2'},[(0,l.createElementVNode)('path',{d:'M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2'})],-1)])])],512),[[l.vShow,s.value&&!u.value]])],36),(0,l.createCommentVNode)(' å­èŠ‚ç‚¹ '),i.value&&d.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',lm,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(g.value,(o,s)=>((0,l.openBlock)(),(0,l.createBlock)(n,{key:s,name:String(s),value:o,path:h(s),depth:e.depth+1,'expanded-paths':e.expandedPaths,'editing-path':e.editingPath,'search-query':e.searchQuery,onToggle:a[13]||(a[13]=e=>t.$emit('toggle',e)),onEdit:a[14]||(a[14]=e=>t.$emit('edit',e)),onSave:a[15]||(a[15]=(e,a)=>t.$emit('save',e,a)),onCancel:a[16]||(a[16]=e=>t.$emit('cancel')),onDelete:a[17]||(a[17]=e=>t.$emit('delete',e)),onAddChild:a[18]||(a[18]=e=>t.$emit('add-child',e)),onCopyPath:a[19]||(a[19]=e=>t.$emit('copy-path',e))},null,8,['name','value','path','depth','expanded-paths','editing-path','search-query']))),128))])):(0,l.createCommentVNode)('v-if',!0)],2)}}}),rm=(0,B.A)(sm,[['__scopeId','data-v-4d4216a6']]),cm={class:'variable-manager-panel'},im={class:'panel-header'},dm={class:'header-left'},um={class:'header-actions'},mm=['disabled'],pm={class:'toolbar'},vm={class:'search-box'},fm={class:'view-options'},gm={class:'option-toggle'},hm={key:0,class:'state-container'},ym={class:'tree-view'},Vm={class:'tree-root'},Nm={class:'status-bar'},Em={class:'stat-item'},km={key:0,class:'stat-item'},bm={key:1,class:'stat-item'},Cm={class:'modal-dialog'},wm={class:'modal-header'},Sm={class:'modal-body'},Bm={class:'form-group'},Im={class:'path-input-group'},Mm={key:0,class:'path-prefix'},Am={class:'form-group'},Dm={class:'type-selector'},xm=['onClick'],_m={class:'type-icon'},Tm={class:'type-name'},$m={key:0,class:'form-group'},Rm={key:2,class:'boolean-toggle'},Lm={class:'modal-footer'},Pm=['disabled'],Om=(0,l.defineComponent)({__name:'VariableManagerPanel',emits:['close','variable-updated'],setup(e,{emit:t}){const a=t,n=sl(),o=(0,l.ref)(null),s=(0,l.ref)(''),r=(0,l.ref)(!1),c=(0,l.ref)(new Set),i=(0,l.ref)(null),d=(0,l.ref)(!1),u=(0,l.ref)(''),m=(0,l.ref)(!1),p=(0,l.ref)(null),v=(0,l.ref)(''),f=(0,l.ref)('string'),g=(0,l.ref)(''),h=[{value:'string',label:'å­—ç¬¦ä¸²',icon:'T'},{value:'number',label:'æ•°å­—',icon:'#'},{value:'boolean',label:'å¸ƒå°”',icon:'?'},{value:'object',label:'å¯¹è±¡',icon:'{}'},{value:'array',label:'æ•°ç»„',icon:'[]'},{value:'null',label:'ç©ºå€¼',icon:'Ã¸'}],y=(0,l.computed)(()=>n.isMvuAvailable),V=(0,l.computed)(()=>n.statData),N=(0,l.computed)(()=>{if(!V.value)return{};const e=(t,a='')=>{if(null===t||'object'!=typeof t)return t;if(Array.isArray(t))return t.map((t,n)=>e(t,`${a}[${n}]`));const n={};for(const[o,l]of Object.entries(t)){if(!r.value&&'$meta'===o)continue;const t=a?`${a}.${o}`:o;if(s.value){const a=s.value.toLowerCase(),r=t.toLowerCase().includes(a),i='object'!=typeof l||null===l?String(l).toLowerCase().includes(a):JSON.stringify(l).toLowerCase().includes(a);if(!r&&!i){if('object'==typeof l&&null!==l){const a=e(l,t);(Object.keys(a).length>0||Array.isArray(a)&&a.length>0)&&(n[o]=a,c.value.add(t))}continue}{const e=t.split('.');let a='';for(const t of e)a=a?`${a}.${t}`:t,c.value.add(a)}}n[o]='object'==typeof l&&null!==l?e(l,t):l}return n};return e(V.value)}),E=(0,l.computed)(()=>{const e=t=>{if(null===t||'object'!=typeof t)return 1;let a=0;const n=Array.isArray(t)?t:Object.values(t);for(const t of n)'object'==typeof t&&null!==t?a+=e(t):a++;return a};return V.value?e(V.value):0});function k(e){c.value.has(e)?c.value.delete(e):c.value.add(e)}function b(){const e=(t,a='')=>{if(null!==t&&'object'==typeof t)if(Array.isArray(t))t.forEach((t,n)=>{const o=`${a}[${n}]`;'object'==typeof t&&null!==t&&(c.value.add(o),e(t,o))});else for(const[n,o]of Object.entries(t)){if(!r.value&&'$meta'===n)continue;const t=a?`${a}.${n}`:n;'object'==typeof o&&null!==o&&(c.value.add(t),e(o,t))}};V.value&&e(V.value)}function C(){c.value.clear()}async function w(){d.value=!0;try{await n.refresh(),u.value=(new Date).toLocaleTimeString()}catch(e){console.error('[VariableManager] åˆ·æ–°å¤±è´¥:',e)}finally{d.value=!1}}function S(e){i.value=e}async function B(e,t){try{await n.setVariable(e,t,'å˜é‡ç®¡ç†å™¨ç¼–è¾‘')&&(a('variable-updated',e,t),await w())}catch(e){console.error('[VariableManager] ä¿å­˜å¤±è´¥:',e)}finally{i.value=null}}function I(){i.value=null}async function M(e){if(confirm(`ç¡®å®šè¦åˆ é™¤å˜é‡ "${e}" å—ï¼Ÿ`))try{await n.setVariable(e,void 0,'å˜é‡ç®¡ç†å™¨åˆ é™¤')&&await w()}catch(e){console.error('[VariableManager] åˆ é™¤å¤±è´¥:',e)}}function A(e){p.value=e,v.value='',f.value='string',g.value='',m.value=!0}async function D(e){try{await navigator.clipboard.writeText(e)}catch(e){console.error('[VariableManager] å¤åˆ¶å¤±è´¥:',e)}}function x(){p.value=null,v.value='',f.value='string',g.value='',m.value=!0}function T(){m.value=!1,p.value=null}async function R(){if(!v.value.trim())return;const e=p.value?`${p.value}.${v.value.trim()}`:v.value.trim();let t;switch(f.value){case'string':t=g.value||'';break;case'number':t='number'==typeof g.value?g.value:0;break;case'boolean':t=!0===g.value;break;case'object':t={};break;case'array':t=[];break;case'null':t=null}try{await n.setVariable(e,t,'å˜é‡ç®¡ç†å™¨æ–°å¢')&&(a('variable-updated',e,t),p.value&&c.value.add(p.value),await w(),T())}catch(e){console.error('[VariableManager] æ·»åŠ å¤±è´¥:',e)}}return(0,l.onMounted)(async()=>{if(V.value&&0!==Object.keys(V.value).length?u.value=(new Date).toLocaleTimeString():await w(),V.value)for(const e of Object.keys(V.value))(r.value||'$meta'!==e)&&c.value.add(e)}),(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',cm,[(0,l.createCommentVNode)(' é¢æ¿å¤´éƒ¨ '),(0,l.createElementVNode)('div',im,[(0,l.createElementVNode)('div',dm,[t[9]||(t[9]=(0,l.createElementVNode)('span',{class:'header-title'},'å˜é‡ç®¡ç†å™¨',-1)),(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(['status-dot',{connected:y.value}])},null,2)]),(0,l.createElementVNode)('div',um,[(0,l.createElementVNode)('button',{class:'btn-text',onClick:x,title:'åœ¨æ ¹çº§æ·»åŠ å˜é‡'},[...t[10]||(t[10]=[(0,l.createElementVNode)('span',{class:'btn-icon'},'+',-1),(0,l.createElementVNode)('span',{class:'btn-label'},'æ–°å¢',-1)])]),(0,l.createElementVNode)('button',{class:'btn-icon-only',onClick:b,title:'å±•å¼€å…¨éƒ¨'},[...t[11]||(t[11]=[(0,l.createElementVNode)('svg',{viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'2'},[(0,l.createElementVNode)('path',{d:'M4 4h16M4 12h16M4 20h16'}),(0,l.createElementVNode)('path',{d:'M9 8l3-3 3 3M9 16l3 3 3-3'})],-1)])]),(0,l.createElementVNode)('button',{class:'btn-icon-only',onClick:C,title:'æŠ˜å å…¨éƒ¨'},[...t[12]||(t[12]=[(0,l.createElementVNode)('svg',{viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'2'},[(0,l.createElementVNode)('path',{d:'M4 4h16M4 12h16M4 20h16'}),(0,l.createElementVNode)('path',{d:'M9 4l3 3 3-3M9 20l3-3 3 3'})],-1)])]),(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['btn-icon-only',{loading:d.value}]),onClick:w,disabled:d.value},[...t[13]||(t[13]=[(0,l.createElementVNode)('svg',{class:'icon-refresh',viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'2'},[(0,l.createElementVNode)('path',{d:'M23 4v6h-6M1 20v-6h6M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15'})],-1)])],10,mm),(0,l.createElementVNode)('button',{class:'btn-icon-only btn-close',onClick:t[0]||(t[0]=t=>e.$emit('close'))},[...t[14]||(t[14]=[(0,l.createElementVNode)('svg',{viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'2'},[(0,l.createElementVNode)('path',{d:'M18 6L6 18M6 6l12 12'})],-1)])])])]),(0,l.createCommentVNode)(' å·¥å…·æ  '),(0,l.createElementVNode)('div',pm,[(0,l.createCommentVNode)(' æœç´¢æ¡† '),(0,l.createElementVNode)('div',vm,[t[16]||(t[16]=(0,l.createElementVNode)('svg',{class:'search-icon',viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'2'},[(0,l.createElementVNode)('circle',{cx:'11',cy:'11',r:'8'}),(0,l.createElementVNode)('path',{d:'M21 21l-4.35-4.35'})],-1)),(0,l.withDirectives)((0,l.createElementVNode)('input',{'onUpdate:modelValue':t[1]||(t[1]=e=>s.value=e),type:'text',placeholder:'æœç´¢å˜é‡è·¯å¾„æˆ–å€¼...',class:'search-input'},null,512),[[l.vModelText,s.value]]),s.value?((0,l.openBlock)(),(0,l.createElementBlock)('button',{key:0,class:'btn-clear',onClick:t[2]||(t[2]=e=>s.value='')},[...t[15]||(t[15]=[(0,l.createElementVNode)('svg',{viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'2'},[(0,l.createElementVNode)('path',{d:'M18 6L6 18M6 6l12 12'})],-1)])])):(0,l.createCommentVNode)('v-if',!0)]),(0,l.createCommentVNode)(' æ˜¾ç¤ºé€‰é¡¹ '),(0,l.createElementVNode)('div',fm,[(0,l.createElementVNode)('label',gm,[(0,l.withDirectives)((0,l.createElementVNode)('input',{type:'checkbox','onUpdate:modelValue':t[3]||(t[3]=e=>r.value=e)},null,512),[[l.vModelCheckbox,r.value]]),t[17]||(t[17]=(0,l.createElementVNode)('span',null,'æ˜¾ç¤º $meta',-1))])])]),(0,l.createCommentVNode)(' ä¸»å†…å®¹åŒº - æ ‘å½¢è§†å›¾ '),(0,l.createElementVNode)('div',{class:'main-content',ref_key:'treeContainerRef',ref:o},[(0,l.createCommentVNode)(' åŠ è½½çŠ¶æ€ '),d.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',hm,[...t[18]||(t[18]=[(0,l.createElementVNode)('div',{class:'loading-spinner'},null,-1),(0,l.createElementVNode)('span',{class:'state-text'},'æ­£åœ¨åŠ è½½...',-1)])])):V.value&&0!==Object.keys(V.value).length?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:2},[(0,l.createCommentVNode)(' æ ‘å½¢è§†å›¾ '),(0,l.createElementVNode)('div',ym,[(0,l.createElementVNode)('div',Vm,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(N.value,(e,t)=>((0,l.openBlock)(),(0,l.createBlock)(rm,{key:String(t),name:String(t),value:e,path:String(t),depth:0,'expanded-paths':c.value,'editing-path':i.value,'search-query':s.value,onToggle:k,onEdit:S,onSave:B,onCancel:I,onDelete:M,onAddChild:A,onCopyPath:D},null,8,['name','value','path','expanded-paths','editing-path','search-query']))),128))])])],2112)):((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createCommentVNode)(' ç©ºæ•°æ®çŠ¶æ€ '),(0,l.createElementVNode)('div',{class:'state-container'},[t[19]||(t[19]=(0,l.createElementVNode)('svg',{class:'state-icon',viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'1.5'},[(0,l.createElementVNode)('rect',{x:'3',y:'3',width:'18',height:'18',rx:'2'}),(0,l.createElementVNode)('path',{d:'M9 9h6M9 13h6M9 17h4'})],-1)),t[20]||(t[20]=(0,l.createElementVNode)('span',{class:'state-text'},'æš‚æ— å˜é‡æ•°æ®',-1)),(0,l.createElementVNode)('button',{class:'btn-primary',onClick:w},'åˆ·æ–°')])],2112))],512),(0,l.createCommentVNode)(' åº•éƒ¨çŠ¶æ€æ  '),(0,l.createElementVNode)('div',Nm,[(0,l.createElementVNode)('span',Em,'å…± '+(0,l.toDisplayString)(E.value)+' ä¸ªå¶å­èŠ‚ç‚¹',1),c.value.size>0?((0,l.openBlock)(),(0,l.createElementBlock)('span',km,'å·²å±•å¼€ '+(0,l.toDisplayString)(c.value.size)+' é¡¹',1)):(0,l.createCommentVNode)('v-if',!0),u.value?((0,l.openBlock)(),(0,l.createElementBlock)('span',bm,'æ›´æ–°äº '+(0,l.toDisplayString)(u.value),1)):(0,l.createCommentVNode)('v-if',!0)]),(0,l.createCommentVNode)(' æ·»åŠ å˜é‡å¯¹è¯æ¡† '),m.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'modal-overlay',onClick:(0,l.withModifiers)(T,['self'])},[(0,l.createElementVNode)('div',Cm,[(0,l.createElementVNode)('div',wm,[(0,l.createElementVNode)('h3',null,(0,l.toDisplayString)(p.value?'æ·»åŠ å­å˜é‡':'æ·»åŠ æ–°å˜é‡'),1),(0,l.createElementVNode)('button',{class:'btn-close-modal',onClick:T},[...t[21]||(t[21]=[(0,l.createElementVNode)('svg',{viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'2'},[(0,l.createElementVNode)('path',{d:'M18 6L6 18M6 6l12 12'})],-1)])])]),(0,l.createElementVNode)('div',Sm,[(0,l.createElementVNode)('div',Bm,[t[22]||(t[22]=(0,l.createElementVNode)('label',{class:'form-label'},'å˜é‡åç§°',-1)),(0,l.createElementVNode)('div',Im,[p.value?((0,l.openBlock)(),(0,l.createElementBlock)('span',Mm,(0,l.toDisplayString)(p.value)+'.',1)):(0,l.createCommentVNode)('v-if',!0),(0,l.withDirectives)((0,l.createElementVNode)('input',{'onUpdate:modelValue':t[4]||(t[4]=e=>v.value=e),type:'text',placeholder:'è¾“å…¥å˜é‡å...',class:'form-input',onKeydown:(0,l.withKeys)(R,['enter'])},null,544),[[l.vModelText,v.value]])])]),(0,l.createElementVNode)('div',Am,[t[23]||(t[23]=(0,l.createElementVNode)('label',{class:'form-label'},'ç±»å‹',-1)),(0,l.createElementVNode)('div',Dm,[((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(h,e=>(0,l.createElementVNode)('button',{key:e.value,class:(0,l.normalizeClass)(['type-option',{active:f.value===e.value,[`type-${e.value}`]:!0}]),onClick:t=>f.value=e.value},[(0,l.createElementVNode)('span',_m,(0,l.toDisplayString)(e.icon),1),(0,l.createElementVNode)('span',Tm,(0,l.toDisplayString)(e.label),1)],10,xm)),64))])]),'object'!==f.value&&'array'!==f.value&&'null'!==f.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',$m,[t[24]||(t[24]=(0,l.createElementVNode)('label',{class:'form-label'},'åˆå§‹å€¼',-1)),'string'===f.value?(0,l.withDirectives)(((0,l.openBlock)(),(0,l.createElementBlock)('input',{key:0,'onUpdate:modelValue':t[5]||(t[5]=e=>g.value=e),type:'text',placeholder:'è¾“å…¥å­—ç¬¦ä¸²å€¼...',class:'form-input'},null,512)),[[l.vModelText,g.value]]):'number'===f.value?(0,l.withDirectives)(((0,l.openBlock)(),(0,l.createElementBlock)('input',{key:1,'onUpdate:modelValue':t[6]||(t[6]=e=>g.value=e),type:'number',step:'any',placeholder:'è¾“å…¥æ•°å­—...',class:'form-input'},null,512)),[[l.vModelText,g.value,void 0,{number:!0}]]):'boolean'===f.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',Rm,[(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['bool-btn',{active:!0===g.value}]),onClick:t[7]||(t[7]=e=>g.value=!0)},' true ',2),(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['bool-btn',{active:!1===g.value}]),onClick:t[8]||(t[8]=e=>g.value=!1)},' false ',2)])):(0,l.createCommentVNode)('v-if',!0)])):(0,l.createCommentVNode)('v-if',!0)]),(0,l.createElementVNode)('div',Lm,[(0,l.createElementVNode)('button',{class:'btn-secondary',onClick:T},'å–æ¶ˆ'),(0,l.createElementVNode)('button',{class:'btn-primary',onClick:R,disabled:!v.value.trim()},'æ·»åŠ ',8,Pm)])])])):(0,l.createCommentVNode)('v-if',!0)]))}}),Fm=(0,B.A)(Om,[['__scopeId','data-v-aaba435e']]),jm={class:'dialog-header'},Um={class:'header-left'},zm={class:'header-icon'},Wm={class:'header-status'},Hm={key:0,class:'review-summary'},Gm={class:'tag-name'},Km={class:'tag-status'},Jm={key:1,class:'issues-section'},qm={class:'issues-list'},Ym={class:'issue-icon'},Xm={class:'issue-message'},Zm={key:2,class:'variables-section'},Qm={class:'section-title'},ep={class:'variables-list'},tp={class:'var-path'},ap={class:'var-op'},np={class:'var-value'},op={key:0,class:'more-hint'},lp={class:'content-section'},sp={class:'section-header'},rp={class:'section-actions'},cp={key:0,class:'raw-content'},ip=['innerHTML'],dp={class:'dialog-footer'},up=['disabled'],mp=['disabled'],pp={key:0,class:'loading-spinner'},vp={key:1,class:'btn-icon'},fp=(0,l.defineComponent)({__name:'AIResponseReviewDialog',props:{visible:{type:Boolean,default:!1},reviewResult:{default:null},isProcessing:{type:Boolean,default:!1}},emits:['confirm','rollback','close'],setup(e,{emit:t}){const a=e,n=t,o=(0,l.ref)(!1),s=(0,l.ref)(),r=(0,l.computed)(()=>a.reviewResult?a.reviewResult.passed?'status-passed':'status-failed':'status-pending'),c=(0,l.computed)(()=>{if(!a.reviewResult)return'å®¡æŸ¥ä¸­...';if(a.reviewResult.passed){const e=a.reviewResult.issues.filter(e=>'warning'===e.level).length;return e>0?`é€šè¿‡ (${e}è­¦å‘Š)`:'é€šè¿‡'}return`æœªé€šè¿‡ (${a.reviewResult.issues.filter(e=>'error'===e.level).length}é”™è¯¯)`}),i=(0,l.computed)(()=>a.reviewResult?.gameTextContent?a.reviewResult.gameTextContent.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/\n/g,'<br>'):'<p class="empty-hint">æœªæå–åˆ°æ¸¸æˆæ–‡æœ¬å†…å®¹</p>'),d={thinking:'æ€è€ƒè¿‡ç¨‹',gametxt:'æ¸¸æˆæ–‡æœ¬',å†å²è®°å½•:'å†å²è®°å½•',UpdateVariable:'å˜é‡æ›´æ–°'},u=e=>e.exists?e.isClosed?'tag-ok':'tag-error':'tag-missing',m=e=>e.exists?e.isClosed?'âœ“':'âœ—':'â—‹',p=e=>e.exists?e.isClosed?'æ­£å¸¸':`æœªé—­åˆ (${e.openCount}/${e.closeCount})`:'æœªæ‰¾åˆ°',v=e=>{switch(e){case'error':return'âŒ';case'warning':return'âš ï¸';case'info':return'â„¹ï¸';default:return'â€¢'}},f=e=>{switch(e){case'set':return'=';case'add':return'+=';case'subtract':return'-=';case'append':return'<<';case'remove':return'DEL';default:return'?'}},g=e=>{if(null===e)return'null';if(void 0===e)return'undefined';if('string'==typeof e){const t=30;return e.length>t?`"${e.substring(0,t)}..."`:`"${e}"`}if('object'==typeof e){const t=JSON.stringify(e);return t.length>30?t.substring(0,30)+'...':t}return String(e)},h=()=>{n('confirm')},y=()=>{n('rollback')},V=()=>{},N=()=>{o.value=!o.value};return(0,l.watch)(()=>a.visible,e=>{e&&(o.value=!1,(0,l.nextTick)(()=>{s.value&&(s.value.scrollTop=0)}))}),(t,a)=>((0,l.openBlock)(),(0,l.createBlock)(l.Transition,{name:'review-dialog'},{default:(0,l.withCtx)(()=>[e.visible?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'review-dialog-overlay',onClick:(0,l.withModifiers)(V,['self'])},[(0,l.createElementVNode)('div',{class:(0,l.normalizeClass)(['review-dialog',{'has-errors':!e.reviewResult?.passed}])},[(0,l.createCommentVNode)(' å¯¹è¯æ¡†å¤´éƒ¨ '),(0,l.createElementVNode)('div',jm,[(0,l.createElementVNode)('div',Um,[(0,l.createElementVNode)('span',zm,(0,l.toDisplayString)(e.reviewResult?.passed?'âœ…':'âš ï¸'),1),a[0]||(a[0]=(0,l.createElementVNode)('h3',{class:'header-title'},'AIè¾“å‡ºå®¡æŸ¥',-1))]),(0,l.createElementVNode)('div',Wm,[(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(['status-badge',r.value])},(0,l.toDisplayString)(c.value),3)])]),(0,l.createCommentVNode)(' å®¡æŸ¥æ‘˜è¦ '),e.reviewResult?((0,l.openBlock)(),(0,l.createElementBlock)('div',Hm,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.reviewResult.tagChecks,(e,t)=>{return(0,l.openBlock)(),(0,l.createElementBlock)('div',{key:t,class:'summary-item'},[(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(['tag-icon',u(e)])},(0,l.toDisplayString)(m(e)),3),(0,l.createElementVNode)('span',Gm,(0,l.toDisplayString)((a=e.tagName,d[a]||a)),1),(0,l.createElementVNode)('span',Km,(0,l.toDisplayString)(p(e)),1)]);var a}),128))])):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' é—®é¢˜åˆ—è¡¨ '),e.reviewResult&&e.reviewResult.issues.length>0?((0,l.openBlock)(),(0,l.createElementBlock)('div',Jm,[a[1]||(a[1]=(0,l.createElementVNode)('div',{class:'section-title'},[(0,l.createElementVNode)('span',{class:'section-icon'},'ğŸ“‹'),(0,l.createElementVNode)('span',null,'é—®é¢˜åˆ—è¡¨')],-1)),(0,l.createElementVNode)('div',qm,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.reviewResult.issues,(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:t,class:(0,l.normalizeClass)(['issue-item',`issue-${e.level}`])},[(0,l.createElementVNode)('span',Ym,(0,l.toDisplayString)(v(e.level)),1),(0,l.createElementVNode)('span',Xm,(0,l.toDisplayString)(e.message),1)],2))),128))])])):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' å˜é‡æ›´æ–°é¢„è§ˆ '),e.reviewResult?.variableCheck?.commands?.length?((0,l.openBlock)(),(0,l.createElementBlock)('div',Zm,[(0,l.createElementVNode)('div',Qm,[a[2]||(a[2]=(0,l.createElementVNode)('span',{class:'section-icon'},'ğŸ“Š',-1)),(0,l.createElementVNode)('span',null,'å˜é‡æ›´æ–°é¢„è§ˆ ('+(0,l.toDisplayString)(e.reviewResult.variableCheck.commands.length)+'æ¡)',1)]),(0,l.createElementVNode)('div',ep,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.reviewResult.variableCheck.commands.slice(0,10),(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:t,class:'variable-item'},[(0,l.createElementVNode)('span',tp,(0,l.toDisplayString)(e.path),1),(0,l.createElementVNode)('span',ap,(0,l.toDisplayString)(f(e.operation)),1),(0,l.createElementVNode)('span',np,(0,l.toDisplayString)(g(e.value)),1)]))),128)),e.reviewResult.variableCheck.commands.length>10?((0,l.openBlock)(),(0,l.createElementBlock)('div',op,' ... è¿˜æœ‰ '+(0,l.toDisplayString)(e.reviewResult.variableCheck.commands.length-10)+' æ¡ ',1)):(0,l.createCommentVNode)('v-if',!0)])])):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' AIå›å¤å†…å®¹é¢„è§ˆ '),(0,l.createElementVNode)('div',lp,[(0,l.createElementVNode)('div',sp,[a[3]||(a[3]=(0,l.createElementVNode)('div',{class:'section-title'},[(0,l.createElementVNode)('span',{class:'section-icon'},'ğŸ“'),(0,l.createElementVNode)('span',null,'AIå›å¤å†…å®¹')],-1)),(0,l.createElementVNode)('div',rp,[(0,l.createElementVNode)('button',{class:'btn-toggle',onClick:N},(0,l.toDisplayString)(o.value?'æ˜¾ç¤ºè§£æå†…å®¹':'æ˜¾ç¤ºåŸå§‹å†…å®¹'),1)])]),(0,l.createElementVNode)('div',{ref_key:'contentPreview',ref:s,class:'content-preview'},[o.value?((0,l.openBlock)(),(0,l.createElementBlock)('pre',cp,(0,l.toDisplayString)(e.reviewResult?.originalText),1)):((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:1,class:'parsed-content',innerHTML:i.value},null,8,ip))],512)]),(0,l.createCommentVNode)(' å¯¹è¯æ¡†åº•éƒ¨æŒ‰é’® '),(0,l.createElementVNode)('div',dp,[(0,l.createElementVNode)('button',{class:'btn btn-rollback',disabled:e.isProcessing,onClick:y},[...a[4]||(a[4]=[(0,l.createElementVNode)('span',{class:'btn-icon'},'â†©ï¸',-1),(0,l.createElementVNode)('span',null,'å›é€€å–æ¶ˆ',-1)])],8,up),(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['btn btn-confirm',{'btn-warning':!e.reviewResult?.passed}]),disabled:e.isProcessing,onClick:h},[e.isProcessing?((0,l.openBlock)(),(0,l.createElementBlock)('span',pp)):((0,l.openBlock)(),(0,l.createElementBlock)('span',vp,(0,l.toDisplayString)(e.reviewResult?.passed?'âœ“':'âš ï¸'),1)),(0,l.createElementVNode)('span',null,(0,l.toDisplayString)(e.reviewResult?.passed?'ç¡®è®¤åº”ç”¨':'å¼ºåˆ¶åº”ç”¨'),1)],10,mp)])],2)])):(0,l.createCommentVNode)('v-if',!0)]),_:1}))}}),gp=(0,B.A)(fp,[['__scopeId','data-v-1d15335f']]);const hp=new class{state;initialized=!1;enabled=!0;constructor(){this.state={mode:'segmented',config:{...Kd},historyRecords:[],historyTexts:[],segmentedContent:null,isProcessing:!1,lastUpdateTime:0,error:null}}isEnabled(){return this.enabled}enable(){this.enabled=!0,console.log('[ContextManager] ä¸Šä¸‹æ–‡ç®¡ç†åŠŸèƒ½å·²å¯ç”¨')}disable(){this.enabled=!1,console.log('[ContextManager] ä¸Šä¸‹æ–‡ç®¡ç†åŠŸèƒ½å·²ç¦ç”¨ï¼ˆå°†ä½¿ç”¨å¤–æŒ‚ä¸–ç•Œä¹¦ï¼‰')}setEnabled(e){this.enabled=e,console.log('[ContextManager] ä¸Šä¸‹æ–‡ç®¡ç†åŠŸèƒ½å·²'+(e?'å¯ç”¨':'ç¦ç”¨'))}async initialize(){try{return console.log('[ContextManager] æ­£åœ¨åˆå§‹åŒ–...'),this.enabled?(await Zd.initialize(),await this.loadFromWorldbook(),this.initialized=!0,console.log('[ContextManager] åˆå§‹åŒ–å®Œæˆ'),!0):(console.log('[ContextManager] ä¸Šä¸‹æ–‡ç®¡ç†åŠŸèƒ½å·²ç¦ç”¨ï¼Œè·³è¿‡åˆå§‹åŒ–ä¸–ç•Œä¹¦æœåŠ¡'),this.initialized=!0,!0)}catch(e){return console.error('[ContextManager] åˆå§‹åŒ–å¤±è´¥:',e),this.state.error=e instanceof Error?e.message:'åˆå§‹åŒ–å¤±è´¥',!1}}async loadFromWorldbook(){if(this.enabled)try{const e=await Zd.getEntryContent(Gd.HISTORY_RECORD);this.state.historyRecords=Xd.parseRecords(e);const t=await Zd.getEntryContent(Gd.HISTORY_TEXT);this.state.historyTexts=Xd.parseHistoryTexts(t),console.log(`[ContextManager] å·²åŠ è½½ ${this.state.historyRecords.length} æ¡å†å²è®°å½•ï¼Œ${this.state.historyTexts.length} æ¡å†å²æ­£æ–‡`)}catch(e){console.error('[ContextManager] ä»ä¸–ç•Œä¹¦åŠ è½½æ•°æ®å¤±è´¥:',e)}else console.log('[ContextManager] åŠŸèƒ½å·²ç¦ç”¨ï¼Œè·³è¿‡ä»ä¸–ç•Œä¹¦åŠ è½½æ•°æ®')}getState(){return this.state}getConfig(){return{...this.state.config}}async setConfig(e){this.state.config={...this.state.config,...e},await this.regenerateSegments()}async setSegmentCount(e){await this.setConfig({segmentCount:Math.max(0,e)})}async setSmallSummaryCount(e){await this.setConfig({smallSummaryCount:Math.max(0,e)})}getMode(){return this.state.mode}async switchMode(e){e!==this.state.mode&&(this.state.mode=e,'full'===e?await Zd.switchToFullMode():(await Zd.switchToSegmentedMode(),await this.regenerateSegments()),console.log(`[ContextManager] å·²åˆ‡æ¢åˆ°${'full'===e?'å…¨é‡':'åˆ†æ®µ'}æ¨¡å¼`))}calculateRanges(e,t,a){const n={totalCount:e,segmentRange:null,smallSummaryRange:null,largeSummaryRange:null};if(0===e)return n;if(t>0&&e>0){const a=Math.max(1,e-t+1),o=e;n.segmentRange=[a,o]}const o=t>0?Math.max(0,e-t):e;if(a>0&&o>0){const e=Math.max(1,o-a+1);n.smallSummaryRange=[e,o]}const l=a>0&&n.smallSummaryRange?n.smallSummaryRange[0]-1:t>0&&n.segmentRange?n.segmentRange[0]-1:e;return l>=1&&(n.largeSummaryRange=[1,l]),n}generateSegmentedContent(){const{historyRecords:e,historyTexts:t,config:a}=this.state,{segmentCount:n,smallSummaryCount:o}=a,l=e.length,s=this.calculateRanges(l,n,o);let r='';if(n>0&&t.length>0){const e=Math.max(0,t.length-n),a=t.slice(e);r=Xd.formatSegmentedText(a)}let c='';if(s.smallSummaryRange){const[t,a]=s.smallSummaryRange,n=e.slice(t-1,a);c=Xd.formatSmallSummary(n)}let i='';if(s.largeSummaryRange){const[t,a]=s.largeSummaryRange,n=e.slice(t-1,a);i=Xd.formatLargeSummary(n)}return{segmentedText:r,smallSummary:c,largeSummary:i,ranges:s}}async regenerateSegments(){if(!this.enabled)return console.log('[ContextManager] åŠŸèƒ½å·²ç¦ç”¨ï¼Œè·³è¿‡åˆ†æ®µç”Ÿæˆ'),!0;try{this.state.isProcessing=!0,this.state.error=null;if(!(this.state.historyRecords.length>0||this.state.historyTexts.length>0))return console.log('[ContextManager] æ²¡æœ‰å†å²æ•°æ®ï¼Œè·³è¿‡åˆ†æ®µç”Ÿæˆï¼ˆé¿å…è¦†ç›–ç°æœ‰ä¸–ç•Œä¹¦å†…å®¹ï¼‰'),!0;const e=this.generateSegmentedContent();return this.state.segmentedContent=e,await Zd.setEntryContent(Gd.SEGMENTED_TEXT,e.segmentedText),await Zd.setEntryContent(Gd.SMALL_SUMMARY,e.smallSummary),await Zd.setEntryContent(Gd.LARGE_SUMMARY,e.largeSummary),this.state.lastUpdateTime=Date.now(),console.log('[ContextManager] åˆ†æ®µå†…å®¹å·²æ›´æ–°',{åˆ†æ®µæ­£æ–‡æ¡æ•°:e.ranges.segmentRange?e.ranges.segmentRange[1]-e.ranges.segmentRange[0]+1:0,å°æ€»ç»“æ¡æ•°:e.ranges.smallSummaryRange?e.ranges.smallSummaryRange[1]-e.ranges.smallSummaryRange[0]+1:0,å¤§æ€»ç»“æ¡æ•°:e.ranges.largeSummaryRange?e.ranges.largeSummaryRange[1]-e.ranges.largeSummaryRange[0]+1:0}),!0}catch(e){return console.error('[ContextManager] é‡æ–°ç”Ÿæˆåˆ†æ®µå¤±è´¥:',e),this.state.error=e instanceof Error?e.message:'ç”Ÿæˆåˆ†æ®µå¤±è´¥',!1}finally{this.state.isProcessing=!1}}async processAIResponse(e){if(!this.enabled)return console.log('[ContextManager] åŠŸèƒ½å·²ç¦ç”¨ï¼Œè·³è¿‡å¤„ç†AIå›å¤'),!1;try{this.state.isProcessing=!0,this.state.error=null;let t=!1;const a=Xd.extractGameTextTag(e);if(a){const e=await Zd.getEntryContent(Gd.HISTORY_TEXT),n=Xd.appendText(e,a);await Zd.setEntryContent(Gd.HISTORY_TEXT,n);const o=this.state.historyTexts.length+1;this.state.historyTexts.push({åºå·:o,å†…å®¹:a}),t=!0,console.log('[ContextManager] å·²è¿½åŠ å†å²æ­£æ–‡ï¼Œå½“å‰å…±',this.state.historyTexts.length,'æ¡')}const n=Xd.extractHistoryRecordTag(e);if(n){const e=Xd.parseRecord(n);if(e){const a=await Zd.getEntryContent(Gd.HISTORY_RECORD),o=Xd.appendRecord(a,n);await Zd.setEntryContent(Gd.HISTORY_RECORD,o),this.state.historyRecords.push(e),t=!0,console.log('[ContextManager] å·²è¿½åŠ å†å²è®°å½•ï¼Œå½“å‰å…±',this.state.historyRecords.length,'æ¡')}}return t&&'segmented'===this.state.mode&&await this.regenerateSegments(),this.state.lastUpdateTime=Date.now(),t}catch(e){return console.error('[ContextManager] å¤„ç†AIå›å¤å¤±è´¥:',e),this.state.error=e instanceof Error?e.message:'å¤„ç†AIå›å¤å¤±è´¥',!1}finally{this.state.isProcessing=!1}}getRecordCount(){return this.state.historyRecords.length}getTextCount(){return this.state.historyTexts.length}getLatestRecords(e){return this.state.historyRecords.slice(-e)}getLatestTexts(e){return this.state.historyTexts.slice(-e)}async clearAll(e=!1){if(!this.enabled&&!e)return console.log('[ContextManager] åŠŸèƒ½å·²ç¦ç”¨ï¼Œåªæ¸…ç©ºæœ¬åœ°çŠ¶æ€'),this.state.historyRecords=[],this.state.historyTexts=[],this.state.segmentedContent=null,this.state.lastUpdateTime=Date.now(),!0;try{return this.state.isProcessing=!0,(this.enabled||e)&&(Zd.isAvailable()?(await Zd.clearAllContextEntries(),console.log('[ContextManager] å·²æ¸…ç©ºä¸–ç•Œä¹¦æ¡ç›®')):console.warn('[ContextManager] ä¸–ç•Œä¹¦æœåŠ¡ä¸å¯ç”¨ï¼Œè·³è¿‡æ¸…ç©ºä¸–ç•Œä¹¦æ¡ç›®')),this.state.historyRecords=[],this.state.historyTexts=[],this.state.segmentedContent=null,this.state.lastUpdateTime=Date.now(),console.log('[ContextManager] å·²æ¸…ç©ºæ‰€æœ‰å†å²æ•°æ®'),!0}catch(e){return console.error('[ContextManager] æ¸…ç©ºæ•°æ®å¤±è´¥:',e),this.state.error=e instanceof Error?e.message:'æ¸…ç©ºæ•°æ®å¤±è´¥',!1}finally{this.state.isProcessing=!1}}async getSaveData(){const e=await Zd.getContextSnapshot();return{config:{...this.state.config},worldbookSnapshots:e,timestamp:Date.now()}}async restoreFromSaveData(e){try{return this.state.isProcessing=!0,this.state.config={...e.config},await Zd.restoreFromSnapshot(e.worldbookSnapshots),await this.loadFromWorldbook(),'segmented'===this.state.mode&&await this.regenerateSegments(),this.state.lastUpdateTime=Date.now(),console.log('[ContextManager] å·²ä»å­˜æ¡£æ¢å¤'),!0}catch(e){return console.error('[ContextManager] ä»å­˜æ¡£æ¢å¤å¤±è´¥:',e),this.state.error=e instanceof Error?e.message:'æ¢å¤å¤±è´¥',!1}finally{this.state.isProcessing=!1}}getStatistics(){const e=this.state.segmentedContent?.ranges||this.calculateRanges(this.state.historyRecords.length,this.state.config.segmentCount,this.state.config.smallSummaryCount);return{recordCount:this.state.historyRecords.length,textCount:this.state.historyTexts.length,segmentCount:e.segmentRange?e.segmentRange[1]-e.segmentRange[0]+1:0,smallSummaryCount:e.smallSummaryRange?e.smallSummaryRange[1]-e.smallSummaryRange[0]+1:0,largeSummaryCount:e.largeSummaryRange?e.largeSummaryRange[1]-e.largeSummaryRange[0]+1:0,mode:this.state.mode}}},yp={enabled:!0,saveOnAIResponse:!0,maxAutoSaves:10,autoSavePrefix:'[è‡ªåŠ¨]',debounceMs:1e3},Vp='saves',Np='config',Ep='1.0.0',kp='mc_house_auto_save_config';const bp=new class{db=null;initialized=!1;autoSaveConfig={...yp};autoSaveDebounceTimer=null;lastAutoSaveTime=0;onAutoSaveCallbacks=[];onLoadCompleteCallbacks=[];async initialize(){return!(!this.initialized||!this.db)||(this.loadAutoSaveConfig(),new Promise((e,t)=>{const a=indexedDB.open('MC_House_SaveDB',2);a.onerror=()=>{console.error('[SaveService] æ‰“å¼€æ•°æ®åº“å¤±è´¥:',a.error),t(a.error)},a.onsuccess=()=>{this.db=a.result,this.initialized=!0,console.log('[SaveService] æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ'),e(!0)},a.onupgradeneeded=e=>{const t=e.target.result,a=e.oldVersion;if(t.objectStoreNames.contains(Vp)){if(a<2){const t=e.target.transaction;if(t){const e=t.objectStore(Vp);e.indexNames.contains('isAutoSave')||e.createIndex('isAutoSave','isAutoSave',{unique:!1}),e.indexNames.contains('saveSource')||e.createIndex('saveSource','saveSource',{unique:!1})}}}else{const e=t.createObjectStore(Vp,{keyPath:'id'});e.createIndex('name','name',{unique:!1}),e.createIndex('createdAt','createdAt',{unique:!1}),e.createIndex('updatedAt','updatedAt',{unique:!1}),e.createIndex('isAutoSave','isAutoSave',{unique:!1}),e.createIndex('saveSource','saveSource',{unique:!1})}t.objectStoreNames.contains(Np)||t.createObjectStore(Np,{keyPath:'key'})}}))}generateId(e='save'){return`${e}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}loadAutoSaveConfig(){try{const e=localStorage.getItem(kp);if(e){const t=JSON.parse(e);this.autoSaveConfig={...yp,...t}}}catch(e){console.warn('[SaveService] åŠ è½½è‡ªåŠ¨å­˜æ¡£é…ç½®å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤é…ç½®:',e),this.autoSaveConfig={...yp}}}saveAutoSaveConfigToStorage(){try{localStorage.setItem(kp,JSON.stringify(this.autoSaveConfig))}catch(e){console.error('[SaveService] ä¿å­˜è‡ªåŠ¨å­˜æ¡£é…ç½®å¤±è´¥:',e)}}getAutoSaveConfig(){return{...this.autoSaveConfig}}updateAutoSaveConfig(e){this.autoSaveConfig={...this.autoSaveConfig,...e},this.saveAutoSaveConfigToStorage(),console.log('[SaveService] è‡ªåŠ¨å­˜æ¡£é…ç½®å·²æ›´æ–°:',this.autoSaveConfig)}resetAutoSaveConfig(){this.autoSaveConfig={...yp},this.saveAutoSaveConfigToStorage()}onAutoSave(e){return this.onAutoSaveCallbacks.push(e),()=>{const t=this.onAutoSaveCallbacks.indexOf(e);t>-1&&this.onAutoSaveCallbacks.splice(t,1)}}emitAutoSaveEvent(e,t){this.onAutoSaveCallbacks.forEach(a=>{try{a(e,t)}catch(e){console.error('[SaveService] è‡ªåŠ¨å­˜æ¡£å›è°ƒæ‰§è¡Œå¤±è´¥:',e)}})}onLoadComplete(e){return this.onLoadCompleteCallbacks.push(e),()=>{const t=this.onLoadCompleteCallbacks.indexOf(e);t>-1&&this.onLoadCompleteCallbacks.splice(t,1)}}emitLoadCompleteEvent(e){console.log('[SaveService] è§¦å‘å­˜æ¡£åŠ è½½å®Œæˆäº‹ä»¶ï¼Œé€šçŸ¥',this.onLoadCompleteCallbacks.length,'ä¸ªå›è°ƒ'),this.onLoadCompleteCallbacks.forEach(t=>{try{t(e)}catch(e){console.error('[SaveService] å­˜æ¡£åŠ è½½å®Œæˆå›è°ƒæ‰§è¡Œå¤±è´¥:',e)}})}getMvuData(){try{return'undefined'!=typeof window&&window.Mvu&&window.Mvu.getMvuData({type:'message',message_id:'latest'})||null}catch(e){return console.error('[SaveService] è·å–MVUæ•°æ®å¤±è´¥:',e),null}}async restoreMvuData(e){try{return!('undefined'==typeof window||!window.Mvu)&&(await window.Mvu.replaceMvuData(e,{type:'message',message_id:'latest'}),!0)}catch(e){return console.error('[SaveService] æ¢å¤MVUæ•°æ®å¤±è´¥:',e),!1}}aiContentDataProvider=null;aiContentDataRestorer=null;setAIContentDataProvider(e){this.aiContentDataProvider=e,console.log('[SaveService] AIå†…å®¹æ•°æ®æä¾›è€…å·²æ³¨å†Œ')}setAIContentDataRestorer(e){this.aiContentDataRestorer=e,console.log('[SaveService] AIå†…å®¹æ•°æ®æ¢å¤è€…å·²æ³¨å†Œ')}getAIContentData(){if(this.aiContentDataProvider)try{return this.aiContentDataProvider()}catch(e){console.error('[SaveService] è·å–AIå†…å®¹æ•°æ®å¤±è´¥:',e)}return null}async restoreAIContentData(e){if(this.aiContentDataRestorer&&e)try{const t=this.aiContentDataRestorer(e);return t instanceof Promise&&await t,await new Promise(e=>setTimeout(e,10)),console.log('[SaveService] AIå†…å®¹æ•°æ®å·²æ¢å¤ï¼ˆå«é…’é¦†èŠå¤©å±‚åŒæ­¥ï¼‰'),!0}catch(e){console.error('[SaveService] æ¢å¤AIå†…å®¹æ•°æ®å¤±è´¥:',e)}return!1}async captureMessage0Content(){try{if('function'!=typeof window.TavernHelper?.getChatMessages)return console.warn('[SaveService] TavernHelper.getChatMessages ä¸å¯ç”¨ï¼Œæ— æ³•æ•è·æ¶ˆæ¯0'),null;const e=await window.TavernHelper.getChatMessages('0');if(e&&e.length>0&&e[0]?.message){const t=e[0].message;return console.log('[SaveService] å·²æ•è·æ¶ˆæ¯0å¿«ç…§ï¼Œé•¿åº¦:',t.length),t}return console.warn('[SaveService] æ¶ˆæ¯0ä¸å­˜åœ¨æˆ–å†…å®¹ä¸ºç©º'),null}catch(e){return console.warn('[SaveService] æ•è·æ¶ˆæ¯0å†…å®¹å¤±è´¥:',e),null}}async enrichAIContentDataWithMessage0(e){if(!e)return null;try{const t=await this.captureMessage0Content();if(t)return{...e,chatMessage0Snapshot:t}}catch(e){console.warn('[SaveService] åˆå¹¶æ¶ˆæ¯0å¿«ç…§å¤±è´¥ï¼Œå­˜æ¡£å°†ä»…åŒ…å« lastAIResponse:',e)}return e}async createSave(e,t){try{await this.initialize();const a=this.getMvuData(),n=await hp.getSaveData(),o=this.getAIContentData(),l=await this.enrichAIContentDataWithMessage0(o),s={id:this.generateId(),name:e,createdAt:Date.now(),updatedAt:Date.now(),mvuData:a,contextData:n,aiContentData:l||void 0,version:Ep,customData:t};return await this.putSave(s),console.log('[SaveService] å­˜æ¡£åˆ›å»ºæˆåŠŸ:',s.id,l?'(å«AIå†…å®¹)':'',l?.chatMessage0Snapshot?'(å«æ¶ˆæ¯0å¿«ç…§)':'(æ— æ¶ˆæ¯0å¿«ç…§)'),s}catch(e){return console.error('[SaveService] åˆ›å»ºå­˜æ¡£å¤±è´¥:',e),null}}async updateSave(e,t){try{await this.initialize();const a=await this.getSave(e);if(!a)return console.warn('[SaveService] å­˜æ¡£ä¸å­˜åœ¨:',e),!1;const n=this.getMvuData(),o=await hp.getSaveData(),l=this.getAIContentData(),s=await this.enrichAIContentDataWithMessage0(l),r={...a,updatedAt:Date.now(),mvuData:n,contextData:o,aiContentData:s||a.aiContentData,customData:t||a.customData};return await this.putSave(r),console.log('[SaveService] å­˜æ¡£æ›´æ–°æˆåŠŸ:',e),!0}catch(e){return console.error('[SaveService] æ›´æ–°å­˜æ¡£å¤±è´¥:',e),!1}}async autoSaveOnAIResponse(e){if(!this.autoSaveConfig.enabled||!this.autoSaveConfig.saveOnAIResponse)return console.log('[SaveService] è‡ªåŠ¨å­˜æ¡£æœªå¯ç”¨'),null;const t=Date.now();if(t-this.lastAutoSaveTime<this.autoSaveConfig.debounceMs)return console.log('[SaveService] è‡ªåŠ¨å­˜æ¡£é˜²æŠ–ä¸­ï¼Œè·³è¿‡'),null;this.lastAutoSaveTime=t;try{console.log('[SaveService] å¼€å§‹AIå›å¤åè‡ªåŠ¨å­˜æ¡£...');const t=(new Date).toLocaleString('zh-CN',{month:'2-digit',day:'2-digit',hour:'2-digit',minute:'2-digit'}),a=`${this.autoSaveConfig.autoSavePrefix} ${t}`,n=await this.createAutoSave(a,'ai_response',e);return n&&(await this.cleanupAutoSaves(),this.emitAutoSaveEvent(n)),n}catch(e){const t=e instanceof Error?e.message:'è‡ªåŠ¨å­˜æ¡£å¤±è´¥';return console.error('[SaveService] AIå›å¤åè‡ªåŠ¨å­˜æ¡£å¤±è´¥:',e),this.emitAutoSaveEvent(null,t),null}}async createAutoSave(e,t='auto',a){try{await this.initialize();const n=this.getMvuData(),o=await hp.getSaveData(),l=this.getAIContentData(),s=await this.enrichAIContentDataWithMessage0(l),r={id:this.generateId('auto'),name:e,createdAt:Date.now(),updatedAt:Date.now(),mvuData:n,contextData:o,aiContentData:s||void 0,version:Ep,isAutoSave:!0,saveSource:t,messageId:a};return await this.putSave(r),console.log('[SaveService] è‡ªåŠ¨å­˜æ¡£åˆ›å»ºæˆåŠŸ:',r.id,s?'(å«AIå†…å®¹)':'',s?.chatMessage0Snapshot?'(å«æ¶ˆæ¯0å¿«ç…§)':'(æ— æ¶ˆæ¯0å¿«ç…§)'),r}catch(e){return console.error('[SaveService] åˆ›å»ºè‡ªåŠ¨å­˜æ¡£å¤±è´¥:',e),null}}async cleanupAutoSaves(){try{const e=await this.listAutoSaves();if(e.length<=this.autoSaveConfig.maxAutoSaves)return;const t=e.sort((e,t)=>t.updatedAt-e.updatedAt).slice(this.autoSaveConfig.maxAutoSaves);for(const e of t)await this.deleteSave(e.id),console.log('[SaveService] æ¸…ç†æ—§çš„è‡ªåŠ¨å­˜æ¡£:',e.id);console.log('[SaveService] è‡ªåŠ¨å­˜æ¡£æ¸…ç†å®Œæˆï¼Œåˆ é™¤äº†',t.length,'ä¸ªæ—§å­˜æ¡£')}catch(e){console.error('[SaveService] æ¸…ç†è‡ªåŠ¨å­˜æ¡£å¤±è´¥:',e)}}async listAutoSaves(){return(await this.listSaves()).filter(e=>!0===e.isAutoSave)}async listManualSaves(){return(await this.listSaves()).filter(e=>!0!==e.isAutoSave)}debouncedAutoSave(e){this.autoSaveDebounceTimer&&clearTimeout(this.autoSaveDebounceTimer),this.autoSaveDebounceTimer=setTimeout(async()=>{await this.autoSaveOnAIResponse(e)},this.autoSaveConfig.debounceMs)}cancelDebouncedAutoSave(){this.autoSaveDebounceTimer&&(clearTimeout(this.autoSaveDebounceTimer),this.autoSaveDebounceTimer=null)}async loadSave(e){try{await this.initialize();const t=await this.getSave(e);if(!t)return console.warn('[SaveService] å­˜æ¡£ä¸å­˜åœ¨:',e),!1;console.log('[SaveService] å¼€å§‹åŠ è½½å­˜æ¡£:',e);const a={mvu:!1,context:!1,aiContent:!1};if(t.mvuData)try{a.mvu=await this.restoreMvuData(t.mvuData),a.mvu?console.log('[SaveService] MVUæ•°æ®æ¢å¤æˆåŠŸï¼Œstat_dataé”®:',Object.keys(t.mvuData.stat_data||{})):console.warn('[SaveService] MVUæ•°æ®æ¢å¤å¤±è´¥')}catch(e){console.error('[SaveService] MVUæ•°æ®æ¢å¤å¼‚å¸¸:',e)}else a.mvu=!0;if(t.contextData)try{await hp.restoreFromSaveData(t.contextData),a.context=!0,console.log('[SaveService] ä¸Šä¸‹æ–‡ç®¡ç†æ•°æ®æ¢å¤æˆåŠŸ')}catch(e){console.error('[SaveService] ä¸Šä¸‹æ–‡ç®¡ç†æ•°æ®æ¢å¤å¼‚å¸¸:',e)}else a.context=!0;if(t.aiContentData)try{a.aiContent=await this.restoreAIContentData(t.aiContentData),console.log('[SaveService] AIå†…å®¹æ•°æ®æ¢å¤æˆåŠŸ')}catch(e){console.error('[SaveService] AIå†…å®¹æ•°æ®æ¢å¤å¼‚å¸¸:',e)}else a.aiContent=!0;await new Promise(e=>setTimeout(e,50));const n=a.mvu&&a.context&&a.aiContent;return console.log('[SaveService] å­˜æ¡£åŠ è½½å®Œæˆ:',{id:e,mvu:a.mvu?'æˆåŠŸ':'å¤±è´¥',context:a.context?'æˆåŠŸ':'å¤±è´¥',aiContent:a.aiContent?'æˆåŠŸ':'å¤±è´¥',overall:n?'å…¨éƒ¨æˆåŠŸ':'éƒ¨åˆ†å¤±è´¥'}),this.emitLoadCompleteEvent(t),n||'undefined'==typeof toastr||toastr.warning('éƒ¨åˆ†æ•°æ®æ¢å¤å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ§åˆ¶å°','å­˜æ¡£åŠ è½½è­¦å‘Š',{timeOut:3e3}),n}catch(e){return console.error('[SaveService] åŠ è½½å­˜æ¡£å¤±è´¥:',e),!1}}async getSave(e){return this.db||await this.initialize(),this.db?new Promise((t,a)=>{const n=this.db.transaction([Vp],'readonly').objectStore(Vp).get(e);n.onerror=()=>a(n.error),n.onsuccess=()=>t(n.result||null)}):null}async putSave(e){if(this.db||await this.initialize(),!this.db)throw new Error('æ•°æ®åº“æœªåˆå§‹åŒ–');return new Promise((t,a)=>{const n=this.db.transaction([Vp],'readwrite').objectStore(Vp).put(e);n.onerror=()=>a(n.error),n.onsuccess=()=>t()})}async deleteSave(e){return this.db||await this.initialize(),!!this.db&&new Promise((t,a)=>{const n=this.db.transaction([Vp],'readwrite').objectStore(Vp).delete(e);n.onerror=()=>a(n.error),n.onsuccess=()=>{console.log('[SaveService] å­˜æ¡£åˆ é™¤æˆåŠŸ:',e),t(!0)}})}async listSaves(){return this.db||await this.initialize(),this.db?new Promise((e,t)=>{const a=this.db.transaction([Vp],'readonly').objectStore(Vp).getAll();a.onerror=()=>t(a.error),a.onsuccess=()=>{const t=a.result.map(e=>({id:e.id,name:e.name,createdAt:e.createdAt,updatedAt:e.updatedAt,version:e.version,isAutoSave:e.isAutoSave,saveSource:e.saveSource})).sort((e,t)=>t.updatedAt-e.updatedAt);e(t)}}):[]}async getSaveStats(){const e=await this.listSaves(),t=e.filter(e=>!e.isAutoSave),a=e.filter(e=>e.isAutoSave);return{total:e.length,manual:t.length,auto:a.length,oldestSave:e.length>0?e[e.length-1]:null,newestSave:e.length>0?e[0]:null}}async exportSave(e){try{const t=await this.getSave(e);return t?JSON.stringify(t,null,2):null}catch(e){return console.error('[SaveService] å¯¼å‡ºå­˜æ¡£å¤±è´¥:',e),null}}async importSave(e,t){try{await this.initialize();const a=JSON.parse(e);return a.id=this.generateId(),t&&(a.name=t),a.updatedAt=Date.now(),delete a.isAutoSave,a.saveSource='manual',await this.putSave(a),console.log('[SaveService] å­˜æ¡£å¯¼å…¥æˆåŠŸ:',a.id),a}catch(e){return console.error('[SaveService] å¯¼å…¥å­˜æ¡£å¤±è´¥:',e),null}}async quickSave(){try{const e=await this.listSaves();if(e.length>0)return await this.updateSave(e[0].id);return null!==await this.createSave('å¿«é€Ÿå­˜æ¡£')}catch(e){return console.error('[SaveService] å¿«é€Ÿä¿å­˜å¤±è´¥:',e),!1}}async quickLoad(){try{const e=await this.listSaves();return 0===e.length?(console.warn('[SaveService] æ²¡æœ‰å¯åŠ è½½çš„å­˜æ¡£'),!1):await this.loadSave(e[0].id)}catch(e){return console.error('[SaveService] å¿«é€ŸåŠ è½½å¤±è´¥:',e),!1}}};function Cp(){const e=(0,l.ref)(!1),t=(0,l.ref)(!1),a=(0,l.ref)(null),n=(0,l.ref)([]),o=(0,l.ref)(null),s=(0,l.ref)(bp.getAutoSaveConfig()),r=(0,l.ref)({total:0,manual:0,auto:0,oldestSave:null,newestSave:null}),c=(0,l.ref)(null);let i=null,d=null;const u=(0,l.computed)(()=>n.value.filter(e=>!e.isAutoSave)),m=(0,l.computed)(()=>n.value.filter(e=>!0===e.isAutoSave)),p=(0,l.computed)(()=>n.value.length>0),v=(0,l.computed)(()=>s.value.enabled),f=async()=>{try{return t.value=!0,a.value=null,await bp.initialize(),await g(),await h(),s.value=bp.getAutoSaveConfig(),i=bp.onAutoSave((e,t)=>{e?(c.value={id:e.id,name:e.name,createdAt:e.createdAt,updatedAt:e.updatedAt,version:e.version,isAutoSave:e.isAutoSave,saveSource:e.saveSource},g(),h(),console.log('[useSave] è‡ªåŠ¨å­˜æ¡£å®Œæˆ:',e.name)):t&&console.error('[useSave] è‡ªåŠ¨å­˜æ¡£å¤±è´¥:',t)}),d=bp.onLoadComplete(async e=>{console.log('[useSave] å­˜æ¡£åŠ è½½å®Œæˆï¼Œé€šçŸ¥ mvuStore åˆ·æ–°æ•°æ®...');try{const e=sl();await e.loadMvuData(),console.log('[useSave] mvuStore æ•°æ®å·²åˆ·æ–°ï¼Œstat_data é”®:',Object.keys(e.statData||{}))}catch(e){console.error('[useSave] åˆ·æ–° mvuStore æ•°æ®å¤±è´¥:',e)}}),e.value=!0,!0}catch(e){return a.value=e instanceof Error?e.message:'åˆå§‹åŒ–å¤±è´¥',!1}finally{t.value=!1}},g=async()=>{try{n.value=await bp.listSaves()}catch(e){console.error('[useSave] åˆ·æ–°åˆ—è¡¨å¤±è´¥:',e)}},h=async()=>{try{r.value=await bp.getSaveStats()}catch(e){console.error('[useSave] åˆ·æ–°ç»Ÿè®¡å¤±è´¥:',e)}},y=async e=>{try{return t.value=!0,a.value=null,await bp.exportSave(e)}catch(e){return a.value=e instanceof Error?e.message:'å¯¼å‡ºå­˜æ¡£å¤±è´¥',null}finally{t.value=!1}},V=async(e,n)=>{try{t.value=!0,a.value=null;const o=await bp.importSave(e,n);return o&&await g(),o}catch(e){return a.value=e instanceof Error?e.message:'å¯¼å…¥å­˜æ¡£å¤±è´¥',null}finally{t.value=!1}},N=e=>{bp.updateAutoSaveConfig(e),s.value=bp.getAutoSaveConfig()};return(0,l.onMounted)(()=>{f()}),(0,l.onUnmounted)(()=>{i&&(i(),i=null),d&&(d(),d=null)}),{isInitialized:e,isProcessing:t,error:a,saveList:n,currentSave:o,autoSaveConfig:s,saveStats:r,lastAutoSave:c,manualSaveList:u,autoSaveList:m,hasSaves:p,isAutoSaveEnabled:v,initialize:f,refreshList:g,refreshStats:h,createSave:async(e,n)=>{try{t.value=!0,a.value=null;const l=await bp.createSave(e,n);return l&&(await g(),o.value={id:l.id,name:l.name,createdAt:l.createdAt,updatedAt:l.updatedAt,version:l.version}),l}catch(e){return a.value=e instanceof Error?e.message:'åˆ›å»ºå­˜æ¡£å¤±è´¥',null}finally{t.value=!1}},updateSave:async(e,n)=>{try{t.value=!0,a.value=null;const o=await bp.updateSave(e,n);return o&&await g(),o}catch(e){return a.value=e instanceof Error?e.message:'æ›´æ–°å­˜æ¡£å¤±è´¥',!1}finally{t.value=!1}},loadSave:async e=>{try{t.value=!0,a.value=null;const l=await bp.loadSave(e);if(l){const t=n.value.find(t=>t.id===e);t&&(o.value=t)}return l}catch(e){return a.value=e instanceof Error?e.message:'åŠ è½½å­˜æ¡£å¤±è´¥',!1}finally{t.value=!1}},deleteSave:async e=>{try{t.value=!0,a.value=null;const n=await bp.deleteSave(e);return n&&(await g(),o.value?.id===e&&(o.value=null)),n}catch(e){return a.value=e instanceof Error?e.message:'åˆ é™¤å­˜æ¡£å¤±è´¥',!1}finally{t.value=!1}},exportSave:y,importSave:V,quickSave:async()=>{try{t.value=!0,a.value=null;const e=await bp.quickSave();return e&&await g(),e}catch(e){return a.value=e instanceof Error?e.message:'å¿«é€Ÿä¿å­˜å¤±è´¥',!1}finally{t.value=!1}},quickLoad:async()=>{try{t.value=!0,a.value=null;const e=await bp.quickLoad();return e&&(await g(),n.value.length>0&&(o.value=n.value[0])),e}catch(e){return a.value=e instanceof Error?e.message:'å¿«é€ŸåŠ è½½å¤±è´¥',!1}finally{t.value=!1}},downloadSave:async(e,t)=>{try{const a=await y(e);if(!a)return;const o=n.value.find(t=>t.id===e),l=t||`${o?.name||'save'}_${(new Date).toISOString().slice(0,10)}.json`,s=new Blob([a],{type:'application/json'}),r=URL.createObjectURL(s),c=document.createElement('a');c.href=r,c.download=l,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(r)}catch(e){a.value=e instanceof Error?e.message:'ä¸‹è½½å­˜æ¡£å¤±è´¥'}},uploadSave:async(e,n)=>{try{t.value=!0,a.value=null;const o=await e.text();return await V(o,n)}catch(e){return a.value=e instanceof Error?e.message:'ä¸Šä¼ å­˜æ¡£å¤±è´¥',null}finally{t.value=!1}},updateAutoSaveConfig:N,toggleAutoSave:()=>{N({enabled:!s.value.enabled})},toggleSaveOnAIResponse:()=>{N({saveOnAIResponse:!s.value.saveOnAIResponse})},setMaxAutoSaves:e=>{e>=1&&e<=50&&N({maxAutoSaves:e})},setAutoSavePrefix:e=>{N({autoSavePrefix:e||'[è‡ªåŠ¨]'})},resetAutoSaveConfig:()=>{bp.resetAutoSaveConfig(),s.value=bp.getAutoSaveConfig()},triggerAutoSave:async()=>{try{t.value=!0,a.value=null;const e=await bp.autoSaveOnAIResponse();return e&&(await g(),await h()),e}catch(e){return a.value=e instanceof Error?e.message:'è‡ªåŠ¨å­˜æ¡£å¤±è´¥',null}finally{t.value=!1}},clearAllAutoSaves:async()=>{try{t.value=!0,a.value=null;const e=await bp.listAutoSaves();for(const t of e)await bp.deleteSave(t.id);return await g(),await h(),console.log('[useSave] å·²æ¸…ç†æ‰€æœ‰è‡ªåŠ¨å­˜æ¡£ï¼Œå…±',e.length,'ä¸ª'),!0}catch(e){return a.value=e instanceof Error?e.message:'æ¸…ç†è‡ªåŠ¨å­˜æ¡£å¤±è´¥',!1}finally{t.value=!1}},convertAutoSaveToManual:async(e,n)=>{try{t.value=!0,a.value=null;const o=await bp.getSave(e);if(!o||!o.isAutoSave)return a.value='å­˜æ¡£ä¸å­˜åœ¨æˆ–ä¸æ˜¯è‡ªåŠ¨å­˜æ¡£',!1;const l=await bp.exportSave(e);if(!l)return a.value='å¯¼å‡ºå­˜æ¡£å¤±è´¥',!1;return!!await bp.importSave(l,n||o.name.replace(/^\[è‡ªåŠ¨\]\s*/,''))&&(await bp.deleteSave(e),await g(),await h(),!0)}catch(e){return a.value=e instanceof Error?e.message:'è½¬æ¢å­˜æ¡£å¤±è´¥',!1}finally{t.value=!1}},service:bp}}const wp={class:'auto-save-settings'},Sp={class:'setting-item'},Bp={class:'toggle-switch'},Ip=['checked'],Mp={class:'toggle-switch'},Ap=['checked','disabled'],Dp={class:'setting-control'},xp=['value','disabled'],_p={class:'setting-control'},Tp=['value','disabled'],$p={class:'setting-control'},Rp=['value','disabled'],Lp={class:'status-section'},Pp={class:'status-items'},Op={class:'status-item'},Fp={class:'status-item'},jp={key:0,class:'status-item'},Up={class:'status-value'},zp=(0,l.defineComponent)({__name:'AutoSaveSettings',setup(e){const{autoSaveConfig:t,lastAutoSave:a,toggleAutoSave:n,toggleSaveOnAIResponse:o,setMaxAutoSaves:s,setAutoSavePrefix:r,updateAutoSaveConfig:c,resetAutoSaveConfig:i}=Cp(),d=e=>{const t=e.target,a=parseInt(t.value,10);!isNaN(a)&&a>=1&&a<=50&&s(a)},u=e=>{const t=e.target;r(t.value)},m=e=>{const t=e.target,a=parseInt(t.value,10);!isNaN(a)&&a>=500&&a<=1e4&&c({debounceMs:a})},p=async()=>{await cs('ç¡®å®šè¦é‡ç½®æ‰€æœ‰è‡ªåŠ¨å­˜æ¡£è®¾ç½®ä¸ºé»˜è®¤å€¼å—ï¼Ÿ','é‡ç½®è®¾ç½®')&&i()};return(e,s)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',wp,[s[15]||(s[15]=(0,l.createElementVNode)('h4',{class:'settings-title'},'è‡ªåŠ¨å­˜æ¡£è®¾ç½®',-1)),(0,l.createCommentVNode)(' ä¸»å¼€å…³ '),(0,l.createElementVNode)('div',Sp,[s[3]||(s[3]=(0,l.createElementVNode)('div',{class:'setting-info'},[(0,l.createElementVNode)('div',{class:'setting-label'},'å¯ç”¨è‡ªåŠ¨å­˜æ¡£'),(0,l.createElementVNode)('div',{class:'setting-desc'},'æ€»å¼€å…³ï¼Œå…³é—­åå°†ä¸ä¼šè‡ªåŠ¨åˆ›å»ºä»»ä½•å­˜æ¡£')],-1)),(0,l.createElementVNode)('label',Bp,[(0,l.createElementVNode)('input',{type:'checkbox',checked:(0,l.unref)(t).enabled,onChange:s[0]||(s[0]=(...e)=>(0,l.unref)(n)&&(0,l.unref)(n)(...e))},null,40,Ip),s[2]||(s[2]=(0,l.createElementVNode)('span',{class:'toggle-slider'},null,-1))])]),(0,l.createCommentVNode)(' AIå›å¤åè‡ªåŠ¨å­˜æ¡£ '),(0,l.createElementVNode)('div',{class:(0,l.normalizeClass)(['setting-item',{disabled:!(0,l.unref)(t).enabled}])},[s[5]||(s[5]=(0,l.createElementVNode)('div',{class:'setting-info'},[(0,l.createElementVNode)('div',{class:'setting-label'},'AIå›å¤åè‡ªåŠ¨å­˜æ¡£'),(0,l.createElementVNode)('div',{class:'setting-desc'},'æ¯æ¬¡AIç”Ÿæˆå›å¤ç»“æŸåè‡ªåŠ¨åˆ›å»ºå­˜æ¡£')],-1)),(0,l.createElementVNode)('label',Mp,[(0,l.createElementVNode)('input',{type:'checkbox',checked:(0,l.unref)(t).saveOnAIResponse,disabled:!(0,l.unref)(t).enabled,onChange:s[1]||(s[1]=(...e)=>(0,l.unref)(o)&&(0,l.unref)(o)(...e))},null,40,Ap),s[4]||(s[4]=(0,l.createElementVNode)('span',{class:'toggle-slider'},null,-1))])],2),(0,l.createCommentVNode)(' æœ€å¤§è‡ªåŠ¨å­˜æ¡£æ•°é‡ '),(0,l.createElementVNode)('div',{class:(0,l.normalizeClass)(['setting-item',{disabled:!(0,l.unref)(t).enabled}])},[s[7]||(s[7]=(0,l.createElementVNode)('div',{class:'setting-info'},[(0,l.createElementVNode)('div',{class:'setting-label'},'æœ€å¤§è‡ªåŠ¨å­˜æ¡£æ•°é‡'),(0,l.createElementVNode)('div',{class:'setting-desc'},'è¶…è¿‡æ­¤æ•°é‡æ—¶ä¼šè‡ªåŠ¨åˆ é™¤æœ€æ—§çš„è‡ªåŠ¨å­˜æ¡£')],-1)),(0,l.createElementVNode)('div',Dp,[(0,l.createElementVNode)('input',{type:'number',class:'number-input',value:(0,l.unref)(t).maxAutoSaves,disabled:!(0,l.unref)(t).enabled,min:'1',max:'50',onChange:d},null,40,xp),s[6]||(s[6]=(0,l.createElementVNode)('span',{class:'unit'},'ä¸ª',-1))])],2),(0,l.createCommentVNode)(' è‡ªåŠ¨å­˜æ¡£å‰ç¼€ '),(0,l.createElementVNode)('div',{class:(0,l.normalizeClass)(['setting-item',{disabled:!(0,l.unref)(t).enabled}])},[s[8]||(s[8]=(0,l.createElementVNode)('div',{class:'setting-info'},[(0,l.createElementVNode)('div',{class:'setting-label'},'è‡ªåŠ¨å­˜æ¡£å‰ç¼€'),(0,l.createElementVNode)('div',{class:'setting-desc'},'è‡ªåŠ¨å­˜æ¡£åç§°çš„å‰ç¼€ï¼Œä¾¿äºåŒºåˆ†')],-1)),(0,l.createElementVNode)('div',_p,[(0,l.createElementVNode)('input',{type:'text',class:'text-input',value:(0,l.unref)(t).autoSavePrefix,disabled:!(0,l.unref)(t).enabled,placeholder:'[è‡ªåŠ¨]',onChange:u},null,40,Tp)])],2),(0,l.createCommentVNode)(' é˜²æŠ–é—´éš” '),(0,l.createElementVNode)('div',{class:(0,l.normalizeClass)(['setting-item',{disabled:!(0,l.unref)(t).enabled}])},[s[10]||(s[10]=(0,l.createElementVNode)('div',{class:'setting-info'},[(0,l.createElementVNode)('div',{class:'setting-label'},'é˜²æŠ–é—´éš”'),(0,l.createElementVNode)('div',{class:'setting-desc'},'ä¸¤æ¬¡è‡ªåŠ¨å­˜æ¡£ä¹‹é—´çš„æœ€å°é—´éš”æ—¶é—´')],-1)),(0,l.createElementVNode)('div',$p,[(0,l.createElementVNode)('input',{type:'number',class:'number-input',value:(0,l.unref)(t).debounceMs,disabled:!(0,l.unref)(t).enabled,min:'500',max:'10000',step:'100',onChange:m},null,40,Rp),s[9]||(s[9]=(0,l.createElementVNode)('span',{class:'unit'},'æ¯«ç§’',-1))])],2),(0,l.createCommentVNode)(' é‡ç½®æŒ‰é’® '),(0,l.createElementVNode)('div',{class:'setting-actions'},[(0,l.createElementVNode)('button',{class:'btn btn-secondary',onClick:p},'é‡ç½®ä¸ºé»˜è®¤å€¼')]),(0,l.createCommentVNode)(' å½“å‰çŠ¶æ€ '),(0,l.createElementVNode)('div',Lp,[s[14]||(s[14]=(0,l.createElementVNode)('h5',{class:'status-title'},'å½“å‰çŠ¶æ€',-1)),(0,l.createElementVNode)('div',Pp,[(0,l.createElementVNode)('div',Op,[s[11]||(s[11]=(0,l.createElementVNode)('span',{class:'status-label'},'è‡ªåŠ¨å­˜æ¡£:',-1)),(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(['status-value',{active:(0,l.unref)(t).enabled}])},(0,l.toDisplayString)((0,l.unref)(t).enabled?'å·²å¯ç”¨':'å·²ç¦ç”¨'),3)]),(0,l.createElementVNode)('div',Fp,[s[12]||(s[12]=(0,l.createElementVNode)('span',{class:'status-label'},'AIå›å¤å­˜æ¡£:',-1)),(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(['status-value',{active:(0,l.unref)(t).saveOnAIResponse&&(0,l.unref)(t).enabled}])},(0,l.toDisplayString)((0,l.unref)(t).saveOnAIResponse&&(0,l.unref)(t).enabled?'å·²å¯ç”¨':'å·²ç¦ç”¨'),3)]),(0,l.unref)(a)?((0,l.openBlock)(),(0,l.createElementBlock)('div',jp,[s[13]||(s[13]=(0,l.createElementVNode)('span',{class:'status-label'},'æœ€åå­˜æ¡£:',-1)),(0,l.createElementVNode)('span',Up,(0,l.toDisplayString)((0,l.unref)(a).name),1)])):(0,l.createCommentVNode)('v-if',!0)])]),(0,l.createCommentVNode)(' è¯´æ˜ä¿¡æ¯ '),s[16]||(s[16]=(0,l.createElementVNode)('div',{class:'info-section'},[(0,l.createElementVNode)('h5',{class:'info-title'},'ğŸ’¡ è¯´æ˜'),(0,l.createElementVNode)('ul',{class:'info-list'},[(0,l.createElementVNode)('li',null,'è‡ªåŠ¨å­˜æ¡£ä¼šåœ¨æ¯æ¬¡AIå›å¤ç»“æŸåè‡ªåŠ¨åˆ›å»º'),(0,l.createElementVNode)('li',null,'è‡ªåŠ¨å­˜æ¡£ä¸æ‰‹åŠ¨å­˜æ¡£åˆ†å¼€ç®¡ç†ï¼Œäº’ä¸å½±å“'),(0,l.createElementVNode)('li',null,'è¶…å‡ºæ•°é‡é™åˆ¶æ—¶ï¼Œæœ€æ—§çš„è‡ªåŠ¨å­˜æ¡£ä¼šè¢«è‡ªåŠ¨åˆ é™¤'),(0,l.createElementVNode)('li',null,'å¯ä»¥å°†é‡è¦çš„è‡ªåŠ¨å­˜æ¡£è½¬æ¢ä¸ºæ‰‹åŠ¨å­˜æ¡£ä»¥æ°¸ä¹…ä¿ç•™')])],-1))]))}}),Wp=(0,B.A)(zp,[['__scopeId','data-v-85be2ade']]),Hp={class:'save-manager'},Gp={class:'save-header'},Kp={class:'header-actions'},Jp=['disabled'],qp={class:'save-stats'},Yp={class:'stat-item'},Xp={class:'stat-value'},Zp={class:'stat-item'},Qp={class:'stat-value'},ev={class:'stat-item'},tv={class:'stat-value'},av={class:'tab-bar'},nv={class:'save-content'},ov={key:0,class:'save-list-container'},lv={class:'create-save-section'},sv=['disabled'],rv={key:0,class:'save-list'},cv={class:'save-info'},iv={class:'save-name'},dv={class:'save-time'},uv={class:'save-actions'},mv=['onClick','disabled'],pv=['onClick','disabled'],vv=['onClick','disabled'],fv=['onClick','disabled'],gv={key:1,class:'empty-state'},hv={class:'save-list-container'},yv={class:'auto-save-actions'},Vv=['disabled'],Nv=['disabled'],Ev={key:0,class:'save-list'},kv={class:'save-info'},bv={class:'save-name'},Cv={class:'save-time'},wv={key:0,class:'save-source'},Sv={class:'save-actions'},Bv=['onClick','disabled'],Iv=['onClick','disabled'],Mv=['onClick','disabled'],Av={key:1,class:'empty-state'},Dv={class:'settings-container'},xv={class:'save-footer'},_v={class:'footer-left'},Tv=['disabled'],$v=['disabled'],Rv={class:'footer-right'},Lv={class:'import-btn btn btn-secondary'},Pv={key:0,class:'error-message'},Ov={class:'confirm-dialog'},Fv={class:'confirm-title'},jv={class:'confirm-message'},Uv=(0,l.defineComponent)({__name:'SaveManager',emits:['close','save-loaded','save-created'],setup(e,{emit:t}){const a=t,{isProcessing:n,error:o,saveList:s,currentSave:r,saveStats:c,manualSaveList:i,autoSaveList:d,hasSaves:u,refreshList:m,refreshStats:p,createSave:v,updateSave:f,loadSave:g,deleteSave:h,quickSave:y,quickLoad:V,downloadSave:N,uploadSave:E,triggerAutoSave:k,clearAllAutoSaves:b,convertAutoSaveToManual:C}=Cp(),w=(0,l.ref)('manual'),S=(0,l.ref)(''),B=(0,l.ref)(!1),I=(0,l.ref)(''),M=(0,l.ref)('');let A=null;const D=e=>new Date(e).toLocaleString('zh-CN',{month:'2-digit',day:'2-digit',hour:'2-digit',minute:'2-digit'}),x=()=>{},T=(e,t,a)=>{I.value=e,M.value=t,A=a,B.value=!0},R=()=>{B.value=!1,A=null},L=()=>{A&&A(),B.value=!1,A=null},P=async()=>{if(!S.value.trim())return;const e=await v(S.value.trim());e&&(S.value='',a('save-created',e.id))},O=async e=>{T('è¯»å–å­˜æ¡£','ç¡®å®šè¦è¯»å–æ­¤å­˜æ¡£å—ï¼Ÿå½“å‰æœªä¿å­˜çš„è¿›åº¦å°†ä¸¢å¤±ã€‚',async()=>{await g(e)&&a('save-loaded',e)})},F=(e,t)=>{T('åˆ é™¤å­˜æ¡£',`ç¡®å®šè¦åˆ é™¤å­˜æ¡£"${t}"å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚`,async()=>{await h(e)})},j=async e=>{const t=e.target,a=t.files?.[0];a&&(await E(a),t.value='')},U=async()=>{await y()},W=async()=>{T('å¿«é€ŸåŠ è½½','ç¡®å®šè¦åŠ è½½æœ€è¿‘çš„å­˜æ¡£å—ï¼Ÿå½“å‰æœªä¿å­˜çš„è¿›åº¦å°†ä¸¢å¤±ã€‚',async()=>{await V()})},H=async()=>{await k()},G=()=>{T('æ¸…ç©ºè‡ªåŠ¨å­˜æ¡£','ç¡®å®šè¦åˆ é™¤æ‰€æœ‰è‡ªåŠ¨å­˜æ¡£å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚',async()=>{await b()})};return(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',Hp,[(0,l.createCommentVNode)(' é¡¶éƒ¨æ ‡é¢˜æ  '),(0,l.createElementVNode)('div',Gp,[t[6]||(t[6]=(0,l.createElementVNode)('h3',{class:'save-title'},[(0,l.createElementVNode)('span',{class:'icon'},'ğŸ’¾'),(0,l.createTextVNode)(' å­˜æ¡£ç®¡ç† ')],-1)),(0,l.createElementVNode)('div',Kp,[(0,l.createElementVNode)('button',{class:'btn btn-icon',onClick:t[0]||(t[0]=(...e)=>(0,l.unref)(m)&&(0,l.unref)(m)(...e)),disabled:(0,l.unref)(n),title:'åˆ·æ–°'},[(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)({spinning:(0,l.unref)(n)})},'ğŸ”„',2)],8,Jp),(0,l.createElementVNode)('button',{class:'btn btn-icon',onClick:t[1]||(t[1]=t=>e.$emit('close')),title:'å…³é—­'},'âœ–')])]),(0,l.createCommentVNode)(' å­˜æ¡£ç»Ÿè®¡ '),(0,l.createElementVNode)('div',qp,[(0,l.createElementVNode)('div',Yp,[t[7]||(t[7]=(0,l.createElementVNode)('span',{class:'stat-label'},'æ€»è®¡',-1)),(0,l.createElementVNode)('span',Xp,(0,l.toDisplayString)((0,l.unref)(c).total),1)]),(0,l.createElementVNode)('div',Zp,[t[8]||(t[8]=(0,l.createElementVNode)('span',{class:'stat-label'},'æ‰‹åŠ¨',-1)),(0,l.createElementVNode)('span',Qp,(0,l.toDisplayString)((0,l.unref)(c).manual),1)]),(0,l.createElementVNode)('div',ev,[t[9]||(t[9]=(0,l.createElementVNode)('span',{class:'stat-label'},'è‡ªåŠ¨',-1)),(0,l.createElementVNode)('span',tv,(0,l.toDisplayString)((0,l.unref)(c).auto),1)])]),(0,l.createCommentVNode)(' æ ‡ç­¾é¡µåˆ‡æ¢ '),(0,l.createElementVNode)('div',av,[(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['tab-btn',{active:'manual'===w.value}]),onClick:t[2]||(t[2]=e=>w.value='manual')},' æ‰‹åŠ¨å­˜æ¡£ ('+(0,l.toDisplayString)((0,l.unref)(i).length)+') ',3),(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['tab-btn',{active:'auto'===w.value}]),onClick:t[3]||(t[3]=e=>w.value='auto')},' è‡ªåŠ¨å­˜æ¡£ ('+(0,l.toDisplayString)((0,l.unref)(d).length)+') ',3),(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['tab-btn',{active:'settings'===w.value}]),onClick:t[4]||(t[4]=e=>w.value='settings')},' è®¾ç½® ',2)]),(0,l.createCommentVNode)(' å†…å®¹åŒºåŸŸ '),(0,l.createElementVNode)('div',nv,[(0,l.createCommentVNode)(' æ‰‹åŠ¨å­˜æ¡£åˆ—è¡¨ '),'manual'===w.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',ov,[(0,l.createCommentVNode)(' åˆ›å»ºæ–°å­˜æ¡£ '),(0,l.createElementVNode)('div',lv,[(0,l.withDirectives)((0,l.createElementVNode)('input',{'onUpdate:modelValue':t[5]||(t[5]=e=>S.value=e),type:'text',class:'save-name-input',placeholder:'è¾“å…¥å­˜æ¡£åç§°...',onKeyup:(0,l.withKeys)(P,['enter'])},null,544),[[l.vModelText,S.value]]),(0,l.createElementVNode)('button',{class:'btn btn-primary',onClick:P,disabled:(0,l.unref)(n)||!S.value.trim()},' åˆ›å»ºå­˜æ¡£ ',8,sv)]),(0,l.createCommentVNode)(' å­˜æ¡£åˆ—è¡¨ '),(0,l.unref)(i).length>0?((0,l.openBlock)(),(0,l.createElementBlock)('div',rv,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)((0,l.unref)(i),e=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.id,class:(0,l.normalizeClass)(['save-item',{active:(0,l.unref)(r)?.id===e.id}])},[(0,l.createElementVNode)('div',cv,[(0,l.createElementVNode)('div',iv,(0,l.toDisplayString)(e.name),1),(0,l.createElementVNode)('div',dv,[(0,l.createElementVNode)('span',null,'åˆ›å»º: '+(0,l.toDisplayString)(D(e.createdAt)),1),(0,l.createElementVNode)('span',null,'æ›´æ–°: '+(0,l.toDisplayString)(D(e.updatedAt)),1)])]),(0,l.createElementVNode)('div',uv,[(0,l.createElementVNode)('button',{class:'btn btn-sm btn-primary',onClick:t=>O(e.id),disabled:(0,l.unref)(n),title:'è¯»å–'},' ğŸ“‚ ',8,mv),(0,l.createElementVNode)('button',{class:'btn btn-sm btn-secondary',onClick:t=>(async e=>{T('è¦†ç›–å­˜æ¡£','ç¡®å®šè¦è¦†ç›–æ­¤å­˜æ¡£å—ï¼ŸåŸæœ‰æ•°æ®å°†è¢«æ›¿æ¢ã€‚',async()=>{await f(e)})})(e.id),disabled:(0,l.unref)(n),title:'è¦†ç›–'},' ğŸ’¾ ',8,pv),(0,l.createElementVNode)('button',{class:'btn btn-sm btn-secondary',onClick:t=>(async e=>{await N(e)})(e.id),disabled:(0,l.unref)(n),title:'å¯¼å‡º'},' ğŸ“¤ ',8,vv),(0,l.createElementVNode)('button',{class:'btn btn-sm btn-danger',onClick:t=>F(e.id,e.name),disabled:(0,l.unref)(n),title:'åˆ é™¤'},' ğŸ—‘ï¸ ',8,fv)])],2))),128))])):((0,l.openBlock)(),(0,l.createElementBlock)('div',gv,[...t[10]||(t[10]=[(0,l.createElementVNode)('p',null,'æš‚æ— æ‰‹åŠ¨å­˜æ¡£',-1),(0,l.createElementVNode)('p',{class:'hint'},'åœ¨ä¸Šæ–¹è¾“å…¥åç§°åˆ›å»ºæ–°å­˜æ¡£',-1)])]))])):'auto'===w.value?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createCommentVNode)(' è‡ªåŠ¨å­˜æ¡£åˆ—è¡¨ '),(0,l.createElementVNode)('div',hv,[(0,l.createCommentVNode)(' è‡ªåŠ¨å­˜æ¡£æ“ä½œ '),(0,l.createElementVNode)('div',yv,[(0,l.createElementVNode)('button',{class:'btn btn-secondary',onClick:H,disabled:(0,l.unref)(n)},' ç«‹å³è‡ªåŠ¨å­˜æ¡£ ',8,Vv),(0,l.createElementVNode)('button',{class:'btn btn-danger',onClick:G,disabled:(0,l.unref)(n)||0===(0,l.unref)(d).length},' æ¸…ç©ºè‡ªåŠ¨å­˜æ¡£ ',8,Nv)]),(0,l.createCommentVNode)(' è‡ªåŠ¨å­˜æ¡£åˆ—è¡¨ '),(0,l.unref)(d).length>0?((0,l.openBlock)(),(0,l.createElementBlock)('div',Ev,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)((0,l.unref)(d),e=>{return(0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.id,class:'save-item auto-save'},[(0,l.createElementVNode)('div',kv,[(0,l.createElementVNode)('div',bv,[t[11]||(t[11]=(0,l.createElementVNode)('span',{class:'auto-badge'},'è‡ªåŠ¨',-1)),(0,l.createTextVNode)(' '+(0,l.toDisplayString)(e.name),1)]),(0,l.createElementVNode)('div',Cv,[(0,l.createElementVNode)('span',null,(0,l.toDisplayString)(D(e.updatedAt)),1),e.saveSource?((0,l.openBlock)(),(0,l.createElementBlock)('span',wv,' æ¥æº: '+(0,l.toDisplayString)((a=e.saveSource,{manual:'æ‰‹åŠ¨',auto:'è‡ªåŠ¨',ai_response:'AIå›å¤'}[a]||a)),1)):(0,l.createCommentVNode)('v-if',!0)])]),(0,l.createElementVNode)('div',Sv,[(0,l.createElementVNode)('button',{class:'btn btn-sm btn-primary',onClick:t=>O(e.id),disabled:(0,l.unref)(n),title:'è¯»å–'},' ğŸ“‚ ',8,Bv),(0,l.createElementVNode)('button',{class:'btn btn-sm btn-secondary',onClick:t=>(async e=>{T('è½¬ä¸ºæ‰‹åŠ¨å­˜æ¡£','ç¡®å®šè¦å°†æ­¤è‡ªåŠ¨å­˜æ¡£è½¬ä¸ºæ‰‹åŠ¨å­˜æ¡£å—ï¼Ÿ',async()=>{await C(e)})})(e.id),disabled:(0,l.unref)(n),title:'è½¬ä¸ºæ‰‹åŠ¨å­˜æ¡£'},' ğŸ“Œ ',8,Iv),(0,l.createElementVNode)('button',{class:'btn btn-sm btn-danger',onClick:t=>F(e.id,e.name),disabled:(0,l.unref)(n),title:'åˆ é™¤'},' ğŸ—‘ï¸ ',8,Mv)])]);var a}),128))])):((0,l.openBlock)(),(0,l.createElementBlock)('div',Av,[...t[12]||(t[12]=[(0,l.createElementVNode)('p',null,'æš‚æ— è‡ªåŠ¨å­˜æ¡£',-1),(0,l.createElementVNode)('p',{class:'hint'},'AIå›å¤ç»“æŸåä¼šè‡ªåŠ¨åˆ›å»ºå­˜æ¡£',-1)])]))])],2112)):'settings'===w.value?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:2},[(0,l.createCommentVNode)(' è®¾ç½®é¢æ¿ '),(0,l.createElementVNode)('div',Dv,[(0,l.createVNode)(Wp)])],2112)):(0,l.createCommentVNode)('v-if',!0)]),(0,l.createCommentVNode)(' åº•éƒ¨æ“ä½œæ  '),(0,l.createElementVNode)('div',xv,[(0,l.createElementVNode)('div',_v,[(0,l.createElementVNode)('button',{class:'btn btn-secondary',onClick:U,disabled:(0,l.unref)(n)},'å¿«é€Ÿä¿å­˜',8,Tv),(0,l.createElementVNode)('button',{class:'btn btn-secondary',onClick:W,disabled:(0,l.unref)(n)||!(0,l.unref)(u)},' å¿«é€ŸåŠ è½½ ',8,$v)]),(0,l.createElementVNode)('div',Rv,[(0,l.createElementVNode)('label',Lv,[t[13]||(t[13]=(0,l.createTextVNode)(' å¯¼å…¥å­˜æ¡£ ',-1)),(0,l.createElementVNode)('input',{type:'file',accept:'.json',onChange:j,hidden:''},null,32)])])]),(0,l.createCommentVNode)(' é”™è¯¯æç¤º '),(0,l.unref)(o)?((0,l.openBlock)(),(0,l.createElementBlock)('div',Pv,[(0,l.createTextVNode)((0,l.toDisplayString)((0,l.unref)(o))+' ',1),(0,l.createElementVNode)('button',{class:'btn-close',onClick:x},'Ã—')])):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' ç¡®è®¤å¯¹è¯æ¡† '),B.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:1,class:'confirm-overlay',onClick:(0,l.withModifiers)(R,['self'])},[(0,l.createElementVNode)('div',Ov,[(0,l.createElementVNode)('div',Fv,(0,l.toDisplayString)(I.value),1),(0,l.createElementVNode)('div',jv,(0,l.toDisplayString)(M.value),1),(0,l.createElementVNode)('div',{class:'confirm-actions'},[(0,l.createElementVNode)('button',{class:'btn btn-secondary',onClick:R},'å–æ¶ˆ'),(0,l.createElementVNode)('button',{class:'btn btn-danger',onClick:L},'ç¡®è®¤')])])])):(0,l.createCommentVNode)('v-if',!0)]))}}),zv=(0,B.A)(Uv,[['__scopeId','data-v-7aa5842e']]);const Wv={class:'context-manager-panel'},Hv={class:'panel-header'},Gv={class:'panel-body'},Kv={class:'enable-section'},Jv={class:'enable-row'},qv={class:'toggle-switch'},Yv=['checked','disabled'],Xv={class:'stats-section'},Zv={class:'stats-grid'},Qv={class:'stat-item'},ef={class:'stat-value'},tf={class:'stat-item'},af={class:'stat-value'},nf={class:'stat-item'},of={class:'stat-value'},lf={class:'stat-item'},sf={class:'stat-value'},rf={key:0,class:'last-update'},cf={class:'mode-section'},df={class:'mode-selector'},uf=['disabled'],mf=['disabled'],pf={class:'config-section'},vf={class:'config-item'},ff={class:'config-control'},gf=['disabled'],hf={class:'config-item'},yf={class:'config-control'},Vf=['disabled'],Nf={class:'actions-section'},Ef={class:'action-buttons'},kf=['disabled'],bf={key:0},Cf={key:1},wf=['disabled'],Sf=['disabled'],Bf=['disabled'],If={key:0,class:'error-message'},Mf=(0,l.defineComponent)({__name:'ContextManagerPanel',emits:['close'],setup(e){const{isProcessing:t,error:a,mode:n,config:o,statistics:s,formattedLastUpdateTime:r,isEnabled:c,refresh:i,setSegmentCount:d,setSmallSummaryCount:u,switchMode:m,regenerateSegments:p,clearAll:v,setEnabled:f}=function(){const e=(0,l.ref)(!1),t=(0,l.ref)(!1),a=(0,l.ref)(null),n=(0,l.ref)('segmented'),o=(0,l.ref)(!1),s=(0,l.ref)({segmentCount:3,smallSummaryCount:25}),r=(0,l.ref)({recordCount:0,textCount:0,segmentCount:0,smallSummaryCount:0,largeSummaryCount:0,mode:'segmented'}),c=(0,l.ref)([]),i=(0,l.ref)([]),d=(0,l.ref)(null),u=(0,l.ref)(0),m=(0,l.computed)(()=>r.value.recordCount>0),p=(0,l.computed)(()=>'segmented'===n.value),v=(0,l.computed)(()=>u.value?new Date(u.value).toLocaleString('zh-CN'):''),f=()=>{const e=hp.getState(),l=hp.getStatistics(),m=hp.getConfig();n.value=e.mode,s.value=m,r.value=l,t.value=e.isProcessing,a.value=e.error,u.value=e.lastUpdateTime,d.value=e.segmentedContent,o.value=hp.isEnabled(),c.value=hp.getLatestRecords(10),i.value=hp.getLatestTexts(5)};return(0,l.onMounted)(async()=>{console.log('[useContextManager] Composableå·²æŒ‚è½½'),f()}),{isInitialized:e,isProcessing:t,error:a,mode:n,config:s,statistics:r,latestRecords:c,latestTexts:i,segmentedContent:d,lastUpdateTime:u,isEnabled:o,hasRecords:m,isSegmentedMode:p,formattedLastUpdateTime:v,initialize:async()=>{try{t.value=!0,a.value=null;const n=await hp.initialize();return n&&(e.value=!0,f()),n}catch(e){return a.value=e instanceof Error?e.message:'åˆå§‹åŒ–å¤±è´¥',!1}finally{t.value=!1}},refresh:async()=>{await hp.loadFromWorldbook(),f()},setSegmentCount:async e=>{try{return t.value=!0,a.value=null,await hp.setSegmentCount(e),f(),!0}catch(e){return a.value=e instanceof Error?e.message:'è®¾ç½®å¤±è´¥',!1}finally{t.value=!1}},setSmallSummaryCount:async e=>{try{return t.value=!0,a.value=null,await hp.setSmallSummaryCount(e),f(),!0}catch(e){return a.value=e instanceof Error?e.message:'è®¾ç½®å¤±è´¥',!1}finally{t.value=!1}},updateConfig:async e=>{try{return t.value=!0,a.value=null,await hp.setConfig(e),f(),!0}catch(e){return a.value=e instanceof Error?e.message:'æ›´æ–°é…ç½®å¤±è´¥',!1}finally{t.value=!1}},switchMode:async e=>{try{return t.value=!0,a.value=null,await hp.switchMode(e),f(),!0}catch(e){return a.value=e instanceof Error?e.message:'åˆ‡æ¢æ¨¡å¼å¤±è´¥',!1}finally{t.value=!1}},regenerateSegments:async()=>{try{t.value=!0,a.value=null;const e=await hp.regenerateSegments();return f(),e}catch(e){return a.value=e instanceof Error?e.message:'é‡æ–°ç”Ÿæˆå¤±è´¥',!1}finally{t.value=!1}},clearAll:async(e=!1)=>{try{t.value=!0,a.value=null;const n=await hp.clearAll(e);return f(),n}catch(e){return a.value=e instanceof Error?e.message:'æ¸…ç©ºå¤±è´¥',!1}finally{t.value=!1}},getSaveData:async()=>await hp.getSaveData(),restoreFromSaveData:async e=>{try{t.value=!0,a.value=null;const n=await hp.restoreFromSaveData(e);return f(),n}catch(e){return a.value=e instanceof Error?e.message:'æ¢å¤å¤±è´¥',!1}finally{t.value=!1}},syncState:f,setEnabled:async e=>{try{return t.value=!0,a.value=null,hp.setEnabled(e),e&&await hp.initialize(),f(),!0}catch(e){return a.value=e instanceof Error?e.message:'è®¾ç½®å¯ç”¨çŠ¶æ€å¤±è´¥',!1}finally{t.value=!1}},service:hp}}(),g=(0,l.reactive)({segmentCount:3,smallSummaryCount:25}),h=async()=>{await i(),'undefined'!=typeof toastr&&toastr.success('æ•°æ®å·²åˆ·æ–°')},y=async()=>{await d(g.segmentCount)&&'undefined'!=typeof toastr&&toastr.success('åˆ†æ®µæ•°é‡å·²æ›´æ–°')},V=async()=>{await u(g.smallSummaryCount)&&'undefined'!=typeof toastr&&toastr.success('å°æ€»ç»“èŒƒå›´å·²æ›´æ–°')},N=async()=>{await m(n.value)&&'undefined'!=typeof toastr&&toastr.success(`å·²åˆ‡æ¢åˆ°${'segmented'===n.value?'åˆ†æ®µ':'å®Œæ•´'}æ¨¡å¼`)},E=async()=>{await p()&&'undefined'!=typeof toastr&&toastr.success('åˆ†æ®µå·²é‡æ–°ç”Ÿæˆ')},k=async()=>{const e=c.value?'ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰ä¸Šä¸‹æ–‡æ•°æ®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚':'åŠŸèƒ½æœªå¯ç”¨ï¼Œä»…æ¸…ç©ºæœ¬åœ°çŠ¶æ€ã€‚ç¡®å®šç»§ç»­å—ï¼Ÿ';if(!await rs(e,'æ¸…ç©ºæ•°æ®'))return;await v(!1)&&'undefined'!=typeof toastr&&toastr.success('æ•°æ®å·²æ¸…ç©º')},b=async()=>{if(!await rs('ç¡®å®šè¦å¼ºåˆ¶æ¸…ç©ºä¸–ç•Œä¹¦ä¸­çš„ä¸Šä¸‹æ–‡æ¡ç›®å—ï¼Ÿæ­¤æ“ä½œä¼šå½±å“ä¸–ç•Œä¹¦å†…å®¹ï¼Œä¸å¯æ¢å¤ï¼','å¼ºåˆ¶æ¸…ç©ºä¸–ç•Œä¹¦'))return;await v(!0)&&'undefined'!=typeof toastr&&toastr.success('ä¸–ç•Œä¹¦æ¡ç›®å·²æ¸…ç©º')},C=async e=>{const t=e.target;if(t.checked){if(await cs('å¯ç”¨åå°†ç”±æœ¬ç³»ç»Ÿç®¡ç†ä¸–ç•Œä¹¦æ¡ç›®ã€‚å¦‚æœæ‚¨ä½¿ç”¨å¤–æŒ‚çš„ä¸–ç•Œä¹¦æ¥æä¾›ä¸Šä¸‹æ–‡ï¼Œè¯·ä¿æŒç¦ç”¨çŠ¶æ€ã€‚ç¡®å®šå¯ç”¨å—ï¼Ÿ','å¯ç”¨ä¸Šä¸‹æ–‡ç®¡ç†')){await f(!0)&&'undefined'!=typeof toastr&&toastr.success('ä¸Šä¸‹æ–‡ç®¡ç†å·²å¯ç”¨')}else t.checked=!1}else{await f(!1)&&'undefined'!=typeof toastr&&toastr.info('ä¸Šä¸‹æ–‡ç®¡ç†å·²ç¦ç”¨')}};return(0,l.onMounted)(()=>{g.segmentCount=o.value.segmentCount,g.smallSummaryCount=o.value.smallSummaryCount}),(e,o)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',Wv,[(0,l.createCommentVNode)(' å¤´éƒ¨ '),(0,l.createElementVNode)('div',Hv,[o[5]||(o[5]=(0,l.createElementVNode)('h3',null,'ğŸ“š ä¸Šä¸‹æ–‡ç®¡ç†',-1)),(0,l.createElementVNode)('button',{class:'btn-close',onClick:o[0]||(o[0]=t=>e.$emit('close'))},'âœ•')]),(0,l.createCommentVNode)(' å†…å®¹ '),(0,l.createElementVNode)('div',Gv,[(0,l.createCommentVNode)(' åŠŸèƒ½å¯ç”¨å¼€å…³ '),(0,l.createElementVNode)('div',Kv,[o[8]||(o[8]=(0,l.createElementVNode)('div',{class:'section-title'},'âš¡ åŠŸèƒ½å¼€å…³',-1)),(0,l.createElementVNode)('div',Jv,[o[7]||(o[7]=(0,l.createElementVNode)('span',{class:'enable-label'},'ä¸Šä¸‹æ–‡ç®¡ç†åŠŸèƒ½',-1)),(0,l.createElementVNode)('label',qv,[(0,l.createElementVNode)('input',{type:'checkbox',checked:(0,l.unref)(c),onChange:C,disabled:(0,l.unref)(t)},null,40,Yv),o[6]||(o[6]=(0,l.createElementVNode)('span',{class:'toggle-slider'},null,-1))])]),(0,l.createElementVNode)('div',{class:(0,l.normalizeClass)(['enable-status',{enabled:(0,l.unref)(c),disabled:!(0,l.unref)(c)}])},(0,l.toDisplayString)((0,l.unref)(c)?'âœ… å·²å¯ç”¨ - æ­£åœ¨ç®¡ç†ä¸–ç•Œä¹¦':'âš ï¸ å·²ç¦ç”¨ - ä½¿ç”¨å¤–æŒ‚ä¸–ç•Œä¹¦'),3)]),(0,l.createCommentVNode)(' ç»Ÿè®¡ä¿¡æ¯ '),(0,l.createElementVNode)('div',Xv,[o[13]||(o[13]=(0,l.createElementVNode)('div',{class:'section-title'},'ğŸ“Š ç»Ÿè®¡ä¿¡æ¯',-1)),(0,l.createElementVNode)('div',Zv,[(0,l.createElementVNode)('div',Qv,[o[9]||(o[9]=(0,l.createElementVNode)('span',{class:'stat-label'},'å†å²è®°å½•',-1)),(0,l.createElementVNode)('span',ef,(0,l.toDisplayString)((0,l.unref)(s).recordCount),1)]),(0,l.createElementVNode)('div',tf,[o[10]||(o[10]=(0,l.createElementVNode)('span',{class:'stat-label'},'å†å²æ­£æ–‡',-1)),(0,l.createElementVNode)('span',af,(0,l.toDisplayString)((0,l.unref)(s).textCount),1)]),(0,l.createElementVNode)('div',nf,[o[11]||(o[11]=(0,l.createElementVNode)('span',{class:'stat-label'},'åˆ†æ®µæ­£æ–‡',-1)),(0,l.createElementVNode)('span',of,(0,l.toDisplayString)((0,l.unref)(s).segmentCount),1)]),(0,l.createElementVNode)('div',lf,[o[12]||(o[12]=(0,l.createElementVNode)('span',{class:'stat-label'},'å°æ€»ç»“',-1)),(0,l.createElementVNode)('span',sf,(0,l.toDisplayString)((0,l.unref)(s).smallSummaryCount),1)])]),(0,l.unref)(r)?((0,l.openBlock)(),(0,l.createElementBlock)('div',rf,'æœ€åæ›´æ–°: '+(0,l.toDisplayString)((0,l.unref)(r)),1)):(0,l.createCommentVNode)('v-if',!0)]),(0,l.createCommentVNode)(' æ¨¡å¼åˆ‡æ¢ '),(0,l.createElementVNode)('div',cf,[o[16]||(o[16]=(0,l.createElementVNode)('div',{class:'section-title'},'ğŸ›ï¸ æ¨¡å¼é…ç½®',-1)),(0,l.createElementVNode)('div',df,[(0,l.createElementVNode)('label',{class:(0,l.normalizeClass)(['mode-option',{active:'segmented'===(0,l.unref)(n),disabled:!(0,l.unref)(c)}])},[(0,l.withDirectives)((0,l.createElementVNode)('input',{type:'radio','onUpdate:modelValue':o[1]||(o[1]=e=>(0,l.isRef)(n)?n.value=e:null),value:'segmented',onChange:N,disabled:!(0,l.unref)(c)},null,40,uf),[[l.vModelRadio,(0,l.unref)(n)]]),o[14]||(o[14]=(0,l.createElementVNode)('span',null,'åˆ†æ®µæ¨¡å¼',-1))],2),(0,l.createElementVNode)('label',{class:(0,l.normalizeClass)(['mode-option',{active:'full'===(0,l.unref)(n),disabled:!(0,l.unref)(c)}])},[(0,l.withDirectives)((0,l.createElementVNode)('input',{type:'radio','onUpdate:modelValue':o[2]||(o[2]=e=>(0,l.isRef)(n)?n.value=e:null),value:'full',onChange:N,disabled:!(0,l.unref)(c)},null,40,mf),[[l.vModelRadio,(0,l.unref)(n)]]),o[15]||(o[15]=(0,l.createElementVNode)('span',null,'å®Œæ•´æ¨¡å¼',-1))],2)])]),(0,l.createCommentVNode)(' é…ç½®é€‰é¡¹ '),(0,l.createElementVNode)('div',pf,[o[21]||(o[21]=(0,l.createElementVNode)('div',{class:'section-title'},'âš™ï¸ åˆ†æ®µé…ç½®',-1)),(0,l.createElementVNode)('div',vf,[o[17]||(o[17]=(0,l.createElementVNode)('label',null,'åˆ†æ®µæ­£æ–‡æ•°é‡',-1)),(0,l.createElementVNode)('div',ff,[(0,l.withDirectives)((0,l.createElementVNode)('input',{type:'number','onUpdate:modelValue':o[3]||(o[3]=e=>g.segmentCount=e),min:'0',max:'20',class:'config-input'},null,512),[[l.vModelText,g.segmentCount,void 0,{number:!0}]]),(0,l.createElementVNode)('button',{class:'btn-apply',onClick:y,disabled:(0,l.unref)(t)},'åº”ç”¨',8,gf)]),o[18]||(o[18]=(0,l.createElementVNode)('span',{class:'config-hint'},'è®¾ä¸º0åˆ™ä¸ä½¿ç”¨åˆ†æ®µæ­£æ–‡',-1))]),(0,l.createElementVNode)('div',hf,[o[19]||(o[19]=(0,l.createElementVNode)('label',null,'å°æ€»ç»“èŒƒå›´',-1)),(0,l.createElementVNode)('div',yf,[(0,l.withDirectives)((0,l.createElementVNode)('input',{type:'number','onUpdate:modelValue':o[4]||(o[4]=e=>g.smallSummaryCount=e),min:'0',max:'100',class:'config-input'},null,512),[[l.vModelText,g.smallSummaryCount,void 0,{number:!0}]]),(0,l.createElementVNode)('button',{class:'btn-apply',onClick:V,disabled:(0,l.unref)(t)},'åº”ç”¨',8,Vf)]),o[20]||(o[20]=(0,l.createElementVNode)('span',{class:'config-hint'},'è®¾ä¸º0åˆ™ä¸ä½¿ç”¨å°æ€»ç»“',-1))])]),(0,l.createCommentVNode)(' æ“ä½œæŒ‰é’® '),(0,l.createElementVNode)('div',Nf,[o[22]||(o[22]=(0,l.createElementVNode)('div',{class:'section-title'},'ğŸ”§ æ“ä½œ',-1)),(0,l.createElementVNode)('div',Ef,[(0,l.createElementVNode)('button',{class:'btn btn-primary',onClick:h,disabled:(0,l.unref)(t)},[(0,l.unref)(t)?((0,l.openBlock)(),(0,l.createElementBlock)('span',bf,'å¤„ç†ä¸­...')):((0,l.openBlock)(),(0,l.createElementBlock)('span',Cf,'ğŸ”„ åˆ·æ–°æ•°æ®'))],8,kf),(0,l.createElementVNode)('button',{class:'btn btn-secondary',onClick:E,disabled:(0,l.unref)(t)||!(0,l.unref)(c)},' ğŸ”€ é‡æ–°åˆ†æ®µ ',8,wf),(0,l.createElementVNode)('button',{class:'btn btn-danger',onClick:k,disabled:(0,l.unref)(t)},'ğŸ—‘ï¸ æ¸…ç©ºæ‰€æœ‰',8,Sf),(0,l.unref)(c)?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('button',{key:0,class:'btn btn-danger-outline',onClick:b,disabled:(0,l.unref)(t)},' ğŸ—‘ï¸ å¼ºåˆ¶æ¸…ç©ºä¸–ç•Œä¹¦ ',8,Bf))])]),(0,l.createCommentVNode)(' é”™è¯¯æç¤º '),(0,l.unref)(a)?((0,l.openBlock)(),(0,l.createElementBlock)('div',If,'âš ï¸ '+(0,l.toDisplayString)((0,l.unref)(a)),1)):(0,l.createCommentVNode)('v-if',!0)])]))}}),Af=(0,B.A)(Mf,[['__scopeId','data-v-6b8678ab']]),Df=[{name:'thinking',displayName:'æ€è€ƒè¿‡ç¨‹',required:!1},{name:'gametxt',displayName:'æ¸¸æˆæ–‡æœ¬',required:!0},{name:'å†å²è®°å½•',displayName:'å†å²è®°å½•',required:!1},{name:'UpdateVariable',displayName:'å˜é‡æ›´æ–°',required:!1}];class xf{static instance;constructor(){}static getInstance(){return xf.instance||(xf.instance=new xf),xf.instance}review(e){const t=Date.now(),a=[],n=this.checkAllTags(e);for(const e of n){const t=Df.find(t=>t.name===e.tagName),n=t?.displayName||e.tagName;t?.required&&!e.exists?a.push({level:'error',category:'tag',message:`ç¼ºå°‘å¿…éœ€çš„ <${n}> æ ‡ç­¾`,field:e.tagName}):e.exists&&!e.isClosed?a.push({level:'error',category:'tag',message:`<${n}> æ ‡ç­¾æœªæ­£ç¡®é—­åˆï¼ˆå¼€å§‹:${e.openCount}, ç»“æŸ:${e.closeCount}ï¼‰`,field:e.tagName}):e.warning&&a.push({level:'warning',category:'tag',message:e.warning,field:e.tagName})}const o=this.extractTagContent(e,'gametxt'),l=this.extractTagContent(e,'å†å²è®°å½•'),s=this.extractTagContent(e,'thinking');let r=null;const c=n.find(e=>'UpdateVariable'===e.tagName);if(c?.exists&&c.content){r=this.parseVariableCommands(c.content);for(const e of r.errors)a.push({level:'error',category:'variable',message:e,field:'UpdateVariable'});for(const e of r.warnings)a.push({level:'warning',category:'variable',message:e,field:'UpdateVariable'})}o&&o.length<10&&a.push({level:'warning',category:'format',message:'æ¸¸æˆæ–‡æœ¬å†…å®¹è¿‡çŸ­ï¼Œå¯èƒ½ä¸å®Œæ•´',field:'gametxt'});return{passed:!a.some(e=>'error'===e.level),originalText:e,tagChecks:n,variableCheck:r,gameTextContent:o,historyContent:l,thinkingContent:s,issues:a,timestamp:t}}checkAllTags(e){return Df.map(t=>this.checkTag(e,t.name))}checkTag(e,t){const a=new RegExp(`<${this.escapeRegex(t)}>`,'gi'),n=new RegExp(`</${this.escapeRegex(t)}>`,'gi'),o=e.match(a)||[],l=e.match(n)||[],s=o.length,r=l.length,c=s>0,i=s===r&&s>0;let d,u;return c&&(d=this.extractTagContent(e,t),s>1&&(u=`å­˜åœ¨å¤šä¸ª <${t}> æ ‡ç­¾ï¼ˆ${s}ä¸ªï¼‰ï¼Œä½¿ç”¨æœ€åä¸€ä¸ª`)),{tagName:t,exists:c,isClosed:i,openCount:s,closeCount:r,content:d,warning:u}}extractTagContent(e,t){if(!e||'string'!=typeof e)return'';const a=new RegExp(`<${this.escapeRegex(t)}>([\\s\\S]*?)</${this.escapeRegex(t)}>`,'gi'),n=[...e.matchAll(a)];return n.length>0?n[n.length-1][1].trim():''}parseVariableCommands(e){const t=[];if(!e||!e.trim())return{success:!0,rawContent:e,commands:[],errors:[],warnings:['å˜é‡æ›´æ–°å†…å®¹ä¸ºç©º']};const a=this.tryParseAsMvuCommands(e);if(a.commands.length>0)return{success:0===a.errors.length,rawContent:e,commands:a.commands,errors:a.errors,warnings:a.warnings};const n=this.tryParseAsJson(e);if(n.success)return{success:!0,rawContent:e,commands:n.commands,errors:n.errors,warnings:n.warnings};const o=this.tryParseAsLines(e);return o.commands.length>0?{success:0===o.errors.length,rawContent:e,commands:o.commands,errors:o.errors,warnings:o.warnings}:(t.push('æ— æ³•è§£æå˜é‡æ›´æ–°æŒ‡ä»¤æ ¼å¼ï¼Œè¯·æ£€æŸ¥æ˜¯å¦ç¬¦åˆMVUå‘½ä»¤ã€JSONæˆ–è¡Œå‘½ä»¤æ ¼å¼'),{success:!1,rawContent:e,commands:[],errors:t,warnings:[]})}tryParseAsMvuCommands(e){const t=[],a=[],n=e.split('\n');let o,l='',s=0,r=0,c=!1,i='';for(let e=0;e<n.length;e++){const d=n[e].trim();if(!d)continue;if(d.startsWith('//')){o=d.slice(2).trim();continue}l+=(l?'\n':'')+d;for(let e=0;e<d.length;e++){const t=d[e],a=e>0?d[e-1]:'';'"'!==t&&'\''!==t||'\\'===a?c||('{'===t?s++:'}'===t?s--:'['===t?r++:']'===t&&r--):c?t===i&&(c=!1):(c=!0,i=t)}const u=l.trim();if(0===s&&0===r&&(u.endsWith(');')||u.endsWith(')'))){const e=this.parseMvuSingleCommand(l,o);if(e)t.push(e);else if(l.trim()){const e=l.substring(0,50)+(l.length>50?'...':'');a.push(`æ— æ³•è§£æå‘½ä»¤: "${e}"`)}l='',o=void 0,s=0,r=0,c=!1}}if(l.trim()){const e=this.parseMvuSingleCommand(l,o);if(e)t.push(e);else{const e=l.substring(0,50)+(l.length>50?'...':'');a.push(`æ— æ³•è§£æå‘½ä»¤: "${e}"`)}}return{commands:t,errors:[],warnings:a}}parseMvuSingleCommand(e,t){if(!e||'string'!=typeof e)return null;let a=e.trim();a.endsWith(';')&&(a=a.slice(0,-1).trim());const n=this.findLastCommentIndex(a);if(n>-1){const e=a.slice(n+2).trim();!t&&e&&(t=e),a=a.slice(0,n).trim()}if(!a)return null;const o=a.match(/^_\.(set|assign|add|remove)\s*\(\s*([\s\S]*)\s*\)$/i);if(o)return this.parseLodashStyleCommand(o[1].toLowerCase(),o[2],t);const l=a.match(/^(SET|ADD|SUB|MUL|DIV|APPEND|REMOVE|CLEAR|TOGGLE|INIT)\s*\(\s*([\s\S]*)\s*\)$/i);return l?this.parseOldStyleCommand(l[1].toUpperCase(),l[2],t):null}findLastCommentIndex(e){let t=!1,a='',n=-1;for(let o=0;o<e.length-1;o++){const l=e[o],s=e[o+1],r=o>0?e[o-1]:'';'"'!==l&&'\''!==l||'\\'===r?t||'/'!==l||'/'!==s||(n=o):t?l===a&&(t=!1):(t=!0,a=l)}return n}parseLodashStyleCommand(e,t,a){const n=this.parseMvuArguments(t);if(n.length<1)return null;const o='string'==typeof n[0]?n[0]:String(n[0]);switch(e){case'set':{const e=n.length>=3?n[2]:n[1];return{path:o,operation:'set',value:e,comment:a,rawLine:`_.set('${o}', ${JSON.stringify(e)})`}}case'assign':{if(n.length<3)return null;const e='string'==typeof n[1]?n[1]:String(n[1]);return{path:`${o}.${e}`,operation:'set',value:n[2],comment:a,rawLine:`_.assign('${o}', '${e}', ${JSON.stringify(n[2])})`}}case'add':{const e=n.length>=2?n[1]:1;return{path:o,operation:'add',value:'number'==typeof e?e:parseFloat(String(e))||1,comment:a,rawLine:`_.add('${o}', ${e})`}}case'remove':return{path:o,operation:'remove',value:n.length>=2?n[1]:void 0,comment:a,rawLine:`_.remove('${o}'${n.length>=2?', '+JSON.stringify(n[1]):''})`};default:return null}}parseOldStyleCommand(e,t,a){const n=this.parseMvuArguments(t);if(n.length<1)return null;const o='string'==typeof n[0]?n[0]:String(n[0]),l=n.length>=2?n[1]:void 0;let s;switch(e){case'SET':case'INIT':s='set';break;case'ADD':s='add';break;case'SUB':s='subtract';break;case'APPEND':s='append';break;case'REMOVE':case'CLEAR':s='remove';break;default:s='unknown'}return{path:o,operation:s,value:l,comment:a,rawLine:`${e}('${o}'${void 0!==l?', '+JSON.stringify(l):''})`}}parseMvuArguments(e){const t=[];let a='',n=0,o=0,l=!1,s='';const r=e.trim();for(let e=0;e<r.length;e++){const c=r[e],i=e>0?r[e-1]:'';if('"'!==c&&'\''!==c||'\\'===i)if(l)a+=c;else if('{'!==c)if('}'!==c)if('['!==c)if(']'!==c){if(','===c&&0===n&&0===o){const e=a.trim();e&&t.push(this.parseMvuValue(e)),a='';continue}a+=c}else o--,a+=c;else o++,a+=c;else n--,a+=c;else n++,a+=c;else l?c===s&&(l=!1):(l=!0,s=c),a+=c}const c=a.trim();return c&&t.push(this.parseMvuValue(c)),t}parseMvuValue(e){const t=e.trim();if(t){if('null'===t)return null;if('true'===t)return!0;if('false'===t)return!1;if(/^-?\d+(\.\d+)?$/.test(t))return parseFloat(t);if(t.startsWith('\'')&&t.endsWith('\'')||t.startsWith('"')&&t.endsWith('"'))return t.slice(1,-1);if(t.startsWith('{')&&t.endsWith('}')||t.startsWith('[')&&t.endsWith(']'))try{return JSON.parse(t)}catch{try{const e=t.replace(/'/g,'"');return JSON.parse(e)}catch{return t}}return t}}tryParseAsJson(e){const t=[],a=[],n=[];try{let o=e.trim();o=o.split('\n').filter(e=>!e.trim().startsWith('//')&&!e.trim().startsWith('#')).join('\n');const l=JSON.parse(o);return'object'!=typeof l||null===l?{success:!1,commands:[],errors:['JSONè§£æç»“æœä¸æ˜¯å¯¹è±¡'],warnings:[]}:(this.extractJsonCommands(l,'',n),0===n.length&&a.push('JSONæ ¼å¼æ­£ç¡®ä½†æœªæ£€æµ‹åˆ°å˜é‡æ›´æ–°æŒ‡ä»¤'),{success:!0,commands:n,errors:t,warnings:a})}catch(e){return{success:!1,commands:[],errors:[],warnings:[]}}}extractJsonCommands(e,t,a){for(const[n,o]of Object.entries(e)){const e=t?`${t}.${n}`:n;null===o||'object'!=typeof o||Array.isArray(o)?a.push({path:e,operation:'set',value:o,rawLine:`${e} = ${JSON.stringify(o)}`}):'operation'in o||'value'in o||'set'in o||'add'in o?a.push(this.parseJsonCommand(e,o)):this.extractJsonCommands(o,e,a)}}parseJsonCommand(e,t){let a,n,o='set';return'operation'in t?(o=this.normalizeOperation(t.operation),a=t.value??t.newValue,n=t.comment||t.reason):'set'in t?(o='set',a=t.set):'add'in t?(o='add',a=t.add):'subtract'in t||'sub'in t?(o='subtract',a=t.subtract??t.sub):'value'in t?(o='set',a=t.value,n=t.comment||t.reason):(o='unknown',a=t),{path:e,operation:o,value:a,comment:n,rawLine:JSON.stringify({[e]:t})}}normalizeOperation(e){switch(e.toLowerCase().trim()){case'set':case'=':case'assign':return'set';case'add':case'+':case'+=':case'increase':return'add';case'subtract':case'sub':case'-':case'-=':case'decrease':return'subtract';case'append':case'push':return'append';case'remove':case'delete':return'remove';default:return'unknown'}}tryParseAsLines(e){const t=[],a=[],n=e.split('\n').filter(e=>e.trim());for(let e=0;e<n.length;e++){const o=n[e].trim(),l=e+1;if(o.startsWith('//')||o.startsWith('#')||o.startsWith('--'))continue;const s=this.parseLineCommand(o);s?a.push(s):o.length>0&&t.push(`ç¬¬${l}è¡Œæ— æ³•è§£æ: "${o.substring(0,50)}${o.length>50?'...':''}"`)}return{commands:a,errors:[],warnings:t}}parseLineCommand(e){const t=[/^([a-zA-Z\u4e00-\u9fa5_][\w\u4e00-\u9fa5.]*)\s*\+=\s*(.+)$/,/^([a-zA-Z\u4e00-\u9fa5_][\w\u4e00-\u9fa5.]*)\s*-=\s*(.+)$/,/^([a-zA-Z\u4e00-\u9fa5_][\w\u4e00-\u9fa5.]*)\s*=\s*(.+)$/,/^([a-zA-Z\u4e00-\u9fa5_][\w\u4e00-\u9fa5.]*)\s*:\s*(.+)$/],a=['add','subtract','set','set'];for(let n=0;n<t.length;n++){const o=e.match(t[n]);if(o){const t=o[1].trim();let l,s=o[2].trim();const r=s.match(/\/\/\s*(.+)$/);r&&(l=r[1].trim(),s=s.substring(0,r.index).trim());const c=this.parseValue(s);return{path:t,operation:a[n],value:c,comment:l,rawLine:e}}}return null}parseValue(e){if('null'===(e=e.trim()))return null;if('undefined'===e)return;if('true'===e)return!0;if('false'===e)return!1;const t=Number(e);if(!isNaN(t)&&''!==e)return t;if(e.startsWith('"')&&e.endsWith('"')||e.startsWith('\'')&&e.endsWith('\''))return e.slice(1,-1);if(e.startsWith('[')&&e.endsWith(']')||e.startsWith('{')&&e.endsWith('}'))try{return JSON.parse(e)}catch{}return e}escapeRegex(e){return e.replace(/[.*+?^${}()|[\]\\]/g,'\\$&')}quickCheck(e){const t=[];for(const a of Df)if(a.required){const n=this.checkTag(e,a.name);n.exists&&n.isClosed||t.push(a.displayName)}return{passed:0===t.length,missingTags:t}}getSummary(e){const t=[];e.passed?t.push('âœ… æ ¼å¼å®¡æŸ¥é€šè¿‡'):t.push('âŒ æ ¼å¼å®¡æŸ¥æœªé€šè¿‡');const a=e.issues.filter(e=>'error'===e.level).length,n=e.issues.filter(e=>'warning'===e.level).length;return a>0&&t.push(`  - ${a} ä¸ªé”™è¯¯`),n>0&&t.push(`  - ${n} ä¸ªè­¦å‘Š`),e.variableCheck&&t.push(`  - ${e.variableCheck.commands.length} æ¡å˜é‡æ›´æ–°æŒ‡ä»¤`),t.join('\n')}}const _f=xf.getInstance();function Tf(){const e=(0,l.ref)(''),t=(0,l.ref)(''),a=(0,l.ref)([]),n=(0,l.ref)(0),o=(0,l.ref)(!1),s=(0,l.ref)(!1),r=(0,l.ref)(null),c=(0,l.ref)(''),i=(0,l.ref)([]),d=(0,l.ref)(''),u=(0,l.ref)('idle'),m=(0,l.ref)(null),p=[],v=(0,l.ref)(!1),f=(0,l.ref)('standard'),g=(0,l.ref)(!0),h=(0,l.ref)(!1),y=(0,l.ref)(null),V=(0,l.ref)(null),N=(0,l.ref)(null),E=(0,l.ref)(!1),k=(0,l.ref)(null);let b=null,C=null,w=!1;const S=(0,l.computed)(()=>!!e.value),B=(0,l.computed)(()=>a.value.length>1),I=()=>(new Date).toLocaleTimeString('zh-CN',{hour:'2-digit',minute:'2-digit'}),M=e=>{if(!e||'string'!=typeof e)return'';const t=[...e.matchAll(/<gametxt>([\s\S]*?)<\/gametxt>/gi)];if(t.length>0){return t[t.length-1][1].trim().replace(/<!--[\s\S]*?-->/g,'').trim()}return e},A=e=>{if(!e||'string'!=typeof e)return null;const t=[...e.matchAll(/<UpdateVariable>([\s\S]*?)<\/UpdateVariable>/gi)];return t.length>0?t[t.length-1][1].trim():null},D=(e,t=['gametxt'])=>{const a={isValid:!0,hasGameText:/<gametxt>[\s\S]*?<\/gametxt>/i.test(e),hasUpdateVariable:/<UpdateVariable>[\s\S]*?<\/UpdateVariable>/i.test(e),hasHistoryRecord:/<å†å²è®°å½•>[\s\S]*?<\/å†å²è®°å½•>/i.test(e),missingTags:[]};return t.includes('gametxt')&&!a.hasGameText&&a.missingTags.push('gametxt'),t.includes('UpdateVariable')&&!a.hasUpdateVariable&&a.missingTags.push('UpdateVariable'),t.includes('å†å²è®°å½•')&&!a.hasHistoryRecord&&a.missingTags.push('å†å²è®°å½•'),a.isValid=0===a.missingTags.length,a},x=async(l,r)=>{const i=D(l);i.isValid||(console.warn('[useAIInteraction] AIå“åº”æ ¼å¼ä¸å®Œæ•´:',i.missingTags),'undefined'!=typeof toastr&&toastr.warning(`AIå“åº”ç¼ºå°‘: ${i.missingTags.join(', ')}`,'æ ¼å¼è­¦å‘Š',{timeOut:3e3})),t.value=l,console.log('[useAIInteraction] å·²ä¿å­˜AIå›å¤ç”¨äºä¸‹æ¬¡ä¸Šä¸‹æ–‡æ³¨å…¥');const d=i.hasGameText?M(l):'';if(d){window.__currentSwipeGeneration?(a.value.push(d),n.value=a.value.length-1,e.value=d,delete window.__currentSwipeGeneration,console.log('[useAIInteraction] æ–°swipeå·²æ·»åŠ ')):(e.value=d,a.value=[d],n.value=0,console.log('[useAIInteraction] å†…å®¹å·²æ›´æ–°')),c.value=I()}else i.hasGameText||console.warn('[useAIInteraction] æœªæå–åˆ°æœ‰æ•ˆçš„æ˜¾ç¤ºæ–‡æœ¬ï¼ˆç¼ºå°‘gametxtæ ‡ç­¾ï¼‰');i.hasUpdateVariable&&await U(l),await W(l),await G(l),await H(),T(),o.value=!1,s.value=!1},T=()=>{if(0===p.length)return;console.log('[useAIInteraction] è§¦å‘å˜é‡å¤„ç†å®Œæˆå›è°ƒï¼Œæ•°é‡:',p.length);const e=p.splice(0);for(const t of e)try{t()}catch(e){console.error('[useAIInteraction] å˜é‡å¤„ç†å®Œæˆå›è°ƒæ‰§è¡Œå¤±è´¥:',e)}};let R=null;const L=(e,t,a,n)=>{const o=new Set([...Object.keys(e||{}),...Object.keys(t||{})]);for(const l of o){const o=a?`${a}.${l}`:l,s=e?.[l],r=t?.[l];if(void 0===s&&void 0===r)continue;if(void 0===s&&void 0!==r){n.push({path:o,oldValue:void 0,newValue:r,comment:'æ–°å¢'});continue}if(void 0!==s&&void 0===r)continue;const c=typeof s;if(c===typeof r)if('object'===c&&null!==s&&null!==r){if(Array.isArray(s)||Array.isArray(r)){JSON.stringify(s)!==JSON.stringify(r)&&n.push({path:o,oldValue:s,newValue:r,comment:'æ•°ç»„å˜åŒ–'});continue}L(s,r,o,n)}else s!==r&&n.push({path:o,oldValue:s,newValue:r});else n.push({path:o,oldValue:s,newValue:r,comment:'ç±»å‹å˜åŒ–'})}},P=e=>{const t=[],a=e.deltaData;if(a&&'object'==typeof a&&Object.keys(a).length>0&&(console.log('[useAIInteraction] ä» delta_data æå–å˜é‡å˜åŒ–:',Object.keys(a)),console.log('[useAIInteraction] delta_data å†…å®¹:',JSON.stringify(a).substring(0,500)),O(a,'',t),t.length>0))return t;const n=e.displayData;return n&&'object'==typeof n&&Object.keys(n).length>0&&(console.log('[useAIInteraction] ä» display_data æå–å˜é‡å˜åŒ–:',Object.keys(n)),console.log('[useAIInteraction] display_data å†…å®¹:',JSON.stringify(n).substring(0,500)),j(n,'',t,e),t.length>0)?t:(console.log('[useAIInteraction] delta_data å’Œ display_data éƒ½æ²¡æœ‰å˜åŒ–ï¼Œå°è¯•å¿«ç…§å¯¹æ¯”...'),(e=>{const t=[];if(!R)return console.log('[useAIInteraction] æ²¡æœ‰æ›´æ–°å‰å¿«ç…§ï¼Œæ— æ³•å¯¹æ¯”æ£€æµ‹å˜åŒ–'),t;const a=e.statData;return a&&'object'==typeof a?(L(R,a,'',t),console.log('[useAIInteraction] é€šè¿‡å¯¹æ¯”æ£€æµ‹åˆ°',t.length,'ä¸ªå˜é‡å˜åŒ–'),t):(console.log('[useAIInteraction] å½“å‰æ•°æ®ä¸ºç©ºï¼Œæ— æ³•å¯¹æ¯”æ£€æµ‹å˜åŒ–'),t)})(e))},O=(e,t,a)=>{for(const n of Object.keys(e)){const o=e[n],l=t?`${t}.${n}`:n;if(o&&'object'==typeof o&&'new'in o)a.push({path:l,oldValue:o.old,newValue:o.new,comment:o.reason||o.comment});else if(o&&'object'==typeof o&&'newValue'in o)a.push({path:l,oldValue:o.oldValue,newValue:o.newValue,comment:o.reason||o.comment});else{if(null!=o&&'object'!=typeof o){const e=R?F(R,l):void 0;e!==o&&a.push({path:l,oldValue:e,newValue:o});continue}o&&'object'==typeof o&&!Array.isArray(o)&&O(o,l,a)}}},F=(e,t)=>t.split('.').reduce((e,t)=>e&&'object'==typeof e?e[t]:void 0,e),j=(e,t,a,n)=>{for(const o of Object.keys(e)){const l=e[o],s=t?`${t}.${o}`:o;if('string'==typeof l){const e=n.getVariable(s),t=R?F(R,s):void 0;a.push({path:s,oldValue:t,newValue:e,comment:l})}else l&&'object'==typeof l&&!Array.isArray(l)&&j(l,s,a,n)}},U=async e=>{try{const t=sl();if(i.value=[],!t.isMvuAvailable)return void console.log('[useAIInteraction] MVUä¸å¯ç”¨ï¼Œè·³è¿‡å˜é‡æ›´æ–°');if(!t.mvuData){console.warn('[useAIInteraction] MVUæ•°æ®æœªåŠ è½½ï¼Œå°è¯•åˆå§‹åŒ–...');try{await t.initialize({type:'message',message_id:'latest'}),console.log('[useAIInteraction] MVUåˆå§‹åŒ–æˆåŠŸ')}catch(e){return void console.error('[useAIInteraction] MVUåˆå§‹åŒ–å¤±è´¥:',e)}}if(!A(e))return void console.log('[useAIInteraction] æœªå‘ç°å˜é‡æ›´æ–°æŒ‡ä»¤');console.log('[useAIInteraction] å‘ç°å˜é‡æ›´æ–°æŒ‡ä»¤ï¼Œå¼€å§‹è§£ææ‰§è¡Œ...'),(e=>{try{const t=e.statData;t&&'object'==typeof t?(R=JSON.parse(JSON.stringify(t)),console.log('[useAIInteraction] å·²ä¿å­˜å˜é‡æ›´æ–°å‰å¿«ç…§ï¼Œé¡¶çº§é”®:',Object.keys(R||{}))):R=null}catch(e){console.warn('[useAIInteraction] ä¿å­˜å˜é‡å¿«ç…§å¤±è´¥:',e),R=null}})(t);const a=await t.parseAndExecuteCommands(e);if(a.success){console.log('[useAIInteraction] å˜é‡æ›´æ–°æˆåŠŸï¼Œå…±æ‰§è¡Œ',a.results.length,'æ¡æŒ‡ä»¤'),await t.refresh();if(1===a.results.length&&'MVU_NATIVE'===a.results[0].command?.path){console.log('[useAIInteraction] ä½¿ç”¨ MVU åŸç”Ÿè§£æï¼Œä» MVU æ•°æ®æå–å˜é‡å˜åŒ–...');const e=P(t);i.value=e,console.log('[useAIInteraction] æå–åˆ°',e.length,'ä¸ªå˜é‡å˜åŒ–'),0===e.length&&(console.log('[useAIInteraction] è°ƒè¯•ä¿¡æ¯ - delta_data:',JSON.stringify(t.deltaData).substring(0,300)),console.log('[useAIInteraction] è°ƒè¯•ä¿¡æ¯ - display_data:',JSON.stringify(t.displayData).substring(0,300)),console.log('[useAIInteraction] è°ƒè¯•ä¿¡æ¯ - å¿«ç…§å­˜åœ¨:',!!R))}else a.results.forEach(e=>{e.success&&'MVU_NATIVE'!==e.command?.path&&i.value.push({path:e.command.path,oldValue:e.oldValue,newValue:e.newValue,comment:e.command.comment})});console.log('[useAIInteraction] æœ€ç»ˆå˜é‡å˜åŒ–æ•°:',i.value.length),R=null}else console.warn('[useAIInteraction] å˜é‡æ›´æ–°å¤±è´¥:',a.error),R=null}catch(e){console.error('[useAIInteraction] è§£æå˜é‡æ›´æ–°å¤±è´¥:',e),R=null}},W=async e=>{try{if(await hp.processAIResponse(e)){const e=hp.getStatistics();console.log('[useAIInteraction] ä¸Šä¸‹æ–‡å·²æ›´æ–°:',{å†å²è®°å½•æ•°:e.recordCount,å†å²æ­£æ–‡æ•°:e.textCount,åˆ†æ®µæ­£æ–‡æ•°:e.segmentCount,å°æ€»ç»“æ•°:e.smallSummaryCount,å¤§æ€»ç»“æ•°:e.largeSummaryCount})}}catch(e){console.error('[useAIInteraction] ä¸Šä¸‹æ–‡ç®¡ç†å¤„ç†å¤±è´¥:',e)}},H=async()=>{try{const e=bp.getAutoSaveConfig();if(!e.enabled||!e.saveOnAIResponse)return void console.log('[useAIInteraction] è‡ªåŠ¨å­˜æ¡£æœªå¯ç”¨ï¼Œè·³è¿‡');let t;u.value='saving',console.log('[useAIInteraction] å¼€å§‹æ‰§è¡Œè‡ªåŠ¨å­˜æ¡£...'),'function'==typeof window.getLastMessageId&&(t=window.getLastMessageId());const a=await bp.autoSaveOnAIResponse(t);a?(u.value='success',m.value=a.name,console.log('[useAIInteraction] è‡ªåŠ¨å­˜æ¡£æˆåŠŸ:',a.name),'undefined'!=typeof toastr&&toastr.info(`å·²è‡ªåŠ¨å­˜æ¡£: ${a.name}`,'è‡ªåŠ¨å­˜æ¡£',{timeOut:2e3})):u.value='idle'}catch(e){u.value='error',console.error('[useAIInteraction] è‡ªåŠ¨å­˜æ¡£å¤±è´¥:',e)}},G=async e=>{let t=[],a=!1;try{if(console.log('[useAIInteraction] ä¿å­˜AIå›å¤åˆ°é…’é¦†èŠå¤©è®°å½•ï¼ˆåŒå±‚åŒ–æ¨¡å¼ + é”™è¯¯æ¢å¤ï¼‰'),'function'!=typeof window.TavernHelper?.setChatMessages)return console.warn('[useAIInteraction] TavernHelperä¸å¯ç”¨'),!1;try{const e='function'==typeof window.getLastMessageId?window.getLastMessageId()??-1:-1;e>=0&&(t=await window.TavernHelper.getChatMessages(`0-${e}`),t&&t.length>0&&(t=JSON.parse(JSON.stringify(t)),a=!0,console.log('[useAIInteraction] å·²åˆ›å»ºæ¶ˆæ¯å¿«ç…§ï¼Œå…±',t.length,'æ¡æ¶ˆæ¯')))}catch(e){console.warn('[useAIInteraction] è·å–æ¶ˆæ¯å¿«ç…§å¤±è´¥ï¼Œç»§ç»­æ‰§è¡Œï¼ˆæ— å›æ»šèƒ½åŠ›ï¼‰:',e)}const n=await window.TavernHelper.getChatMessages('0');if(!n||0===n.length)throw new Error('æ¶ˆæ¯0ä¸å­˜åœ¨ï¼Œæ— æ³•ä¿å­˜AIå›å¤');const o=n[0];return o.message=e,await window.TavernHelper.setChatMessages([o],{refresh:'none'}),console.log('[useAIInteraction] AIå›å¤å·²ä¿å­˜åˆ°æ¶ˆæ¯0'),await K(),console.log('[useAIInteraction] åŒå±‚åŒ–ä¿å­˜æˆåŠŸ'),!0}catch(e){if(console.error('[useAIInteraction] ä¿å­˜AIå›å¤å¤±è´¥ï¼Œå°è¯•å›æ»š:',e),a&&t.length>0)try{await window.TavernHelper.setChatMessages(t,{refresh:'none'}),console.log('[useAIInteraction] å›æ»šæˆåŠŸï¼Œå·²æ¢å¤åŸå§‹æ¶ˆæ¯'),'undefined'!=typeof toastr&&toastr.warning('ä¿å­˜å¤±è´¥ï¼Œå·²å›æ»šåˆ°åŸå§‹çŠ¶æ€','åŒå±‚åŒ–é”™è¯¯',{timeOut:3e3})}catch(e){console.error('[useAIInteraction] å›æ»šå¤±è´¥:',e),'undefined'!=typeof toastr&&toastr.error('ä¿å­˜å¤±è´¥ä¸”æ— æ³•å›æ»šï¼Œæ¶ˆæ¯å¯èƒ½å·²æŸå','ä¸¥é‡é”™è¯¯',{timeOut:5e3})}return!1}},K=async()=>{let e=0;for(;e<3;)try{if('function'!=typeof window.getLastMessageId)return!0;const e=window.getLastMessageId?.()??-1;if(e<=0)return console.log('[useAIInteraction] æ— éœ€æ¸…ç†å¤šä½™æ¶ˆæ¯ï¼Œå½“å‰åªæœ‰æ¶ˆæ¯0'),!0;if('function'==typeof window.deleteChatMessages){const t=Array.from({length:e},(_,e)=>e+1);return console.log('[useAIInteraction] åˆ é™¤å¤šä½™æ¶ˆæ¯:',t),await window.deleteChatMessages(t,{refresh:'none'}),console.log('[useAIInteraction] å¤šä½™æ¶ˆæ¯å·²åˆ é™¤ï¼Œä¿æŒåŒå±‚åŒ–'),!0}return!0}catch(t){if(e++,console.warn(`[useAIInteraction] æ¸…ç†å¤šä½™æ¶ˆæ¯å¤±è´¥ (å°è¯• ${e}/3):`,t),e>=3)return console.error('[useAIInteraction] æ¸…ç†å¤šä½™æ¶ˆæ¯æœ€ç»ˆå¤±è´¥ï¼Œæ¶ˆæ¯å±‚çº§å¯èƒ½æ··ä¹±'),'undefined'!=typeof toastr&&toastr.warning('æ¶ˆæ¯æ¸…ç†å¤±è´¥ï¼Œå±‚çº§å¯èƒ½æ··ä¹±','åŒå±‚åŒ–è­¦å‘Š',{timeOut:3e3}),!1;await new Promise(t=>setTimeout(t,100*e))}return!1},J=async()=>{try{if('function'!=typeof window.TavernHelper?.getChatMessages)return!1;const e=await window.TavernHelper.getChatMessages();if(e&&e.length>0)for(let t=0;t<e.length;t++)if(!e[t].is_user)return e.splice(t,1),await window.TavernHelper.setChatMessages(e,{refresh:'none'}),!0;return!1}catch(e){return console.error('[useAIInteraction] åˆ é™¤é…’é¦†æ¶ˆæ¯å¤±è´¥:',e),!1}},q=async()=>{try{if('function'!=typeof window.getChatMessages)return console.warn('[useAIInteraction] getChatMessageså‡½æ•°ä¸å¯ç”¨'),!1;const o=window.getLastMessageId?.()??-1;if(o<0)return console.log('[useAIInteraction] é…’é¦†èŠå¤©è®°å½•ä¸ºç©º'),!1;const l=await window.getChatMessages(`0-${o}`,{role:'all',hide_state:'unhidden',include_swipes:!0});for(let o=l.length-1;o>=0;o--){const s=l[o];if('user'!==s.role){const o=s.swipes?.[s.swipe_id||0]||s.message||'',l=M(o);if(l)return e.value=l,a.value=s.swipes?s.swipes.map(e=>M(e)):[l],n.value=s.swipe_id||0,c.value=I(),t.value=o,console.log('[useAIInteraction] å·²åŠ è½½æœ€æ–°å†…å®¹ï¼Œå¹¶æ¢å¤lastAIResponseï¼Œé•¿åº¦:',o.length),!0}}return!1}catch(e){return console.error('[useAIInteraction] ä»é…’é¦†åŠ è½½å†…å®¹å¤±è´¥:',e),!1}},Y=e=>{const a=sl();let n,o={};try{if('undefined'!=typeof window&&window.Mvu){const e=window.Mvu;if('function'==typeof e.getMvuData){const t=e.getMvuData({type:'message',message_id:'latest'});t&&t.stat_data?(o=t.stat_data,console.log('[useAIInteraction] ä» MVU API è·å–åˆ°å˜é‡æ•°æ®ï¼Œé”®æ•°é‡:',Object.keys(o).length)):console.warn('[useAIInteraction] MVU API è¿”å›æ•°æ®ä¸ºç©º')}}0===Object.keys(o).length&&(a.mvuData?.stat_data?(o=a.mvuData.stat_data,console.log('[useAIInteraction] ä» store ç¼“å­˜è·å–å˜é‡æ•°æ®ï¼Œé”®æ•°é‡:',Object.keys(o).length)):console.warn('[useAIInteraction] store ç¼“å­˜ä¸­ä¹Ÿæ²¡æœ‰å˜é‡æ•°æ®')),0===Object.keys(o).length&&a.isMvuAvailable&&(console.log('[useAIInteraction] å°è¯•å¼ºåˆ¶åˆ·æ–° store...'),a.refresh().catch(e=>{console.error('[useAIInteraction] åˆ·æ–° store å¤±è´¥:',e)}),a.mvuData?.stat_data&&(o=a.mvuData.stat_data))}catch(e){console.error('[useAIInteraction] è·å– MVU æ•°æ®å¤±è´¥:',e)}try{n=JSON.stringify(o,null,2)}catch(e){console.error('[useAIInteraction] åºåˆ—åŒ–å˜é‡æ•°æ®å¤±è´¥:',e),n='{}'}let l='';l+=`<status_current_variables>\n${n}\n</status_current_variables>\n\n`,t.value&&(l+=`<last_ai_response>\n${t.value}\n</last_ai_response>\n\n`,console.log('[useAIInteraction] å·²æ³¨å…¥ä¸Šä¸€æ¬¡AIå›å¤ï¼Œé•¿åº¦:',t.value.length)),l+=e;const s=Object.keys(o);return console.log('[useAIInteraction] å·²æ„å»ºåŒ…å«å˜é‡æ•°æ®å’Œä¸Šä¸‹æ–‡çš„prompt:',{å˜é‡æ•°æ®å¤§å°:n.length+'å­—ç¬¦',é¡¶çº§é”®:s,MCé”®:o.MC?Object.keys(o.MC):'æ— MCå¯¹è±¡',ç”¨æˆ·è¾“å…¥é•¿åº¦:e.length+'å­—ç¬¦',ä¸Šä¸€æ¬¡AIå›å¤é•¿åº¦:t.value?t.value.length+'å­—ç¬¦':'æ— '}),l},X=()=>{try{return w?(console.log('[useAIInteraction] ç›‘å¬å™¨å·²å­˜åœ¨ï¼Œè·³è¿‡é‡å¤ç»‘å®š'),!0):(console.log('[useAIInteraction] è®¾ç½®AIäº‹ä»¶ç›‘å¬å™¨'),'function'!=typeof window.eventOn?(console.warn('[useAIInteraction] eventOnå‡½æ•°ä¸å¯ç”¨'),!1):(Z(),b=(t,a)=>(t=>{if(!t)return;console.log('[useAIInteraction] æ”¶åˆ°æµå¼æ–‡æœ¬ï¼Œé•¿åº¦:',t.length);const a=M(t);a&&(s.value=!0,o.value=!1,e.value=a)})(t),C=(l,c)=>(async(l,c)=>{if(!l)return console.warn('[useAIInteraction] æ”¶åˆ°ç©ºçš„AIå›å¤'),o.value=!1,void(s.value=!1);console.log('[useAIInteraction] AIç”Ÿæˆç»“æŸï¼ŒID:',c),console.log('[useAIInteraction] AIå›å¤é•¿åº¦:',l.length);try{if(r.value=null,g.value){console.log('[useAIInteraction] å®¡æŸ¥æ¨¡å¼å¯ç”¨ï¼Œå¼€å§‹å®¡æŸ¥AIå›å¤...'),k.value={currentContent:e.value,swipes:[...a.value],currentSwipeIndex:n.value,lastAIResponse:t.value},console.log('[useAIInteraction] å·²ä¿å­˜å®¡æŸ¥å‰å†…å®¹å¿«ç…§ï¼Œå†…å®¹é•¿åº¦:',e.value.length);const o=_f.review(l);y.value=o,V.value=l,N.value=c;const r=M(l);return r&&(e.value=r),h.value=!0,s.value=!1,void console.log('[useAIInteraction] å®¡æŸ¥ç»“æœ:',{passed:o.passed,issueCount:o.issues.length,variableCommands:o.variableCheck?.commands?.length||0})}await x(l,c)}catch(e){console.error('[useAIInteraction] å¤„ç†AIå›å¤å¤±è´¥:',e),r.value=e instanceof Error?e.message:'å¤„ç†AIå›å¤å¤±è´¥',o.value=!1,s.value=!1}})(l,c),void 0!==window.iframe_events?(window.eventOn(window.iframe_events.STREAM_TOKEN_RECEIVED_FULLY,b),window.eventOn(window.iframe_events.GENERATION_ENDED,C)):(window.eventOn('js_stream_token_received_fully',b),window.eventOn('js_generation_ended',C)),w=!0,console.log('[useAIInteraction] ç›‘å¬å™¨è®¾ç½®æˆåŠŸ'),!0))}catch(e){return console.error('[useAIInteraction] è®¾ç½®AIç›‘å¬å™¨å¤±è´¥:',e),!1}},Z=()=>{try{if(!w&&!b&&!C)return;console.log('[useAIInteraction] æ¸…ç†AIäº‹ä»¶ç›‘å¬å™¨'),'function'==typeof window.eventRemoveListener&&(b&&(void 0!==window.iframe_events?window.eventRemoveListener(window.iframe_events.STREAM_TOKEN_RECEIVED_FULLY,b):window.eventRemoveListener('js_stream_token_received_fully',b)),C&&(void 0!==window.iframe_events?window.eventRemoveListener(window.iframe_events.GENERATION_ENDED,C):window.eventRemoveListener('js_generation_ended',C))),b=null,C=null,w=!1}catch(e){console.error('[useAIInteraction] æ¸…ç†AIç›‘å¬å™¨å¤±è´¥:',e)}},Q=()=>e.value||0!==a.value.length||t.value?{currentContent:e.value,swipes:[...a.value],currentSwipeIndex:n.value,lastUserInput:d.value,lastUpdateTime:c.value,lastAIResponse:t.value}:null,ee=async o=>{console.log('[useAIInteraction] æ¢å¤AIå†…å®¹æ•°æ®ï¼ˆå«é…’é¦†èŠå¤©å±‚åŒæ­¥ v2ï¼‰'),e.value=o.currentContent||'',a.value=o.swipes||[],n.value=o.currentSwipeIndex||0,d.value=o.lastUserInput||'',c.value=o.lastUpdateTime||'',t.value=o.lastAIResponse||'',console.log('[useAIInteraction] VueçŠ¶æ€å·²æ¢å¤:',{contentLength:e.value.length,swipesCount:a.value.length,currentIndex:n.value,lastAIResponseLength:t.value.length,hasMessage0Snapshot:!!o.chatMessage0Snapshot,message0SnapshotLength:o.chatMessage0Snapshot?.length||0});const l=o.chatMessage0Snapshot||o.lastAIResponse||'';if(l){const e=o.chatMessage0Snapshot?'æ¶ˆæ¯0å¿«ç…§':'lastAIResponse';console.log(`[useAIInteraction] ä½¿ç”¨ ${e} æ¢å¤é…’é¦†èŠå¤©å±‚ï¼Œé•¿åº¦: ${l.length}`);try{await G(l)?console.log(`[useAIInteraction] é…’é¦†èŠå¤©å±‚å·²æ¢å¤ï¼ˆæ¥æº: ${e}ï¼‰`):console.warn('[useAIInteraction] é…’é¦†èŠå¤©å±‚æ¢å¤å¤±è´¥ï¼Œä»…å‰ç«¯æ˜¾ç¤ºå·²æ¢å¤')}catch(e){console.error('[useAIInteraction] é…’é¦†èŠå¤©å±‚æ¢å¤å¼‚å¸¸:',e)}o.chatMessage0Snapshot&&!t.value&&(t.value=o.chatMessage0Snapshot,console.log('[useAIInteraction] ç”¨æ¶ˆæ¯0å¿«ç…§å¡«å…… lastAIResponseï¼ˆç¡®ä¿ä¸Šä¸‹æ–‡æ³¨å…¥ï¼‰'))}else console.log('[useAIInteraction] æ— å¯ç”¨å†…å®¹ï¼Œè·³è¿‡é…’é¦†èŠå¤©å±‚åŒæ­¥')};(0,l.onMounted)(async()=>{console.log('[useAIInteraction] Composableå·²æŒ‚è½½'),X(),bp.setAIContentDataProvider(Q),bp.setAIContentDataRestorer(ee),await hp.initialize(),await te(),await q()});const te=async(e=3e3,t=100)=>{const a=sl(),n=Date.now();for(;Date.now()-n<e;){if(a.isMvuAvailable&&a.mvuData?.stat_data)return void console.log('[useAIInteraction] MVU Store å·²å°±ç»ª');if(a.isLoading)await new Promise(e=>setTimeout(e,t));else{if(!a.isLoading&&!a.mvuData){console.log('[useAIInteraction] è§¦å‘ MVU Store åˆå§‹åŒ–...');try{await a.initialize()}catch(e){console.warn('[useAIInteraction] MVU Store åˆå§‹åŒ–å¤±è´¥:',e)}}await new Promise(e=>setTimeout(e,t))}}console.warn('[useAIInteraction] ç­‰å¾… MVU Store è¶…æ—¶ï¼Œç»§ç»­æ‰§è¡Œ')};return(0,l.onUnmounted)(()=>{console.log('[useAIInteraction] Composableæ­£åœ¨å¸è½½'),Z()}),{currentContent:e,swipes:a,currentSwipeIndex:n,isProcessing:o,isStreaming:s,error:r,lastUpdateTime:c,variableChanges:i,lastAIResponse:t,hasContent:S,hasMultipleSwipes:B,sendMessageToAI:async t=>{if(!t.trim())return r.value='æ¶ˆæ¯ä¸èƒ½ä¸ºç©º',!1;try{if(console.log('[useAIInteraction] å‘é€æ¶ˆæ¯ç»™AIï¼ˆåŒå±‚åŒ–æ¨¡å¼ + ä¸»åŠ¨å˜é‡æ³¨å…¥ï¼‰:',t),d.value=t.trim(),e.value='',a.value=[],n.value=0,i.value=[],'function'!=typeof window.generate)throw new Error('generateå‡½æ•°ä¸å¯ç”¨ï¼Œè¯·ç¡®ä¿åœ¨é…’é¦†ç¯å¢ƒä¸­è¿è¡Œ');o.value=!0,r.value=null;const l=Y(t.trim()),s=$s().streamingEnabled;return console.log('[useAIInteraction] æµå¼ä¼ è¾“æ¨¡å¼:',s?'å¼€å¯':'å…³é—­'),await window.generate({user_input:l,should_stream:s,max_chat_history:0}),!0}catch(e){return console.error('[useAIInteraction] å‘é€æ¶ˆæ¯å¤±è´¥:',e),r.value=e instanceof Error?e.message:'å‘é€æ¶ˆæ¯å¤±è´¥',o.value=!1,!1}},regenerateAIResponse:async()=>{try{if(console.log('[useAIInteraction] é‡æ–°ç”ŸæˆAIå›å¤ï¼ˆä¸»åŠ¨å˜é‡æ³¨å…¥ï¼‰'),!d.value)return console.warn('[useAIInteraction] æ²¡æœ‰å¯é‡æ–°ç”Ÿæˆçš„ç”¨æˆ·è¾“å…¥'),!1;if('function'!=typeof window.generate)throw new Error('generateå‡½æ•°ä¸å¯ç”¨');await J(),e.value='',a.value=[],n.value=0,i.value=[],o.value=!0,r.value=null;const t=Y(d.value),l=$s().streamingEnabled;return await window.generate({user_input:t,should_stream:l,max_chat_history:0}),!0}catch(e){return console.error('[useAIInteraction] é‡æ–°ç”Ÿæˆå¤±è´¥:',e),r.value=e instanceof Error?e.message:'é‡æ–°ç”Ÿæˆå¤±è´¥',o.value=!1,!1}},generateSwipe:async()=>{try{if(console.log('[useAIInteraction] ç”Ÿæˆæ›´å¤šå›å¤ï¼ˆä¸»åŠ¨å˜é‡æ³¨å…¥ï¼‰'),!d.value)return console.warn('[useAIInteraction] æ²¡æœ‰å¯ç”Ÿæˆswipeçš„ç”¨æˆ·è¾“å…¥'),!1;if('function'!=typeof window.generate)throw new Error('generateå‡½æ•°ä¸å¯ç”¨');await J(),window.__currentSwipeGeneration=!0,o.value=!0,r.value=null;const e=Y(d.value),t=$s().streamingEnabled;return await window.generate({user_input:e,should_stream:t,max_chat_history:0}),!0}catch(e){return console.error('[useAIInteraction] ç”Ÿæˆswipeå¤±è´¥:',e),r.value=e instanceof Error?e.message:'ç”Ÿæˆswipeå¤±è´¥',o.value=!1,delete window.__currentSwipeGeneration,!1}},switchSwipe:t=>{if(a.value.length<=1)return;let o=n.value;o='prev'===t?o>0?o-1:a.value.length-1:o<a.value.length-1?o+1:0,n.value=o,e.value=a.value[o]},clearContent:async()=>{if(e.value='',a.value=[],n.value=0,i.value=[],d.value='',t.value='',r.value=null,c.value='','function'==typeof window.deleteChatMessages)try{const e=window.getLastMessageId?.()??-1;if(e>=0){const t=Array.from({length:e+1},(_,e)=>e);await window.deleteChatMessages(t,{refresh:'none'})}}catch(e){console.error('[useAIInteraction] æ¸…é™¤é…’é¦†èŠå¤©è®°å½•å¤±è´¥:',e)}},loadLatestFromTavern:q,setupAIListeners:X,cleanupAIListeners:Z,extractGameText:M,extractUpdateVariableContent:A,buildPromptWithVariables:Y,validateResponseFormat:D,contextManagerService:hp,autoSaveStatus:u,lastAutoSaveName:m,performAutoSave:H,triggerManualAutoSave:async()=>{try{let e;u.value='saving','function'==typeof window.getLastMessageId&&(e=window.getLastMessageId());const t=await bp.createAutoSave(`[æ‰‹åŠ¨è§¦å‘] ${(new Date).toLocaleTimeString('zh-CN')}`,'auto',e);return t?(u.value='success',m.value=t.name,!0):(u.value='error',!1)}catch(e){return u.value='error',console.error('[useAIInteraction] æ‰‹åŠ¨è§¦å‘è‡ªåŠ¨å­˜æ¡£å¤±è´¥:',e),!1}},getAIContentData:Q,restoreAIContentData:ee,onceVariablesProcessed:e=>{p.push(e)},reviewModeEnabled:g,showReviewDialog:h,currentReviewResult:y,isReviewProcessing:E,confirmReview:async()=>{if(V.value){console.log('[useAIInteraction] ç”¨æˆ·ç¡®è®¤å®¡æŸ¥ï¼Œç»§ç»­å¤„ç†AIå›å¤'),E.value=!0;try{h.value=!1,await x(V.value,N.value||''),V.value=null,N.value=null,y.value=null,k.value=null,console.log('[useAIInteraction] å®¡æŸ¥ç¡®è®¤å¤„ç†å®Œæˆ')}catch(e){console.error('[useAIInteraction] å®¡æŸ¥ç¡®è®¤å¤„ç†å¤±è´¥:',e),r.value=e instanceof Error?e.message:'å¤„ç†å¤±è´¥'}finally{E.value=!1}}else console.warn('[useAIInteraction] æ²¡æœ‰å¾…å¤„ç†çš„AIå›å¤')},rollbackReview:async()=>{console.log('[useAIInteraction] ç”¨æˆ·å›é€€å®¡æŸ¥ï¼Œå–æ¶ˆæœ¬æ¬¡AIå›å¤'),E.value=!0;try{if(h.value=!1,k.value)console.log('[useAIInteraction] æ¢å¤å®¡æŸ¥å‰çš„å†…å®¹å¿«ç…§'),e.value=k.value.currentContent,a.value=[...k.value.swipes],n.value=k.value.currentSwipeIndex,t.value=k.value.lastAIResponse,console.log('[useAIInteraction] å·²æ¢å¤å†…å®¹ï¼Œé•¿åº¦:',e.value.length);else{console.warn('[useAIInteraction] æ²¡æœ‰å®¡æŸ¥å‰å¿«ç…§ï¼Œå°è¯•ä»é…’é¦†æ¢å¤...');if(!await q()&&t.value){const o=M(t.value);o&&(e.value=o,a.value=[o],n.value=0,console.log('[useAIInteraction] å·²ä» lastAIResponse æ¢å¤å†…å®¹'))}}V.value=null,N.value=null,y.value=null,k.value=null,await K(),'undefined'!=typeof toastr&&toastr.info('å·²å›é€€æœ¬æ¬¡AIå›å¤ï¼Œä¿ç•™ä¸Šä¸€æ¬¡å†…å®¹','å®¡æŸ¥å›é€€',{timeOut:2e3}),console.log('[useAIInteraction] å®¡æŸ¥å›é€€å®Œæˆï¼Œå·²ä¿ç•™ä¸Šä¸€æ¬¡å†…å®¹')}catch(e){console.error('[useAIInteraction] å®¡æŸ¥å›é€€å¤±è´¥:',e)}finally{E.value=!1,o.value=!1,s.value=!1}},toggleReviewMode:()=>(g.value=!g.value,console.log('[useAIInteraction] å®¡æŸ¥æ¨¡å¼:',g.value?'å¯ç”¨':'ç¦ç”¨'),'undefined'!=typeof toastr&&toastr.info(g.value?'å®¡æŸ¥æ¨¡å¼å·²å¯ç”¨':'å®¡æŸ¥æ¨¡å¼å·²ç¦ç”¨','è®¾ç½®',{timeOut:2e3}),g.value),setReviewMode:e=>{g.value=e,console.log('[useAIInteraction] å®¡æŸ¥æ¨¡å¼è®¾ç½®ä¸º:',e?'å¯ç”¨':'ç¦ç”¨')},aiResponseReviewService:_f,isMvuInterceptorEnabled:v,currentFilterPreset:f,initializeMvuInterceptor:()=>(console.log('[useAIInteraction] MVUæ‹¦æˆªå™¨å·²ç¦ç”¨ï¼Œè·³è¿‡åˆå§‹åŒ–'),!1),toggleMvuInterceptor:()=>(console.log('[useAIInteraction] MVUæ‹¦æˆªå™¨å·²ç¦ç”¨'),!1),enableMvuInterceptor:()=>{console.log('[useAIInteraction] MVUæ‹¦æˆªå™¨å·²ç¦ç”¨')},disableMvuInterceptor:()=>{console.log('[useAIInteraction] MVUæ‹¦æˆªå™¨å·²ç¦ç”¨')},setFilterPreset:e=>{console.log('[useAIInteraction] MVUæ‹¦æˆªå™¨å·²ç¦ç”¨ï¼Œæ— æ³•è®¾ç½®é¢„è®¾:',e)},getMvuInterceptorStats:()=>null,getAverageCompressionRatio:()=>0,mvuInterceptorService:null}}const $f={class:'main-area'},Rf={class:'modal help-modal'},Lf={class:'modal-header'},Pf={class:'modal-footer'},Of={class:'modal save-manager-modal'},Ff={class:'modal context-manager-modal'},jf={class:'modal history-text-modal'},Uf={class:'modal roster-modal'},zf={class:'modal document-modal'},Wf={class:'modal form-modal'},Hf={class:'modal changelog-modal'},Gf={class:'modal variable-manager-modal'},Kf=(0,l.defineComponent)({__name:'GameLayout',setup(e){const{currentContent:t,isProcessing:a,isStreaming:n,error:o,lastUpdateTime:s,variableChanges:r,sendMessageToAI:c,reviewModeEnabled:i,showReviewDialog:d,currentReviewResult:u,isReviewProcessing:m,confirmReview:p,rollbackReview:v,toggleReviewMode:f,onceVariablesProcessed:g}=Tf(),{quickSave:h,quickLoad:y}=Cp(),{statData:V,isMvuAvailable:N,getVariable:E,refresh:k,updateVersion:b,onUpdate:C,forceRefresh:w}=function(e){const t=sl(),a=(0,l.ref)(0),n=(0,l.ref)('pending'),o=(0,l.ref)(null);let s=null,r=null,c=0;const i=async()=>{try{return n.value='initializing',o.value=null,await t.initialize(e),t.isMvuAvailable&&t.mvuData?(n.value='success',console.log('[useMVU] MVUåˆå§‹åŒ–æˆåŠŸ'),!0):t.isMvuAvailable?t.mvuData?(n.value='success',!0):(n.value='failed',o.value='MVUæ•°æ®ä¸ºç©º',console.warn('[useMVU] MVUæ•°æ®ä¸ºç©º'),!1):(n.value='failed',o.value='MVUæ¡†æ¶ä¸å¯ç”¨',console.warn('[useMVU] MVUæ¡†æ¶ä¸å¯ç”¨'),!1)}catch(e){return n.value='failed',o.value=e instanceof Error?e.message:'åˆå§‹åŒ–å¤±è´¥',console.error('[useMVU] MVUåˆå§‹åŒ–å¤±è´¥:',e),!1}},d=()=>{if(c>=3)return console.warn('[useMVU] å·²è¾¾æœ€å¤§é‡è¯•æ¬¡æ•°ï¼Œåœæ­¢é‡è¯•'),void(n.value='failed');c++,n.value='retrying';const e=1e3*c;console.log(`[useMVU] å°†åœ¨ ${e}ms åè¿›è¡Œç¬¬ ${c} æ¬¡é‡è¯•...`),r=setTimeout(async()=>{!await i()&&c<3&&d()},e)};return(0,l.onMounted)(async()=>{console.log('[useMVU] onMounted, isMvuAvailable:',t.isMvuAvailable),t.isMvuAvailable&&t.mvuData?(console.log('[useMVU] Storeå·²åˆå§‹åŒ–ï¼Œè·³è¿‡åˆå§‹åŒ–'),n.value='success'):await i()||d(),s=t.onUpdateEnd(()=>{console.log('[useMVU] æ”¶åˆ°å˜é‡æ›´æ–°ç»“æŸäº‹ä»¶ï¼Œè§¦å‘åˆ·æ–°'),a.value++,'failed'!==n.value&&'retrying'!==n.value||(n.value='success',o.value=null,console.log('[useMVU] MVUå·²å°±ç»ªï¼ˆé€šè¿‡æ›´æ–°äº‹ä»¶ç¡®è®¤ï¼‰'))})}),(0,l.onUnmounted)(()=>{s&&(s(),s=null),r&&(clearTimeout(r),r=null)}),{mvuData:(0,l.computed)(()=>(a.value,t.mvuData)),statData:(0,l.computed)(()=>(a.value,t.statData)),displayData:(0,l.computed)(()=>(a.value,t.displayData)),deltaData:(0,l.computed)(()=>(a.value,t.deltaData)),isLoading:(0,l.computed)(()=>t.isLoading),error:(0,l.computed)(()=>t.error),isMvuAvailable:(0,l.computed)(()=>t.isMvuAvailable),updateVersion:a,initState:n,initError:o,refresh:t.refresh,forceRefresh:()=>(a.value++,t.refresh()),getVariable:t.getVariable,setVariable:t.setVariable,setVariables:t.setVariables,updateVariable:t.updateVariable,clearError:t.clearError,onUpdate:e=>t.onUpdateEnd(e),retryInitialize:async()=>(r&&(clearTimeout(r),r=null),c=0,await i())}}(),S=(0,l.computed)(()=>{b.value;return E('MC.ç³»ç»Ÿ.å½“å‰æ—¶é—´.æ—¥æœŸ','')}),B=(0,l.computed)(()=>{b.value;return E('MC.ç³»ç»Ÿ.å½“å‰æ—¶é—´.æ—¶é—´','')}),M=(0,l.computed)(()=>{b.value;return E('MC.ç³»ç»Ÿ.å½“å‰åœ°ç‚¹','')}),A=(0,l.computed)(()=>{b.value;return E('MC.ç©å®¶.å§“å','')}),D=(0,l.computed)(()=>{b.value;return E('MC.ç©å®¶.èŒä½','')}),x=(0,l.computed)(()=>{b.value;return E('MC.ç©å®¶.éƒ¨é—¨','')});(0,l.watch)([V,b],([e,t])=>{e&&console.log('[GameLayout] MVUæ•°æ®æ›´æ–° (v'+t+'):',{æ—¥æœŸ:E('MC.ç³»ç»Ÿ.å½“å‰æ—¶é—´.æ—¥æœŸ',''),æ—¶é—´:E('MC.ç³»ç»Ÿ.å½“å‰æ—¶é—´.æ—¶é—´',''),åœ°ç‚¹:E('MC.ç³»ç»Ÿ.å½“å‰åœ°ç‚¹',''),ç©å®¶å§“å:E('MC.ç©å®¶.å§“å',''),ç©å®¶èŒä½:E('MC.ç©å®¶.èŒä½',''),ç©å®¶éƒ¨é—¨:E('MC.ç©å®¶.éƒ¨é—¨','')})},{deep:!1,immediate:!1});const T=(0,l.ref)(!1),R=(0,l.ref)(!1),L=(0,l.ref)(!1),P=(0,l.ref)('connected'),O=(0,l.ref)(!1),F=(0,l.ref)('workplace'),j=(0,l.ref)(!1),U=(0,l.ref)(!1),W=(0,l.ref)(!1),H=(0,l.ref)(!1),G=(0,l.ref)(!1),K=(0,l.ref)(!1),J=(0,l.ref)(!1),q=(0,l.ref)(!1),Y=(0,l.ref)(!1),X=(0,l.ref)(!1),Z=(0,l.ref)(!1),Q=()=>{document.fullscreenElement?(document.exitFullscreen?.(),T.value=!1):(document.documentElement.requestFullscreen?.(),T.value=!0)},ee=()=>{T.value=!!document.fullscreenElement},te=e=>{'handbook'!==e?'personnel'!==e?'forms'!==e?(F.value=e,console.log('[GameLayout] åˆ‡æ¢åˆ°è§†å›¾:',e)):q.value=!0:K.value=!0:J.value=!0},ae=async e=>{console.log('[GameLayout] å‘é€æ¶ˆæ¯ç»™AI:',e);try{await c(e)}catch(e){console.error('[GameLayout] AIäº¤äº’é”™è¯¯:',e),'undefined'!=typeof toastr&&toastr.error('å‘é€æ¶ˆæ¯å¤±è´¥ï¼Œè¯·é‡è¯•')}},ne=()=>{console.log('[GameLayout] æ¸…é™¤AIé”™è¯¯')};let oe=null;const le=async e=>{console.log('[GameLayout] æ”¶åˆ°å¼€å§‹æ¸¸æˆè¯·æ±‚ï¼Œprompté•¿åº¦:',e.prompt.length,'æœ‰directVariables:',!!e.directVariables),e.directVariables&&(oe=e.directVariables,console.log('[GameLayout] æ–‡æ¡£å˜é‡æ•°æ®å·²æš‚å­˜ï¼Œæ³¨å†Œå˜é‡å¤„ç†å®Œæˆå›è°ƒ'),g(()=>{se()}));try{if(await c(e.prompt),'undefined'!=typeof toastr){const t=e.directVariables?'AIæ­£åœ¨ç”Ÿæˆå¼€å±€å†…å®¹ï¼Œæ–‡æ¡£å˜é‡å°†åœ¨ AI å®Œæˆåå†™å…¥...':'æ¸¸æˆå¼€å§‹ï¼Œæ­£åœ¨ç”Ÿæˆå¼€å±€åœºæ™¯...';toastr.success(t,'å¼€å§‹æ¸¸æˆ',{timeOut:3e3})}}catch(e){console.error('[GameLayout] å¼€å§‹æ¸¸æˆå¤±è´¥:',e),oe=null,'undefined'!=typeof toastr&&toastr.error('å¼€å§‹æ¸¸æˆå¤±è´¥ï¼Œè¯·é‡è¯•','é”™è¯¯',{timeOut:3e3})}},se=async()=>{const e=oe;if(!e)return;oe=null;const t=Object.keys(e).length;console.log('[GameLayout] AI å“åº”å®Œæˆï¼Œå¼€å§‹ç›´æ¥å†™å…¥æ–‡æ¡£å˜é‡...',Object.keys(e));try{const a=sl();await a.setVariables(e,'å¼€å±€åˆå§‹åŒ–')?(console.log('[GameLayout] æ–‡æ¡£å˜é‡å†™å…¥æˆåŠŸï¼Œå…±å†™å…¥',t,'ä¸ªå˜é‡'),w(),'undefined'!=typeof toastr&&toastr.success(`æ–‡æ¡£å˜é‡å·²å†™å…¥ï¼ˆ${t} ä¸ªï¼‰`,'ç›´æ¥å¼€å§‹',{timeOut:3e3})):(console.warn('[GameLayout] æ–‡æ¡£å˜é‡å†™å…¥å¤±è´¥'),'undefined'!=typeof toastr&&toastr.warning('æ–‡æ¡£å˜é‡å†™å…¥å¯èƒ½å¤±è´¥ï¼Œè¯·æ£€æŸ¥å˜é‡é¢æ¿','è­¦å‘Š',{timeOut:4e3}))}catch(e){console.error('[GameLayout] æ–‡æ¡£å˜é‡å†™å…¥å¤±è´¥:',e),'undefined'!=typeof toastr&&toastr.error('æ–‡æ¡£å˜é‡å†™å…¥å¤±è´¥','é”™è¯¯',{timeOut:3e3})}},re=()=>{Z.value=!Z.value,Z.value?document.documentElement.classList.add('dark-theme'):document.documentElement.classList.remove('dark-theme'),console.log('[GameLayout] ä¸»é¢˜åˆ‡æ¢:',Z.value?'æ·±è‰²':'æµ…è‰²')},ce=e=>{console.log('[GameLayout] å­˜æ¡£å·²åŠ è½½:',e),W.value=!1,'undefined'!=typeof toastr&&toastr.success('å­˜æ¡£å·²åŠ è½½')},ie=e=>{console.log('[GameLayout] å­˜æ¡£å·²åˆ›å»º:',e),'undefined'!=typeof toastr&&toastr.success('å­˜æ¡£å·²åˆ›å»º')},de=(e,t)=>{console.log('[GameLayout] å˜é‡å·²æ›´æ–°:',e,t),w(),'undefined'!=typeof toastr&&toastr.success(`å˜é‡ ${e} å·²æ›´æ–°`)},ue=async()=>{console.log('[GameLayout] ç”¨æˆ·ç¡®è®¤AIå“åº”å®¡æŸ¥');try{await p(),w()}catch(e){console.error('[GameLayout] å®¡æŸ¥ç¡®è®¤å¤„ç†å¤±è´¥:',e)}},me=async()=>{console.log('[GameLayout] ç”¨æˆ·å›é€€AIå“åº”');try{await v()}catch(e){console.error('[GameLayout] å®¡æŸ¥å›é€€å¤„ç†å¤±è´¥:',e)}},pe=()=>{L.value=window.innerWidth<=768,L.value||(R.value=!1)},ve=()=>{pe()};return(0,l.onMounted)(()=>{console.log('[GameLayout] MCliteå¸ƒå±€å·²åŠ è½½'),document.addEventListener('fullscreenchange',ee),window.addEventListener('resize',ve),pe(),console.log('[GameLayout] MVUå¯ç”¨çŠ¶æ€:',N.value)}),(0,l.onUnmounted)(()=>{document.removeEventListener('fullscreenchange',ee),window.removeEventListener('resize',ve)}),(e,c)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{class:(0,l.normalizeClass)(['game-layout',{'is-fullscreen':T.value,'sidebar-open':R.value}])},[(0,l.createCommentVNode)(' é¡¶éƒ¨çŠ¶æ€æ  '),(0,l.createVNode)(I,{'connection-status':P.value,'is-fullscreen':T.value,'is-dark-theme':Z.value,'game-date':S.value,'game-period':B.value,'game-location':M.value,'player-name':A.value,'player-position':D.value,'player-department':x.value,onToggleFullscreen:Q,onToggleTheme:re},null,8,['connection-status','is-fullscreen','is-dark-theme','game-date','game-period','game-location','player-name','player-position','player-department']),(0,l.createCommentVNode)(' ä¸­é—´åŒºåŸŸï¼šä¸»å†…å®¹ + å³ä¾§å¯¼èˆª '),(0,l.createElementVNode)('div',$f,[(0,l.createCommentVNode)(' ä¸»å†…å®¹åŒºï¼ˆæ¸¸æˆæ–‡æœ¬æ˜¾ç¤ºåŒºåŸŸï¼‰ '),(0,l.createVNode)(Zl,{ref:'mainContentRef','current-content':(0,l.unref)(t),'is-processing':(0,l.unref)(a),'is-streaming':(0,l.unref)(n),'variable-changes':(0,l.unref)(r),'last-update-time':(0,l.unref)(s),onGameStart:le},null,8,['current-content','is-processing','is-streaming','variable-changes','last-update-time']),(0,l.createCommentVNode)(' å³ä¾§å¯¼èˆªæ  '),(0,l.createVNode)(cr,{ref:'sidebarRef','active-menu':F.value,collapsed:O.value,'mobile-visible':R.value,onMenuChange:te,'onUpdate:collapsed':c[0]||(c[0]=e=>O.value=e),onOpenHelp:c[1]||(c[1]=e=>j.value=!0),onOpenAiFilter:c[2]||(c[2]=e=>U.value=!0),onOpenSaveManager:c[3]||(c[3]=e=>W.value=!0),onOpenContextManager:c[4]||(c[4]=e=>H.value=!0),onOpenHistoryText:c[5]||(c[5]=e=>G.value=!0),onOpenChangelog:c[6]||(c[6]=e=>Y.value=!0),onOpenVariableManager:c[7]||(c[7]=e=>X.value=!0),onCloseMobile:c[8]||(c[8]=e=>R.value=!1)},null,8,['active-menu','collapsed','mobile-visible']),(0,l.createCommentVNode)(' ç§»åŠ¨ç«¯ä¾§è¾¹æ é®ç½© '),R.value&&L.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'sidebar-overlay',onClick:c[9]||(c[9]=e=>R.value=!1)})):(0,l.createCommentVNode)('v-if',!0)]),(0,l.createCommentVNode)(' ç§»åŠ¨ç«¯æµ®åŠ¨èœå•æŒ‰é’® '),L.value&&!R.value?((0,l.openBlock)(),(0,l.createElementBlock)('button',{key:0,class:'mobile-menu-fab',title:'æ‰“å¼€èœå•',onClick:c[10]||(c[10]=e=>R.value=!0)},[...c[30]||(c[30]=[(0,l.createElementVNode)('span',{class:'fab-icon'},'â˜°',-1)])])):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' åº•éƒ¨è¾“å…¥æ  '),(0,l.createVNode)(Ts,{ref:'bottomBarRef','is-loading':(0,l.unref)(a),error:(0,l.unref)(o),onSend:ae,onClearError:ne},null,8,['is-loading','error']),(0,l.createCommentVNode)(' AIä¸Šä¸‹æ–‡è¿‡æ»¤æµ‹è¯•é¢æ¿ï¼ˆå·²ç¦ç”¨ï¼‰\n    <Teleport to="body">\n      <div v-if="showAIFilterPanel" class="modal-overlay fullscreen-modal" @click.self="showAIFilterPanel = false">\n        <div class="modal ai-filter-modal">\n          <AIContextFilterPanel @close="showAIFilterPanel = false" />\n        </div>\n      </div>\n    </Teleport>\n    '),(0,l.createCommentVNode)(' å¸®åŠ©å¼¹çª— '),((0,l.openBlock)(),(0,l.createBlock)(l.Teleport,{to:'body'},[j.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'modal-overlay fullscreen-modal help-overlay',onClick:c[13]||(c[13]=(0,l.withModifiers)(e=>j.value=!1,['self']))},[(0,l.createElementVNode)('div',Rf,[(0,l.createElementVNode)('div',Lf,[c[31]||(c[31]=(0,l.createElementVNode)('h3',null,'â“ å¸®åŠ©è¯´æ˜',-1)),(0,l.createElementVNode)('button',{class:'btn-close',onClick:c[11]||(c[11]=e=>j.value=!1)},'âœ•')]),c[32]||(c[32]=(0,l.createElementVNode)('div',{class:'modal-body'},[(0,l.createElementVNode)('div',{class:'help-section'},[(0,l.createElementVNode)('h4',null,'ğŸ“ å¦‚ä½•å¼€æ–°æ¡£ï¼Ÿ'),(0,l.createElementVNode)('ol',{class:'help-steps'},[(0,l.createElementVNode)('li',null,[(0,l.createTextVNode)('æ‰“å¼€'),(0,l.createElementVNode)('strong',null,'ä¸Šä¸‹æ–‡é¢æ¿'),(0,l.createTextVNode)('ï¼Œç‚¹å‡»"æ¸…ç©ºæ‰€æœ‰"æŒ‰é’®ï¼Œæ¸…ç†ä¸–ç•Œä¹¦å†…å®¹')]),(0,l.createElementVNode)('li',null,[(0,l.createTextVNode)('å¼€å¯'),(0,l.createElementVNode)('strong',null,'æ–°èŠå¤©')]),(0,l.createElementVNode)('li',null,[(0,l.createTextVNode)('æ‰“å¼€'),(0,l.createElementVNode)('strong',null,'å­˜æ¡£ç®¡ç†é¢æ¿'),(0,l.createTextVNode)(' - è®¾ç½® - ä¿®æ”¹'),(0,l.createElementVNode)('strong',null,'[è‡ªåŠ¨å­˜æ¡£]å‰ç¼€')]),(0,l.createElementVNode)('li',null,'æ­£å¸¸æ¸¸ç©å³å¯')])])],-1)),(0,l.createElementVNode)('div',Pf,[(0,l.createElementVNode)('button',{class:'btn btn-primary',onClick:c[12]||(c[12]=e=>j.value=!1)},'æˆ‘çŸ¥é“äº†')])])])):(0,l.createCommentVNode)('v-if',!0)])),(0,l.createCommentVNode)(' å­˜æ¡£ç®¡ç†é¢æ¿ '),((0,l.openBlock)(),(0,l.createBlock)(l.Teleport,{to:'body'},[W.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'modal-overlay fullscreen-modal save-manager-overlay',onClick:c[15]||(c[15]=(0,l.withModifiers)(e=>W.value=!1,['self']))},[(0,l.createElementVNode)('div',Of,[(0,l.createVNode)(zv,{onClose:c[14]||(c[14]=e=>W.value=!1),onSaveLoaded:ce,onSaveCreated:ie})])])):(0,l.createCommentVNode)('v-if',!0)])),(0,l.createCommentVNode)(' ä¸Šä¸‹æ–‡ç®¡ç†é¢æ¿ '),((0,l.openBlock)(),(0,l.createBlock)(l.Teleport,{to:'body'},[H.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'modal-overlay fullscreen-modal context-manager-overlay',onClick:c[17]||(c[17]=(0,l.withModifiers)(e=>H.value=!1,['self']))},[(0,l.createElementVNode)('div',Ff,[(0,l.createVNode)(Af,{onClose:c[16]||(c[16]=e=>H.value=!1)})])])):(0,l.createCommentVNode)('v-if',!0)])),(0,l.createCommentVNode)(' å†å²æ­£æ–‡é¢æ¿ - æ¨¡æ€æ¡†æ–¹å¼ '),((0,l.openBlock)(),(0,l.createBlock)(l.Teleport,{to:'body'},[G.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'modal-overlay fullscreen-modal history-text-overlay',onClick:c[19]||(c[19]=(0,l.withModifiers)(e=>G.value=!1,['self']))},[(0,l.createElementVNode)('div',jf,[(0,l.createVNode)(wu,{onClose:c[18]||(c[18]=e=>G.value=!1)})])])):(0,l.createCommentVNode)('v-if',!0)])),(0,l.createCommentVNode)(' MClite v2 èŠ±åå†Œé¢æ¿ '),((0,l.openBlock)(),(0,l.createBlock)(l.Teleport,{to:'body'},[K.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'modal-overlay fullscreen-modal roster-overlay',onClick:c[21]||(c[21]=(0,l.withModifiers)(e=>K.value=!1,['self']))},[(0,l.createElementVNode)('div',Uf,[(0,l.createVNode)(Jr,{onClose:c[20]||(c[20]=e=>K.value=!1)})])])):(0,l.createCommentVNode)('v-if',!0)])),(0,l.createCommentVNode)(' MClite v2 æ–‡æ¡£é¢æ¿ '),((0,l.openBlock)(),(0,l.createBlock)(l.Teleport,{to:'body'},[J.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'modal-overlay fullscreen-modal document-overlay',onClick:c[23]||(c[23]=(0,l.withModifiers)(e=>J.value=!1,['self']))},[(0,l.createElementVNode)('div',zf,[(0,l.createVNode)(Dc,{onClose:c[22]||(c[22]=e=>J.value=!1)})])])):(0,l.createCommentVNode)('v-if',!0)])),(0,l.createCommentVNode)(' MClite v2 è¡¨å•é¢æ¿ '),((0,l.openBlock)(),(0,l.createBlock)(l.Teleport,{to:'body'},[q.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'modal-overlay fullscreen-modal form-overlay',onClick:c[25]||(c[25]=(0,l.withModifiers)(e=>q.value=!1,['self']))},[(0,l.createElementVNode)('div',Wf,[(0,l.createVNode)(Hd,{onClose:c[24]||(c[24]=e=>q.value=!1)})])])):(0,l.createCommentVNode)('v-if',!0)])),(0,l.createCommentVNode)(' æ›´æ–°æ—¥å¿—é¢æ¿ '),((0,l.openBlock)(),(0,l.createBlock)(l.Teleport,{to:'body'},[Y.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'modal-overlay fullscreen-modal changelog-overlay',onClick:c[27]||(c[27]=(0,l.withModifiers)(e=>Y.value=!1,['self']))},[(0,l.createElementVNode)('div',Hf,[(0,l.createVNode)(Zu,{onClose:c[26]||(c[26]=e=>Y.value=!1)})])])):(0,l.createCommentVNode)('v-if',!0)])),(0,l.createCommentVNode)(' å˜é‡ç®¡ç†å™¨é¢æ¿ '),((0,l.openBlock)(),(0,l.createBlock)(l.Teleport,{to:'body'},[X.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'modal-overlay fullscreen-modal variable-manager-overlay',onClick:c[29]||(c[29]=(0,l.withModifiers)(e=>X.value=!1,['self']))},[(0,l.createElementVNode)('div',Gf,[(0,l.createVNode)(Fm,{onClose:c[28]||(c[28]=e=>X.value=!1),onVariableUpdated:de})])])):(0,l.createCommentVNode)('v-if',!0)])),(0,l.createCommentVNode)(' AIå“åº”å®¡æŸ¥å¯¹è¯æ¡† '),((0,l.openBlock)(),(0,l.createBlock)(l.Teleport,{to:'body'},[(0,l.createVNode)(gp,{visible:(0,l.unref)(d),'review-result':(0,l.unref)(u),'is-processing':(0,l.unref)(m),onConfirm:ue,onRollback:me},null,8,['visible','review-result','is-processing'])]))],2))}}),Jf=(0,B.A)(Kf,[['__scopeId','data-v-38c14460']]),qf={key:0,class:'error-boundary'},Yf={class:'error-content'},Xf={class:'error-message'},Zf={key:0,class:'error-details'},Qf=(0,l.defineComponent)({__name:'ErrorBoundary',props:{showDetails:{type:Boolean,default:!0},fallbackMessage:{default:'ç»„ä»¶åŠ è½½æ—¶å‘ç”Ÿé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•ã€‚'}},emits:['error','retry','dismiss'],setup(e,{expose:t,emit:a}){const n=e,o=a,s=(0,l.ref)(!1),r=(0,l.ref)(''),c=(0,l.ref)('');(0,l.onErrorCaptured)((e,t,a)=>(s.value=!0,r.value=e.message||n.fallbackMessage,n.showDetails&&(c.value=`\né”™è¯¯ç±»å‹: ${e.name}\né”™è¯¯ä¿¡æ¯: ${e.message}\nç»„ä»¶ä¿¡æ¯: ${a}\nå †æ ˆä¿¡æ¯:\n${e.stack||'æ— å †æ ˆä¿¡æ¯'}\n    `.trim()),console.error('[ErrorBoundary] æ•è·åˆ°é”™è¯¯:',e),console.error('[ErrorBoundary] ç»„ä»¶ä¿¡æ¯:',a),o('error',e,a),!1));const i=()=>{s.value=!1,r.value='',c.value='',o('retry')},d=()=>{s.value=!1,r.value='',c.value='',o('dismiss')};return t({reset:()=>{s.value=!1,r.value='',c.value=''},hasError:s}),(e,t)=>s.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',qf,[(0,l.createElementVNode)('div',Yf,[t[1]||(t[1]=(0,l.createElementVNode)('div',{class:'error-icon'},'âš ï¸',-1)),t[2]||(t[2]=(0,l.createElementVNode)('h3',{class:'error-title'},'å‡ºç°äº†ä¸€äº›é—®é¢˜',-1)),(0,l.createElementVNode)('p',Xf,(0,l.toDisplayString)(r.value),1),(0,l.createElementVNode)('div',{class:'error-actions'},[(0,l.createElementVNode)('button',{class:'btn btn-primary',onClick:i},'é‡è¯•'),(0,l.createElementVNode)('button',{class:'btn btn-secondary',onClick:d},'å¿½ç•¥')]),c.value?((0,l.openBlock)(),(0,l.createElementBlock)('details',Zf,[t[0]||(t[0]=(0,l.createElementVNode)('summary',null,'æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯',-1)),(0,l.createElementVNode)('pre',null,(0,l.toDisplayString)(c.value),1)])):(0,l.createCommentVNode)('v-if',!0)])])):(0,l.renderSlot)(e.$slots,'default',{key:1})}}),eg=(0,B.A)(Qf,[['__scopeId','data-v-c0fce67a']]),tg=(0,l.defineComponent)({__name:'App',setup(e){const t=$s(),a=(0,l.ref)(),n=(e,t)=>{console.error('[App] æ•è·åˆ°é”™è¯¯:',e),console.error('[App] ç»„ä»¶ä¿¡æ¯:',t),'undefined'!=typeof toastr&&toastr.error('åº”ç”¨å‘ç”Ÿé”™è¯¯ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•')},o=()=>{console.log('[App] ç”¨æˆ·ç‚¹å‡»é‡è¯•'),t.initialize()};return(0,l.onMounted)(async()=>{console.log('[App] MCæˆ¿å­åº”ç”¨å·²æŒ‚è½½');try{await t.initialize(),console.log('[App] åº”ç”¨çŠ¶æ€åˆå§‹åŒ–å®Œæˆ')}catch(e){console.error('[App] åˆå§‹åŒ–å¤±è´¥:',e)}}),(0,l.onUnmounted)(()=>{console.log('[App] MCæˆ¿å­åº”ç”¨æ­£åœ¨å¸è½½')}),(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{id:'app-container',ref_key:'appContainer',ref:a},[(0,l.createVNode)(eg,{onError:n,onRetry:o},{default:(0,l.withCtx)(()=>[((0,l.openBlock)(),(0,l.createBlock)(l.Suspense,null,{default:(0,l.withCtx)(()=>[(0,l.createVNode)(Jf)]),fallback:(0,l.withCtx)(()=>[...t[0]||(t[0]=[(0,l.createElementVNode)('div',{class:'loading-container'},[(0,l.createElementVNode)('div',{class:'loading-spinner'}),(0,l.createElementVNode)('p',{class:'loading-text'},'æ­£åœ¨åŠ è½½MCæˆ¿å­...')],-1)])]),_:1}))]),_:1}),(0,l.createCommentVNode)(' å…¨å±€ç¡®è®¤å¯¹è¯æ¡† '),(0,l.createVNode)(ki)],512))}}),ag=(0,B.A)(tg,[['__scopeId','data-v-caf9f040']]),ng=e(),og=(0,l.createApp)(ag);og.use(ng),og.mount('#app');$s().initialize(),console.log('[MCæˆ¿å­] åº”ç”¨å·²å¯åŠ¨'),'undefined'!=typeof toastr&&toastr.success('MCæˆ¿å­ç³»ç»ŸåŠ è½½æˆåŠŸ'),window.addEventListener('pagehide',()=>{console.log('[MCæˆ¿å­] åº”ç”¨æ­£åœ¨å¸è½½'),'undefined'!=typeof toastr&&toastr.info('MCæˆ¿å­ç³»ç»Ÿå·²å¸è½½')});
//# sourceMappingURL=index.js.map</script><style>.top-bar[data-v-704fab95]{display:flex;align-items:center;justify-content:space-between;gap:var(--spacing-sm);height:50px;padding:0 var(--spacing-md);background:var(--office-header);border-bottom:1px solid var(--border-color);flex-shrink:0;position:relative;z-index:100}.top-bar-left[data-v-704fab95]{display:flex;align-items:center;gap:var(--spacing-xs);min-width:0;flex-shrink:0}.player-card[data-v-704fab95]{display:flex;align-items:center;gap:6px;padding:4px 8px;background:hsla(0,0%,100%,.08);border:1px solid hsla(0,0%,100%,.1);border-radius:var(--radius-sm);min-width:0;flex:1;max-width:180px}.player-avatar[data-v-704fab95]{flex-shrink:0;width:26px;height:26px;display:flex;align-items:center;justify-content:center;background:rgba(99,102,241,.3);border-radius:50%}.player-avatar .avatar-icon[data-v-704fab95]{font-size:13px}.player-info[data-v-704fab95]{display:flex;flex-direction:column;min-width:0;line-height:1.15}.player-name[data-v-704fab95]{font-size:12px;font-weight:600;color:#fff;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.player-role[data-v-704fab95]{font-size:9px;color:hsla(0,0%,100%,.55);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.top-bar-center[data-v-704fab95]{display:flex;align-items:center;justify-content:center;gap:var(--spacing-sm);flex:1;min-width:0}.datetime-group[data-v-704fab95]{display:flex;align-items:center;gap:4px}.date-item[data-v-704fab95],.time-item[data-v-704fab95],.location-item[data-v-704fab95]{display:flex;align-items:center;gap:3px;padding:3px 6px;background:hsla(0,0%,100%,.08);border-radius:var(--radius-xs);border:1px solid hsla(0,0%,100%,.1)}.item-icon[data-v-704fab95]{font-size:11px;flex-shrink:0}.item-value[data-v-704fab95]{font-size:11px;font-weight:500;color:#fff;white-space:nowrap}.location-text[data-v-704fab95]{max-width:120px;overflow:hidden;text-overflow:ellipsis}.period-badge[data-v-704fab95]{display:inline-block;padding:2px 6px;border-radius:3px;font-size:10px;font-weight:600;font-family:monospace;letter-spacing:.3px}.period-badge.period-morning[data-v-704fab95]{background:rgba(255,193,7,.25);color:#ffc107;box-shadow:inset 0 0 0 1px rgba(255,193,7,.3)}.period-badge.period-noon[data-v-704fab95]{background:rgba(255,152,0,.25);color:#ff9800;box-shadow:inset 0 0 0 1px rgba(255,152,0,.3)}.period-badge.period-afternoon[data-v-704fab95]{background:rgba(255,87,34,.25);color:#ff7043;box-shadow:inset 0 0 0 1px rgba(255,87,34,.3)}.period-badge.period-evening[data-v-704fab95]{background:rgba(156,39,176,.25);color:#ce93d8;box-shadow:inset 0 0 0 1px rgba(156,39,176,.3)}.period-badge.period-night[data-v-704fab95]{background:rgba(63,81,181,.25);color:#9fa8da;box-shadow:inset 0 0 0 1px rgba(63,81,181,.3)}.period-badge.period-default[data-v-704fab95]{background:rgba(158,158,158,.25);color:#bdbdbd;box-shadow:inset 0 0 0 1px rgba(158,158,158,.3)}.top-bar-right[data-v-704fab95]{display:flex;align-items:center;gap:var(--spacing-xs);flex-shrink:0}.connection-indicator[data-v-704fab95]{padding:4px}.connection-indicator .status-dot[data-v-704fab95]{width:8px;height:8px;border-radius:50%;transition:background-color var(--transition-normal)}.connection-indicator.connected .status-dot[data-v-704fab95]{background:var(--success-color);box-shadow:0 0 6px var(--success-color)}.connection-indicator.connecting .status-dot[data-v-704fab95]{background:var(--warning-color);animation:pulse-704fab95 1.5s ease-in-out infinite}.connection-indicator.disconnected .status-dot[data-v-704fab95]{background:var(--error-color)}@keyframes pulse-704fab95{0%,100%{opacity:1}50%{opacity:.4}}.action-buttons[data-v-704fab95]{display:flex;align-items:center;gap:4px}.action-btn[data-v-704fab95]{display:flex;align-items:center;justify-content:center;width:34px;height:34px;background:hsla(0,0%,100%,.1);border:1px solid hsla(0,0%,100%,.15);border-radius:var(--radius-sm);cursor:pointer;transition:all var(--transition-fast)}.action-btn .btn-icon[data-v-704fab95]{font-size:15px}.action-btn[data-v-704fab95]:hover{background:hsla(0,0%,100%,.2);border-color:hsla(0,0%,100%,.25)}.action-btn[data-v-704fab95]:active{transform:scale(0.95)}@media (max-width:1024px){.top-bar[data-v-704fab95]{gap:var(--spacing-xs)}.player-card[data-v-704fab95]{max-width:150px}.location-text[data-v-704fab95]{max-width:100px}}@media (max-width:768px){.top-bar[data-v-704fab95]{height:46px;padding:0 var(--spacing-sm);gap:6px}.top-bar-left[data-v-704fab95]{gap:4px}.player-card[data-v-704fab95]{max-width:120px;padding:3px 6px}.player-avatar[data-v-704fab95]{width:22px;height:22px}.player-avatar .avatar-icon[data-v-704fab95]{font-size:11px}.player-name[data-v-704fab95]{font-size:11px}.player-role[data-v-704fab95]{font-size:8px}.top-bar-center[data-v-704fab95]{gap:4px;justify-content:flex-start}.datetime-group[data-v-704fab95]{gap:3px}.date-item[data-v-704fab95],.time-item[data-v-704fab95]{padding:2px 4px}.item-icon[data-v-704fab95]{font-size:10px}.item-value[data-v-704fab95]{font-size:10px}.period-badge[data-v-704fab95]{font-size:9px;padding:2px 4px}.location-item[data-v-704fab95]{display:none}.connection-indicator[data-v-704fab95]{padding:2px}.connection-indicator .status-dot[data-v-704fab95]{width:6px;height:6px}.action-btn[data-v-704fab95]{width:30px;height:30px}.action-btn .btn-icon[data-v-704fab95]{font-size:13px}}@media (max-width:480px){.top-bar[data-v-704fab95]{height:42px;padding:0 6px;grid-template-columns:auto 1fr auto;gap:4px}.player-card[data-v-704fab95]{max-width:100px;padding:2px 4px;gap:4px}.player-avatar[data-v-704fab95]{width:20px;height:20px}.player-avatar .avatar-icon[data-v-704fab95]{font-size:10px}.player-info[data-v-704fab95]{display:flex;flex-direction:column}.player-name[data-v-704fab95]{font-size:10px}.player-role[data-v-704fab95]{display:none}.top-bar-center[data-v-704fab95]{justify-content:center}.datetime-group[data-v-704fab95]{gap:2px}.date-item[data-v-704fab95]{display:none}.time-item[data-v-704fab95]{padding:2px 4px}.period-badge[data-v-704fab95]{font-size:9px;padding:2px 5px}.action-buttons[data-v-704fab95]{gap:2px}.action-btn[data-v-704fab95]{width:28px;height:28px}.action-btn .btn-icon[data-v-704fab95]{font-size:12px}}@media (max-width:360px){.top-bar[data-v-704fab95]{height:38px;padding:0 4px;gap:2px}.player-card[data-v-704fab95]{max-width:80px;padding:2px 3px}.player-avatar[data-v-704fab95]{width:18px;height:18px}.player-avatar .avatar-icon[data-v-704fab95]{font-size:9px}.player-name[data-v-704fab95]{font-size:9px}.period-badge[data-v-704fab95]{font-size:8px;padding:1px 3px}.connection-indicator[data-v-704fab95]{display:none}.action-btn[data-v-704fab95]{width:26px;height:26px}.action-btn .btn-icon[data-v-704fab95]{font-size:11px}}
.content-renderer[data-v-5c20d1a7]{font-size:var(--font-md,15px);line-height:1.8;color:var(--text-color,#1a1a1a)}.content-renderer--dark[data-v-5c20d1a7]{color:var(--text-color,#e8e8e8)}.content-text[data-v-5c20d1a7] .block-dialogue{color:#0d47a1;font-weight:500}.content-text[data-v-5c20d1a7] .block-thought{color:#6b21a8;font-style:italic;opacity:.9}.content-text[data-v-5c20d1a7] .block-scenery{color:#166534;opacity:.95}.content-text[data-v-5c20d1a7] .block-system{color:#b91c1c;font-weight:700}.content-renderer--dark .content-text[data-v-5c20d1a7] .block-dialogue{color:#93c5fd;font-weight:500}.content-renderer--dark .content-text[data-v-5c20d1a7] .block-thought{color:#c4b5fd;opacity:.95}.content-renderer--dark .content-text[data-v-5c20d1a7] .block-scenery{color:#6ee7b7;opacity:1}.content-renderer--dark .content-text[data-v-5c20d1a7] .block-system{color:#fca5a5;font-weight:700}.streaming-cursor[data-v-5c20d1a7]{display:inline-block;animation:cursorBlink-5c20d1a7 1s step-end infinite;color:var(--primary-color,#1a5fb4);font-weight:bold}.content-renderer--dark .streaming-cursor[data-v-5c20d1a7]{color:var(--primary-color,#60a5fa)}@keyframes cursorBlink-5c20d1a7{0%,50%{opacity:1}51%,100%{opacity:0}}
.variable-changes-panel[data-v-73a3470b]{background:var(--bg-tertiary,#f5f5f5);border:1px solid var(--border-color,#e0e0e0);border-radius:var(--radius-md,8px);overflow:hidden;transition:all var(--transition-normal,0.3s) ease}.variable-changes-panel.expanded[data-v-73a3470b]{box-shadow:var(--shadow-sm,0 2px 4px rgba(0,0,0,0.1))}.panel-header[data-v-73a3470b]{display:flex;align-items:center;justify-content:space-between;padding:var(--spacing-sm,8px) var(--spacing-md,12px);cursor:pointer;-webkit-user-select:none;user-select:none;transition:background var(--transition-fast,0.15s)}.panel-header[data-v-73a3470b]:hover{background:var(--bg-hover,rgba(0,0,0,0.05))}.header-left[data-v-73a3470b]{display:flex;align-items:center;gap:var(--spacing-sm,8px)}.header-icon[data-v-73a3470b]{font-size:14px}.header-title[data-v-73a3470b]{font-size:var(--font-sm,14px);font-weight:500;color:var(--text-color,#333)}.changes-count[data-v-73a3470b]{display:inline-flex;align-items:center;justify-content:center;min-width:20px;height:20px;padding:0 6px;background:var(--primary-color,#6366f1);color:#fff;font-size:var(--font-xs,12px);font-weight:600;border-radius:10px}.header-right[data-v-73a3470b]{display:flex;align-items:center}.toggle-icon[data-v-73a3470b]{font-size:10px;color:var(--text-secondary,#666);transition:transform var(--transition-fast,0.15s)}.panel-content[data-v-73a3470b]{border-top:1px solid var(--border-color,#e0e0e0);background:var(--bg-color,#fff)}.no-changes[data-v-73a3470b]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:var(--spacing-lg,16px);gap:var(--spacing-xs,4px)}.no-changes .empty-icon[data-v-73a3470b]{font-size:24px;opacity:.5}.no-changes .empty-text[data-v-73a3470b]{font-size:var(--font-sm,14px);color:var(--text-disabled,#999)}.changes-list[data-v-73a3470b]{max-height:300px;overflow-y:auto;padding:var(--spacing-sm,8px)}.change-item[data-v-73a3470b]{display:flex;flex-direction:column;gap:var(--spacing-xs,4px);padding:var(--spacing-sm,8px);border-radius:var(--radius-sm,4px);margin-bottom:var(--spacing-xs,4px);background:var(--bg-secondary,#fafafa);border-left:3px solid rgba(0,0,0,0);transition:all var(--transition-fast,0.15s)}.change-item[data-v-73a3470b]:last-child{margin-bottom:0}.change-item[data-v-73a3470b]:hover{background:var(--bg-hover,#f0f0f0)}.change-item.change-new[data-v-73a3470b]{border-left-color:var(--success-color,#4caf50);background:rgba(76,175,80,.05)}.change-item.change-new .path-icon[data-v-73a3470b]{color:var(--success-color,#4caf50)}.change-item.change-increase[data-v-73a3470b]{border-left-color:var(--info-color,#2196f3);background:rgba(33,150,243,.05)}.change-item.change-increase .path-icon[data-v-73a3470b]{color:var(--info-color,#2196f3)}.change-item.change-decrease[data-v-73a3470b]{border-left-color:var(--warning-color,#ff9800);background:rgba(255,152,0,.05)}.change-item.change-decrease .path-icon[data-v-73a3470b]{color:var(--warning-color,#ff9800)}.change-item.change-modify[data-v-73a3470b]{border-left-color:var(--primary-color,#6366f1);background:rgba(99,102,241,.05)}.change-item.change-modify .path-icon[data-v-73a3470b]{color:var(--primary-color,#6366f1)}.change-path[data-v-73a3470b]{display:flex;align-items:center;gap:var(--spacing-xs,4px)}.change-path .path-icon[data-v-73a3470b]{font-size:12px}.change-path .path-text[data-v-73a3470b]{font-size:var(--font-xs,12px);font-family:monospace;color:var(--text-secondary,#666);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.change-values[data-v-73a3470b]{display:flex;align-items:center;gap:var(--spacing-sm,8px);padding-left:var(--spacing-md,12px)}.change-values .old-value[data-v-73a3470b]{font-size:var(--font-sm,14px);font-family:monospace;color:var(--text-disabled,#999);text-decoration:line-through}.change-values .arrow[data-v-73a3470b]{font-size:var(--font-xs,12px);color:var(--text-disabled,#999)}.change-values .new-value[data-v-73a3470b]{font-size:var(--font-sm,14px);font-family:monospace;color:var(--text-color,#333);font-weight:500}.change-comment[data-v-73a3470b]{display:flex;align-items:center;gap:var(--spacing-xs,4px);padding-left:var(--spacing-md,12px)}.change-comment .comment-icon[data-v-73a3470b]{font-size:10px;opacity:.7}.change-comment .comment-text[data-v-73a3470b]{font-size:var(--font-xs,12px);color:var(--text-secondary,#666);font-style:italic}.panel-footer[data-v-73a3470b]{display:flex;justify-content:flex-end;gap:var(--spacing-sm,8px);padding:var(--spacing-sm,8px) var(--spacing-md,12px);border-top:1px solid var(--border-color,#e0e0e0);background:var(--bg-tertiary,#f5f5f5)}.btn-clear[data-v-73a3470b],.btn-copy[data-v-73a3470b]{display:flex;align-items:center;gap:var(--spacing-xs,4px);padding:var(--spacing-xs,4px) var(--spacing-sm,8px);font-size:var(--font-xs,12px);color:var(--text-secondary,#666);background:rgba(0,0,0,0);border:1px solid var(--border-color,#e0e0e0);border-radius:var(--radius-sm,4px);cursor:pointer;transition:all var(--transition-fast,0.15s)}.btn-clear[data-v-73a3470b]:hover,.btn-copy[data-v-73a3470b]:hover{background:var(--bg-hover,#f0f0f0);color:var(--text-color,#333);border-color:var(--border-hover,#ccc)}.btn-clear .btn-icon[data-v-73a3470b],.btn-copy .btn-icon[data-v-73a3470b]{font-size:10px}.expand-enter-active[data-v-73a3470b],.expand-leave-active[data-v-73a3470b]{transition:all .3s ease;max-height:400px;overflow:hidden}.expand-enter-from[data-v-73a3470b],.expand-leave-to[data-v-73a3470b]{max-height:0;opacity:0}@media (max-width:768px){.changes-list[data-v-73a3470b]{max-height:200px}.change-item[data-v-73a3470b]{padding:var(--spacing-xs,4px) var(--spacing-sm,8px)}.change-values[data-v-73a3470b]{flex-wrap:wrap}}
.panel-header[data-v-b2c97ed8]{flex-shrink:0;display:flex;align-items:center;justify-content:space-between;background:linear-gradient(135deg,var(--primary-color) 0%,var(--primary-hover) 100%);color:#fff;padding:var(--spacing-xs) var(--spacing-md);position:relative;overflow:hidden}.header-content[data-v-b2c97ed8]{display:flex;align-items:center;gap:var(--spacing-sm)}.header-title[data-v-b2c97ed8]{margin:0;font-size:var(--font-md);font-weight:600}.header-actions[data-v-b2c97ed8]{display:flex;align-items:center;gap:var(--spacing-sm)}.ai-mode-segmented[data-v-b2c97ed8]{display:flex;background:hsla(0,0%,100%,.15);border-radius:var(--radius-sm);overflow:hidden;border:1px solid hsla(0,0%,100%,.25)}.ai-mode-segmented .segment[data-v-b2c97ed8]{padding:4px 14px;background:none;border:none;color:hsla(0,0%,100%,.7);font-size:var(--font-sm);font-weight:500;cursor:pointer;transition:all .2s;white-space:nowrap}.ai-mode-segmented .segment[data-v-b2c97ed8]:not(:last-child){border-right:1px solid hsla(0,0%,100%,.2)}.ai-mode-segmented .segment.active[data-v-b2c97ed8]{background:hsla(0,0%,100%,.3);color:#fff;font-weight:600}.ai-mode-segmented .segment[data-v-b2c97ed8]:hover:not(.active){background:hsla(0,0%,100%,.1)}.preset-btn[data-v-b2c97ed8]{display:flex;align-items:center;gap:4px;padding:4px 10px;background:hsla(0,0%,100%,.2);border:1px solid hsla(0,0%,100%,.3);border-radius:var(--radius-sm);color:#fff;font-size:var(--font-xs);cursor:pointer;transition:background .2s}.preset-btn[data-v-b2c97ed8]:hover{background:hsla(0,0%,100%,.3)}.preset-count[data-v-b2c97ed8]{background:hsla(0,0%,100%,.3);padding:0 5px;border-radius:8px;font-size:10px}.mode-hint[data-v-b2c97ed8]{flex-shrink:0;padding:4px var(--spacing-md);background:var(--bg-tertiary);font-size:var(--font-xs);color:var(--text-secondary);border-bottom:1px solid var(--border-color);text-align:center}
.setting-section[data-v-15032e13]{background:var(--bg-color);border:1px solid var(--border-color);border-radius:var(--radius-md);margin-bottom:var(--spacing-md);overflow:hidden;transition:all var(--transition-fast)}.setting-section[data-v-15032e13]:last-child{margin-bottom:0}.setting-section.has-content[data-v-15032e13]{border-color:var(--primary-color)}.section-header[data-v-15032e13]{display:flex;align-items:center;justify-content:space-between;padding:var(--spacing-sm) var(--spacing-md);background:var(--bg-tertiary);border-bottom:1px solid var(--border-color)}.section-header .section-header-left[data-v-15032e13]{display:flex;align-items:center;gap:var(--spacing-sm)}.section-header .section-icon[data-v-15032e13]{font-size:16px}.section-header .section-title[data-v-15032e13]{margin:0;font-size:var(--font-md);font-weight:600;color:var(--text-color)}.section-content[data-v-15032e13]{padding:var(--spacing-md)}.form-row[data-v-15032e13]{margin-bottom:var(--spacing-md)}.form-row[data-v-15032e13]:last-child{margin-bottom:0}.form-row-2col[data-v-15032e13]{display:grid;grid-template-columns:1fr 1fr;gap:var(--spacing-md)}.form-group[data-v-15032e13]{display:flex;flex-direction:column;gap:4px}.form-label[data-v-15032e13]{font-size:var(--font-sm);font-weight:600;color:var(--text-color);display:flex;align-items:center;gap:4px}.form-input[data-v-15032e13]{padding:8px 12px;border:1px solid var(--border-color);border-radius:var(--radius-sm);background:var(--bg-color);color:var(--text-color);font-size:var(--font-sm);transition:border-color .2s}.form-input[data-v-15032e13]:focus{outline:none;border-color:var(--primary-color)}.form-input.has-error[data-v-15032e13]{border-color:var(--danger-color)}.form-input.has-value[data-v-15032e13]{border-color:var(--success-color)}.form-textarea[data-v-15032e13]{padding:8px 12px;border:1px solid var(--border-color);border-radius:var(--radius-sm);background:var(--bg-color);color:var(--text-color);font-size:var(--font-sm);resize:vertical;font-family:inherit;transition:border-color .2s}.form-textarea[data-v-15032e13]:focus{outline:none;border-color:var(--primary-color)}.form-textarea.has-value[data-v-15032e13]{border-color:var(--success-color)}.required-mark[data-v-15032e13]{color:var(--danger-color);font-weight:700}.optional-mark[data-v-15032e13]{font-size:var(--font-xs);color:var(--text-secondary);font-weight:400}.required-badge[data-v-15032e13],.optional-badge[data-v-15032e13]{padding:2px 8px;font-size:var(--font-xs);font-weight:600;border-radius:var(--radius-xs);letter-spacing:.5px}.required-badge[data-v-15032e13]{background:rgba(var(--danger-color-rgb,220,53,69),0.1);color:var(--danger-color)}.optional-badge[data-v-15032e13]{background:var(--bg-tertiary);color:var(--text-secondary)}.char-count[data-v-15032e13]{font-size:var(--font-xs);color:var(--text-disabled);text-align:right}.help-text[data-v-15032e13]{font-size:var(--font-xs);color:var(--text-secondary)}.error-text[data-v-15032e13]{font-size:var(--font-xs);color:var(--danger-color)}@media (max-width:768px){.form-row-2col[data-v-15032e13]{grid-template-columns:1fr}}.scene-type-selector[data-v-15032e13]{display:flex;flex-wrap:wrap;gap:var(--spacing-xs)}.scene-type-btn[data-v-15032e13]{display:flex;align-items:center;gap:6px;padding:6px 12px;background:var(--bg-tertiary);border:1px solid var(--border-color);border-radius:var(--radius-sm);cursor:pointer;font-size:var(--font-sm);color:var(--text-color);transition:all .2s}.scene-type-btn[data-v-15032e13]:hover{border-color:var(--primary-color);background:var(--bg-secondary)}.scene-type-btn.active[data-v-15032e13]{border-color:var(--primary-color);background:rgba(var(--primary-color-rgb,66,133,244),0.1);color:var(--primary-color);font-weight:600}.scene-type-btn .check-icon[data-v-15032e13]{font-size:12px}
.setting-section[data-v-23286912]{background:var(--bg-color);border:1px solid var(--border-color);border-radius:var(--radius-md);margin-bottom:var(--spacing-md);overflow:hidden;transition:all var(--transition-fast)}.setting-section[data-v-23286912]:last-child{margin-bottom:0}.setting-section.has-content[data-v-23286912]{border-color:var(--primary-color)}.section-header[data-v-23286912]{display:flex;align-items:center;justify-content:space-between;padding:var(--spacing-sm) var(--spacing-md);background:var(--bg-tertiary);border-bottom:1px solid var(--border-color)}.section-header .section-header-left[data-v-23286912]{display:flex;align-items:center;gap:var(--spacing-sm)}.section-header .section-icon[data-v-23286912]{font-size:16px}.section-header .section-title[data-v-23286912]{margin:0;font-size:var(--font-md);font-weight:600;color:var(--text-color)}.section-content[data-v-23286912]{padding:var(--spacing-md)}.form-row[data-v-23286912]{margin-bottom:var(--spacing-md)}.form-row[data-v-23286912]:last-child{margin-bottom:0}.form-row-2col[data-v-23286912]{display:grid;grid-template-columns:1fr 1fr;gap:var(--spacing-md)}.form-group[data-v-23286912]{display:flex;flex-direction:column;gap:4px}.form-label[data-v-23286912]{font-size:var(--font-sm);font-weight:600;color:var(--text-color);display:flex;align-items:center;gap:4px}.form-input[data-v-23286912]{padding:8px 12px;border:1px solid var(--border-color);border-radius:var(--radius-sm);background:var(--bg-color);color:var(--text-color);font-size:var(--font-sm);transition:border-color .2s}.form-input[data-v-23286912]:focus{outline:none;border-color:var(--primary-color)}.form-input.has-error[data-v-23286912]{border-color:var(--danger-color)}.form-input.has-value[data-v-23286912]{border-color:var(--success-color)}.form-textarea[data-v-23286912]{padding:8px 12px;border:1px solid var(--border-color);border-radius:var(--radius-sm);background:var(--bg-color);color:var(--text-color);font-size:var(--font-sm);resize:vertical;font-family:inherit;transition:border-color .2s}.form-textarea[data-v-23286912]:focus{outline:none;border-color:var(--primary-color)}.form-textarea.has-value[data-v-23286912]{border-color:var(--success-color)}.required-mark[data-v-23286912]{color:var(--danger-color);font-weight:700}.optional-mark[data-v-23286912]{font-size:var(--font-xs);color:var(--text-secondary);font-weight:400}.required-badge[data-v-23286912],.optional-badge[data-v-23286912]{padding:2px 8px;font-size:var(--font-xs);font-weight:600;border-radius:var(--radius-xs);letter-spacing:.5px}.required-badge[data-v-23286912]{background:rgba(var(--danger-color-rgb,220,53,69),0.1);color:var(--danger-color)}.optional-badge[data-v-23286912]{background:var(--bg-tertiary);color:var(--text-secondary)}.char-count[data-v-23286912]{font-size:var(--font-xs);color:var(--text-disabled);text-align:right}.help-text[data-v-23286912]{font-size:var(--font-xs);color:var(--text-secondary)}.error-text[data-v-23286912]{font-size:var(--font-xs);color:var(--danger-color)}@media (max-width:768px){.form-row-2col[data-v-23286912]{grid-template-columns:1fr}}
.setting-section[data-v-1d3e43b4]{background:var(--bg-color);border:1px solid var(--border-color);border-radius:var(--radius-md);margin-bottom:var(--spacing-md);overflow:hidden;transition:all var(--transition-fast)}.setting-section[data-v-1d3e43b4]:last-child{margin-bottom:0}.setting-section.has-content[data-v-1d3e43b4]{border-color:var(--primary-color)}.section-header[data-v-1d3e43b4]{display:flex;align-items:center;justify-content:space-between;padding:var(--spacing-sm) var(--spacing-md);background:var(--bg-tertiary);border-bottom:1px solid var(--border-color)}.section-header .section-header-left[data-v-1d3e43b4]{display:flex;align-items:center;gap:var(--spacing-sm)}.section-header .section-icon[data-v-1d3e43b4]{font-size:16px}.section-header .section-title[data-v-1d3e43b4]{margin:0;font-size:var(--font-md);font-weight:600;color:var(--text-color)}.section-content[data-v-1d3e43b4]{padding:var(--spacing-md)}.form-row[data-v-1d3e43b4]{margin-bottom:var(--spacing-md)}.form-row[data-v-1d3e43b4]:last-child{margin-bottom:0}.form-row-2col[data-v-1d3e43b4]{display:grid;grid-template-columns:1fr 1fr;gap:var(--spacing-md)}.form-group[data-v-1d3e43b4]{display:flex;flex-direction:column;gap:4px}.form-label[data-v-1d3e43b4]{font-size:var(--font-sm);font-weight:600;color:var(--text-color);display:flex;align-items:center;gap:4px}.form-input[data-v-1d3e43b4]{padding:8px 12px;border:1px solid var(--border-color);border-radius:var(--radius-sm);background:var(--bg-color);color:var(--text-color);font-size:var(--font-sm);transition:border-color .2s}.form-input[data-v-1d3e43b4]:focus{outline:none;border-color:var(--primary-color)}.form-input.has-error[data-v-1d3e43b4]{border-color:var(--danger-color)}.form-input.has-value[data-v-1d3e43b4]{border-color:var(--success-color)}.form-textarea[data-v-1d3e43b4]{padding:8px 12px;border:1px solid var(--border-color);border-radius:var(--radius-sm);background:var(--bg-color);color:var(--text-color);font-size:var(--font-sm);resize:vertical;font-family:inherit;transition:border-color .2s}.form-textarea[data-v-1d3e43b4]:focus{outline:none;border-color:var(--primary-color)}.form-textarea.has-value[data-v-1d3e43b4]{border-color:var(--success-color)}.required-mark[data-v-1d3e43b4]{color:var(--danger-color);font-weight:700}.optional-mark[data-v-1d3e43b4]{font-size:var(--font-xs);color:var(--text-secondary);font-weight:400}.required-badge[data-v-1d3e43b4],.optional-badge[data-v-1d3e43b4]{padding:2px 8px;font-size:var(--font-xs);font-weight:600;border-radius:var(--radius-xs);letter-spacing:.5px}.required-badge[data-v-1d3e43b4]{background:rgba(var(--danger-color-rgb,220,53,69),0.1);color:var(--danger-color)}.optional-badge[data-v-1d3e43b4]{background:var(--bg-tertiary);color:var(--text-secondary)}.char-count[data-v-1d3e43b4]{font-size:var(--font-xs);color:var(--text-disabled);text-align:right}.help-text[data-v-1d3e43b4]{font-size:var(--font-xs);color:var(--text-secondary)}.error-text[data-v-1d3e43b4]{font-size:var(--font-xs);color:var(--danger-color)}@media (max-width:768px){.form-row-2col[data-v-1d3e43b4]{grid-template-columns:1fr}}.section-header-right[data-v-1d3e43b4]{display:flex;align-items:center;gap:var(--spacing-sm)}.field-count[data-v-1d3e43b4]{font-size:var(--font-xs);color:var(--text-secondary)}.card-desc[data-v-1d3e43b4]{font-size:var(--font-sm);color:var(--text-secondary);margin:0 0 var(--spacing-sm) 0}.preset-fields[data-v-1d3e43b4]{margin-bottom:var(--spacing-sm)}.preset-fields .preset-label[data-v-1d3e43b4]{font-size:var(--font-xs);color:var(--text-secondary);margin-bottom:4px;display:block}.preset-tags[data-v-1d3e43b4]{display:flex;flex-wrap:wrap;gap:4px}.preset-tag[data-v-1d3e43b4]{display:flex;align-items:center;gap:2px;padding:2px 8px;background:var(--bg-tertiary);border:1px dashed var(--border-color);border-radius:var(--radius-xs);cursor:pointer;font-size:var(--font-xs);color:var(--text-secondary);transition:all .2s}.preset-tag[data-v-1d3e43b4]:hover{border-color:var(--primary-color);color:var(--primary-color);background:rgba(var(--primary-color-rgb,66,133,244),0.05)}.preset-tag .tag-icon[data-v-1d3e43b4]{font-size:10px;font-weight:bold}.selected-fields[data-v-1d3e43b4]{min-height:36px;padding:var(--spacing-sm);background:var(--bg-tertiary);border:1px solid var(--border-color);border-radius:var(--radius-sm);margin-bottom:var(--spacing-sm)}.selected-fields.has-fields[data-v-1d3e43b4]{border-color:var(--success-color)}.empty-hint[data-v-1d3e43b4]{font-size:var(--font-xs);color:var(--text-disabled)}.field-tags[data-v-1d3e43b4]{display:flex;flex-wrap:wrap;gap:4px}.field-tag[data-v-1d3e43b4]{display:flex;align-items:center;gap:4px;padding:3px 8px;background:var(--primary-color);color:#fff;border-radius:var(--radius-xs);font-size:var(--font-xs)}.field-tag .tag-remove[data-v-1d3e43b4]{background:none;border:none;color:hsla(0,0%,100%,.7);cursor:pointer;font-size:10px;padding:0 2px}.field-tag .tag-remove[data-v-1d3e43b4]:hover{color:#fff}.tag-enter-active[data-v-1d3e43b4],.tag-leave-active[data-v-1d3e43b4]{transition:all .2s ease}.tag-enter-from[data-v-1d3e43b4],.tag-leave-to[data-v-1d3e43b4]{opacity:0;transform:scale(0.8)}.add-field-row[data-v-1d3e43b4]{display:flex;gap:var(--spacing-xs)}.add-field-input[data-v-1d3e43b4]{flex:1;padding:6px 10px;border:1px solid var(--border-color);border-radius:var(--radius-sm);background:var(--bg-color);color:var(--text-color);font-size:var(--font-sm)}.add-field-input[data-v-1d3e43b4]:focus{outline:none;border-color:var(--primary-color)}.add-field-btn[data-v-1d3e43b4]{padding:6px 12px;background:var(--primary-color);border:none;border-radius:var(--radius-sm);color:#fff;font-size:var(--font-sm);cursor:pointer}.add-field-btn[data-v-1d3e43b4]:disabled{opacity:.5;cursor:not-allowed}.add-field-btn[data-v-1d3e43b4]:hover:not(:disabled){background:var(--primary-hover)}
.document-tabs[data-v-cb6886f0]{display:flex;align-items:center;gap:var(--spacing-xs);border-bottom:1px solid var(--border-color);padding:0 var(--spacing-sm);background:var(--bg-tertiary);overflow-x:auto}.tabs-list[data-v-cb6886f0]{display:flex;gap:2px}.tab-item[data-v-cb6886f0]{display:flex;align-items:center;gap:4px;padding:6px 12px;background:none;border:none;border-bottom:2px solid rgba(0,0,0,0);cursor:pointer;font-size:var(--font-sm);color:var(--text-secondary);white-space:nowrap;transition:all .2s}.tab-item[data-v-cb6886f0]:hover{color:var(--text-color);background:var(--bg-secondary)}.tab-item.active[data-v-cb6886f0]{color:var(--primary-color);border-bottom-color:var(--primary-color);font-weight:600}.tab-close[data-v-cb6886f0]{width:16px;height:16px;display:flex;align-items:center;justify-content:center;background:none;border:none;cursor:pointer;font-size:10px;color:var(--text-disabled);border-radius:50%;padding:0}.tab-close[data-v-cb6886f0]:hover{background:var(--danger-color);color:#fff}.add-tab-btn[data-v-cb6886f0]{padding:4px 10px;background:none;border:1px dashed var(--border-color);border-radius:var(--radius-xs);cursor:pointer;font-size:var(--font-xs);color:var(--text-secondary);white-space:nowrap}.add-tab-btn[data-v-cb6886f0]:hover{border-color:var(--primary-color);color:var(--primary-color)}
.doc-meta-editor[data-v-d3c9924a]{padding:var(--spacing-sm);background:var(--bg-tertiary);border-bottom:1px solid var(--border-color)}.meta-row[data-v-d3c9924a]{display:flex;gap:var(--spacing-sm);margin-bottom:var(--spacing-xs)}.meta-row[data-v-d3c9924a]:last-child{margin-bottom:0}.form-group[data-v-d3c9924a]{display:flex;flex-direction:column;gap:2px;flex:1}.form-group.form-toggle-group[data-v-d3c9924a]{flex:0 0 auto;min-width:80px;align-items:center}.form-group.flex-1[data-v-d3c9924a]{flex:1}.form-label[data-v-d3c9924a]{font-size:11px;font-weight:600;color:var(--text-secondary)}.required-mark[data-v-d3c9924a]{color:var(--danger-color)}.form-input[data-v-d3c9924a]{padding:4px 8px;border:1px solid var(--border-color);border-radius:var(--radius-xs);background:var(--bg-color);color:var(--text-color);font-size:var(--font-sm)}.form-input[data-v-d3c9924a]:focus{outline:none;border-color:var(--primary-color)}.form-input.has-value[data-v-d3c9924a]{border-color:var(--success-color)}.toggle-btn[data-v-d3c9924a]{padding:4px 12px;border:1px solid var(--border-color);border-radius:var(--radius-xs);background:var(--bg-color);color:var(--text-secondary);font-size:var(--font-sm);cursor:pointer;transition:all .2s}.toggle-btn.active[data-v-d3c9924a]{background:var(--primary-color);border-color:var(--primary-color);color:#fff}
.editor-node.collapsed>.node-children[data-v-0a118b06]{display:none}.node-row[data-v-0a118b06]{display:flex;align-items:center;gap:4px;padding:3px 4px;border-radius:var(--radius-xs);transition:background .15s}.node-row[data-v-0a118b06]:hover{background:var(--bg-tertiary)}.node-row:hover .node-actions[data-v-0a118b06]{opacity:1}.node-indent[data-v-0a118b06]{flex-shrink:0;display:flex;align-items:center}.toggle-btn[data-v-0a118b06]{width:20px;height:20px;display:flex;align-items:center;justify-content:center;background:none;border:none;cursor:pointer;padding:0;color:var(--text-secondary);font-size:10px}.toggle-btn[data-v-0a118b06]:hover{color:var(--primary-color)}.toggle-btn .toggle-arrow[data-v-0a118b06]{transition:transform .2s;display:inline-block}.toggle-btn .toggle-arrow.expanded[data-v-0a118b06]{transform:rotate(90deg)}.toggle-placeholder[data-v-0a118b06]{width:20px;height:20px}.node-key[data-v-0a118b06]{flex-shrink:0;min-width:120px;max-width:240px}.node-key .key-display[data-v-0a118b06]{display:block;padding:2px 6px;cursor:pointer;border-radius:var(--radius-xs);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.node-key .key-display[data-v-0a118b06]:hover{background:rgba(var(--primary-color-rgb,66,133,244),0.08)}.node-key .key-display.empty[data-v-0a118b06]{color:var(--text-disabled);font-style:italic}.node-key .key-input[data-v-0a118b06]{width:100%;padding:2px 6px;border:1px solid var(--primary-color);border-radius:var(--radius-xs);background:var(--bg-color);color:var(--text-color);font-size:inherit;font-weight:inherit;outline:none}.key-depth-0[data-v-0a118b06]{font-size:var(--font-md);font-weight:700;color:var(--text-color)}.key-depth-1[data-v-0a118b06]{font-size:var(--font-sm);font-weight:600;color:var(--text-color)}.key-depth-2[data-v-0a118b06]{font-size:var(--font-sm);font-weight:600;color:var(--text-secondary)}.key-depth-3[data-v-0a118b06]{font-size:var(--font-sm);font-weight:500;color:var(--text-secondary)}.key-depth-4[data-v-0a118b06],.key-depth-5[data-v-0a118b06]{font-size:var(--font-xs);font-weight:500;color:var(--text-secondary)}.node-text[data-v-0a118b06]{flex:1;min-width:0}.node-text .text-display[data-v-0a118b06]{display:block;padding:2px 6px;cursor:pointer;border-radius:var(--radius-xs);font-size:var(--font-sm);color:var(--text-secondary);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.node-text .text-display[data-v-0a118b06]:hover{background:rgba(var(--primary-color-rgb,66,133,244),0.05)}.node-text .text-display.empty[data-v-0a118b06]{color:var(--text-disabled);font-style:italic;font-size:var(--font-xs)}.node-text .text-input[data-v-0a118b06]{width:100%;padding:2px 6px;border:1px solid var(--primary-color);border-radius:var(--radius-xs);background:var(--bg-color);color:var(--text-color);font-size:var(--font-sm);outline:none}.node-actions[data-v-0a118b06]{flex-shrink:0;display:flex;align-items:center;gap:2px;opacity:0;transition:opacity .15s}.action-btn[data-v-0a118b06]{width:22px;height:22px;display:flex;align-items:center;justify-content:center;background:none;border:1px solid rgba(0,0,0,0);border-radius:var(--radius-xs);cursor:pointer;padding:0;font-size:11px;color:var(--text-secondary);transition:all .15s}.action-btn[data-v-0a118b06]:hover{background:var(--bg-tertiary);border-color:var(--border-color);color:var(--primary-color)}.action-btn.danger[data-v-0a118b06]:hover{color:var(--danger-color);border-color:var(--danger-color)}.action-btn.field-btn.has-fields[data-v-0a118b06]{color:var(--primary-color);opacity:1}.field-indicator[data-v-0a118b06]{padding:2px 0}.field-indicator .field-badge[data-v-0a118b06]{display:inline-block;padding:1px 8px;background:rgba(var(--primary-color-rgb,66,133,244),0.08);color:var(--primary-color);font-size:11px;border-radius:var(--radius-xs)}.node-enter-active[data-v-0a118b06],.node-leave-active[data-v-0a118b06]{transition:all .2s ease}.node-enter-from[data-v-0a118b06],.node-leave-to[data-v-0a118b06]{opacity:0;transform:translateY(-8px)}
.outline-editor[data-v-90f80318]{border:1px solid var(--border-color);border-radius:var(--radius-sm);background:var(--bg-color);min-height:120px}.empty-state[data-v-90f80318]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:var(--spacing-lg);color:var(--text-secondary)}.empty-state .empty-text[data-v-90f80318]{margin:0 0 var(--spacing-sm);font-size:var(--font-sm)}.node-tree[data-v-90f80318]{padding:var(--spacing-xs)}.add-root-area[data-v-90f80318]{padding:var(--spacing-xs) var(--spacing-sm);border-top:1px dashed var(--border-color)}.add-root-btn[data-v-90f80318]{padding:8px 20px;background:var(--primary-color);border:none;border-radius:var(--radius-sm);color:#fff;font-size:var(--font-sm);cursor:pointer}.add-root-btn[data-v-90f80318]:hover{background:var(--primary-hover)}.add-root-btn-sm[data-v-90f80318]{padding:4px 12px;background:none;border:1px dashed var(--border-color);border-radius:var(--radius-xs);color:var(--text-secondary);font-size:var(--font-xs);cursor:pointer;transition:all .2s}.add-root-btn-sm[data-v-90f80318]:hover{border-color:var(--primary-color);color:var(--primary-color)}
.form-meta-editor[data-v-d7fda2bc]{border:1px solid rgba(var(--primary-color-rgb,66,133,244),0.3);border-radius:var(--radius-sm);margin:var(--spacing-sm) 0;overflow:hidden}.meta-header[data-v-d7fda2bc]{display:flex;align-items:center;gap:var(--spacing-xs);padding:var(--spacing-xs) var(--spacing-sm);background:rgba(var(--primary-color-rgb,66,133,244),0.08);font-size:var(--font-sm);font-weight:600;color:var(--primary-color)}.meta-body[data-v-d7fda2bc]{padding:var(--spacing-sm)}.meta-row[data-v-d7fda2bc]{display:flex;gap:var(--spacing-sm);margin-bottom:var(--spacing-xs)}.meta-row[data-v-d7fda2bc]:last-child{margin-bottom:0}.form-group[data-v-d7fda2bc]{flex:1;display:flex;flex-direction:column;gap:2px}.form-label[data-v-d7fda2bc]{font-size:11px;font-weight:600;color:var(--text-secondary)}.form-input[data-v-d7fda2bc]{padding:4px 8px;border:1px solid var(--border-color);border-radius:var(--radius-xs);background:var(--bg-color);color:var(--text-color);font-size:var(--font-sm)}.form-input[data-v-d7fda2bc]:focus{outline:none;border-color:var(--primary-color)}.workflow-section[data-v-d7fda2bc]{margin-top:var(--spacing-sm);padding-top:var(--spacing-sm);border-top:1px solid var(--border-color)}.workflow-header[data-v-d7fda2bc]{display:flex;justify-content:space-between;align-items:center;margin-bottom:var(--spacing-xs)}.workflow-label[data-v-d7fda2bc]{font-size:var(--font-xs);font-weight:600;color:var(--text-secondary)}.add-step-btn[data-v-d7fda2bc]{padding:2px 8px;background:none;border:1px dashed var(--border-color);border-radius:var(--radius-xs);cursor:pointer;font-size:11px;color:var(--text-secondary)}.add-step-btn[data-v-d7fda2bc]:hover{border-color:var(--primary-color);color:var(--primary-color)}.workflow-step[data-v-d7fda2bc]{display:flex;align-items:center;gap:4px;margin-bottom:4px}.workflow-step .step-number[data-v-d7fda2bc]{width:20px;text-align:center;font-size:11px;font-weight:600;color:var(--text-secondary)}.workflow-step .step-input[data-v-d7fda2bc]{flex:1;padding:3px 6px;border:1px solid var(--border-color);border-radius:var(--radius-xs);font-size:12px;background:var(--bg-color);color:var(--text-color)}.workflow-step .step-input[data-v-d7fda2bc]:focus{outline:none;border-color:var(--primary-color)}.step-checkbox[data-v-d7fda2bc]{display:flex;align-items:center;gap:2px;font-size:11px;color:var(--text-secondary);white-space:nowrap}.step-checkbox input[data-v-d7fda2bc]{margin:0}.step-remove[data-v-d7fda2bc]{width:18px;height:18px;display:flex;align-items:center;justify-content:center;background:none;border:none;cursor:pointer;font-size:10px;color:var(--text-disabled)}.step-remove[data-v-d7fda2bc]:hover{color:var(--danger-color)}.workflow-empty[data-v-d7fda2bc]{font-size:var(--font-xs);color:var(--text-disabled);margin:0}
.form-preview-panel[data-v-9c3fd1f4]{border:1px solid var(--border-color);border-radius:var(--radius-sm);margin:var(--spacing-sm) 0;overflow:hidden}.preview-header[data-v-9c3fd1f4]{display:flex;align-items:center;gap:var(--spacing-xs);padding:var(--spacing-xs) var(--spacing-sm);background:var(--bg-tertiary);border-bottom:1px solid var(--border-color);font-size:var(--font-sm);font-weight:600}.preview-close[data-v-9c3fd1f4]{margin-left:auto;width:20px;height:20px;display:flex;align-items:center;justify-content:center;background:none;border:none;cursor:pointer;color:var(--text-secondary)}.preview-close[data-v-9c3fd1f4]:hover{color:var(--text-color)}.preview-body[data-v-9c3fd1f4]{padding:var(--spacing-md);max-height:400px;overflow-y:auto}.preview-empty[data-v-9c3fd1f4]{text-align:center;color:var(--text-disabled);font-size:var(--font-sm)}.preview-empty p[data-v-9c3fd1f4]{margin:0}.form-title[data-v-9c3fd1f4]{font-size:var(--font-md);font-weight:700;margin-bottom:var(--spacing-xs)}.form-desc[data-v-9c3fd1f4]{font-size:var(--font-sm);color:var(--text-secondary);margin-bottom:var(--spacing-md)}.preview-field[data-v-9c3fd1f4]{margin-bottom:var(--spacing-sm)}.field-label[data-v-9c3fd1f4]{display:block;font-size:var(--font-sm);font-weight:600;margin-bottom:4px}.field-label .required-mark[data-v-9c3fd1f4]{color:var(--danger-color)}.preview-input[data-v-9c3fd1f4],.preview-textarea[data-v-9c3fd1f4]{width:100%;padding:6px 10px;border:1px solid var(--border-color);border-radius:var(--radius-xs);background:var(--bg-tertiary);color:var(--text-disabled);font-size:var(--font-sm)}.preview-textarea[data-v-9c3fd1f4]{resize:none;font-family:inherit}.radio-group[data-v-9c3fd1f4],.checkbox-group[data-v-9c3fd1f4]{display:flex;flex-wrap:wrap;gap:var(--spacing-sm)}.radio-option[data-v-9c3fd1f4],.checkbox-option[data-v-9c3fd1f4]{display:flex;align-items:center;gap:4px;font-size:var(--font-sm);color:var(--text-secondary)}.readonly-text[data-v-9c3fd1f4]{font-size:var(--font-sm);color:var(--text-disabled);font-style:italic}
.field-editor-overlay[data-v-be091d6c]{position:fixed;inset:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:1000}.field-editor-modal[data-v-be091d6c]{background:var(--bg-color);border-radius:var(--radius-md);width:560px;max-width:90vw;max-height:80vh;display:flex;flex-direction:column;box-shadow:0 8px 32px rgba(0,0,0,.3)}.modal-header[data-v-be091d6c]{display:flex;align-items:center;justify-content:space-between;padding:var(--spacing-sm) var(--spacing-md);border-bottom:1px solid var(--border-color)}.modal-header .modal-title[data-v-be091d6c]{display:flex;align-items:center;gap:var(--spacing-xs)}.modal-header .modal-title h3[data-v-be091d6c]{margin:0;font-size:var(--font-md)}.modal-header .modal-close[data-v-be091d6c]{width:28px;height:28px;display:flex;align-items:center;justify-content:center;background:none;border:none;cursor:pointer;color:var(--text-secondary);border-radius:var(--radius-xs)}.modal-header .modal-close[data-v-be091d6c]:hover{background:var(--bg-tertiary)}.modal-body[data-v-be091d6c]{flex:1;overflow-y:auto;padding:var(--spacing-md)}.modal-footer[data-v-be091d6c]{display:flex;justify-content:flex-end;gap:var(--spacing-sm);padding:var(--spacing-sm) var(--spacing-md);border-top:1px solid var(--border-color)}.field-info[data-v-be091d6c]{font-size:var(--font-sm);color:var(--text-secondary);margin:0 0 var(--spacing-sm)}.field-item[data-v-be091d6c]{border:1px solid var(--border-color);border-radius:var(--radius-sm);padding:var(--spacing-sm);margin-bottom:var(--spacing-sm)}.field-row[data-v-be091d6c]{display:flex;gap:var(--spacing-sm);align-items:flex-end}.field-options[data-v-be091d6c]{display:flex;flex-wrap:wrap;gap:var(--spacing-sm);margin-top:var(--spacing-xs);padding-top:var(--spacing-xs);border-top:1px dashed var(--border-color)}.form-group[data-v-be091d6c]{flex:1;display:flex;flex-direction:column;gap:2px}.form-group label[data-v-be091d6c]{font-size:11px;font-weight:600;color:var(--text-secondary)}.form-input[data-v-be091d6c]{padding:4px 8px;border:1px solid var(--border-color);border-radius:var(--radius-xs);background:var(--bg-color);color:var(--text-color);font-size:var(--font-sm)}.form-input[data-v-be091d6c]:focus{outline:none;border-color:var(--primary-color)}.checkbox-label[data-v-be091d6c]{display:flex;align-items:center;gap:4px;font-size:var(--font-xs);color:var(--text-secondary);white-space:nowrap}.options-input[data-v-be091d6c],.placeholder-input[data-v-be091d6c]{display:flex;flex-direction:column;gap:2px}.options-input label[data-v-be091d6c],.placeholder-input label[data-v-be091d6c]{font-size:11px;color:var(--text-secondary)}.remove-btn[data-v-be091d6c]{width:24px;height:24px;display:flex;align-items:center;justify-content:center;background:none;border:none;cursor:pointer;color:var(--text-disabled)}.remove-btn[data-v-be091d6c]:hover{color:var(--danger-color)}.add-field-btn[data-v-be091d6c]{width:100%;padding:6px;background:none;border:1px dashed var(--border-color);border-radius:var(--radius-sm);cursor:pointer;font-size:var(--font-sm);color:var(--text-secondary)}.add-field-btn[data-v-be091d6c]:hover{border-color:var(--primary-color);color:var(--primary-color)}.btn[data-v-be091d6c]{padding:6px 16px;border:none;border-radius:var(--radius-sm);cursor:pointer;font-size:var(--font-sm)}.btn-secondary[data-v-be091d6c]{background:var(--bg-tertiary);color:var(--text-color);border:1px solid var(--border-color)}.btn-primary[data-v-be091d6c]{background:var(--primary-color);color:#fff}.btn-primary[data-v-be091d6c]:hover{background:var(--primary-hover)}.modal-enter-active[data-v-be091d6c],.modal-leave-active[data-v-be091d6c]{transition:all .2s}.modal-enter-from[data-v-be091d6c],.modal-leave-to[data-v-be091d6c]{opacity:0}.modal-enter-from .field-editor-modal[data-v-be091d6c],.modal-leave-to .field-editor-modal[data-v-be091d6c]{transform:scale(0.95)}
.setting-section[data-v-456f4b8c]{background:var(--bg-color);border:1px solid var(--border-color);border-radius:var(--radius-md);margin-bottom:var(--spacing-md);overflow:hidden;transition:all var(--transition-fast)}.setting-section[data-v-456f4b8c]:last-child{margin-bottom:0}.setting-section.has-content[data-v-456f4b8c]{border-color:var(--primary-color)}.section-header[data-v-456f4b8c]{display:flex;align-items:center;justify-content:space-between;padding:var(--spacing-sm) var(--spacing-md);background:var(--bg-tertiary);border-bottom:1px solid var(--border-color)}.section-header .section-header-left[data-v-456f4b8c]{display:flex;align-items:center;gap:var(--spacing-sm)}.section-header .section-icon[data-v-456f4b8c]{font-size:16px}.section-header .section-title[data-v-456f4b8c]{margin:0;font-size:var(--font-md);font-weight:600;color:var(--text-color)}.section-content[data-v-456f4b8c]{padding:var(--spacing-md)}.form-row[data-v-456f4b8c]{margin-bottom:var(--spacing-md)}.form-row[data-v-456f4b8c]:last-child{margin-bottom:0}.form-row-2col[data-v-456f4b8c]{display:grid;grid-template-columns:1fr 1fr;gap:var(--spacing-md)}.form-group[data-v-456f4b8c]{display:flex;flex-direction:column;gap:4px}.form-label[data-v-456f4b8c]{font-size:var(--font-sm);font-weight:600;color:var(--text-color);display:flex;align-items:center;gap:4px}.form-input[data-v-456f4b8c]{padding:8px 12px;border:1px solid var(--border-color);border-radius:var(--radius-sm);background:var(--bg-color);color:var(--text-color);font-size:var(--font-sm);transition:border-color .2s}.form-input[data-v-456f4b8c]:focus{outline:none;border-color:var(--primary-color)}.form-input.has-error[data-v-456f4b8c]{border-color:var(--danger-color)}.form-input.has-value[data-v-456f4b8c]{border-color:var(--success-color)}.form-textarea[data-v-456f4b8c]{padding:8px 12px;border:1px solid var(--border-color);border-radius:var(--radius-sm);background:var(--bg-color);color:var(--text-color);font-size:var(--font-sm);resize:vertical;font-family:inherit;transition:border-color .2s}.form-textarea[data-v-456f4b8c]:focus{outline:none;border-color:var(--primary-color)}.form-textarea.has-value[data-v-456f4b8c]{border-color:var(--success-color)}.required-mark[data-v-456f4b8c]{color:var(--danger-color);font-weight:700}.optional-mark[data-v-456f4b8c]{font-size:var(--font-xs);color:var(--text-secondary);font-weight:400}.required-badge[data-v-456f4b8c],.optional-badge[data-v-456f4b8c]{padding:2px 8px;font-size:var(--font-xs);font-weight:600;border-radius:var(--radius-xs);letter-spacing:.5px}.required-badge[data-v-456f4b8c]{background:rgba(var(--danger-color-rgb,220,53,69),0.1);color:var(--danger-color)}.optional-badge[data-v-456f4b8c]{background:var(--bg-tertiary);color:var(--text-secondary)}.char-count[data-v-456f4b8c]{font-size:var(--font-xs);color:var(--text-disabled);text-align:right}.help-text[data-v-456f4b8c]{font-size:var(--font-xs);color:var(--text-secondary)}.error-text[data-v-456f4b8c]{font-size:var(--font-xs);color:var(--danger-color)}@media (max-width:768px){.form-row-2col[data-v-456f4b8c]{grid-template-columns:1fr}}.document-editor-section .section-header[data-v-456f4b8c]{display:flex;align-items:center;justify-content:space-between}.doc-count[data-v-456f4b8c]{font-size:var(--font-xs);color:var(--text-secondary)}.empty-state[data-v-456f4b8c]{padding:var(--spacing-lg);text-align:center}.empty-text[data-v-456f4b8c]{color:var(--text-secondary);font-size:var(--font-sm);margin:0 0 var(--spacing-md)}.empty-actions[data-v-456f4b8c]{display:flex;justify-content:center;gap:var(--spacing-sm)}.add-doc-btn[data-v-456f4b8c]{padding:8px 16px;border:none;border-radius:var(--radius-sm);cursor:pointer;font-size:var(--font-sm);background:var(--primary-color);color:#fff}.add-doc-btn[data-v-456f4b8c]:hover{background:var(--primary-hover)}.add-doc-btn.secondary[data-v-456f4b8c]{background:var(--bg-tertiary);color:var(--text-color);border:1px solid var(--border-color)}.add-doc-btn.secondary[data-v-456f4b8c]:hover{border-color:var(--primary-color)}.document-edit-area[data-v-456f4b8c]{display:flex;flex-direction:column}.outline-area[data-v-456f4b8c]{padding:var(--spacing-sm)}.doc-toolbar[data-v-456f4b8c]{display:flex;gap:var(--spacing-xs);padding:var(--spacing-xs) var(--spacing-sm);border-top:1px solid var(--border-color)}.toolbar-btn[data-v-456f4b8c]{display:flex;align-items:center;gap:4px;padding:4px 10px;background:none;border:1px solid var(--border-color);border-radius:var(--radius-xs);cursor:pointer;font-size:var(--font-xs);color:var(--text-secondary)}.toolbar-btn[data-v-456f4b8c]:hover{border-color:var(--primary-color);color:var(--primary-color)}.toolbar-btn.active[data-v-456f4b8c]{background:rgba(var(--primary-color-rgb,66,133,244),0.1);border-color:var(--primary-color);color:var(--primary-color)}
.setting-section[data-v-622bcc9a]{background:var(--bg-color);border:1px solid var(--border-color);border-radius:var(--radius-md);margin-bottom:var(--spacing-md);overflow:hidden;transition:all var(--transition-fast)}.setting-section[data-v-622bcc9a]:last-child{margin-bottom:0}.setting-section.has-content[data-v-622bcc9a]{border-color:var(--primary-color)}.section-header[data-v-622bcc9a]{display:flex;align-items:center;justify-content:space-between;padding:var(--spacing-sm) var(--spacing-md);background:var(--bg-tertiary);border-bottom:1px solid var(--border-color)}.section-header .section-header-left[data-v-622bcc9a]{display:flex;align-items:center;gap:var(--spacing-sm)}.section-header .section-icon[data-v-622bcc9a]{font-size:16px}.section-header .section-title[data-v-622bcc9a]{margin:0;font-size:var(--font-md);font-weight:600;color:var(--text-color)}.section-content[data-v-622bcc9a]{padding:var(--spacing-md)}.form-row[data-v-622bcc9a]{margin-bottom:var(--spacing-md)}.form-row[data-v-622bcc9a]:last-child{margin-bottom:0}.form-row-2col[data-v-622bcc9a]{display:grid;grid-template-columns:1fr 1fr;gap:var(--spacing-md)}.form-group[data-v-622bcc9a]{display:flex;flex-direction:column;gap:4px}.form-label[data-v-622bcc9a]{font-size:var(--font-sm);font-weight:600;color:var(--text-color);display:flex;align-items:center;gap:4px}.form-input[data-v-622bcc9a]{padding:8px 12px;border:1px solid var(--border-color);border-radius:var(--radius-sm);background:var(--bg-color);color:var(--text-color);font-size:var(--font-sm);transition:border-color .2s}.form-input[data-v-622bcc9a]:focus{outline:none;border-color:var(--primary-color)}.form-input.has-error[data-v-622bcc9a]{border-color:var(--danger-color)}.form-input.has-value[data-v-622bcc9a]{border-color:var(--success-color)}.form-textarea[data-v-622bcc9a]{padding:8px 12px;border:1px solid var(--border-color);border-radius:var(--radius-sm);background:var(--bg-color);color:var(--text-color);font-size:var(--font-sm);resize:vertical;font-family:inherit;transition:border-color .2s}.form-textarea[data-v-622bcc9a]:focus{outline:none;border-color:var(--primary-color)}.form-textarea.has-value[data-v-622bcc9a]{border-color:var(--success-color)}.required-mark[data-v-622bcc9a]{color:var(--danger-color);font-weight:700}.optional-mark[data-v-622bcc9a]{font-size:var(--font-xs);color:var(--text-secondary);font-weight:400}.required-badge[data-v-622bcc9a],.optional-badge[data-v-622bcc9a]{padding:2px 8px;font-size:var(--font-xs);font-weight:600;border-radius:var(--radius-xs);letter-spacing:.5px}.required-badge[data-v-622bcc9a]{background:rgba(var(--danger-color-rgb,220,53,69),0.1);color:var(--danger-color)}.optional-badge[data-v-622bcc9a]{background:var(--bg-tertiary);color:var(--text-secondary)}.char-count[data-v-622bcc9a]{font-size:var(--font-xs);color:var(--text-disabled);text-align:right}.help-text[data-v-622bcc9a]{font-size:var(--font-xs);color:var(--text-secondary)}.error-text[data-v-622bcc9a]{font-size:var(--font-xs);color:var(--danger-color)}@media (max-width:768px){.form-row-2col[data-v-622bcc9a]{grid-template-columns:1fr}}
.panel-footer[data-v-6b14a14a]{flex-shrink:0;display:flex;align-items:center;justify-content:space-between;padding:var(--spacing-xs) var(--spacing-md);background:var(--bg-tertiary);border-top:1px solid var(--border-color);gap:var(--spacing-sm)}.footer-left[data-v-6b14a14a],.footer-right[data-v-6b14a14a]{display:flex;align-items:center;gap:var(--spacing-xs)}.btn[data-v-6b14a14a]{padding:5px 10px;border:none;border-radius:var(--radius-sm);cursor:pointer;font-size:var(--font-sm);font-weight:500;transition:all .2s;white-space:nowrap}.btn[data-v-6b14a14a]:disabled{opacity:.5;cursor:not-allowed}.btn-primary[data-v-6b14a14a]{background:var(--primary-color);color:#fff}.btn-primary[data-v-6b14a14a]:hover:not(:disabled){background:var(--primary-hover)}.btn-secondary[data-v-6b14a14a]{background:var(--bg-color);color:var(--text-color);border:1px solid var(--border-color)}.btn-secondary[data-v-6b14a14a]:hover:not(:disabled){border-color:var(--primary-color)}.btn-success[data-v-6b14a14a]{background:var(--success-color);color:#fff}.btn-success[data-v-6b14a14a]:hover:not(:disabled){opacity:.9}.btn-outline-primary[data-v-6b14a14a]{background:none;color:var(--primary-color);border:1px solid var(--primary-color)}.btn-outline-primary[data-v-6b14a14a]:hover:not(:disabled){background:rgba(var(--primary-color-rgb,66,133,244),0.08)}.btn-loading[data-v-6b14a14a]{display:flex;gap:4px}.btn-loading .loading-dot[data-v-6b14a14a]{width:6px;height:6px;border-radius:50%;background:currentColor;animation:loadingPulse-6b14a14a 1s ease-in-out infinite}.btn-loading .loading-dot[data-v-6b14a14a]:nth-child(2){animation-delay:.2s}.btn-loading .loading-dot[data-v-6b14a14a]:nth-child(3){animation-delay:.4s}@keyframes loadingPulse-6b14a14a{0%,80%,100%{transform:scale(0.6);opacity:.5}40%{transform:scale(1);opacity:1}}@media (max-width:768px){.panel-footer[data-v-6b14a14a]{flex-direction:column;gap:var(--spacing-xs)}.footer-left[data-v-6b14a14a],.footer-right[data-v-6b14a14a]{width:100%;justify-content:center}}
.preset-panel-overlay[data-v-8bbf8ee2],.save-preset-overlay[data-v-8bbf8ee2],.delete-confirm-overlay[data-v-8bbf8ee2]{position:fixed;inset:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:1000}.preset-panel-modal[data-v-8bbf8ee2],.save-preset-modal[data-v-8bbf8ee2],.delete-confirm-modal[data-v-8bbf8ee2]{background:var(--bg-color);border-radius:var(--radius-md);max-width:90vw;max-height:80vh;display:flex;flex-direction:column;box-shadow:0 8px 32px rgba(0,0,0,.3)}.preset-panel-modal[data-v-8bbf8ee2]{width:520px}.save-preset-modal[data-v-8bbf8ee2]{width:400px}.delete-confirm-modal[data-v-8bbf8ee2]{width:360px}.modal-header[data-v-8bbf8ee2]{display:flex;align-items:center;justify-content:space-between;padding:var(--spacing-sm) var(--spacing-md);border-bottom:1px solid var(--border-color);flex-shrink:0}.modal-header.danger[data-v-8bbf8ee2]{background:rgba(var(--danger-color-rgb,220,53,69),0.05)}.modal-header .modal-title[data-v-8bbf8ee2]{display:flex;align-items:center;gap:var(--spacing-xs)}.modal-header .modal-title h3[data-v-8bbf8ee2]{margin:0;font-size:var(--font-md)}.modal-header .modal-close[data-v-8bbf8ee2]{width:28px;height:28px;display:flex;align-items:center;justify-content:center;background:none;border:none;cursor:pointer;color:var(--text-secondary);border-radius:var(--radius-xs)}.modal-header .modal-close[data-v-8bbf8ee2]:hover{background:var(--bg-tertiary)}.modal-body[data-v-8bbf8ee2]{flex:1;overflow:hidden;padding:var(--spacing-md);display:flex;flex-direction:column;min-height:0}.modal-footer[data-v-8bbf8ee2]{display:flex;justify-content:flex-end;gap:var(--spacing-sm);padding:var(--spacing-sm) var(--spacing-md);border-top:1px solid var(--border-color);flex-shrink:0}.toolbar[data-v-8bbf8ee2]{display:flex;align-items:center;justify-content:space-between;margin-bottom:var(--spacing-sm);flex-shrink:0}.toolbar-info[data-v-8bbf8ee2]{font-size:var(--font-sm);color:var(--text-secondary)}.toolbar-actions[data-v-8bbf8ee2]{display:flex;gap:var(--spacing-xs)}.toolbar-btn[data-v-8bbf8ee2]{display:flex;align-items:center;gap:4px;padding:4px 10px;border:1px solid var(--border-color);border-radius:var(--radius-sm);background:var(--bg-color);color:var(--text-color);font-size:var(--font-xs);cursor:pointer}.toolbar-btn[data-v-8bbf8ee2]:hover:not(:disabled){background:var(--bg-tertiary);border-color:var(--primary-color)}.toolbar-btn[data-v-8bbf8ee2]:disabled{opacity:.4;cursor:not-allowed}.preset-list[data-v-8bbf8ee2]{flex:1;overflow-y:auto;min-height:0;max-height:400px}.preset-list[data-v-8bbf8ee2]::-webkit-scrollbar{width:6px}.preset-list[data-v-8bbf8ee2]::-webkit-scrollbar-track{background:rgba(0,0,0,0)}.preset-list[data-v-8bbf8ee2]::-webkit-scrollbar-thumb{background:var(--border-color);border-radius:3px}.preset-list[data-v-8bbf8ee2]::-webkit-scrollbar-thumb:hover{background:var(--text-secondary)}.empty-state[data-v-8bbf8ee2]{text-align:center;padding:var(--spacing-lg) var(--spacing-md);color:var(--text-secondary)}.empty-state .empty-icon[data-v-8bbf8ee2]{font-size:32px;margin-bottom:var(--spacing-xs)}.empty-state .empty-text[data-v-8bbf8ee2]{font-size:var(--font-sm);font-weight:600;margin-bottom:4px}.empty-state .empty-hint[data-v-8bbf8ee2]{font-size:var(--font-xs);color:var(--text-disabled)}.preset-items[data-v-8bbf8ee2]{display:flex;flex-direction:column;gap:4px}.preset-item[data-v-8bbf8ee2]{display:flex;align-items:center;gap:var(--spacing-sm);padding:var(--spacing-sm);border:1px solid var(--border-color);border-radius:var(--radius-sm);cursor:pointer;transition:all .2s}.preset-item[data-v-8bbf8ee2]:hover{border-color:var(--primary-color);background:var(--bg-tertiary)}.preset-item-icon[data-v-8bbf8ee2]{font-size:20px;flex-shrink:0}.preset-item-content[data-v-8bbf8ee2]{flex:1;min-width:0}.preset-item-content .preset-item-name[data-v-8bbf8ee2]{font-size:var(--font-sm);font-weight:600;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.preset-item-content .preset-item-desc[data-v-8bbf8ee2]{font-size:var(--font-xs);color:var(--text-secondary);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.preset-item-content .preset-item-meta[data-v-8bbf8ee2]{font-size:11px;color:var(--text-disabled)}.preset-item-content .preset-item-meta .meta-sep[data-v-8bbf8ee2]{margin:0 4px}.preset-item-actions[data-v-8bbf8ee2]{display:flex;gap:2px;flex-shrink:0}.action-btn[data-v-8bbf8ee2]{width:28px;height:28px;display:flex;align-items:center;justify-content:center;background:none;border:none;cursor:pointer;border-radius:var(--radius-xs);font-size:14px}.action-btn[data-v-8bbf8ee2]:hover{background:var(--bg-tertiary)}.action-btn.danger[data-v-8bbf8ee2]:hover{background:rgba(var(--danger-color-rgb,220,53,69),0.1)}.form-group[data-v-8bbf8ee2]{display:flex;flex-direction:column;gap:4px;margin-bottom:var(--spacing-sm)}.form-group[data-v-8bbf8ee2]:last-child{margin-bottom:0}.form-label[data-v-8bbf8ee2]{font-size:var(--font-sm);font-weight:600}.form-label .required[data-v-8bbf8ee2]{color:var(--danger-color)}.form-input[data-v-8bbf8ee2],.form-textarea[data-v-8bbf8ee2]{padding:6px 10px;border:1px solid var(--border-color);border-radius:var(--radius-sm);background:var(--bg-color);color:var(--text-color);font-size:var(--font-sm);font-family:inherit}.form-input[data-v-8bbf8ee2]:focus,.form-textarea[data-v-8bbf8ee2]:focus{outline:none;border-color:var(--primary-color)}.btn[data-v-8bbf8ee2]{padding:6px 14px;border:none;border-radius:var(--radius-sm);cursor:pointer;font-size:var(--font-sm);display:flex;align-items:center;gap:4px}.btn[data-v-8bbf8ee2]:disabled{opacity:.5;cursor:not-allowed}.btn-primary[data-v-8bbf8ee2]{background:var(--primary-color);color:#fff}.btn-primary[data-v-8bbf8ee2]:hover:not(:disabled){background:var(--primary-hover)}.btn-secondary[data-v-8bbf8ee2]{background:var(--bg-tertiary);color:var(--text-color);border:1px solid var(--border-color)}.btn-success[data-v-8bbf8ee2]{background:var(--success-color);color:#fff}.btn-danger[data-v-8bbf8ee2]{background:var(--danger-color);color:#fff}.modal-enter-active[data-v-8bbf8ee2],.modal-leave-active[data-v-8bbf8ee2]{transition:all .2s}.modal-enter-from[data-v-8bbf8ee2],.modal-leave-to[data-v-8bbf8ee2]{opacity:0}
.prompt-preview-overlay[data-v-478f66d2]{position:fixed;inset:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:1000}.prompt-preview-modal[data-v-478f66d2]{background:var(--bg-color);border-radius:var(--radius-md);width:700px;max-width:90vw;max-height:85vh;display:flex;flex-direction:column;box-shadow:0 8px 32px rgba(0,0,0,.3)}.modal-header[data-v-478f66d2]{display:flex;align-items:center;justify-content:space-between;padding:var(--spacing-sm) var(--spacing-md);border-bottom:1px solid var(--border-color)}.modal-header .modal-title[data-v-478f66d2]{display:flex;align-items:center;gap:var(--spacing-xs)}.modal-header .modal-title h3[data-v-478f66d2]{margin:0;font-size:var(--font-md)}.modal-header .modal-close[data-v-478f66d2]{width:28px;height:28px;display:flex;align-items:center;justify-content:center;background:none;border:none;cursor:pointer;color:var(--text-secondary);border-radius:var(--radius-xs)}.modal-header .modal-close[data-v-478f66d2]:hover{background:var(--bg-tertiary)}.modal-body[data-v-478f66d2]{flex:1;overflow-y:auto;padding:var(--spacing-md)}.modal-footer[data-v-478f66d2]{display:flex;justify-content:flex-end;gap:var(--spacing-sm);padding:var(--spacing-sm) var(--spacing-md);border-top:1px solid var(--border-color)}.prompt-info[data-v-478f66d2]{font-size:var(--font-sm);color:var(--text-secondary);margin-bottom:var(--spacing-sm)}.prompt-textarea[data-v-478f66d2]{width:100%;padding:var(--spacing-sm);border:1px solid var(--border-color);border-radius:var(--radius-sm);background:var(--bg-secondary);color:var(--text-color);font-size:var(--font-sm);font-family:"Consolas","Monaco",monospace;line-height:1.6;resize:vertical}.prompt-textarea[data-v-478f66d2]:focus{outline:none;border-color:var(--primary-color)}.prompt-stats[data-v-478f66d2]{display:flex;gap:var(--spacing-md);margin-top:var(--spacing-sm)}.prompt-stats .stat-item[data-v-478f66d2]{display:flex;align-items:center;gap:4px;font-size:var(--font-xs);color:var(--text-secondary)}.prompt-stats .direct-badge[data-v-478f66d2]{background:rgba(var(--success-color-rgb,40,167,69),0.1);color:var(--success-color);padding:2px 8px;border-radius:var(--radius-xs);font-weight:600}.btn[data-v-478f66d2]{display:flex;align-items:center;gap:4px;padding:6px 14px;border:none;border-radius:var(--radius-sm);cursor:pointer;font-size:var(--font-sm)}.btn-primary[data-v-478f66d2]{background:var(--primary-color);color:#fff}.btn-primary[data-v-478f66d2]:hover{background:var(--primary-hover)}.btn-secondary[data-v-478f66d2]{background:var(--bg-tertiary);color:var(--text-color);border:1px solid var(--border-color)}.modal-enter-active[data-v-478f66d2],.modal-leave-active[data-v-478f66d2]{transition:all .2s}.modal-enter-from[data-v-478f66d2],.modal-leave-to[data-v-478f66d2]{opacity:0}
.game-start-panel[data-v-0b23890f]{display:flex;flex-direction:column;height:100%;background:var(--bg-secondary);border-radius:var(--radius-md);overflow:hidden}.panel-body[data-v-0b23890f]{flex:1;overflow-y:auto;padding:var(--spacing-md)}.collapsible-section[data-v-0b23890f]{border:1px solid var(--border-color);border-radius:var(--radius-sm);margin-bottom:var(--spacing-sm);overflow:hidden}.collapsible-section.collapsed .collapsible-body[data-v-0b23890f]{display:none}.collapsible-header[data-v-0b23890f]{display:flex;align-items:center;gap:var(--spacing-xs);width:100%;padding:var(--spacing-xs) var(--spacing-sm);background:var(--bg-tertiary);border:none;cursor:pointer;font-size:var(--font-sm);font-weight:600;color:var(--text-color);text-align:left}.collapsible-header[data-v-0b23890f]:hover{background:var(--bg-color)}.collapse-arrow[data-v-0b23890f]{font-size:12px;color:var(--text-secondary);width:12px;text-align:center}.collapsible-title[data-v-0b23890f]{flex:1}.collapsible-warn[data-v-0b23890f]{font-size:var(--font-xs);font-weight:400;color:var(--danger-color)}.collapsible-body[data-v-0b23890f]{padding:var(--spacing-xs)}.validation-errors[data-v-0b23890f]{position:sticky;bottom:0;background:rgba(var(--danger-color-rgb,220,53,69),0.1);border-top:2px solid var(--danger-color);padding:var(--spacing-sm) var(--spacing-md)}.validation-errors .error-header[data-v-0b23890f]{display:flex;align-items:center;gap:var(--spacing-xs);font-size:var(--font-sm);font-weight:600;color:var(--danger-color);margin-bottom:var(--spacing-xs)}.validation-errors .error-close[data-v-0b23890f]{margin-left:auto;background:none;border:none;cursor:pointer;color:var(--text-secondary)}.validation-errors .error-list[data-v-0b23890f]{margin:0;padding-left:20px;font-size:var(--font-sm);color:var(--danger-color)}.validation-errors .error-list li[data-v-0b23890f]{margin-bottom:2px}.slide-up-enter-active[data-v-0b23890f],.slide-up-leave-active[data-v-0b23890f]{transition:all .3s ease}.slide-up-enter-from[data-v-0b23890f],.slide-up-leave-to[data-v-0b23890f]{transform:translateY(100%);opacity:0}
.todo-widget[data-v-2d2aca8c]{position:relative}.widget-badge[data-v-2d2aca8c]{display:inline-flex;align-items:center;gap:4px;padding:4px 10px;font-size:var(--font-xs,12px);color:var(--text-secondary,#666);background:var(--bg-color,#fff);border:1px solid var(--border-color,#e0e0e0);border-radius:14px;cursor:pointer;transition:all .2s ease;white-space:nowrap}.widget-badge[data-v-2d2aca8c]:hover{background:var(--bg-hover,#f0f0f0);border-color:var(--border-hover,#ccc)}.widget-badge.active[data-v-2d2aca8c]{background:var(--primary-light,rgba(99,102,241,0.1));border-color:var(--primary-color,#6366f1);color:var(--primary-color,#6366f1)}.badge-icon[data-v-2d2aca8c]{font-size:13px}.badge-label[data-v-2d2aca8c]{font-weight:500}.badge-count[data-v-2d2aca8c]{display:inline-flex;align-items:center;justify-content:center;min-width:18px;height:18px;padding:0 5px;font-size:11px;font-weight:600;color:var(--text-disabled,#999);background:var(--bg-tertiary,#f0f0f0);border-radius:9px}.badge-count.has-items[data-v-2d2aca8c]{color:#fff;background:var(--primary-color,#6366f1)}.widget-dropdown[data-v-2d2aca8c]{position:absolute;top:calc(100% + 4px);left:0;z-index:100;min-width:320px;max-width:420px;background:var(--bg-color,#fff);border:1px solid var(--border-color,#e0e0e0);border-radius:var(--radius-md,8px);box-shadow:var(--shadow-md,0 4px 12px rgba(0,0,0,0.15));backdrop-filter:blur(8px)}.dropdown-list[data-v-2d2aca8c]{max-height:280px;overflow-y:auto;padding:var(--spacing-xs,4px)}.todo-item[data-v-2d2aca8c]{display:flex;align-items:flex-start;gap:var(--spacing-sm,8px);padding:var(--spacing-sm,8px);border-radius:var(--radius-sm,4px);transition:background .15s}.todo-item[data-v-2d2aca8c]:hover{background:var(--bg-hover,rgba(0,0,0,0.03))}.todo-item.is-completed[data-v-2d2aca8c]{opacity:.55}.todo-item.is-completed .todo-title[data-v-2d2aca8c]{text-decoration:line-through;color:var(--text-disabled,#999)}.todo-item.is-urgent[data-v-2d2aca8c]:not(.is-completed){background:rgba(239,68,68,.04)}.todo-checkbox[data-v-2d2aca8c]{position:relative;display:flex;align-items:center;justify-content:center;flex-shrink:0;width:18px;height:18px;margin-top:2px;cursor:pointer}.todo-checkbox input[data-v-2d2aca8c]{position:absolute;opacity:0;width:0;height:0}.todo-checkbox input:checked+.checkmark[data-v-2d2aca8c]{background:var(--primary-color,#6366f1);border-color:var(--primary-color,#6366f1)}.todo-checkbox input:checked+.checkmark[data-v-2d2aca8c]::after{display:block}.todo-checkbox input:disabled+.checkmark[data-v-2d2aca8c]{cursor:not-allowed;opacity:.5}.todo-checkbox .checkmark[data-v-2d2aca8c]{width:16px;height:16px;border:1.5px solid var(--border-color,#ccc);border-radius:3px;background:var(--bg-color,#fff);transition:all .15s}.todo-checkbox .checkmark[data-v-2d2aca8c]::after{content:"";display:none;position:absolute;left:5px;top:2px;width:4px;height:8px;border:solid #fff;border-width:0 2px 2px 0;transform:rotate(45deg)}.todo-content[data-v-2d2aca8c]{flex:1;min-width:0}.todo-header[data-v-2d2aca8c]{display:flex;align-items:center;gap:var(--spacing-xs,4px);margin-bottom:2px}.todo-title[data-v-2d2aca8c]{font-size:var(--font-sm,13px);color:var(--text-color,#333);line-height:1.4;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.priority-tag[data-v-2d2aca8c]{flex-shrink:0;padding:1px 6px;font-size:10px;font-weight:600;border-radius:3px;white-space:nowrap}.priority-tag.urgent[data-v-2d2aca8c]{color:#dc2626;background:rgba(239,68,68,.1)}.priority-tag.normal[data-v-2d2aca8c]{color:var(--text-disabled,#999);background:var(--bg-tertiary,#f0f0f0)}.todo-meta[data-v-2d2aca8c]{display:flex;flex-wrap:wrap;gap:var(--spacing-xs,4px)}.meta-tag[data-v-2d2aca8c]{font-size:11px;padding:1px 5px;border-radius:3px;color:var(--text-secondary,#666);background:var(--bg-tertiary,#f5f5f5)}.meta-tag.source[data-v-2d2aca8c]{color:var(--info-color,#2196f3);background:rgba(33,150,243,.08)}.meta-tag.deadline[data-v-2d2aca8c]{color:var(--warning-color,#f59e0b);background:rgba(245,158,11,.08)}.meta-tag.status-å·²å®Œæˆ[data-v-2d2aca8c]{color:var(--success-color,#4caf50);background:rgba(76,175,80,.08)}.meta-tag.status-å·²å–æ¶ˆ[data-v-2d2aca8c]{color:var(--text-disabled,#999);background:var(--bg-tertiary,#f0f0f0)}.meta-tag.status-è¿›è¡Œä¸­[data-v-2d2aca8c]{color:var(--primary-color,#6366f1);background:rgba(99,102,241,.08)}.dropdown-enter-active[data-v-2d2aca8c],.dropdown-leave-active[data-v-2d2aca8c]{transition:all .2s ease}.dropdown-enter-from[data-v-2d2aca8c],.dropdown-leave-to[data-v-2d2aca8c]{opacity:0;transform:translateY(-4px)}@media (max-width:768px){.widget-dropdown[data-v-2d2aca8c]{min-width:260px;max-width:calc(100vw - 32px)}.dropdown-list[data-v-2d2aca8c]{max-height:220px}}
.notice-widget[data-v-dd4538d8]{position:relative}.widget-badge[data-v-dd4538d8]{display:inline-flex;align-items:center;gap:4px;padding:4px 10px;font-size:var(--font-xs,12px);color:var(--text-secondary,#666);background:var(--bg-color,#fff);border:1px solid var(--border-color,#e0e0e0);border-radius:14px;cursor:pointer;transition:all .2s ease;white-space:nowrap}.widget-badge[data-v-dd4538d8]:hover{background:var(--bg-hover,#f0f0f0);border-color:var(--border-hover,#ccc)}.widget-badge.active[data-v-dd4538d8]{background:rgba(245,158,11,.1);border-color:var(--warning-color,#f59e0b);color:var(--warning-color,#d97706)}.badge-icon[data-v-dd4538d8]{font-size:13px}.badge-label[data-v-dd4538d8]{font-weight:500}.badge-count[data-v-dd4538d8]{display:inline-flex;align-items:center;justify-content:center;min-width:18px;height:18px;padding:0 5px;font-size:11px;font-weight:600;color:var(--text-disabled,#999);background:var(--bg-tertiary,#f0f0f0);border-radius:9px}.badge-count.has-items[data-v-dd4538d8]{color:#fff;background:var(--warning-color,#f59e0b)}.widget-dropdown[data-v-dd4538d8]{position:absolute;top:calc(100% + 4px);left:0;z-index:100;min-width:320px;max-width:420px;background:var(--bg-color,#fff);border:1px solid var(--border-color,#e0e0e0);border-radius:var(--radius-md,8px);box-shadow:var(--shadow-md,0 4px 12px rgba(0,0,0,0.15));backdrop-filter:blur(8px)}.dropdown-list[data-v-dd4538d8]{max-height:280px;overflow-y:auto;padding:var(--spacing-xs,4px)}.notice-item[data-v-dd4538d8]{display:flex;align-items:stretch;gap:0;padding:var(--spacing-sm,8px);padding-left:0;border-radius:var(--radius-sm,4px);transition:background .15s}.notice-item[data-v-dd4538d8]:hover{background:var(--bg-hover,rgba(0,0,0,0.03))}.notice-item.is-urgent[data-v-dd4538d8]{background:rgba(239,68,68,.03)}.notice-item.is-important[data-v-dd4538d8]{background:rgba(245,158,11,.03)}.importance-bar[data-v-dd4538d8]{flex-shrink:0;width:3px;margin-right:var(--spacing-sm,8px);border-radius:2px}.importance-bar.importance-ç´§æ€¥[data-v-dd4538d8]{background:#dc2626}.importance-bar.importance-é‡è¦[data-v-dd4538d8]{background:#f59e0b}.importance-bar.importance-æ™®é€š[data-v-dd4538d8]{background:var(--border-color,#e0e0e0)}.notice-content[data-v-dd4538d8]{flex:1;min-width:0}.notice-header[data-v-dd4538d8]{display:flex;align-items:center;gap:var(--spacing-xs,4px);margin-bottom:2px}.category-tag[data-v-dd4538d8]{flex-shrink:0;padding:1px 6px;font-size:10px;font-weight:600;color:var(--primary-color,#6366f1);background:rgba(99,102,241,.1);border-radius:3px;white-space:nowrap}.notice-title[data-v-dd4538d8]{font-size:var(--font-sm,13px);color:var(--text-color,#333);line-height:1.4;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.notice-meta[data-v-dd4538d8]{display:flex;flex-wrap:wrap;gap:var(--spacing-xs,4px)}.meta-tag[data-v-dd4538d8]{font-size:11px;padding:1px 5px;border-radius:3px;color:var(--text-secondary,#666);background:var(--bg-tertiary,#f5f5f5)}.meta-tag.publisher[data-v-dd4538d8]{color:var(--info-color,#2196f3);background:rgba(33,150,243,.08)}.meta-tag.date[data-v-dd4538d8]{color:var(--text-secondary,#666)}.meta-tag.importance-ç´§æ€¥[data-v-dd4538d8]{color:#dc2626;background:rgba(239,68,68,.1);font-weight:600}.meta-tag.importance-é‡è¦[data-v-dd4538d8]{color:#d97706;background:rgba(245,158,11,.1)}.meta-tag.importance-æ™®é€š[data-v-dd4538d8]{color:var(--text-disabled,#999);background:var(--bg-tertiary,#f0f0f0)}.dropdown-enter-active[data-v-dd4538d8],.dropdown-leave-active[data-v-dd4538d8]{transition:all .2s ease}.dropdown-enter-from[data-v-dd4538d8],.dropdown-leave-to[data-v-dd4538d8]{opacity:0;transform:translateY(-4px)}@media (max-width:768px){.widget-dropdown[data-v-dd4538d8]{min-width:260px;max-width:calc(100vw - 32px)}.dropdown-list[data-v-dd4538d8]{max-height:220px}}
.widget-dock[data-v-16f1afc2]{flex-shrink:0;border-bottom:1px solid var(--border-color,#e0e0e0);background:var(--bg-tertiary,#f8f8f8)}.dock-bar[data-v-16f1afc2]{display:flex;align-items:center;gap:var(--spacing-sm,8px);padding:var(--spacing-xs,4px) var(--spacing-md,12px)}@media (max-width:768px){.dock-bar[data-v-16f1afc2]{padding:var(--spacing-xs,4px) var(--spacing-sm,8px);gap:var(--spacing-xs,4px)}}
.main-content[data-v-0ee91b54]{flex:1;display:flex;flex-direction:column;overflow:hidden;min-height:0;background:var(--bg-color)}.game-text-container[data-v-0ee91b54]{flex:1;display:flex;flex-direction:column;overflow:hidden;padding:var(--spacing-md)}.processing-state[data-v-0ee91b54]{flex:1;display:flex;align-items:center;justify-content:center}.thinking-panel[data-v-0ee91b54]{text-align:center;padding:var(--spacing-xl)}.thinking-animation[data-v-0ee91b54]{display:flex;justify-content:center;gap:8px;margin-bottom:var(--spacing-md)}.thinking-animation .thinking-dot[data-v-0ee91b54]{width:12px;height:12px;background:var(--primary-color);border-radius:50%;animation:thinkingPulse-0ee91b54 1.4s ease-in-out infinite}.thinking-animation .thinking-dot[data-v-0ee91b54]:nth-child(1){animation-delay:0s}.thinking-animation .thinking-dot[data-v-0ee91b54]:nth-child(2){animation-delay:.2s}.thinking-animation .thinking-dot[data-v-0ee91b54]:nth-child(3){animation-delay:.4s}@keyframes thinkingPulse-0ee91b54{0%,80%,100%{transform:scale(0.6);opacity:.5}40%{transform:scale(1);opacity:1}}.thinking-text[data-v-0ee91b54]{font-size:var(--font-md);color:var(--text-secondary);margin:0}.content-display[data-v-0ee91b54]{flex:1;display:flex;flex-direction:column;overflow-y:auto;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-md)}.content-header[data-v-0ee91b54]{display:flex;justify-content:space-between;align-items:center;padding:var(--spacing-sm) var(--spacing-md);border-bottom:1px solid var(--border-color);background:var(--bg-tertiary);flex-shrink:0}.content-meta[data-v-0ee91b54]{display:flex;align-items:center;gap:var(--spacing-md)}.content-meta .meta-item[data-v-0ee91b54]{display:flex;align-items:center;gap:var(--spacing-xs);font-size:var(--font-xs);color:var(--text-disabled)}.content-meta .meta-item .meta-icon[data-v-0ee91b54]{font-size:12px}.content-meta .streaming-badge[data-v-0ee91b54]{color:var(--primary-color)}.content-meta .streaming-badge .streaming-dot[data-v-0ee91b54]{display:inline-block;width:6px;height:6px;background:var(--primary-color);border-radius:50%;animation:streamingBlink-0ee91b54 1s ease-in-out infinite}.version-badge .version-tag[data-v-0ee91b54]{display:inline-block;padding:2px 8px;font-size:10px;font-family:monospace;font-weight:500;color:var(--text-disabled);background:var(--bg-color);border:1px solid var(--border-color);border-radius:3px;white-space:nowrap}@keyframes streamingBlink-0ee91b54{0%,100%{opacity:1}50%{opacity:.3}}.game-text[data-v-0ee91b54]{flex:1;padding:var(--spacing-lg);overflow-y:auto}.game-text[data-v-0ee91b54] .content-block-renderer{font-size:var(--font-md);line-height:1.8;color:var(--text-color)}[data-v-0ee91b54] .variable-changes-panel{margin-top:auto;border-radius:0;border-left:none;border-right:none;border-bottom:none}@media (max-width:768px){.game-text-container[data-v-0ee91b54]{padding:var(--spacing-sm)}.content-header[data-v-0ee91b54]{flex-direction:row;justify-content:space-between;align-items:center;padding:var(--spacing-xs) var(--spacing-sm)}.content-meta[data-v-0ee91b54]{gap:var(--spacing-sm)}.content-meta .meta-item[data-v-0ee91b54]{font-size:11px}.version-badge .version-tag[data-v-0ee91b54]{padding:1px 6px;font-size:9px}.game-text[data-v-0ee91b54]{padding:var(--spacing-md)}.text-content[data-v-0ee91b54]{font-size:var(--font-sm)}}
.bottom-bar[data-v-3ec5b5a3]{display:flex;flex-direction:column;gap:0;padding:0;background:var(--bg-secondary);border-top:1px solid var(--border-color);flex-shrink:0;position:relative;z-index:50}.history-panel[data-v-3ec5b5a3]{background:var(--bg-color);border-bottom:1px solid var(--border-color);max-height:300px;display:flex;flex-direction:column}.history-header[data-v-3ec5b5a3]{display:flex;align-items:center;gap:var(--spacing-sm);padding:var(--spacing-sm) var(--spacing-md);background:var(--bg-secondary);border-bottom:1px solid var(--border-color)}.history-header .history-title[data-v-3ec5b5a3]{font-size:var(--font-sm);font-weight:500;color:var(--text-color)}.history-header .history-count[data-v-3ec5b5a3]{font-size:var(--font-xs);color:var(--text-secondary);background:var(--bg-tertiary);padding:2px 8px;border-radius:var(--radius-sm)}.history-header .history-actions[data-v-3ec5b5a3]{margin-left:auto;display:flex;gap:var(--spacing-xs)}.history-header .history-clear-btn[data-v-3ec5b5a3],.history-header .history-close-btn[data-v-3ec5b5a3]{width:24px;height:24px;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0);border:none;border-radius:var(--radius-xs);cursor:pointer;font-size:12px;color:var(--text-secondary)}.history-header .history-clear-btn[data-v-3ec5b5a3]:hover,.history-header .history-close-btn[data-v-3ec5b5a3]:hover{background:var(--bg-tertiary);color:var(--text-color)}.history-header .history-clear-btn[data-v-3ec5b5a3]:hover{color:var(--error-color)}.history-search[data-v-3ec5b5a3]{padding:var(--spacing-xs) var(--spacing-md);border-bottom:1px solid var(--border-color)}.history-search .history-search-input[data-v-3ec5b5a3]{width:100%;padding:var(--spacing-xs) var(--spacing-sm);background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-sm);color:var(--text-color);font-size:var(--font-xs);outline:none}.history-search .history-search-input[data-v-3ec5b5a3]:focus{border-color:var(--primary-color)}.history-search .history-search-input[data-v-3ec5b5a3]::placeholder{color:var(--text-disabled)}.history-list[data-v-3ec5b5a3]{flex:1;overflow-y:auto;padding:var(--spacing-xs) 0}.history-item[data-v-3ec5b5a3]{display:flex;align-items:center;gap:var(--spacing-sm);padding:var(--spacing-xs) var(--spacing-md);cursor:pointer;transition:background var(--transition-fast)}.history-item[data-v-3ec5b5a3]:hover{background:var(--bg-secondary)}.history-item:hover .history-delete-btn[data-v-3ec5b5a3]{opacity:1}.history-item.is-active[data-v-3ec5b5a3]{background:rgba(var(--primary-color-rgb),0.1);border-left:3px solid var(--primary-color);padding-left:calc(var(--spacing-md) - 3px)}.history-item .history-content[data-v-3ec5b5a3]{flex:1;font-size:var(--font-xs);color:var(--text-color);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.history-item .history-time[data-v-3ec5b5a3]{font-size:10px;color:var(--text-disabled);flex-shrink:0}.history-item .history-delete-btn[data-v-3ec5b5a3]{width:20px;height:20px;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0);border:none;border-radius:var(--radius-xs);cursor:pointer;font-size:10px;color:var(--text-secondary);opacity:0;transition:all var(--transition-fast)}.history-item .history-delete-btn[data-v-3ec5b5a3]:hover{background:rgba(var(--error-color-rgb),0.1);color:var(--error-color)}.history-empty[data-v-3ec5b5a3]{padding:var(--spacing-lg);text-align:center;color:var(--text-disabled);font-size:var(--font-xs)}.input-area[data-v-3ec5b5a3]{flex:1;min-width:0;display:flex;flex-direction:column;gap:var(--spacing-xs);padding:var(--spacing-sm) var(--spacing-md)}.input-container[data-v-3ec5b5a3]{display:flex;align-items:flex-end;gap:var(--spacing-sm);background:var(--bg-color);border:1px solid var(--border-color);border-radius:var(--radius-md);padding:var(--spacing-xs);transition:border-color var(--transition-fast),box-shadow var(--transition-fast)}.input-container[data-v-3ec5b5a3]:focus-within{border-color:var(--primary-color);box-shadow:0 0 0 2px rgba(var(--primary-color-rgb),0.1)}.input-container.is-loading[data-v-3ec5b5a3]{opacity:.7;border-color:var(--border-color)}.input-container.has-error[data-v-3ec5b5a3]{border-color:var(--error-color)}.history-toggle-btn[data-v-3ec5b5a3]{width:36px;height:36px;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0);border:1px solid var(--border-color);border-radius:var(--radius-sm);cursor:pointer;transition:all var(--transition-fast);flex-shrink:0}.history-toggle-btn .history-icon[data-v-3ec5b5a3]{font-size:16px}.history-toggle-btn[data-v-3ec5b5a3]:hover{background:var(--bg-secondary);border-color:var(--primary-color)}.history-toggle-btn.is-active[data-v-3ec5b5a3]{background:rgba(var(--primary-color-rgb),0.1);border-color:var(--primary-color)}.history-toggle-btn[data-v-3ec5b5a3]:not(.has-history){opacity:.5}.history-toggle-btn[data-v-3ec5b5a3]:not(.has-history):hover{opacity:.7}.message-input[data-v-3ec5b5a3]{flex:1;min-height:36px;max-height:120px;padding:var(--spacing-xs) var(--spacing-sm);background:rgba(0,0,0,0);border:none;color:var(--text-color);font-size:var(--font-sm);line-height:1.5;resize:none;outline:none}.message-input[data-v-3ec5b5a3]::placeholder{color:var(--text-disabled)}.message-input[data-v-3ec5b5a3]:disabled{opacity:.6;cursor:not-allowed}.send-btn[data-v-3ec5b5a3]{width:36px;height:36px;display:flex;align-items:center;justify-content:center;background:var(--primary-color);border:none;border-radius:var(--radius-sm);cursor:pointer;transition:all var(--transition-fast);flex-shrink:0}.send-btn .send-icon[data-v-3ec5b5a3],.send-btn .loading-icon[data-v-3ec5b5a3]{font-size:16px}.send-btn[data-v-3ec5b5a3]:hover:not(:disabled){background:var(--primary-hover);transform:scale(1.05)}.send-btn[data-v-3ec5b5a3]:active:not(:disabled){transform:scale(0.95)}.send-btn[data-v-3ec5b5a3]:disabled{background:var(--bg-tertiary);cursor:not-allowed;opacity:.6}.send-btn.is-loading[data-v-3ec5b5a3]{animation:pulse-3ec5b5a3 1.5s infinite}@keyframes pulse-3ec5b5a3{0%,100%{opacity:1}50%{opacity:.6}}.navigation-hint[data-v-3ec5b5a3]{display:flex;align-items:center;gap:var(--spacing-xs);padding:var(--spacing-xs) var(--spacing-sm);background:rgba(var(--primary-color-rgb),0.1);border-radius:var(--radius-sm);font-size:var(--font-xs);color:var(--primary-color)}.navigation-hint .hint-icon[data-v-3ec5b5a3]{font-size:12px}.navigation-hint .hint-text[data-v-3ec5b5a3]{flex:1}.navigation-hint .hint-cancel[data-v-3ec5b5a3]{width:16px;height:16px;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0);border:none;border-radius:var(--radius-xs);cursor:pointer;font-size:10px;color:var(--primary-color)}.navigation-hint .hint-cancel[data-v-3ec5b5a3]:hover{background:rgba(var(--primary-color-rgb),0.2)}.error-message[data-v-3ec5b5a3]{display:flex;align-items:center;gap:var(--spacing-xs);padding:var(--spacing-xs) var(--spacing-sm);background:rgba(var(--error-color-rgb),0.1);border-radius:var(--radius-sm);color:var(--error-color);font-size:var(--font-xs)}.error-message .error-icon[data-v-3ec5b5a3]{flex-shrink:0}.error-message .error-text[data-v-3ec5b5a3]{flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.error-message .error-dismiss[data-v-3ec5b5a3]{width:20px;height:20px;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0);border:none;color:var(--error-color);cursor:pointer;border-radius:var(--radius-xs)}.error-message .error-dismiss[data-v-3ec5b5a3]:hover{background:rgba(var(--error-color-rgb),0.2)}.slide-up-enter-active[data-v-3ec5b5a3],.slide-up-leave-active[data-v-3ec5b5a3]{transition:all .2s ease}.slide-up-enter-from[data-v-3ec5b5a3],.slide-up-leave-to[data-v-3ec5b5a3]{opacity:0;max-height:0;transform:translateY(10px)}.slide-up-enter-to[data-v-3ec5b5a3],.slide-up-leave-from[data-v-3ec5b5a3]{opacity:1;max-height:300px;transform:translateY(0)}@media (max-width:768px){.bottom-bar[data-v-3ec5b5a3]{flex-direction:column}.input-area[data-v-3ec5b5a3]{padding:var(--spacing-sm);padding-bottom:calc(var(--spacing-sm) + env(safe-area-inset-bottom,0px))}.input-container[data-v-3ec5b5a3]{padding:var(--spacing-sm)}.message-input[data-v-3ec5b5a3]{font-size:16px}.send-btn[data-v-3ec5b5a3],.history-toggle-btn[data-v-3ec5b5a3]{width:44px;height:44px}.send-btn .send-icon[data-v-3ec5b5a3],.send-btn .loading-icon[data-v-3ec5b5a3],.send-btn .history-icon[data-v-3ec5b5a3],.history-toggle-btn .send-icon[data-v-3ec5b5a3],.history-toggle-btn .loading-icon[data-v-3ec5b5a3],.history-toggle-btn .history-icon[data-v-3ec5b5a3]{font-size:18px}.history-panel[data-v-3ec5b5a3]{max-height:250px}}
.sidebar[data-v-08e8a59e]{display:flex;flex-direction:column;width:280px;height:100%;background:var(--bg-secondary);border-left:1px solid var(--border-color);transition:width var(--transition-normal),transform var(--transition-normal);flex-shrink:0;position:relative;overflow:hidden}.sidebar.is-collapsed[data-v-08e8a59e]{width:60px}.sidebar.is-collapsed .nav-item[data-v-08e8a59e]{justify-content:center;padding:var(--spacing-md)}.mobile-close-btn[data-v-08e8a59e]{display:none;position:absolute;right:var(--spacing-sm);top:var(--spacing-sm);width:36px;height:36px;align-items:center;justify-content:center;background:var(--bg-hover);border:1px solid var(--border-color);border-radius:var(--radius-sm);cursor:pointer;z-index:11;transition:all var(--transition-fast)}.mobile-close-btn .close-icon[data-v-08e8a59e]{font-size:18px;color:var(--text-secondary)}.mobile-close-btn[data-v-08e8a59e]:hover{background:var(--bg-tertiary)}.mobile-close-btn:hover .close-icon[data-v-08e8a59e]{color:var(--text-color)}.collapse-btn[data-v-08e8a59e]{position:absolute;left:-12px;top:50%;transform:translateY(-50%);width:24px;height:48px;display:flex;align-items:center;justify-content:center;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-sm) 0 0 var(--radius-sm);cursor:pointer;z-index:10;transition:all var(--transition-fast)}.collapse-btn .collapse-icon[data-v-08e8a59e]{font-size:10px;color:var(--text-secondary)}.collapse-btn[data-v-08e8a59e]:hover{background:var(--bg-hover);border-color:var(--border-hover)}.collapse-btn:hover .collapse-icon[data-v-08e8a59e]{color:var(--text-color)}.nav-menu[data-v-08e8a59e]{padding:var(--spacing-sm);flex-shrink:0}.nav-item[data-v-08e8a59e]{display:flex;align-items:center;gap:var(--spacing-sm);padding:var(--spacing-sm) var(--spacing-md);margin-bottom:var(--spacing-xs);border-radius:var(--radius-sm);cursor:pointer;transition:all var(--transition-fast);position:relative}.nav-item .nav-icon[data-v-08e8a59e]{font-size:16px;flex-shrink:0}.nav-item .nav-label[data-v-08e8a59e]{font-size:var(--font-sm);color:var(--text-color);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.nav-item .lite-tag[data-v-08e8a59e]{margin-left:auto;padding:1px 4px;font-size:9px;font-weight:500;background:var(--warning-light);color:var(--warning-color);border-radius:3px;opacity:.8}.nav-item[data-v-08e8a59e]:hover{background:var(--bg-hover)}.nav-item:hover .nav-label[data-v-08e8a59e]{color:var(--text-highlight)}.nav-item.is-active[data-v-08e8a59e]{background:var(--primary-light);border-left:3px solid var(--primary-color)}.nav-item.is-active .nav-label[data-v-08e8a59e]{color:var(--primary-color);font-weight:600}.nav-item.is-disabled[data-v-08e8a59e]{opacity:.5;cursor:not-allowed}.info-panels[data-v-08e8a59e]{flex:1;overflow-y:auto;padding:var(--spacing-sm);display:flex;flex-direction:column;gap:var(--spacing-sm)}.info-panel[data-v-08e8a59e]{background:var(--bg-color);border:1px solid var(--border-light);border-radius:var(--radius-sm);overflow:hidden}.panel-header[data-v-08e8a59e]{display:flex;align-items:center;gap:var(--spacing-xs);padding:var(--spacing-xs) var(--spacing-sm);background:var(--bg-tertiary);border-bottom:1px solid var(--border-light)}.panel-header .panel-icon[data-v-08e8a59e]{font-size:14px}.panel-header .panel-title[data-v-08e8a59e]{font-size:var(--font-xs);font-weight:600;color:var(--text-color)}.panel-header .panel-count[data-v-08e8a59e]{margin-left:auto;min-width:18px;height:18px;display:flex;align-items:center;justify-content:center;padding:0 5px;background:var(--primary-light);color:var(--primary-color);font-size:10px;font-weight:600;border-radius:9px}.panel-body[data-v-08e8a59e]{padding:var(--spacing-xs);max-height:150px;overflow-y:auto}.settings-panel .panel-body[data-v-08e8a59e]{padding:var(--spacing-sm)}.setting-item[data-v-08e8a59e]{display:flex;align-items:center;justify-content:space-between;padding:var(--spacing-xs) 0}.setting-label[data-v-08e8a59e]{display:flex;align-items:center;gap:var(--spacing-xs)}.setting-label .setting-icon[data-v-08e8a59e]{font-size:14px}.setting-label .setting-text[data-v-08e8a59e]{font-size:var(--font-sm);color:var(--text-color)}.setting-hint[data-v-08e8a59e]{font-size:10px;color:var(--text-muted);margin-top:2px;padding-left:22px}.toggle-switch[data-v-08e8a59e]{position:relative;display:inline-block;width:40px;height:20px;cursor:pointer}.toggle-switch input[data-v-08e8a59e]{opacity:0;width:0;height:0}.toggle-switch input:checked+.toggle-slider[data-v-08e8a59e]{background:var(--primary-color)}.toggle-switch input:checked+.toggle-slider[data-v-08e8a59e]::before{transform:translateX(20px)}.toggle-switch .toggle-slider[data-v-08e8a59e]{position:absolute;top:0;left:0;right:0;bottom:0;background:var(--bg-tertiary);border-radius:20px;transition:all var(--transition-fast)}.toggle-switch .toggle-slider[data-v-08e8a59e]::before{content:"";position:absolute;left:2px;bottom:2px;width:16px;height:16px;background:#fff;border-radius:50%;transition:all var(--transition-fast);box-shadow:0 1px 3px rgba(0,0,0,.2)}.lite-info-panel[data-v-08e8a59e]{background:var(--warning-light);border:1px solid var(--warning-color)}.lite-notice[data-v-08e8a59e]{text-align:center;padding:var(--spacing-xs)}.lite-notice p[data-v-08e8a59e]{margin:0;font-size:var(--font-xs);color:var(--text-color)}.lite-notice p.lite-detail[data-v-08e8a59e]{font-size:10px;color:var(--text-secondary);margin-top:2px}.sidebar-footer[data-v-08e8a59e]{padding:var(--spacing-sm);border-top:1px solid var(--border-light);flex-shrink:0}.mobile-settings[data-v-08e8a59e]{display:none}.divider[data-v-08e8a59e]{height:1px;background:var(--border-light);margin:var(--spacing-xs) 0}.footer-item[data-v-08e8a59e]{margin-bottom:var(--spacing-xs)}.footer-item[data-v-08e8a59e]:last-child{margin-bottom:0}.footer-item .nav-label[data-v-08e8a59e]{color:var(--text-secondary)}.footer-item:hover .nav-label[data-v-08e8a59e]{color:var(--text-color)}.footer-item.highlight-item[data-v-08e8a59e]{background:rgba(99,102,241,.1);border:1px solid rgba(99,102,241,.2);border-radius:var(--radius-sm);margin-bottom:var(--spacing-xs)}.footer-item.highlight-item .nav-label[data-v-08e8a59e]{color:var(--primary-color);font-weight:500}.footer-item.highlight-item[data-v-08e8a59e]:hover{background:rgba(99,102,241,.2);border-color:rgba(99,102,241,.4)}.footer-item.highlight-item.secondary[data-v-08e8a59e]{background:rgba(59,130,246,.08);border:1px solid rgba(59,130,246,.15)}.footer-item.highlight-item.secondary .nav-label[data-v-08e8a59e]{color:#3b82f6;font-weight:500}.footer-item.highlight-item.secondary[data-v-08e8a59e]:hover{background:rgba(59,130,246,.15);border-color:rgba(59,130,246,.3)}.footer-item.highlight-item.dev-tool[data-v-08e8a59e]{background:rgba(245,158,11,.08);border:1px solid rgba(245,158,11,.15)}.footer-item.highlight-item.dev-tool .nav-label[data-v-08e8a59e]{color:#f59e0b;font-weight:500}.footer-item.highlight-item.dev-tool[data-v-08e8a59e]:hover{background:rgba(245,158,11,.15);border-color:rgba(245,158,11,.3)}.footer-item.debug-item[data-v-08e8a59e]{border-top:1px dashed var(--border-light);padding-top:var(--spacing-sm);margin-top:var(--spacing-sm)}.footer-item.debug-item .nav-icon[data-v-08e8a59e]{opacity:.7}.footer-item.debug-item .nav-label[data-v-08e8a59e]{color:var(--text-muted);font-size:11px}.footer-item.debug-item:hover .nav-icon[data-v-08e8a59e]{opacity:1}.footer-item.debug-item:hover .nav-label[data-v-08e8a59e]{color:var(--text-secondary)}@media (max-width:768px){.sidebar[data-v-08e8a59e]{position:fixed;right:8px;top:50%;transform:translateY(-50%) translateX(calc(100% + 16px));bottom:auto;width:auto;min-width:150px;max-width:200px;height:auto;max-height:80vh;z-index:100;box-shadow:var(--shadow-lg);transition:transform var(--transition-normal);border:1px solid var(--border-color);border-radius:var(--radius-md);padding:var(--spacing-xs) 0}.sidebar.is-visible[data-v-08e8a59e]{transform:translateY(-50%) translateX(0)}.sidebar.is-collapsed[data-v-08e8a59e]{width:auto;min-width:150px;max-width:200px}.sidebar.is-collapsed .nav-item[data-v-08e8a59e]{justify-content:flex-start;padding:var(--spacing-xs) var(--spacing-sm)}.sidebar.is-collapsed .nav-label[data-v-08e8a59e],.sidebar.is-collapsed .lite-tag[data-v-08e8a59e]{display:inline}.desktop-only[data-v-08e8a59e]{display:none !important}.mobile-settings[data-v-08e8a59e]{display:block;padding:var(--spacing-xs) var(--spacing-sm);background:var(--bg-tertiary);border-radius:var(--radius-xs);margin:0 var(--spacing-xs) var(--spacing-xs)}.mobile-setting-item[data-v-08e8a59e]{display:flex;align-items:center;gap:var(--spacing-xs)}.mobile-setting-item .setting-icon[data-v-08e8a59e]{font-size:12px}.mobile-setting-item .setting-text[data-v-08e8a59e]{font-size:11px;color:var(--text-color);flex:1}.toggle-switch.small[data-v-08e8a59e]{width:32px;height:16px}.toggle-switch.small .toggle-slider[data-v-08e8a59e]::before{width:12px;height:12px;left:2px;bottom:2px}.toggle-switch.small input:checked+.toggle-slider[data-v-08e8a59e]::before{transform:translateX(16px)}.mobile-close-btn[data-v-08e8a59e]{display:flex;position:relative;right:auto;top:auto;width:28px;height:28px;margin:var(--spacing-xs) auto var(--spacing-xs)}.mobile-close-btn .close-icon[data-v-08e8a59e]{font-size:14px}.collapse-btn[data-v-08e8a59e]{display:none}.nav-menu[data-v-08e8a59e]{padding:var(--spacing-xs);padding-top:0}.nav-item[data-v-08e8a59e]{padding:var(--spacing-xs) var(--spacing-sm);margin-bottom:2px}.nav-item .nav-icon[data-v-08e8a59e]{font-size:14px}.nav-item .nav-label[data-v-08e8a59e]{font-size:var(--font-xs);white-space:nowrap}.nav-item .lite-tag[data-v-08e8a59e]{font-size:8px;padding:1px 3px}.sidebar-footer[data-v-08e8a59e]{padding:var(--spacing-xs);border-top:none}.footer-item[data-v-08e8a59e]{padding:var(--spacing-xs) var(--spacing-sm);margin-bottom:2px}.footer-item .nav-icon[data-v-08e8a59e]{font-size:12px}.footer-item .nav-label[data-v-08e8a59e]{font-size:11px;white-space:nowrap}.footer-item.highlight-item[data-v-08e8a59e]{padding:var(--spacing-xs) var(--spacing-sm)}.footer-item.highlight-item.secondary[data-v-08e8a59e]{background:rgba(59,130,246,.12);border-color:rgba(59,130,246,.25)}.footer-item.debug-item[data-v-08e8a59e]{padding-top:var(--spacing-xs);margin-top:var(--spacing-xs)}.divider[data-v-08e8a59e]{margin:2px 0}}@media (max-width:480px){.sidebar[data-v-08e8a59e]{right:4px;min-width:130px;max-width:170px;max-height:75vh;border-radius:var(--radius-sm)}.mobile-settings[data-v-08e8a59e]{padding:var(--spacing-xs);margin:0 var(--spacing-xs) var(--spacing-xs)}.mobile-setting-item .setting-icon[data-v-08e8a59e]{font-size:11px}.mobile-setting-item .setting-text[data-v-08e8a59e]{font-size:10px}.toggle-switch.small[data-v-08e8a59e]{width:28px;height:14px}.toggle-switch.small .toggle-slider[data-v-08e8a59e]::before{width:10px;height:10px;left:2px;bottom:2px}.toggle-switch.small input:checked+.toggle-slider[data-v-08e8a59e]::before{transform:translateX(14px)}.nav-item[data-v-08e8a59e]{padding:var(--spacing-xs) var(--spacing-xs)}.nav-item .nav-icon[data-v-08e8a59e]{font-size:13px}.nav-item .nav-label[data-v-08e8a59e]{font-size:11px}.footer-item .nav-icon[data-v-08e8a59e]{font-size:11px}.footer-item .nav-label[data-v-08e8a59e]{font-size:10px}.footer-item.highlight-item[data-v-08e8a59e]{padding:var(--spacing-xs)}.footer-item.highlight-item.secondary .nav-icon[data-v-08e8a59e]{font-size:12px}}
.roster-panel[data-v-484d301b]{display:flex;flex-direction:column;height:100%;background:var(--bg-secondary);border-radius:8px;overflow:hidden;color:var(--text-color)}.panel-header[data-v-484d301b]{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-bottom:1px solid var(--border-color);background:var(--bg-tertiary)}.panel-header .header-left[data-v-484d301b]{display:flex;align-items:center;gap:10px}.panel-header .header-left .panel-icon[data-v-484d301b]{font-size:20px}.panel-header .header-left h2[data-v-484d301b]{margin:0;font-size:18px;font-weight:600;color:var(--text-color)}.panel-header .header-right[data-v-484d301b]{display:flex;align-items:center;gap:12px}.panel-header .header-right .entry-count[data-v-484d301b]{font-size:14px;color:var(--text-secondary);background:var(--bg-secondary);padding:4px 10px;border-radius:12px}.panel-header .header-right .close-btn[data-v-484d301b]{background:none;border:none;font-size:18px;cursor:pointer;padding:4px 8px;color:var(--text-secondary);border-radius:4px;transition:all .2s}.panel-header .header-right .close-btn[data-v-484d301b]:hover{background:var(--bg-hover);color:var(--text-color)}.panel-main[data-v-484d301b]{display:flex;flex:1;overflow:hidden}.category-sidebar[data-v-484d301b]{width:160px;min-width:160px;background:var(--bg-tertiary);border-right:1px solid var(--border-color);display:flex;flex-direction:column}.category-sidebar .sidebar-header[data-v-484d301b]{padding:12px;border-bottom:1px solid var(--border-color)}.category-sidebar .sidebar-header .sidebar-title[data-v-484d301b]{font-size:13px;font-weight:600;color:var(--text-secondary);text-transform:uppercase;letter-spacing:.5px}.category-sidebar .category-list[data-v-484d301b]{flex:1;overflow-y:auto;padding:8px}.category-sidebar .category-item[data-v-484d301b]{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;margin-bottom:4px;border-radius:6px;cursor:pointer;transition:all .2s}.category-sidebar .category-item .category-name[data-v-484d301b]{font-size:13px;color:var(--text-color)}.category-sidebar .category-item .category-count[data-v-484d301b]{font-size:12px;color:var(--text-secondary);background:var(--bg-secondary);padding:2px 8px;border-radius:10px}.category-sidebar .category-item[data-v-484d301b]:hover{background:var(--bg-hover)}.category-sidebar .category-item.active[data-v-484d301b]{background:var(--primary-light)}.category-sidebar .category-item.active .category-name[data-v-484d301b]{color:var(--primary-color);font-weight:600}.category-sidebar .category-item.active .category-count[data-v-484d301b]{background:var(--primary-color);color:#fff}.panel-body[data-v-484d301b]{flex:1;overflow-y:auto;padding:16px;background:var(--bg-color)}.state-container[data-v-484d301b]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:48px;height:100%}.state-container .state-icon[data-v-484d301b]{font-size:48px;margin-bottom:16px}.state-container p[data-v-484d301b]{margin:0 0 8px 0;color:var(--text-secondary);font-size:15px}.state-container .empty-hint[data-v-484d301b]{font-size:13px;color:var(--text-disabled)}.state-container .empty-hint code[data-v-484d301b]{background:var(--bg-tertiary);padding:2px 6px;border-radius:4px;font-family:monospace;color:var(--text-color)}.state-container .retry-btn[data-v-484d301b]{margin-top:16px;padding:8px 20px;background:var(--primary-color);color:#fff;border:none;border-radius:6px;cursor:pointer}.state-container .retry-btn[data-v-484d301b]:hover{background:var(--primary-hover)}.content-area[data-v-484d301b]{display:flex;flex-direction:column;gap:16px}.group-header[data-v-484d301b]{display:flex;align-items:center;justify-content:space-between;padding-bottom:12px;border-bottom:2px solid var(--primary-color)}.group-header .group-title[data-v-484d301b]{margin:0;font-size:18px;color:var(--text-color)}.group-header .group-count[data-v-484d301b]{font-size:14px;color:var(--text-secondary)}.entry-table[data-v-484d301b]{background:var(--bg-secondary);border-radius:8px;border:1px solid var(--border-color);overflow:hidden}.table-header[data-v-484d301b]{display:flex;align-items:center;padding:12px 16px;background:var(--bg-tertiary);border-bottom:1px solid var(--border-color);font-size:13px;font-weight:600;color:var(--text-secondary)}.table-body[data-v-484d301b]{max-height:500px;overflow-y:auto}.table-row[data-v-484d301b]{border-bottom:1px solid var(--border-color)}.table-row[data-v-484d301b]:last-child{border-bottom:none}.table-row.is-expanded[data-v-484d301b]{background:var(--bg-tertiary)}.row-main[data-v-484d301b]{display:flex;align-items:center;padding:12px 16px;cursor:pointer;transition:background .2s}.row-main[data-v-484d301b]:hover{background:var(--bg-hover)}.col-name[data-v-484d301b]{flex:1.5;display:flex;align-items:center;gap:10px}.col-summary[data-v-484d301b]{flex:1;font-size:13px;color:var(--text-secondary)}.col-action[data-v-484d301b]{width:80px;text-align:right}.person-avatar[data-v-484d301b]{width:32px;height:32px;border-radius:50%;background:var(--primary-light);color:var(--primary-color);display:flex;align-items:center;justify-content:center;font-size:14px;font-weight:600}.person-name[data-v-484d301b]{font-size:14px;font-weight:500;color:var(--text-color)}.expand-btn[data-v-484d301b]{font-size:12px;color:var(--primary-color);cursor:pointer}.row-details[data-v-484d301b]{padding:16px 16px 16px 58px;border-top:1px solid var(--border-color);background:var(--bg-color)}.field-grid[data-v-484d301b]{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:12px}.field-item[data-v-484d301b]{display:flex;flex-direction:column;gap:4px;padding:8px 12px;background:var(--bg-secondary);border-radius:6px}.field-item .field-label[data-v-484d301b]{font-size:12px;color:var(--text-secondary);font-weight:500}.field-item .field-value[data-v-484d301b]{font-size:14px;color:var(--text-color);word-break:break-word}@media (max-width:768px){.panel-main[data-v-484d301b]{flex-direction:column}.category-sidebar[data-v-484d301b]{width:100%;min-width:100%;max-height:120px;border-right:none;border-bottom:1px solid var(--border-color)}.category-list[data-v-484d301b]{display:flex;flex-wrap:wrap;gap:4px}.field-grid[data-v-484d301b]{grid-template-columns:1fr}}
.tree-node[data-v-77df52ff]{margin:8px 0}.node-header[data-v-77df52ff]{display:flex;align-items:flex-start;gap:8px;cursor:pointer;padding:4px 8px;border-radius:var(--radius-sm,4px)}.node-header[data-v-77df52ff]:hover{background:var(--bg-hover)}.expand-icon[data-v-77df52ff],.expand-placeholder[data-v-77df52ff]{width:16px;font-size:10px;color:var(--text-secondary);flex-shrink:0;margin-top:4px}.node-title[data-v-77df52ff]{font-weight:600;color:var(--text-color);flex-shrink:0}.node-inline-content[data-v-77df52ff]{color:var(--text-color);font-weight:normal;line-height:1.6}.node-content[data-v-77df52ff]{margin-top:4px;padding-left:24px;color:var(--text-color);line-height:1.8;text-align:justify;white-space:pre-wrap}.node-children[data-v-77df52ff]{margin-left:16px;padding-left:8px;border-left:2px solid var(--border-color)}.depth-0>.node-header>.node-title[data-v-77df52ff]{font-size:20px;color:var(--primary-color)}.depth-1>.node-header>.node-title[data-v-77df52ff]{font-size:17px;color:var(--text-color)}.depth-2>.node-header>.node-title[data-v-77df52ff]{font-size:15px;color:var(--text-color)}.depth-3>.node-header>.node-title[data-v-77df52ff]{font-size:14px;color:var(--text-secondary)}.depth-4>.node-header>.node-title[data-v-77df52ff],.depth-5>.node-header>.node-title[data-v-77df52ff]{font-size:13px;color:var(--text-secondary)}
.document-panel[data-v-58f812ad]{display:flex;flex-direction:column;height:100%;background:var(--bg-secondary);border-radius:8px;overflow:hidden;color:var(--text-color)}.panel-header[data-v-58f812ad]{display:flex;align-items:center;padding:12px 16px;border-bottom:1px solid var(--border-color);background:var(--bg-tertiary)}.panel-header h2[data-v-58f812ad]{margin:0;font-size:18px;flex:1;color:var(--text-color)}.panel-header .doc-count[data-v-58f812ad]{margin-right:16px;font-size:14px;color:var(--text-secondary)}.panel-header .close-btn[data-v-58f812ad]{background:none;border:none;font-size:18px;cursor:pointer;padding:4px 8px;color:var(--text-secondary)}.panel-header .close-btn[data-v-58f812ad]:hover{color:var(--text-color)}.panel-main[data-v-58f812ad]{display:flex;flex:1;overflow:hidden}.document-sidebar[data-v-58f812ad]{width:220px;min-width:220px;background:var(--bg-tertiary);border-right:1px solid var(--border-color);display:flex;flex-direction:column;transition:width .25s ease,min-width .25s ease}.document-sidebar.collapsed[data-v-58f812ad]{width:50px;min-width:50px}.sidebar-header[data-v-58f812ad]{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;border-bottom:1px solid var(--border-color);background:var(--bg-secondary)}.sidebar-header .sidebar-title[data-v-58f812ad]{font-size:13px;font-weight:600;color:var(--text-color)}.sidebar-header .toggle-btn[data-v-58f812ad]{background:none;border:none;font-size:12px;cursor:pointer;padding:4px 6px;color:var(--text-secondary);border-radius:4px;transition:background .2s}.sidebar-header .toggle-btn[data-v-58f812ad]:hover{background:var(--bg-hover);color:var(--text-color)}.document-list[data-v-58f812ad]{flex:1;overflow-y:auto;padding:8px}.doc-item[data-v-58f812ad]{display:flex;align-items:flex-start;gap:10px;padding:10px 12px;margin-bottom:6px;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:6px;cursor:pointer;transition:all .2s ease}.doc-item .doc-icon[data-v-58f812ad]{font-size:16px;flex-shrink:0;margin-top:2px}.doc-item .doc-info[data-v-58f812ad]{flex:1;min-width:0;display:flex;flex-direction:column;gap:4px}.doc-item .doc-title[data-v-58f812ad]{font-size:13px;font-weight:500;color:var(--text-color);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.doc-item .doc-desc[data-v-58f812ad]{font-size:11px;color:var(--text-secondary);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.doc-item[data-v-58f812ad]:hover{background:var(--bg-hover);border-color:var(--primary-color)}.doc-item.active[data-v-58f812ad]{background:var(--primary-light);border-color:var(--primary-color)}.doc-item.active .doc-title[data-v-58f812ad]{color:var(--primary-color);font-weight:600}.sidebar-empty[data-v-58f812ad]{padding:20px;text-align:center;color:var(--text-secondary);font-size:12px}.collapsed-list[data-v-58f812ad]{flex:1;overflow-y:auto;padding:8px 4px;display:flex;flex-direction:column;align-items:center;gap:6px}.collapsed-item[data-v-58f812ad]{width:36px;height:36px;display:flex;align-items:center;justify-content:center;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:6px;cursor:pointer;font-size:16px;transition:all .2s ease}.collapsed-item[data-v-58f812ad]:hover{background:var(--bg-hover);border-color:var(--primary-color)}.collapsed-item.active[data-v-58f812ad]{background:var(--primary-light);border-color:var(--primary-color)}.panel-body[data-v-58f812ad]{flex:1;overflow-y:auto;padding:16px;background:var(--bg-color)}.loading-state[data-v-58f812ad],.error-state[data-v-58f812ad],.empty-state[data-v-58f812ad]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:48px;color:var(--text-secondary);height:100%}.loading-state button[data-v-58f812ad],.error-state button[data-v-58f812ad],.empty-state button[data-v-58f812ad]{margin-top:16px;padding:8px 16px;background:var(--primary-color);color:#fff;border:none;border-radius:4px;cursor:pointer}.loading-state button[data-v-58f812ad]:hover,.error-state button[data-v-58f812ad]:hover,.empty-state button[data-v-58f812ad]:hover{background:var(--primary-hover)}.loading-state .empty-hint[data-v-58f812ad],.error-state .empty-hint[data-v-58f812ad],.empty-state .empty-hint[data-v-58f812ad]{font-size:12px;margin-top:8px;color:var(--text-disabled)}.loading-state .empty-hint code[data-v-58f812ad],.error-state .empty-hint code[data-v-58f812ad],.empty-state .empty-hint code[data-v-58f812ad]{background:var(--bg-tertiary);padding:2px 6px;border-radius:4px;font-family:monospace;color:var(--text-color)}.document-content[data-v-58f812ad]{padding:8px}.current-doc-header[data-v-58f812ad]{display:flex;align-items:center;margin-bottom:16px;padding-bottom:12px;border-bottom:2px solid var(--primary-color)}.current-doc-header .current-doc-title[data-v-58f812ad]{margin:0;font-size:20px;color:var(--text-color);flex:1}.current-doc-header .section-count[data-v-58f812ad]{font-size:14px;color:var(--text-secondary);background:var(--bg-tertiary);padding:4px 10px;border-radius:12px}.document-description[data-v-58f812ad]{margin-bottom:24px;padding:16px;background:var(--bg-tertiary);border-radius:8px;color:var(--text-secondary);line-height:1.6;font-style:italic;border-left:4px solid var(--primary-color)}@media (max-width:768px){.panel-header[data-v-58f812ad]{padding:10px 12px}.panel-header h2[data-v-58f812ad]{font-size:16px}.panel-header .doc-count[data-v-58f812ad]{font-size:12px}.document-sidebar[data-v-58f812ad]{width:180px;min-width:180px}.document-sidebar.collapsed[data-v-58f812ad]{width:44px;min-width:44px}.sidebar-header[data-v-58f812ad]{padding:8px 10px}.sidebar-header .sidebar-title[data-v-58f812ad]{font-size:12px}.doc-item[data-v-58f812ad]{padding:8px 10px}.doc-item .doc-title[data-v-58f812ad]{font-size:12px}.doc-item .doc-desc[data-v-58f812ad]{font-size:10px}.panel-body[data-v-58f812ad]{padding:12px}.current-doc-header .current-doc-title[data-v-58f812ad]{font-size:18px}.current-doc-header .section-count[data-v-58f812ad]{font-size:12px;padding:3px 8px}}@media (max-width:480px){.document-sidebar[data-v-58f812ad]{width:44px;min-width:44px}.document-sidebar[data-v-58f812ad]:not(.collapsed){position:absolute;left:0;top:0;bottom:0;width:200px;min-width:200px;z-index:10;box-shadow:2px 0 8px rgba(0,0,0,.15)}.panel-main[data-v-58f812ad]{position:relative}.collapsed-item[data-v-58f812ad]{width:32px;height:32px;font-size:14px}}
.form-field[data-v-7a3b8962]{display:flex;flex-direction:column;gap:8px}.form-field.has-error .text-input[data-v-7a3b8962],.form-field.has-error .textarea-input[data-v-7a3b8962],.form-field.has-error .number-input[data-v-7a3b8962],.form-field.has-error .date-input[data-v-7a3b8962],.form-field.has-error .datetime-input[data-v-7a3b8962],.form-field.has-error .select-input[data-v-7a3b8962]{border-color:var(--error-color,#ef4444)}.field-label[data-v-7a3b8962]{font-size:14px;font-weight:500;color:var(--text-color)}.field-label .required-mark[data-v-7a3b8962]{color:var(--error-color,#ef4444);margin-left:2px}.readonly-value[data-v-7a3b8962]{padding:10px 12px;background:var(--bg-tertiary);border:1px solid var(--border-color);border-radius:6px;color:var(--text-secondary);font-size:14px}.text-input[data-v-7a3b8962],.textarea-input[data-v-7a3b8962],.number-input[data-v-7a3b8962],.date-input[data-v-7a3b8962],.datetime-input[data-v-7a3b8962],.select-input[data-v-7a3b8962]{padding:10px 12px;background:var(--bg-color);border:1px solid var(--border-color);border-radius:6px;color:var(--text-color);font-size:14px;transition:border-color .2s,box-shadow .2s}.text-input[data-v-7a3b8962]:focus,.textarea-input[data-v-7a3b8962]:focus,.number-input[data-v-7a3b8962]:focus,.date-input[data-v-7a3b8962]:focus,.datetime-input[data-v-7a3b8962]:focus,.select-input[data-v-7a3b8962]:focus{outline:none;border-color:var(--primary-color);box-shadow:0 0 0 3px var(--primary-light)}.text-input[data-v-7a3b8962]::placeholder,.textarea-input[data-v-7a3b8962]::placeholder,.number-input[data-v-7a3b8962]::placeholder,.date-input[data-v-7a3b8962]::placeholder,.datetime-input[data-v-7a3b8962]::placeholder,.select-input[data-v-7a3b8962]::placeholder{color:var(--text-disabled)}.textarea-input[data-v-7a3b8962]{resize:vertical;min-height:100px}.number-input[data-v-7a3b8962]{width:150px}.char-count[data-v-7a3b8962]{font-size:12px;color:var(--text-disabled);text-align:right}.radio-group[data-v-7a3b8962]{display:flex;flex-wrap:wrap;gap:16px}.radio-option[data-v-7a3b8962],.checkbox-option[data-v-7a3b8962]{display:flex;align-items:center;gap:8px;cursor:pointer}.radio-option input[type=radio][data-v-7a3b8962],.radio-option input[type=checkbox][data-v-7a3b8962],.checkbox-option input[type=radio][data-v-7a3b8962],.checkbox-option input[type=checkbox][data-v-7a3b8962]{width:18px;height:18px;cursor:pointer;accent-color:var(--primary-color)}.radio-option .radio-label[data-v-7a3b8962],.radio-option .checkbox-label[data-v-7a3b8962],.checkbox-option .radio-label[data-v-7a3b8962],.checkbox-option .checkbox-label[data-v-7a3b8962]{font-size:14px;color:var(--text-color)}.table-input[data-v-7a3b8962]{border:1px solid var(--border-color);border-radius:8px;overflow:hidden}.data-table[data-v-7a3b8962]{width:100%;border-collapse:collapse}.data-table th[data-v-7a3b8962],.data-table td[data-v-7a3b8962]{padding:10px 12px;text-align:left;border-bottom:1px solid var(--border-color)}.data-table th[data-v-7a3b8962]{background:var(--bg-tertiary);font-size:13px;font-weight:500;color:var(--text-secondary)}.data-table th .required-mark[data-v-7a3b8962]{color:var(--error-color,#ef4444)}.data-table td[data-v-7a3b8962]{background:var(--bg-color)}.data-table .action-col[data-v-7a3b8962]{width:60px;text-align:center}.table-cell-input[data-v-7a3b8962],.table-cell-select[data-v-7a3b8962]{width:100%;padding:6px 8px;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:4px;color:var(--text-color);font-size:13px}.table-cell-input[data-v-7a3b8962]:focus,.table-cell-select[data-v-7a3b8962]:focus{outline:none;border-color:var(--primary-color)}.remove-row-btn[data-v-7a3b8962]{width:24px;height:24px;display:flex;align-items:center;justify-content:center;background:var(--error-light,rgba(239,68,68,0.1));border:none;border-radius:4px;color:var(--error-color,#ef4444);cursor:pointer;font-size:12px;transition:all .2s}.remove-row-btn[data-v-7a3b8962]:hover{background:var(--error-color,#ef4444);color:#fff}.add-row-btn[data-v-7a3b8962]{width:100%;padding:10px;background:var(--bg-tertiary);border:none;border-top:1px solid var(--border-color);color:var(--primary-color);cursor:pointer;font-size:13px;font-weight:500;transition:background .2s}.add-row-btn[data-v-7a3b8962]:hover{background:var(--bg-hover)}.help-text[data-v-7a3b8962]{font-size:12px;color:var(--text-secondary)}.error-text[data-v-7a3b8962]{font-size:12px;color:var(--error-color,#ef4444)}
.confirm-dialog-overlay[data-v-6545ddc8]{position:fixed !important;top:0 !important;left:0 !important;right:0 !important;bottom:0 !important;background:rgba(0,0,0,.5);backdrop-filter:blur(2px);display:flex;align-items:center;justify-content:center;z-index:10010 !important;padding:var(--spacing-md,16px)}.confirm-dialog[data-v-6545ddc8]{background:var(--bg-secondary,#ffffff);border-radius:var(--radius-lg,8px);box-shadow:var(--shadow-lg,0 10px 20px rgba(0,0,0,0.12));max-width:420px;width:100%;overflow:hidden;animation:dialog-enter-6545ddc8 .2s ease-out}.confirm-dialog.type-info[data-v-6545ddc8]{--dialog-accent:var(--info-color,#1c71d8);--dialog-accent-light:var(--info-light,rgba(28,113,216,0.1))}.confirm-dialog.type-warning[data-v-6545ddc8]{--dialog-accent:var(--warning-color,#e5a50a);--dialog-accent-light:var(--warning-light,rgba(229,165,10,0.1))}.confirm-dialog.type-danger[data-v-6545ddc8]{--dialog-accent:var(--error-color,#c01c28);--dialog-accent-light:var(--error-light,rgba(192,28,40,0.1))}.confirm-dialog.type-success[data-v-6545ddc8]{--dialog-accent:var(--success-color,#26a269);--dialog-accent-light:var(--success-light,rgba(38,162,105,0.1))}.dialog-header[data-v-6545ddc8]{display:flex;align-items:center;gap:var(--spacing-sm,8px);padding:var(--spacing-lg,24px) var(--spacing-lg,24px) var(--spacing-sm,8px)}.dialog-icon[data-v-6545ddc8]{font-size:28px;line-height:1;flex-shrink:0}.dialog-title[data-v-6545ddc8]{margin:0;font-size:var(--font-lg,17px);font-weight:600;color:var(--text-color,#2e3436)}.dialog-body[data-v-6545ddc8]{padding:var(--spacing-sm,8px) var(--spacing-lg,24px) var(--spacing-lg,24px)}.dialog-message[data-v-6545ddc8]{margin:0;font-size:var(--font-md,15px);color:var(--text-secondary,#5e5c64);line-height:1.6;word-break:break-word}.dialog-footer[data-v-6545ddc8]{display:flex;justify-content:flex-end;gap:var(--spacing-sm,8px);padding:var(--spacing-md,16px) var(--spacing-lg,24px);background:var(--bg-tertiary,#f6f5f4);border-top:1px solid var(--border-light,#e5e5e5)}.btn[data-v-6545ddc8]{display:inline-flex;align-items:center;justify-content:center;gap:var(--spacing-xs,4px);padding:var(--spacing-sm,8px) var(--spacing-lg,24px);font-size:var(--font-sm,13px);font-weight:500;border-radius:var(--radius-md,6px);border:none;cursor:pointer;transition:all var(--transition-fast,0.1s ease);min-width:80px}.btn[data-v-6545ddc8]:disabled{opacity:.6;cursor:not-allowed}.btn-cancel[data-v-6545ddc8]{background:var(--bg-color,#f6f5f4);color:var(--text-color,#2e3436);border:1px solid var(--border-color,#c0bfbc)}.btn-cancel[data-v-6545ddc8]:hover:not(:disabled){background:var(--bg-hover,#f0f0f0);border-color:var(--border-hover,#9a9996)}.btn-cancel[data-v-6545ddc8]:active:not(:disabled){background:var(--bg-tertiary,#deddda)}.btn-confirm[data-v-6545ddc8]{background:var(--dialog-accent,var(--primary-color,#1a5fb4));color:#fff}.btn-confirm[data-v-6545ddc8]:hover:not(:disabled){filter:brightness(1.1)}.btn-confirm[data-v-6545ddc8]:active:not(:disabled){filter:brightness(0.95)}.btn-confirm.btn-info[data-v-6545ddc8]{background:var(--info-color,#1c71d8)}.btn-confirm.btn-warning[data-v-6545ddc8]{background:var(--warning-color,#e5a50a);color:var(--text-highlight,#000)}.btn-confirm.btn-danger[data-v-6545ddc8]{background:var(--error-color,#c01c28)}.btn-confirm.btn-success[data-v-6545ddc8]{background:var(--success-color,#26a269)}.loading-spinner[data-v-6545ddc8]{width:14px;height:14px;border:2px solid hsla(0,0%,100%,.3);border-top-color:#fff;border-radius:50%;animation:spin-6545ddc8 .8s linear infinite}@keyframes spin-6545ddc8{to{transform:rotate(360deg)}}@keyframes dialog-enter-6545ddc8{from{opacity:0;transform:scale(0.95) translateY(-10px)}to{opacity:1;transform:scale(1) translateY(0)}}.confirm-dialog-enter-active[data-v-6545ddc8],.confirm-dialog-leave-active[data-v-6545ddc8]{transition:opacity .2s ease}.confirm-dialog-enter-from[data-v-6545ddc8],.confirm-dialog-leave-to[data-v-6545ddc8]{opacity:0}.confirm-dialog-enter-active .confirm-dialog[data-v-6545ddc8]{animation:dialog-enter-6545ddc8 .2s ease-out}.confirm-dialog-leave-active .confirm-dialog[data-v-6545ddc8]{animation:dialog-enter-6545ddc8 .15s ease-in reverse}@media (max-width:480px){.confirm-dialog[data-v-6545ddc8]{max-width:calc(100vw - 32px)}.dialog-footer[data-v-6545ddc8]{flex-direction:column-reverse}.btn[data-v-6545ddc8]{width:100%}}:root.dark-theme .confirm-dialog[data-v-6545ddc8]{background:var(--bg-secondary,#2d2d2d);box-shadow:0 10px 30px rgba(0,0,0,.4)}:root.dark-theme .dialog-title[data-v-6545ddc8]{color:var(--text-color,#f5f5f5)}:root.dark-theme .dialog-message[data-v-6545ddc8]{color:var(--text-secondary,#b0b0b0)}:root.dark-theme .dialog-footer[data-v-6545ddc8]{background:var(--bg-tertiary,#3d3d3d);border-top-color:var(--border-color,#4d4d4d)}:root.dark-theme .btn-cancel[data-v-6545ddc8]{background:var(--bg-color,#1e1e1e);color:var(--text-color,#f5f5f5);border-color:var(--border-color,#4d4d4d)}:root.dark-theme .btn-cancel[data-v-6545ddc8]:hover:not(:disabled){background:var(--bg-hover,#3d3d3d)}
.records-viewer[data-v-57f14fb3]{display:flex;flex-direction:column;height:100%;background:var(--bg-color)}.viewer-header[data-v-57f14fb3]{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;background:var(--bg-tertiary);border-bottom:1px solid var(--border-color)}.viewer-header .header-left[data-v-57f14fb3]{display:flex;align-items:center;gap:10px}.viewer-header .header-left .viewer-icon[data-v-57f14fb3]{font-size:18px}.viewer-header .header-left h3[data-v-57f14fb3]{margin:0;font-size:16px;font-weight:600;color:var(--text-color)}.viewer-header .header-left .record-count[data-v-57f14fb3]{font-size:12px;color:var(--text-secondary);background:var(--bg-secondary);padding:2px 8px;border-radius:10px}.viewer-header .header-right[data-v-57f14fb3]{display:flex;align-items:center;gap:8px}.viewer-header .header-right .quick-approve-all-btn[data-v-57f14fb3]{display:flex;align-items:center;gap:6px;padding:6px 12px;background:linear-gradient(135deg,#f59e0b,#d97706);color:#fff;border:none;border-radius:6px;font-size:12px;font-weight:500;cursor:pointer;transition:all .2s ease}.viewer-header .header-right .quick-approve-all-btn .btn-icon[data-v-57f14fb3]{font-size:14px}.viewer-header .header-right .quick-approve-all-btn .pending-badge[data-v-57f14fb3]{background:hsla(0,0%,100%,.3);padding:1px 6px;border-radius:8px;font-size:11px}.viewer-header .header-right .quick-approve-all-btn[data-v-57f14fb3]:hover:not(:disabled){background:linear-gradient(135deg,#d97706,#b45309);transform:translateY(-1px);box-shadow:0 2px 8px rgba(245,158,11,.4)}.viewer-header .header-right .quick-approve-all-btn[data-v-57f14fb3]:disabled{opacity:.6;cursor:not-allowed}.viewer-header .header-right .delete-all-btn[data-v-57f14fb3]{display:flex;align-items:center;gap:6px;padding:6px 12px;background:rgba(0,0,0,0);color:var(--error-color,#ef4444);border:1px solid var(--error-color,#ef4444);border-radius:6px;font-size:12px;font-weight:500;cursor:pointer;transition:all .2s ease}.viewer-header .header-right .delete-all-btn .btn-icon[data-v-57f14fb3]{font-size:14px}.viewer-header .header-right .delete-all-btn[data-v-57f14fb3]:hover:not(:disabled){background:var(--error-color,#ef4444);color:#fff;transform:translateY(-1px);box-shadow:0 2px 8px rgba(239,68,68,.4)}.viewer-header .header-right .delete-all-btn[data-v-57f14fb3]:disabled{opacity:.6;cursor:not-allowed}.viewer-header .header-right .close-btn[data-v-57f14fb3]{background:none;border:none;font-size:16px;cursor:pointer;padding:4px 8px;color:var(--text-secondary);border-radius:4px;transition:all .2s}.viewer-header .header-right .close-btn[data-v-57f14fb3]:hover{background:var(--bg-hover);color:var(--text-color)}.filter-bar[data-v-57f14fb3]{display:flex;align-items:center;gap:16px;padding:12px 16px;background:var(--bg-secondary);border-bottom:1px solid var(--border-color)}.filter-bar .filter-item[data-v-57f14fb3]{display:flex;align-items:center;gap:8px}.filter-bar .filter-item label[data-v-57f14fb3]{font-size:13px;color:var(--text-secondary);white-space:nowrap}.filter-bar .filter-item .filter-select[data-v-57f14fb3]{padding:6px 10px;border:1px solid var(--border-color);border-radius:6px;background:var(--bg-color);color:var(--text-color);font-size:13px;cursor:pointer}.filter-bar .filter-item .filter-select[data-v-57f14fb3]:focus{outline:none;border-color:var(--primary-color)}.filter-bar .search-item[data-v-57f14fb3]{flex:1;position:relative}.filter-bar .search-item .search-input[data-v-57f14fb3]{width:100%;padding:6px 10px 6px 30px;border:1px solid var(--border-color);border-radius:6px;background:var(--bg-color);color:var(--text-color);font-size:13px}.filter-bar .search-item .search-input[data-v-57f14fb3]::placeholder{color:var(--text-disabled)}.filter-bar .search-item .search-input[data-v-57f14fb3]:focus{outline:none;border-color:var(--primary-color)}.filter-bar .search-item .search-icon[data-v-57f14fb3]{position:absolute;left:8px;top:50%;transform:translateY(-50%);font-size:14px;opacity:.5}.records-list[data-v-57f14fb3]{flex:1;overflow-y:auto;padding:16px}.record-card[data-v-57f14fb3]{background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:8px;margin-bottom:12px;cursor:pointer;transition:all .2s ease}.record-card[data-v-57f14fb3]:hover{border-color:var(--primary-color);box-shadow:0 2px 8px rgba(0,0,0,.1)}.record-card.status-approved[data-v-57f14fb3]{border-left:4px solid var(--success-color,#22c55e)}.record-card.status-rejected[data-v-57f14fb3]{border-left:4px solid var(--error-color,#ef4444)}.record-card.status-pending[data-v-57f14fb3]{border-left:4px solid var(--warning-color,#f59e0b)}.card-header[data-v-57f14fb3]{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-bottom:1px solid var(--border-color)}.card-header .card-title[data-v-57f14fb3]{display:flex;align-items:center;gap:12px}.card-header .card-title .app-id[data-v-57f14fb3]{font-size:14px;font-weight:600;color:var(--text-color);font-family:monospace}.card-header .card-title .form-type[data-v-57f14fb3]{font-size:12px;color:var(--text-secondary);background:var(--bg-tertiary);padding:2px 8px;border-radius:4px}.card-header .status-badge[data-v-57f14fb3]{font-size:12px;padding:4px 10px;border-radius:12px;font-weight:500}.card-header .status-badge.status-approved[data-v-57f14fb3]{background:rgba(34,197,94,.15);color:var(--success-color,#22c55e)}.card-header .status-badge.status-rejected[data-v-57f14fb3]{background:rgba(239,68,68,.15);color:var(--error-color,#ef4444)}.card-header .status-badge.status-pending[data-v-57f14fb3]{background:rgba(245,158,11,.15);color:var(--warning-color,#f59e0b)}.card-header .status-badge.status-default[data-v-57f14fb3]{background:var(--bg-tertiary);color:var(--text-secondary)}.card-summary[data-v-57f14fb3]{padding:12px 16px}.card-summary .summary-row[data-v-57f14fb3]{display:flex;align-items:center;margin-bottom:6px}.card-summary .summary-row[data-v-57f14fb3]:last-child{margin-bottom:0}.card-summary .summary-row .summary-label[data-v-57f14fb3]{font-size:13px;color:var(--text-secondary);min-width:60px}.card-summary .summary-row .summary-value[data-v-57f14fb3]{font-size:13px;color:var(--text-color)}.card-summary .summary-row .summary-dept[data-v-57f14fb3]{font-size:12px;color:var(--text-secondary);margin-left:4px}.card-details[data-v-57f14fb3]{padding:0 16px 12px}.card-details .details-divider[data-v-57f14fb3]{height:1px;background:var(--border-color);margin-bottom:12px}.card-details .detail-row[data-v-57f14fb3]{display:flex;margin-bottom:8px}.card-details .detail-row[data-v-57f14fb3]:last-child{margin-bottom:0}.card-details .detail-row .detail-label[data-v-57f14fb3]{font-size:12px;color:var(--text-secondary);min-width:80px;flex-shrink:0}.card-details .detail-row .detail-value[data-v-57f14fb3]{font-size:12px;color:var(--text-color);word-break:break-all}.card-details .detail-row.full-summary[data-v-57f14fb3]{flex-direction:column;gap:4px;margin-top:8px;padding-top:8px;border-top:1px dashed var(--border-color)}.card-details .detail-row.full-summary .detail-value[data-v-57f14fb3]{background:var(--bg-tertiary);padding:8px;border-radius:4px;font-family:monospace;font-size:11px;line-height:1.5}.card-actions[data-v-57f14fb3]{margin-top:12px;padding-top:12px;border-top:1px solid var(--border-color);display:flex;justify-content:flex-end;gap:8px}.card-actions .quick-approve-btn[data-v-57f14fb3]{display:flex;align-items:center;gap:6px;padding:8px 16px;background:linear-gradient(135deg,#22c55e,#16a34a);color:#fff;border:none;border-radius:6px;font-size:13px;font-weight:500;cursor:pointer;transition:all .2s ease}.card-actions .quick-approve-btn .btn-icon[data-v-57f14fb3]{font-size:14px}.card-actions .quick-approve-btn[data-v-57f14fb3]:hover:not(:disabled){background:linear-gradient(135deg,#16a34a,#15803d);transform:translateY(-1px);box-shadow:0 2px 8px rgba(34,197,94,.4)}.card-actions .quick-approve-btn[data-v-57f14fb3]:disabled{opacity:.6;cursor:not-allowed}.card-actions .delete-btn[data-v-57f14fb3]{display:flex;align-items:center;gap:6px;padding:8px 16px;background:var(--bg-tertiary);color:var(--error-color,#ef4444);border:1px solid var(--error-color,#ef4444);border-radius:6px;font-size:13px;font-weight:500;cursor:pointer;transition:all .2s ease}.card-actions .delete-btn .btn-icon[data-v-57f14fb3]{font-size:14px}.card-actions .delete-btn[data-v-57f14fb3]:hover:not(:disabled){background:var(--error-color,#ef4444);color:#fff;transform:translateY(-1px);box-shadow:0 2px 8px rgba(239,68,68,.4)}.card-actions .delete-btn[data-v-57f14fb3]:disabled{opacity:.6;cursor:not-allowed}.expand-indicator[data-v-57f14fb3]{padding:8px 16px;text-align:center;border-top:1px solid var(--border-color);background:var(--bg-tertiary);border-radius:0 0 8px 8px}.expand-indicator span[data-v-57f14fb3]{font-size:12px;color:var(--text-secondary)}.empty-state[data-v-57f14fb3]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:48px;color:var(--text-secondary)}.empty-state .empty-icon[data-v-57f14fb3]{font-size:48px;margin-bottom:16px}.empty-state p[data-v-57f14fb3]{margin:0;font-size:14px}.result-toast[data-v-57f14fb3]{position:fixed;bottom:24px;left:50%;transform:translateX(-50%);display:flex;align-items:center;gap:8px;padding:12px 20px;border-radius:8px;font-size:14px;font-weight:500;box-shadow:0 4px 12px rgba(0,0,0,.15);z-index:1000}.result-toast.success[data-v-57f14fb3]{background:var(--success-color,#22c55e);color:#fff}.result-toast.error[data-v-57f14fb3]{background:var(--error-color,#ef4444);color:#fff}.result-toast .toast-icon[data-v-57f14fb3]{font-size:16px}.result-toast-enter-active[data-v-57f14fb3],.result-toast-leave-active[data-v-57f14fb3]{transition:all .3s ease}.result-toast-enter-from[data-v-57f14fb3],.result-toast-leave-to[data-v-57f14fb3]{opacity:0;transform:translateX(-50%) translateY(20px)}@media (max-width:768px){.filter-bar[data-v-57f14fb3]{flex-direction:column;align-items:stretch}.filter-bar .filter-item[data-v-57f14fb3]{width:100%}.filter-bar .filter-item .filter-select[data-v-57f14fb3]{flex:1}.card-header[data-v-57f14fb3]{flex-direction:column;align-items:flex-start;gap:8px}}
.form-panel[data-v-27cdd179]{display:flex;flex-direction:column;height:100%;background:var(--bg-secondary);border-radius:8px;overflow:hidden;color:var(--text-color)}.panel-header[data-v-27cdd179]{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-bottom:1px solid var(--border-color);background:var(--bg-tertiary)}.panel-header .header-left[data-v-27cdd179]{display:flex;align-items:center;gap:10px}.panel-header .header-left .panel-icon[data-v-27cdd179]{font-size:20px}.panel-header .header-left h2[data-v-27cdd179]{margin:0;font-size:18px;font-weight:600;color:var(--text-color)}.panel-header .header-center[data-v-27cdd179]{flex:1;display:flex;justify-content:center}.panel-header .view-toggle[data-v-27cdd179]{display:flex;background:var(--bg-secondary);border-radius:8px;padding:4px;gap:4px}.panel-header .view-toggle .toggle-btn[data-v-27cdd179]{display:flex;align-items:center;gap:6px;padding:8px 16px;border:none;background:rgba(0,0,0,0);border-radius:6px;cursor:pointer;font-size:13px;color:var(--text-secondary);transition:all .2s ease}.panel-header .view-toggle .toggle-btn .btn-icon[data-v-27cdd179]{font-size:14px}.panel-header .view-toggle .toggle-btn .btn-text[data-v-27cdd179]{font-weight:500}.panel-header .view-toggle .toggle-btn .record-badge[data-v-27cdd179]{background:var(--primary-color);color:#fff;font-size:11px;padding:2px 6px;border-radius:10px;min-width:18px;text-align:center}.panel-header .view-toggle .toggle-btn[data-v-27cdd179]:hover{background:var(--bg-hover);color:var(--text-color)}.panel-header .view-toggle .toggle-btn.active[data-v-27cdd179]{background:var(--primary-color);color:#fff}.panel-header .view-toggle .toggle-btn.active .record-badge[data-v-27cdd179]{background:hsla(0,0%,100%,.3)}.panel-header .header-right[data-v-27cdd179]{display:flex;align-items:center;gap:12px}.panel-header .header-right .form-count[data-v-27cdd179]{font-size:14px;color:var(--text-secondary);background:var(--bg-secondary);padding:4px 10px;border-radius:12px}.panel-header .header-right .close-btn[data-v-27cdd179]{background:none;border:none;font-size:18px;cursor:pointer;padding:4px 8px;color:var(--text-secondary);border-radius:4px;transition:all .2s}.panel-header .header-right .close-btn[data-v-27cdd179]:hover{background:var(--bg-hover);color:var(--text-color)}.panel-main[data-v-27cdd179]{display:flex;flex:1;overflow:hidden}.form-sidebar[data-v-27cdd179]{width:220px;min-width:220px;background:var(--bg-tertiary);border-right:1px solid var(--border-color);display:flex;flex-direction:column;transition:width .25s ease,min-width .25s ease}.form-sidebar.collapsed[data-v-27cdd179]{width:50px;min-width:50px}.sidebar-header[data-v-27cdd179]{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;border-bottom:1px solid var(--border-color);background:var(--bg-secondary)}.sidebar-header .sidebar-title[data-v-27cdd179]{font-size:13px;font-weight:600;color:var(--text-color)}.sidebar-header .toggle-btn[data-v-27cdd179]{background:none;border:none;font-size:12px;cursor:pointer;padding:4px 6px;color:var(--text-secondary);border-radius:4px;transition:background .2s}.sidebar-header .toggle-btn[data-v-27cdd179]:hover{background:var(--bg-hover);color:var(--text-color)}.form-list[data-v-27cdd179]{flex:1;overflow-y:auto;padding:8px}.form-item[data-v-27cdd179]{display:flex;align-items:flex-start;gap:10px;padding:10px 12px;margin-bottom:6px;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:6px;cursor:pointer;transition:all .2s ease}.form-item .form-icon[data-v-27cdd179]{font-size:16px;flex-shrink:0;margin-top:2px}.form-item .form-info[data-v-27cdd179]{flex:1;min-width:0;display:flex;flex-direction:column;gap:4px}.form-item .form-title[data-v-27cdd179]{font-size:13px;font-weight:500;color:var(--text-color);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.form-item .form-desc[data-v-27cdd179]{font-size:11px;color:var(--text-secondary);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.form-item[data-v-27cdd179]:hover{background:var(--bg-hover);border-color:var(--primary-color)}.form-item.active[data-v-27cdd179]{background:var(--primary-light);border-color:var(--primary-color)}.form-item.active .form-title[data-v-27cdd179]{color:var(--primary-color);font-weight:600}.sidebar-empty[data-v-27cdd179]{padding:20px;text-align:center;color:var(--text-secondary);font-size:12px}.collapsed-list[data-v-27cdd179]{flex:1;overflow-y:auto;padding:8px 4px;display:flex;flex-direction:column;align-items:center;gap:6px}.collapsed-item[data-v-27cdd179]{width:36px;height:36px;display:flex;align-items:center;justify-content:center;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:6px;cursor:pointer;font-size:16px;transition:all .2s ease}.collapsed-item[data-v-27cdd179]:hover{background:var(--bg-hover);border-color:var(--primary-color)}.collapsed-item.active[data-v-27cdd179]{background:var(--primary-light);border-color:var(--primary-color)}.panel-body[data-v-27cdd179]{flex:1;overflow-y:auto;padding:16px;background:var(--bg-color)}.state-container[data-v-27cdd179]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:48px;height:100%}.state-container .state-icon[data-v-27cdd179]{font-size:48px;margin-bottom:16px}.state-container p[data-v-27cdd179]{margin:0 0 8px 0;color:var(--text-secondary);font-size:15px}.state-container .empty-hint[data-v-27cdd179]{font-size:13px;color:var(--text-disabled)}.state-container .empty-hint code[data-v-27cdd179]{background:var(--bg-tertiary);padding:2px 6px;border-radius:4px;font-family:monospace;color:var(--text-color)}.state-container .retry-btn[data-v-27cdd179]{margin-top:16px;padding:8px 20px;background:var(--primary-color);color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:14px;transition:background .2s}.state-container .retry-btn[data-v-27cdd179]:hover{background:var(--primary-hover)}.form-content[data-v-27cdd179]{max-width:800px;margin:0 auto}.form-header[data-v-27cdd179]{margin-bottom:20px;padding-bottom:16px;border-bottom:2px solid var(--primary-color)}.form-header .form-header-top[data-v-27cdd179]{display:flex;align-items:flex-start;justify-content:space-between;gap:16px}.form-header .form-title-section[data-v-27cdd179]{flex:1}.form-header .form-title[data-v-27cdd179]{margin:0 0 8px 0;font-size:20px;color:var(--text-color)}.form-header .form-description[data-v-27cdd179]{display:block;font-size:14px;color:var(--text-secondary)}.form-header .form-header-actions[data-v-27cdd179]{flex-shrink:0}.form-header .auto-fill-btn[data-v-27cdd179]{display:flex;align-items:center;gap:6px;padding:8px 16px;background:linear-gradient(135deg,#8b5cf6,#7c3aed);color:#fff;border:none;border-radius:8px;font-size:13px;font-weight:500;cursor:pointer;transition:all .2s ease;box-shadow:0 2px 4px rgba(139,92,246,.3)}.form-header .auto-fill-btn .btn-icon[data-v-27cdd179]{font-size:14px}.form-header .auto-fill-btn .btn-text[data-v-27cdd179]{white-space:nowrap}.form-header .auto-fill-btn[data-v-27cdd179]:hover:not(:disabled){background:linear-gradient(135deg,#7c3aed,#6d28d9);transform:translateY(-1px);box-shadow:0 4px 8px rgba(139,92,246,.4)}.form-header .auto-fill-btn[data-v-27cdd179]:active:not(:disabled){transform:translateY(0);box-shadow:0 2px 4px rgba(139,92,246,.3)}.form-header .auto-fill-btn[data-v-27cdd179]:disabled{opacity:.6;cursor:not-allowed}.workflow-hint[data-v-27cdd179]{display:flex;align-items:center;flex-wrap:wrap;gap:8px;padding:12px 16px;background:var(--bg-tertiary);border-radius:8px;margin-bottom:24px;font-size:13px}.workflow-hint .workflow-label[data-v-27cdd179]{color:var(--text-secondary);font-weight:500}.workflow-hint .workflow-step[data-v-27cdd179]{color:var(--text-color);background:var(--bg-secondary);padding:4px 10px;border-radius:12px}.workflow-hint .workflow-arrow[data-v-27cdd179]{color:var(--text-disabled);margin:0 4px}.form-fields[data-v-27cdd179]{display:flex;flex-direction:column;gap:16px;margin-bottom:24px}.form-actions[data-v-27cdd179]{display:flex;justify-content:flex-end;gap:12px;padding-top:16px;border-top:1px solid var(--border-color)}.form-actions .reset-btn[data-v-27cdd179]{padding:10px 24px;background:var(--bg-tertiary);color:var(--text-color);border:1px solid var(--border-color);border-radius:6px;cursor:pointer;font-size:14px;transition:all .2s}.form-actions .reset-btn[data-v-27cdd179]:hover:not(:disabled){background:var(--bg-hover)}.form-actions .reset-btn[data-v-27cdd179]:disabled{opacity:.5;cursor:not-allowed}.form-actions .submit-btn[data-v-27cdd179]{padding:10px 32px;background:var(--primary-color);color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:14px;font-weight:500;transition:all .2s}.form-actions .submit-btn[data-v-27cdd179]:hover:not(:disabled){background:var(--primary-hover)}.form-actions .submit-btn[data-v-27cdd179]:disabled{opacity:.6;cursor:not-allowed}.submit-success[data-v-27cdd179]{display:flex;align-items:center;justify-content:center;gap:8px;padding:16px;margin-top:16px;background:var(--success-light,rgba(34,197,94,0.1));border:1px solid var(--success-color,#22c55e);border-radius:8px;color:var(--success-color,#22c55e);font-size:14px}.submit-success .success-icon[data-v-27cdd179]{font-size:18px}@media (max-width:768px){.panel-header[data-v-27cdd179]{flex-wrap:wrap;gap:8px}.panel-header .header-center[data-v-27cdd179]{order:3;width:100%;justify-content:center}.panel-header .view-toggle[data-v-27cdd179]{width:100%}.panel-header .view-toggle .toggle-btn[data-v-27cdd179]{flex:1;justify-content:center}.form-sidebar[data-v-27cdd179]{width:180px;min-width:180px}.form-sidebar.collapsed[data-v-27cdd179]{width:44px;min-width:44px}.form-content[data-v-27cdd179]{max-width:100%}.form-actions[data-v-27cdd179]{flex-direction:column}.form-actions .reset-btn[data-v-27cdd179],.form-actions .submit-btn[data-v-27cdd179]{width:100%}}
.history-text-panel[data-v-e34eebd4]{display:flex;flex-direction:column;width:100%;height:100%;background:var(--bg-secondary);border-radius:var(--radius-md);overflow:hidden}.panel-header[data-v-e34eebd4]{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;background:linear-gradient(135deg,#3b82f6 0%,#1d4ed8 100%);color:#fff;flex-shrink:0}.header-left[data-v-e34eebd4]{display:flex;align-items:center;gap:10px}.panel-icon[data-v-e34eebd4]{font-size:20px}.panel-title[data-v-e34eebd4]{margin:0;font-size:16px;font-weight:600}.text-count[data-v-e34eebd4]{padding:3px 10px;font-size:11px;font-weight:500;background:hsla(0,0%,100%,.2);border-radius:10px}.header-actions[data-v-e34eebd4]{display:flex;align-items:center;gap:8px}.btn-refresh[data-v-e34eebd4],.btn-close[data-v-e34eebd4]{width:30px;height:30px;display:flex;align-items:center;justify-content:center;background:hsla(0,0%,100%,.1);border:none;color:#fff;font-size:14px;cursor:pointer;border-radius:4px;transition:all .2s ease}.btn-refresh[data-v-e34eebd4]:hover:not(:disabled),.btn-close[data-v-e34eebd4]:hover:not(:disabled){background:hsla(0,0%,100%,.25)}.btn-refresh[data-v-e34eebd4]:disabled,.btn-close[data-v-e34eebd4]:disabled{opacity:.4;cursor:not-allowed}.search-bar[data-v-e34eebd4]{display:flex;align-items:center;gap:var(--spacing-sm);padding:var(--spacing-sm) var(--spacing-md);background:var(--bg-tertiary);border-bottom:1px solid var(--border-color);flex-shrink:0}.search-input[data-v-e34eebd4]{flex:1;padding:8px 12px;background:var(--bg-color);border:1px solid var(--border-color);border-radius:var(--radius-sm);font-size:var(--font-sm);color:var(--text-color);outline:none;transition:border-color var(--transition-fast)}.search-input[data-v-e34eebd4]:focus{border-color:var(--primary-color)}.search-input[data-v-e34eebd4]::placeholder{color:var(--text-muted)}.search-result-count[data-v-e34eebd4]{font-size:var(--font-xs);color:var(--text-secondary);white-space:nowrap}.panel-body[data-v-e34eebd4]{flex:1;overflow-y:auto;min-height:0}.panel-body[data-v-e34eebd4]::-webkit-scrollbar{width:6px}.panel-body[data-v-e34eebd4]::-webkit-scrollbar-track{background:var(--bg-tertiary)}.panel-body[data-v-e34eebd4]::-webkit-scrollbar-thumb{background:var(--border-color);border-radius:3px}.panel-body[data-v-e34eebd4]::-webkit-scrollbar-thumb:hover{background:var(--border-hover)}.state-container[data-v-e34eebd4]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 40px;gap:var(--spacing-md)}.state-icon[data-v-e34eebd4]{font-size:48px;opacity:.4}.state-text[data-v-e34eebd4]{font-size:var(--font-md);color:var(--text-secondary)}.state-hint[data-v-e34eebd4]{margin:0;font-size:var(--font-sm);color:var(--text-muted)}.loading-spinner[data-v-e34eebd4]{animation:spin-e34eebd4 1s linear infinite}@keyframes spin-e34eebd4{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}.error-icon[data-v-e34eebd4]{color:var(--error-color)}.error-state .state-text[data-v-e34eebd4]{color:var(--error-color)}.text-list[data-v-e34eebd4]{padding:var(--spacing-sm)}.text-item[data-v-e34eebd4]{margin-bottom:var(--spacing-sm);background:var(--bg-color);border:1px solid var(--border-color);border-radius:var(--radius-sm);overflow:hidden;transition:all var(--transition-fast)}.text-item[data-v-e34eebd4]:hover{border-color:var(--border-hover)}.text-item.is-expanded[data-v-e34eebd4]{border-color:var(--primary-color);box-shadow:0 2px 8px rgba(59,130,246,.15)}.text-header[data-v-e34eebd4]{display:flex;align-items:center;justify-content:space-between;padding:var(--spacing-sm) var(--spacing-md);cursor:pointer;transition:background var(--transition-fast)}.text-header[data-v-e34eebd4]:hover{background:var(--bg-hover)}.text-meta[data-v-e34eebd4]{display:flex;align-items:center;gap:var(--spacing-sm);flex:1;min-width:0}.text-number[data-v-e34eebd4]{font-size:var(--font-xs);font-weight:600;color:var(--primary-color);padding:2px 6px;background:var(--primary-light);border-radius:var(--radius-xs);flex-shrink:0}.text-preview[data-v-e34eebd4]{font-size:var(--font-sm);color:var(--text-secondary);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.expand-icon[data-v-e34eebd4]{font-size:10px;color:var(--text-muted);flex-shrink:0}.text-content[data-v-e34eebd4]{padding:var(--spacing-md);border-top:1px solid var(--border-color);background:var(--bg-tertiary)}.content-body[data-v-e34eebd4]{font-size:var(--font-sm);line-height:1.8;color:var(--text-color);white-space:pre-wrap;word-break:break-word}.content-actions[data-v-e34eebd4]{display:flex;justify-content:flex-end;margin-top:var(--spacing-md);padding-top:var(--spacing-sm);border-top:1px solid var(--border-light)}.btn-action[data-v-e34eebd4]{padding:4px 10px;font-size:var(--font-xs);background:var(--bg-color);border:1px solid var(--border-color);border-radius:var(--radius-xs);color:var(--text-secondary);cursor:pointer;transition:all var(--transition-fast)}.btn-action[data-v-e34eebd4]:hover{background:var(--bg-hover);border-color:var(--border-hover);color:var(--text-color)}.panel-footer[data-v-e34eebd4]{display:flex;align-items:center;justify-content:space-between;padding:var(--spacing-sm) var(--spacing-md);background:var(--bg-tertiary);border-top:1px solid var(--border-color);flex-shrink:0}.footer-info .info-text[data-v-e34eebd4]{font-size:var(--font-xs);color:var(--text-muted)}.footer-actions[data-v-e34eebd4]{display:flex;gap:var(--spacing-xs)}.btn[data-v-e34eebd4]{padding:6px 12px;border:none;border-radius:var(--radius-sm);font-size:var(--font-xs);font-weight:500;cursor:pointer;transition:all var(--transition-fast)}.btn[data-v-e34eebd4]:disabled{opacity:.5;cursor:not-allowed}.btn-secondary[data-v-e34eebd4]{background:var(--bg-color);color:var(--text-secondary);border:1px solid var(--border-color)}.btn-secondary[data-v-e34eebd4]:hover:not(:disabled){background:var(--bg-hover);border-color:var(--border-hover);color:var(--text-color)}@media (max-width:768px){.history-text-panel[data-v-e34eebd4]{border-radius:var(--radius-sm)}.panel-header[data-v-e34eebd4]{padding:10px 12px}.header-left[data-v-e34eebd4]{gap:6px}.panel-icon[data-v-e34eebd4]{font-size:16px}.panel-title[data-v-e34eebd4]{font-size:14px}.text-count[data-v-e34eebd4]{padding:2px 8px;font-size:10px}.btn-refresh[data-v-e34eebd4],.btn-close[data-v-e34eebd4]{width:26px;height:26px;font-size:12px}.search-bar[data-v-e34eebd4]{padding:var(--spacing-xs) var(--spacing-sm)}.search-input[data-v-e34eebd4]{padding:6px 10px;font-size:12px}.search-result-count[data-v-e34eebd4]{font-size:10px}.text-list[data-v-e34eebd4]{padding:var(--spacing-xs)}.text-item[data-v-e34eebd4]{margin-bottom:var(--spacing-xs)}.text-header[data-v-e34eebd4]{padding:var(--spacing-xs) var(--spacing-sm)}.text-number[data-v-e34eebd4]{font-size:10px;padding:1px 4px}.text-preview[data-v-e34eebd4]{font-size:11px}.text-content[data-v-e34eebd4]{padding:var(--spacing-sm)}.content-body[data-v-e34eebd4]{font-size:12px;line-height:1.6}.panel-footer[data-v-e34eebd4]{flex-direction:column;gap:var(--spacing-xs);padding:var(--spacing-xs) var(--spacing-sm)}.footer-actions[data-v-e34eebd4]{width:100%;justify-content:center}.btn[data-v-e34eebd4]{padding:5px 10px;font-size:11px}.state-container[data-v-e34eebd4]{padding:40px 20px}.state-icon[data-v-e34eebd4]{font-size:36px}.state-text[data-v-e34eebd4]{font-size:13px}}@media (max-width:480px){.panel-header[data-v-e34eebd4]{padding:8px 10px}.header-left[data-v-e34eebd4]{gap:4px}.panel-icon[data-v-e34eebd4]{font-size:14px}.panel-title[data-v-e34eebd4]{font-size:13px}.text-count[data-v-e34eebd4]{display:none}.header-actions[data-v-e34eebd4]{gap:4px}.btn-refresh[data-v-e34eebd4],.btn-close[data-v-e34eebd4]{width:24px;height:24px;font-size:11px}.search-bar[data-v-e34eebd4]{padding:4px 8px}.search-input[data-v-e34eebd4]{padding:5px 8px;font-size:11px}.text-list[data-v-e34eebd4]{padding:4px}.text-header[data-v-e34eebd4]{padding:6px 8px}.text-meta[data-v-e34eebd4]{gap:4px}.text-number[data-v-e34eebd4]{font-size:9px}.text-preview[data-v-e34eebd4]{font-size:10px}.expand-icon[data-v-e34eebd4]{font-size:8px}.text-content[data-v-e34eebd4]{padding:8px}.content-body[data-v-e34eebd4]{font-size:11px;line-height:1.5}.content-actions[data-v-e34eebd4]{margin-top:8px;padding-top:6px}.btn-action[data-v-e34eebd4]{padding:3px 8px;font-size:10px}.panel-footer[data-v-e34eebd4]{padding:6px 8px}.footer-info .info-text[data-v-e34eebd4]{font-size:10px}.footer-actions .btn[data-v-e34eebd4]{padding:4px 8px;font-size:10px}.state-container[data-v-e34eebd4]{padding:30px 15px}.state-icon[data-v-e34eebd4]{font-size:32px}.state-text[data-v-e34eebd4]{font-size:12px}.state-hint[data-v-e34eebd4]{font-size:11px}}
.changelog-panel[data-v-6b6680e9]{display:flex;flex-direction:column;height:100%;background:var(--bg-secondary);overflow:hidden}.panel-header[data-v-6b6680e9]{display:flex;align-items:center;justify-content:space-between;padding:var(--spacing-md) var(--spacing-lg);background:var(--bg-tertiary);border-bottom:1px solid var(--border-color);flex-shrink:0}.header-left[data-v-6b6680e9]{display:flex;align-items:center;gap:var(--spacing-sm)}.header-icon[data-v-6b6680e9]{font-size:20px}.header-title[data-v-6b6680e9]{margin:0;font-size:var(--font-lg);font-weight:600;color:var(--text-color)}.header-right[data-v-6b6680e9]{display:flex;align-items:center;gap:var(--spacing-xs)}.btn-refresh[data-v-6b6680e9],.btn-close[data-v-6b6680e9]{display:flex;align-items:center;justify-content:center;width:32px;height:32px;background:rgba(0,0,0,0);border:1px solid var(--border-color);border-radius:var(--radius-sm);cursor:pointer;transition:all var(--transition-fast);font-size:16px;color:var(--text-secondary)}.btn-refresh[data-v-6b6680e9]:hover:not(:disabled),.btn-close[data-v-6b6680e9]:hover:not(:disabled){background:var(--bg-hover);color:var(--text-color);border-color:var(--border-hover)}.btn-refresh[data-v-6b6680e9]:disabled,.btn-close[data-v-6b6680e9]:disabled{opacity:.5;cursor:not-allowed}.refresh-icon[data-v-6b6680e9]{display:inline-block;transition:transform .3s ease}.refresh-icon.spinning[data-v-6b6680e9]{animation:spin-6b6680e9 1s linear infinite}@keyframes spin-6b6680e9{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}.panel-body[data-v-6b6680e9]{flex:1;overflow-y:auto;padding:var(--spacing-lg)}.loading-state[data-v-6b6680e9]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:200px;gap:var(--spacing-md);color:var(--text-secondary)}.loading-state .loading-spinner[data-v-6b6680e9]{width:40px;height:40px;border:3px solid var(--border-color);border-top-color:var(--primary-color);border-radius:50%;animation:spin-6b6680e9 .8s linear infinite}.loading-state p[data-v-6b6680e9]{margin:0;font-size:var(--font-sm)}.error-state[data-v-6b6680e9]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:200px;gap:var(--spacing-sm);text-align:center}.error-state .error-icon[data-v-6b6680e9]{font-size:40px}.error-state .error-message[data-v-6b6680e9]{margin:0;color:var(--error-color);font-size:var(--font-sm)}.error-state .btn-retry[data-v-6b6680e9]{padding:var(--spacing-xs) var(--spacing-md);background:var(--primary-color);color:#fff;border:none;border-radius:var(--radius-sm);cursor:pointer;font-size:var(--font-sm);transition:background var(--transition-fast)}.error-state .btn-retry[data-v-6b6680e9]:hover{background:var(--primary-hover)}.changelog-content[data-v-6b6680e9]{line-height:1.6;color:var(--text-color)}.changelog-content[data-v-6b6680e9] .md-h2{font-size:var(--font-xl);font-weight:700;color:var(--text-color);margin:0 0 var(--spacing-lg);padding-bottom:var(--spacing-sm);border-bottom:2px solid var(--primary-color)}.changelog-content[data-v-6b6680e9] .md-h3{font-size:var(--font-lg);font-weight:600;color:var(--text-color);margin:var(--spacing-lg) 0 var(--spacing-md);padding-left:var(--spacing-sm);border-left:3px solid var(--primary-color)}.changelog-content[data-v-6b6680e9] .md-h4{font-size:var(--font-md);font-weight:600;color:var(--text-secondary);margin:var(--spacing-md) 0 var(--spacing-sm)}.changelog-content[data-v-6b6680e9] .md-p{margin:var(--spacing-sm) 0;font-size:var(--font-sm)}.changelog-content[data-v-6b6680e9] .md-quote{margin:var(--spacing-md) 0;padding:var(--spacing-sm) var(--spacing-md);background:rgba(99,102,241,.1);border-left:3px solid var(--primary-color);border-radius:0 var(--radius-sm) var(--radius-sm) 0;font-size:var(--font-sm);color:var(--text-secondary)}.changelog-content[data-v-6b6680e9] .md-ul,.changelog-content[data-v-6b6680e9] .md-ol{margin:var(--spacing-sm) 0;padding-left:var(--spacing-lg)}.changelog-content[data-v-6b6680e9] .md-li,.changelog-content[data-v-6b6680e9] .md-li-ordered{margin:var(--spacing-xs) 0;font-size:var(--font-sm)}.changelog-content[data-v-6b6680e9] .md-hr{margin:var(--spacing-lg) 0;border:none;border-top:1px solid var(--border-color)}.changelog-content[data-v-6b6680e9] .code-block{margin:var(--spacing-md) 0;padding:var(--spacing-md);background:var(--bg-tertiary);border:1px solid var(--border-color);border-radius:var(--radius-sm);overflow-x:auto}.changelog-content[data-v-6b6680e9] .code-block code{font-family:"Consolas","Monaco",monospace;font-size:var(--font-xs);line-height:1.5;white-space:pre}.changelog-content[data-v-6b6680e9] .inline-code{padding:1px 4px;background:var(--bg-tertiary);border:1px solid var(--border-color);border-radius:3px;font-family:"Consolas","Monaco",monospace;font-size:.9em;color:var(--primary-color)}.changelog-content[data-v-6b6680e9] a{color:var(--primary-color);text-decoration:none}.changelog-content[data-v-6b6680e9] a:hover{text-decoration:underline}.changelog-content[data-v-6b6680e9] strong{font-weight:600;color:var(--text-color)}.changelog-content[data-v-6b6680e9] .version-highlight{padding:1px 6px;background:rgba(99,102,241,.15);color:var(--primary-color);border-radius:3px;font-weight:600;font-family:monospace}.changelog-content[data-v-6b6680e9] .emoji-success{color:var(--success-color)}.changelog-content[data-v-6b6680e9] .emoji-error{color:var(--error-color)}.changelog-content[data-v-6b6680e9] .emoji-warning{color:var(--warning-color)}.changelog-content[data-v-6b6680e9] .emoji-alert{color:var(--error-color)}.panel-footer[data-v-6b6680e9]{display:flex;align-items:center;justify-content:space-between;padding:var(--spacing-sm) var(--spacing-lg);background:var(--bg-tertiary);border-top:1px solid var(--border-color);flex-shrink:0}.footer-info .update-time[data-v-6b6680e9]{font-size:var(--font-xs);color:var(--text-muted)}.footer-actions[data-v-6b6680e9]{display:flex;gap:var(--spacing-sm)}.btn-clear-cache[data-v-6b6680e9]{display:flex;align-items:center;gap:var(--spacing-xs);padding:var(--spacing-xs) var(--spacing-sm);background:rgba(0,0,0,0);border:1px solid var(--border-color);border-radius:var(--radius-sm);font-size:var(--font-xs);color:var(--text-secondary);cursor:pointer;transition:all var(--transition-fast)}.btn-clear-cache[data-v-6b6680e9]:hover:not(:disabled){background:rgba(239,68,68,.1);color:var(--error-color);border-color:var(--error-color)}.btn-clear-cache[data-v-6b6680e9]:disabled{opacity:.5;cursor:not-allowed}.btn-clear-cache .cache-icon[data-v-6b6680e9]{font-size:14px}.btn-github[data-v-6b6680e9]{display:flex;align-items:center;gap:var(--spacing-xs);padding:var(--spacing-xs) var(--spacing-sm);background:rgba(0,0,0,0);border:1px solid var(--border-color);border-radius:var(--radius-sm);font-size:var(--font-xs);color:var(--text-secondary);text-decoration:none;transition:all var(--transition-fast)}.btn-github[data-v-6b6680e9]:hover{background:var(--bg-hover);color:var(--text-color);border-color:var(--border-hover)}.btn-github .github-icon[data-v-6b6680e9]{font-size:14px}.cache-status[data-v-6b6680e9]{color:var(--success-color);font-size:var(--font-xs);margin-left:var(--spacing-sm);animation:fadeIn-6b6680e9 .3s ease}@keyframes fadeIn-6b6680e9{from{opacity:0}to{opacity:1}}.cache-dialog-overlay[data-v-6b6680e9]{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:1000;animation:fadeIn-6b6680e9 .2s ease}.cache-dialog[data-v-6b6680e9]{background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-md);width:90%;max-width:400px;box-shadow:0 10px 40px rgba(0,0,0,.3);animation:slideUp-6b6680e9 .3s ease}@keyframes slideUp-6b6680e9{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.dialog-header[data-v-6b6680e9]{display:flex;align-items:center;gap:var(--spacing-sm);padding:var(--spacing-md) var(--spacing-lg);border-bottom:1px solid var(--border-color)}.dialog-header .dialog-icon[data-v-6b6680e9]{font-size:20px}.dialog-header h4[data-v-6b6680e9]{margin:0;font-size:var(--font-md);font-weight:600;color:var(--text-color)}.dialog-body[data-v-6b6680e9]{padding:var(--spacing-lg)}.dialog-body>p[data-v-6b6680e9]{margin:0 0 var(--spacing-md);font-size:var(--font-sm);color:var(--text-secondary)}.cache-options[data-v-6b6680e9]{display:flex;flex-direction:column;gap:var(--spacing-sm)}.cache-option[data-v-6b6680e9]{display:flex;align-items:flex-start;gap:var(--spacing-sm);padding:var(--spacing-sm) var(--spacing-md);background:var(--bg-tertiary);border:1px solid var(--border-color);border-radius:var(--radius-sm);cursor:pointer;transition:all var(--transition-fast)}.cache-option[data-v-6b6680e9]:hover{border-color:var(--primary-color)}.cache-option input[type=checkbox][data-v-6b6680e9]{margin-top:2px;cursor:pointer;accent-color:var(--primary-color)}.cache-option .option-text[data-v-6b6680e9]{display:flex;flex-direction:column;gap:2px}.cache-option .option-text strong[data-v-6b6680e9]{font-size:var(--font-sm);color:var(--text-color)}.cache-option .option-text small[data-v-6b6680e9]{font-size:var(--font-xs);color:var(--text-muted);line-height:1.4}.dialog-footer[data-v-6b6680e9]{display:flex;justify-content:flex-end;gap:var(--spacing-sm);padding:var(--spacing-md) var(--spacing-lg);border-top:1px solid var(--border-color)}.btn-cancel[data-v-6b6680e9]{padding:var(--spacing-xs) var(--spacing-md);background:rgba(0,0,0,0);border:1px solid var(--border-color);border-radius:var(--radius-sm);font-size:var(--font-sm);color:var(--text-secondary);cursor:pointer;transition:all var(--transition-fast)}.btn-cancel[data-v-6b6680e9]:hover{background:var(--bg-hover);color:var(--text-color)}.btn-confirm[data-v-6b6680e9]{padding:var(--spacing-xs) var(--spacing-md);background:var(--primary-color);border:none;border-radius:var(--radius-sm);font-size:var(--font-sm);color:#fff;cursor:pointer;transition:all var(--transition-fast)}.btn-confirm[data-v-6b6680e9]:hover:not(:disabled){background:var(--primary-hover)}.btn-confirm[data-v-6b6680e9]:disabled{opacity:.5;cursor:not-allowed}@media (max-width:768px){.panel-header[data-v-6b6680e9]{padding:var(--spacing-sm) var(--spacing-md)}.header-title[data-v-6b6680e9]{font-size:var(--font-md)}.panel-body[data-v-6b6680e9]{padding:var(--spacing-md)}.changelog-content[data-v-6b6680e9] .md-h2{font-size:var(--font-lg)}.changelog-content[data-v-6b6680e9] .md-h3{font-size:var(--font-md)}.changelog-content[data-v-6b6680e9] .code-block{padding:var(--spacing-sm)}.changelog-content[data-v-6b6680e9] .code-block code{font-size:11px}.panel-footer[data-v-6b6680e9]{padding:var(--spacing-xs) var(--spacing-md);flex-wrap:wrap;gap:var(--spacing-xs)}.footer-info[data-v-6b6680e9]{width:100%;margin-bottom:var(--spacing-xs)}.footer-actions[data-v-6b6680e9]{width:100%;justify-content:flex-end}.cache-dialog[data-v-6b6680e9]{width:95%;margin:var(--spacing-md)}.dialog-body[data-v-6b6680e9]{padding:var(--spacing-md)}.dialog-footer[data-v-6b6680e9]{padding:var(--spacing-sm) var(--spacing-md)}}
.tree-item[data-v-4d4216a6]{font-family:"SF Mono","Fira Code","Consolas",monospace;font-size:13px;line-height:1.4}.item-row[data-v-4d4216a6]{display:flex;align-items:center;gap:4px;padding:3px 8px;padding-right:16px;min-height:26px;cursor:default;border-radius:4px;transition:background .1s}.item-row[data-v-4d4216a6]:hover{background:var(--vm-bg-hover,var(--bg-hover,#f0f0f0))}.tree-item.is-match>.item-row[data-v-4d4216a6]{background:rgba(255,235,59,.15)}.toggle-btn[data-v-4d4216a6]{display:flex;align-items:center;justify-content:center;width:16px;height:16px;flex-shrink:0;cursor:pointer;color:var(--vm-text-muted,var(--text-disabled,#9a9996));transition:color .1s}.toggle-btn svg[data-v-4d4216a6]{width:12px;height:12px}.toggle-btn[data-v-4d4216a6]:hover{color:var(--vm-text-primary,var(--text-color,#2e3436))}.toggle-placeholder[data-v-4d4216a6]{width:16px;flex-shrink:0}.item-key[data-v-4d4216a6]{color:var(--vm-text-primary,var(--text-color,#2e3436));font-weight:500;flex-shrink:0}.item-key.is-meta[data-v-4d4216a6]{color:var(--vm-text-muted,var(--text-disabled,#9a9996));font-style:italic}.separator[data-v-4d4216a6]{color:var(--vm-text-muted,var(--text-disabled,#9a9996));margin:0 4px;flex-shrink:0}.item-value[data-v-4d4216a6]{flex:1;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.item-value.type-string[data-v-4d4216a6]{color:#b35000}.item-value.type-number[data-v-4d4216a6]{color:#2e7d32}.item-value.type-boolean[data-v-4d4216a6]{color:#0d47a1}.item-value.type-array[data-v-4d4216a6]{color:#7b1fa2;font-style:italic}.item-value.type-object[data-v-4d4216a6]{color:#6d5600;font-style:italic}.item-value.type-null[data-v-4d4216a6],.item-value.type-undefined[data-v-4d4216a6]{color:#616161;font-style:italic}:root.dark-theme .item-value.type-string[data-v-4d4216a6]{color:#e9a178}:root.dark-theme .item-value.type-number[data-v-4d4216a6]{color:#b8d7a3}:root.dark-theme .item-value.type-boolean[data-v-4d4216a6]{color:#7eb8da}:root.dark-theme .item-value.type-array[data-v-4d4216a6]{color:#c792ea}:root.dark-theme .item-value.type-object[data-v-4d4216a6]{color:#dcdcaa}:root.dark-theme .item-value.type-null[data-v-4d4216a6],:root.dark-theme .item-value.type-undefined[data-v-4d4216a6]{color:#9e9e9e}.children-hint[data-v-4d4216a6]{color:var(--vm-text-muted,var(--text-disabled,#9a9996));font-size:11px;margin-left:4px}.inline-editor[data-v-4d4216a6]{display:flex;align-items:center;gap:6px;flex:1}.edit-input[data-v-4d4216a6],.edit-select[data-v-4d4216a6]{flex:1;min-width:120px;max-width:400px;padding:2px 8px;background:var(--vm-bg-tertiary,var(--bg-tertiary,#deddda));border:1px solid var(--vm-accent-color,var(--primary-color,#1a5fb4));border-radius:4px;font-family:"SF Mono","Fira Code","Consolas",monospace;font-size:13px;color:var(--vm-text-primary,var(--text-color,#2e3436));outline:none}.edit-select[data-v-4d4216a6]{cursor:pointer}.edit-actions[data-v-4d4216a6]{display:flex;gap:4px}.btn-edit-save[data-v-4d4216a6],.btn-edit-cancel[data-v-4d4216a6]{width:24px;height:24px;display:flex;align-items:center;justify-content:center;border:none;border-radius:4px;font-size:12px;cursor:pointer;transition:all .1s}.btn-edit-save[data-v-4d4216a6]{background:var(--vm-success-color,var(--success-color,#26a269));color:#fff}.btn-edit-save[data-v-4d4216a6]:hover{filter:brightness(0.9)}.btn-edit-cancel[data-v-4d4216a6]{background:var(--vm-bg-tertiary,var(--bg-tertiary,#deddda));color:var(--vm-text-secondary,var(--text-secondary,#5e5c64))}.btn-edit-cancel[data-v-4d4216a6]:hover{background:var(--vm-bg-hover,var(--bg-hover,#f0f0f0));color:var(--vm-text-primary,var(--text-color,#2e3436))}.item-actions[data-v-4d4216a6]{display:flex;gap:2px;margin-left:auto;flex-shrink:0}.action-btn[data-v-4d4216a6]{display:flex;align-items:center;justify-content:center;width:22px;height:22px;background:rgba(0,0,0,0);border:none;border-radius:4px;color:var(--vm-text-muted,var(--text-disabled,#9a9996));cursor:pointer;transition:all .1s}.action-btn svg[data-v-4d4216a6]{width:13px;height:13px}.action-btn[data-v-4d4216a6]:hover{background:var(--vm-bg-hover,var(--bg-hover,#f0f0f0));color:var(--vm-text-primary,var(--text-color,#2e3436))}.action-btn.action-delete[data-v-4d4216a6]:hover{background:rgba(192,28,40,.15);color:var(--vm-danger-color,var(--danger-color,#c01c28))}.item-children[data-v-4d4216a6]{border-left:1px solid var(--vm-border-color,var(--border-color,#c0bfbc));margin-left:15px}
.variable-manager-panel[data-v-aaba435e]{--vm-bg-primary:var(--bg-color,#f6f5f4);--vm-bg-secondary:var(--bg-secondary,#ffffff);--vm-bg-tertiary:var(--bg-tertiary,#deddda);--vm-bg-hover:var(--bg-hover,#f0f0f0);--vm-border-color:var(--border-color,#c0bfbc);--vm-border-light:var(--border-light,#e5e5e5);--vm-text-primary:var(--text-color,#2e3436);--vm-text-secondary:var(--text-secondary,#5e5c64);--vm-text-muted:var(--text-disabled,#9a9996);--vm-accent-color:var(--primary-color,#1a5fb4);--vm-accent-hover:var(--primary-hover,#3584e4);--vm-success-color:var(--success-color,#26a269);--vm-danger-color:var(--danger-color,#c01c28);display:flex;flex-direction:column;height:100%;background:var(--vm-bg-primary);font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","PingFang SC","Hiragino Sans GB","Microsoft YaHei",sans-serif;font-size:14px;color:var(--vm-text-primary);overflow:hidden;-webkit-font-smoothing:antialiased}.panel-header[data-v-aaba435e]{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;background:var(--vm-bg-secondary);border-bottom:1px solid var(--vm-border-color);flex-shrink:0}.header-left[data-v-aaba435e]{display:flex;align-items:center;gap:10px}.header-title[data-v-aaba435e]{font-size:16px;font-weight:600;letter-spacing:.3px}.status-dot[data-v-aaba435e]{width:8px;height:8px;border-radius:50%;background:var(--vm-danger-color)}.status-dot.connected[data-v-aaba435e]{background:var(--vm-success-color)}.header-actions[data-v-aaba435e]{display:flex;align-items:center;gap:8px}.btn-text[data-v-aaba435e]{display:flex;align-items:center;gap:4px;padding:6px 12px;background:var(--vm-accent-color);border:none;border-radius:6px;color:#fff;font-size:13px;font-weight:500;cursor:pointer;transition:background .15s}.btn-text[data-v-aaba435e]:hover{background:var(--vm-accent-hover)}.btn-text .btn-icon[data-v-aaba435e]{font-size:16px;font-weight:600}.btn-icon-only[data-v-aaba435e]{display:flex;align-items:center;justify-content:center;width:32px;height:32px;background:rgba(0,0,0,0);border:1px solid var(--vm-border-color);border-radius:6px;color:var(--vm-text-secondary);cursor:pointer;transition:all .15s}.btn-icon-only svg[data-v-aaba435e]{width:18px;height:18px}.btn-icon-only[data-v-aaba435e]:hover{background:var(--vm-bg-hover);color:var(--vm-text-primary);border-color:var(--vm-border-light)}.btn-icon-only[data-v-aaba435e]:disabled{opacity:.5;cursor:not-allowed}.btn-icon-only.loading .icon-refresh[data-v-aaba435e]{animation:spin-aaba435e 1s linear infinite}.btn-icon-only.btn-close[data-v-aaba435e]:hover{background:rgba(192,28,40,.15);border-color:var(--vm-danger-color);color:var(--vm-danger-color)}@keyframes spin-aaba435e{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}.toolbar[data-v-aaba435e]{display:flex;align-items:center;gap:12px;padding:10px 16px;background:var(--vm-bg-secondary);border-bottom:1px solid var(--vm-border-color);flex-shrink:0}.search-box[data-v-aaba435e]{flex:1;display:flex;align-items:center;gap:8px;padding:8px 12px;background:var(--vm-bg-tertiary);border:1px solid var(--vm-border-color);border-radius:8px;transition:border-color .15s}.search-box[data-v-aaba435e]:focus-within{border-color:var(--vm-accent-color)}.search-box .search-icon[data-v-aaba435e]{width:16px;height:16px;color:var(--vm-text-muted);flex-shrink:0}.search-box .search-input[data-v-aaba435e]{flex:1;background:rgba(0,0,0,0);border:none;font-size:14px;color:var(--vm-text-primary);outline:none}.search-box .search-input[data-v-aaba435e]::placeholder{color:var(--vm-text-muted)}.search-box .btn-clear[data-v-aaba435e]{display:flex;align-items:center;justify-content:center;width:20px;height:20px;background:rgba(0,0,0,0);border:none;color:var(--vm-text-muted);cursor:pointer;padding:0}.search-box .btn-clear svg[data-v-aaba435e]{width:14px;height:14px}.search-box .btn-clear[data-v-aaba435e]:hover{color:var(--vm-text-primary)}.view-options[data-v-aaba435e]{display:flex;align-items:center}.option-toggle[data-v-aaba435e]{display:flex;align-items:center;gap:6px;font-size:12px;color:var(--vm-text-secondary);cursor:pointer}.option-toggle input[type=checkbox][data-v-aaba435e]{width:14px;height:14px;accent-color:var(--vm-accent-color)}.option-toggle[data-v-aaba435e]:hover{color:var(--vm-text-primary)}.main-content[data-v-aaba435e]{flex:1;overflow-y:auto;min-height:0}.main-content[data-v-aaba435e]::-webkit-scrollbar{width:8px}.main-content[data-v-aaba435e]::-webkit-scrollbar-thumb{background:var(--vm-border-color);border-radius:4px}.main-content[data-v-aaba435e]::-webkit-scrollbar-track{background:rgba(0,0,0,0)}.state-container[data-v-aaba435e]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;gap:16px}.state-icon[data-v-aaba435e]{width:64px;height:64px;color:var(--vm-text-muted)}.state-text[data-v-aaba435e]{font-size:15px;color:var(--vm-text-secondary)}.loading-spinner[data-v-aaba435e]{width:36px;height:36px;border:3px solid var(--vm-border-color);border-top-color:var(--vm-accent-color);border-radius:50%;animation:spin-aaba435e .8s linear infinite}.tree-view[data-v-aaba435e]{padding:8px 0}.tree-root[data-v-aaba435e]{font-family:"SF Mono","Fira Code","Consolas",monospace;font-size:13px;line-height:1.6}.status-bar[data-v-aaba435e]{display:flex;align-items:center;justify-content:space-between;padding:8px 16px;background:var(--vm-bg-secondary);border-top:1px solid var(--vm-border-color);flex-shrink:0}.stat-item[data-v-aaba435e]{font-size:12px;color:var(--vm-text-muted)}.modal-overlay[data-v-aaba435e]{position:fixed;inset:0;background:rgba(0,0,0,.6);display:flex;align-items:center;justify-content:center;z-index:1000;backdrop-filter:blur(2px)}.modal-dialog[data-v-aaba435e]{background:var(--vm-bg-primary);border:1px solid var(--vm-border-color);border-radius:12px;width:420px;max-width:calc(100% - 32px);box-shadow:var(--shadow-lg,0 20px 60px rgba(0,0,0,0.4))}.modal-header[data-v-aaba435e]{display:flex;align-items:center;justify-content:space-between;padding:16px 20px;border-bottom:1px solid var(--vm-border-color)}.modal-header h3[data-v-aaba435e]{margin:0;font-size:16px;font-weight:600}.btn-close-modal[data-v-aaba435e]{display:flex;align-items:center;justify-content:center;width:28px;height:28px;background:rgba(0,0,0,0);border:none;border-radius:6px;color:var(--vm-text-secondary);cursor:pointer}.btn-close-modal svg[data-v-aaba435e]{width:16px;height:16px}.btn-close-modal[data-v-aaba435e]:hover{background:var(--vm-bg-hover);color:var(--vm-text-primary)}.modal-body[data-v-aaba435e]{padding:20px}.modal-footer[data-v-aaba435e]{display:flex;justify-content:flex-end;gap:10px;padding:16px 20px;border-top:1px solid var(--vm-border-color)}.form-group[data-v-aaba435e]{margin-bottom:20px}.form-group[data-v-aaba435e]:last-child{margin-bottom:0}.form-label[data-v-aaba435e]{display:block;margin-bottom:8px;font-size:13px;font-weight:500;color:var(--vm-text-secondary)}.path-input-group[data-v-aaba435e]{display:flex;align-items:center;gap:4px}.path-input-group .path-prefix[data-v-aaba435e]{font-family:"SF Mono","Fira Code","Consolas",monospace;font-size:13px;color:var(--vm-text-muted);white-space:nowrap}.form-input[data-v-aaba435e]{flex:1;width:100%;padding:10px 12px;background:var(--vm-bg-tertiary);border:1px solid var(--vm-border-color);border-radius:8px;font-size:14px;color:var(--vm-text-primary);outline:none;transition:border-color .15s}.form-input[data-v-aaba435e]:focus{border-color:var(--vm-accent-color)}.form-input[data-v-aaba435e]::placeholder{color:var(--vm-text-muted)}.type-selector[data-v-aaba435e]{display:grid;grid-template-columns:repeat(3,1fr);gap:8px}.type-option[data-v-aaba435e]{display:flex;flex-direction:column;align-items:center;gap:4px;padding:12px 8px;background:var(--vm-bg-tertiary);border:1px solid var(--vm-border-color);border-radius:8px;cursor:pointer;transition:all .15s}.type-option .type-icon[data-v-aaba435e]{font-family:"SF Mono","Fira Code","Consolas",monospace;font-size:16px;font-weight:600}.type-option .type-name[data-v-aaba435e]{font-size:11px;color:var(--vm-text-secondary)}.type-option[data-v-aaba435e]:hover{background:var(--vm-bg-hover);border-color:var(--vm-border-light)}.type-option.active[data-v-aaba435e]{border-width:2px}.type-option.active.type-string[data-v-aaba435e]{border-color:#b35000}.type-option.active.type-string .type-icon[data-v-aaba435e]{color:#b35000}.type-option.active.type-number[data-v-aaba435e]{border-color:#2e7d32}.type-option.active.type-number .type-icon[data-v-aaba435e]{color:#2e7d32}.type-option.active.type-boolean[data-v-aaba435e]{border-color:#0d47a1}.type-option.active.type-boolean .type-icon[data-v-aaba435e]{color:#0d47a1}.type-option.active.type-object[data-v-aaba435e]{border-color:#6d5600}.type-option.active.type-object .type-icon[data-v-aaba435e]{color:#6d5600}.type-option.active.type-array[data-v-aaba435e]{border-color:#7b1fa2}.type-option.active.type-array .type-icon[data-v-aaba435e]{color:#7b1fa2}.type-option.active.type-null[data-v-aaba435e]{border-color:#616161}.type-option.active.type-null .type-icon[data-v-aaba435e]{color:#616161}.boolean-toggle[data-v-aaba435e]{display:flex;gap:10px}.bool-btn[data-v-aaba435e]{flex:1;padding:10px;background:var(--vm-bg-tertiary);border:1px solid var(--vm-border-color);border-radius:8px;font-size:14px;font-weight:500;color:var(--vm-text-secondary);cursor:pointer;transition:all .15s}.bool-btn[data-v-aaba435e]:hover{background:var(--vm-bg-hover);border-color:var(--vm-border-light)}.bool-btn.active[data-v-aaba435e]{background:rgba(13,71,161,.15);border-color:#0d47a1;color:#0d47a1}.btn-primary[data-v-aaba435e]{padding:10px 20px;background:var(--vm-accent-color);border:none;border-radius:8px;font-size:14px;font-weight:500;color:#fff;cursor:pointer;transition:background .15s}.btn-primary[data-v-aaba435e]:hover:not(:disabled){background:var(--vm-accent-hover)}.btn-primary[data-v-aaba435e]:disabled{opacity:.5;cursor:not-allowed}.btn-secondary[data-v-aaba435e]{padding:10px 20px;background:rgba(0,0,0,0);border:1px solid var(--vm-border-color);border-radius:8px;font-size:14px;font-weight:500;color:var(--vm-text-secondary);cursor:pointer;transition:all .15s}.btn-secondary[data-v-aaba435e]:hover{background:var(--vm-bg-hover);color:var(--vm-text-primary)}
.review-dialog-overlay[data-v-1d15335f]{position:fixed !important;top:0 !important;left:0 !important;right:0 !important;bottom:0 !important;background:rgba(0,0,0,.6);backdrop-filter:blur(4px);display:flex;align-items:center;justify-content:center;z-index:10020 !important;padding:var(--spacing-md,16px)}.review-dialog[data-v-1d15335f]{background:var(--bg-secondary,#ffffff);border-radius:var(--radius-lg,12px);box-shadow:0 20px 40px rgba(0,0,0,.2);max-width:700px;width:100%;max-height:85vh;display:flex;flex-direction:column;overflow-y:auto;overflow-x:hidden;animation:dialog-enter-1d15335f .25s ease-out}.review-dialog.has-errors[data-v-1d15335f]{border:2px solid var(--warning-color,#e5a50a)}.dialog-header[data-v-1d15335f]{display:flex;align-items:center;justify-content:space-between;padding:var(--spacing-lg,20px);background:var(--bg-tertiary,#f6f5f4);border-bottom:1px solid var(--border-color,#e0e0e0)}.header-left[data-v-1d15335f]{display:flex;align-items:center;gap:var(--spacing-sm,8px)}.header-icon[data-v-1d15335f]{font-size:24px}.header-title[data-v-1d15335f]{margin:0;font-size:var(--font-lg,18px);font-weight:600;color:var(--text-color,#2e3436)}.header-status[data-v-1d15335f]{display:flex;align-items:center}.status-badge[data-v-1d15335f]{padding:4px 12px;border-radius:16px;font-size:var(--font-sm,13px);font-weight:500}.status-badge.status-passed[data-v-1d15335f]{background:var(--success-light,rgba(38,162,105,0.15));color:var(--success-color,#26a269)}.status-badge.status-failed[data-v-1d15335f]{background:var(--warning-light,rgba(229,165,10,0.15));color:var(--warning-dark,#b58900)}.status-badge.status-pending[data-v-1d15335f]{background:var(--bg-hover,#e0e0e0);color:var(--text-secondary,#666)}.review-summary[data-v-1d15335f]{display:flex;flex-wrap:wrap;gap:var(--spacing-sm,8px);padding:var(--spacing-md,16px) var(--spacing-lg,20px);background:var(--bg-color,#fff);border-bottom:1px solid var(--border-light,#f0f0f0)}.summary-item[data-v-1d15335f]{display:flex;align-items:center;gap:6px;padding:6px 12px;background:var(--bg-tertiary,#f5f5f5);border-radius:var(--radius-sm,4px);font-size:var(--font-sm,13px)}.tag-icon[data-v-1d15335f]{font-size:12px;width:16px;height:16px;display:flex;align-items:center;justify-content:center;border-radius:50%}.tag-icon.tag-ok[data-v-1d15335f]{background:var(--success-color,#26a269);color:#fff}.tag-icon.tag-missing[data-v-1d15335f]{background:var(--text-disabled,#999);color:#fff}.tag-icon.tag-error[data-v-1d15335f]{background:var(--error-color,#c01c28);color:#fff}.tag-name[data-v-1d15335f]{font-weight:500;color:var(--text-color,#333)}.tag-status[data-v-1d15335f]{color:var(--text-secondary,#666)}.issues-section[data-v-1d15335f]{padding:var(--spacing-md,16px) var(--spacing-lg,20px);background:var(--warning-light,rgba(229,165,10,0.08));border-bottom:1px solid var(--border-light,#f0f0f0)}.section-title[data-v-1d15335f]{display:flex;align-items:center;gap:var(--spacing-sm,8px);font-size:var(--font-md,14px);font-weight:600;color:var(--text-color,#333);margin-bottom:var(--spacing-sm,8px)}.section-icon[data-v-1d15335f]{font-size:16px}.issues-list[data-v-1d15335f]{display:flex;flex-direction:column;gap:6px}.issue-item[data-v-1d15335f]{display:flex;align-items:flex-start;gap:8px;padding:8px 12px;border-radius:var(--radius-sm,4px);font-size:var(--font-sm,13px)}.issue-item.issue-error[data-v-1d15335f]{background:var(--error-light,rgba(192,28,40,0.1));color:var(--error-color,#c01c28)}.issue-item.issue-warning[data-v-1d15335f]{background:var(--warning-light,rgba(229,165,10,0.1));color:var(--warning-dark,#b58900)}.issue-item.issue-info[data-v-1d15335f]{background:var(--info-light,rgba(28,113,216,0.1));color:var(--info-color,#1c71d8)}.issue-icon[data-v-1d15335f]{flex-shrink:0}.issue-message[data-v-1d15335f]{line-height:1.4}.variables-section[data-v-1d15335f]{padding:var(--spacing-md,16px) var(--spacing-lg,20px);background:var(--bg-color,#fff);border-bottom:1px solid var(--border-light,#f0f0f0)}.variables-list[data-v-1d15335f]{display:flex;flex-direction:column;gap:4px;max-height:150px;overflow-y:auto}.variable-item[data-v-1d15335f]{display:flex;align-items:center;gap:8px;padding:6px 10px;background:var(--bg-tertiary,#f5f5f5);border-radius:var(--radius-sm,4px);font-family:monospace;font-size:var(--font-xs,12px)}.var-path[data-v-1d15335f]{color:var(--primary-color,#6366f1);font-weight:500}.var-op[data-v-1d15335f]{color:var(--text-secondary,#666)}.var-value[data-v-1d15335f]{color:var(--success-color,#26a269)}.more-hint[data-v-1d15335f]{text-align:center;padding:8px;color:var(--text-secondary,#666);font-size:var(--font-xs,12px)}.content-section[data-v-1d15335f]{flex:1;display:flex;flex-direction:column;min-height:200px;overflow:hidden}.section-header[data-v-1d15335f]{display:flex;align-items:center;justify-content:space-between;padding:var(--spacing-md,16px) var(--spacing-lg,20px);background:var(--bg-tertiary,#f6f5f4);border-bottom:1px solid var(--border-light,#f0f0f0)}.section-actions[data-v-1d15335f]{display:flex;gap:var(--spacing-sm,8px)}.btn-toggle[data-v-1d15335f]{padding:4px 10px;font-size:var(--font-xs,12px);background:var(--bg-color,#fff);border:1px solid var(--border-color,#ccc);border-radius:var(--radius-sm,4px);cursor:pointer;transition:all .15s}.btn-toggle[data-v-1d15335f]:hover{background:var(--bg-hover,#f0f0f0)}.content-preview[data-v-1d15335f]{flex:1;overflow-y:auto;padding:var(--spacing-md,16px) var(--spacing-lg,20px);background:var(--bg-color,#fff)}.raw-content[data-v-1d15335f]{margin:0;white-space:pre-wrap;word-break:break-word;font-family:monospace;font-size:var(--font-sm,13px);line-height:1.6;color:var(--text-color,#333)}.parsed-content[data-v-1d15335f]{font-size:var(--font-md,15px);line-height:1.8;color:var(--text-color,#333)}.parsed-content[data-v-1d15335f] .empty-hint{color:var(--text-disabled,#999);text-align:center;padding:var(--spacing-lg,20px)}.dialog-footer[data-v-1d15335f]{display:flex;justify-content:space-between;gap:var(--spacing-md,16px);padding:var(--spacing-lg,20px);background:var(--bg-tertiary,#f6f5f4);border-top:1px solid var(--border-color,#e0e0e0)}.btn[data-v-1d15335f]{display:inline-flex;align-items:center;justify-content:center;gap:8px;padding:10px 24px;font-size:var(--font-md,14px);font-weight:500;border-radius:var(--radius-md,6px);border:none;cursor:pointer;transition:all .15s}.btn[data-v-1d15335f]:disabled{opacity:.6;cursor:not-allowed}.btn-icon[data-v-1d15335f]{font-size:16px}.btn-rollback[data-v-1d15335f]{background:var(--bg-color,#fff);color:var(--error-color,#c01c28);border:1px solid var(--error-color,#c01c28)}.btn-rollback[data-v-1d15335f]:hover:not(:disabled){background:var(--error-light,rgba(192,28,40,0.1))}.btn-confirm[data-v-1d15335f]{background:var(--success-color,#26a269);color:#fff;flex:1;max-width:200px}.btn-confirm[data-v-1d15335f]:hover:not(:disabled){filter:brightness(1.1)}.btn-confirm.btn-warning[data-v-1d15335f]{background:var(--warning-color,#e5a50a);color:var(--text-highlight,#000)}.loading-spinner[data-v-1d15335f]{width:16px;height:16px;border:2px solid hsla(0,0%,100%,.3);border-top-color:#fff;border-radius:50%;animation:spin-1d15335f .8s linear infinite}@keyframes spin-1d15335f{to{transform:rotate(360deg)}}@keyframes dialog-enter-1d15335f{from{opacity:0;transform:scale(0.95) translateY(-20px)}to{opacity:1;transform:scale(1) translateY(0)}}.review-dialog-enter-active[data-v-1d15335f],.review-dialog-leave-active[data-v-1d15335f]{transition:opacity .2s ease}.review-dialog-enter-from[data-v-1d15335f],.review-dialog-leave-to[data-v-1d15335f]{opacity:0}.review-dialog-enter-active .review-dialog[data-v-1d15335f]{animation:dialog-enter-1d15335f .25s ease-out}.review-dialog-leave-active .review-dialog[data-v-1d15335f]{animation:dialog-enter-1d15335f .2s ease-in reverse}@media (max-width:600px){.review-dialog-overlay[data-v-1d15335f]{padding:var(--spacing-xs,8px);align-items:flex-start}.review-dialog[data-v-1d15335f]{max-height:calc(100vh - 16px);max-width:calc(100vw - 16px);margin:0}.dialog-header[data-v-1d15335f]{flex-direction:column;gap:var(--spacing-sm,8px);align-items:flex-start;position:sticky;top:0;z-index:10}.dialog-footer[data-v-1d15335f]{flex-direction:column-reverse;position:sticky;bottom:0;z-index:10}.btn[data-v-1d15335f]{width:100%;max-width:none}.review-summary[data-v-1d15335f]{flex-direction:column}.content-section[data-v-1d15335f]{min-height:150px}.content-preview[data-v-1d15335f]{max-height:200px}}@media (max-height:600px){.review-dialog-overlay[data-v-1d15335f]{padding:var(--spacing-xs,8px);align-items:flex-start}.review-dialog[data-v-1d15335f]{max-height:calc(100vh - 16px)}.dialog-header[data-v-1d15335f]{padding:var(--spacing-sm,12px) var(--spacing-md,16px);position:sticky;top:0;z-index:10}.dialog-footer[data-v-1d15335f]{padding:var(--spacing-sm,12px) var(--spacing-md,16px);position:sticky;bottom:0;z-index:10}.content-section[data-v-1d15335f]{min-height:100px}.content-preview[data-v-1d15335f]{max-height:150px}.variables-list[data-v-1d15335f]{max-height:100px}}@media (max-height:400px){.review-dialog[data-v-1d15335f]{max-height:calc(100vh - 8px)}.dialog-header[data-v-1d15335f],.dialog-footer[data-v-1d15335f]{padding:var(--spacing-xs,8px) var(--spacing-sm,12px)}.header-icon[data-v-1d15335f]{font-size:18px}.header-title[data-v-1d15335f]{font-size:var(--font-md,14px)}.btn[data-v-1d15335f]{padding:8px 16px;font-size:var(--font-sm,13px)}.review-summary[data-v-1d15335f]{padding:var(--spacing-xs,8px) var(--spacing-sm,12px)}.issues-section[data-v-1d15335f],.variables-section[data-v-1d15335f]{padding:var(--spacing-xs,8px) var(--spacing-sm,12px)}.content-preview[data-v-1d15335f]{max-height:100px;padding:var(--spacing-xs,8px) var(--spacing-sm,12px)}}:root.dark-theme .review-dialog[data-v-1d15335f]{background:var(--bg-secondary,#2d2d2d);box-shadow:0 20px 40px rgba(0,0,0,.5)}:root.dark-theme .dialog-header[data-v-1d15335f],:root.dark-theme .section-header[data-v-1d15335f],:root.dark-theme .dialog-footer[data-v-1d15335f]{background:var(--bg-tertiary,#3d3d3d);border-color:var(--border-color,#4d4d4d)}:root.dark-theme .header-title[data-v-1d15335f],:root.dark-theme .section-title[data-v-1d15335f]{color:var(--text-color,#f5f5f5)}:root.dark-theme .content-preview[data-v-1d15335f]{background:var(--bg-color,#1e1e1e)}:root.dark-theme .raw-content[data-v-1d15335f],:root.dark-theme .parsed-content[data-v-1d15335f]{color:var(--text-color,#e0e0e0)}:root.dark-theme .btn-toggle[data-v-1d15335f]{background:var(--bg-color,#1e1e1e);border-color:var(--border-color,#4d4d4d);color:var(--text-color,#e0e0e0)}:root.dark-theme .btn-toggle[data-v-1d15335f]:hover{background:var(--bg-hover,#3d3d3d)}:root.dark-theme .btn-rollback[data-v-1d15335f]{background:rgba(0,0,0,0)}
.auto-save-settings[data-v-85be2ade]{padding:var(--spacing-sm)}.settings-title[data-v-85be2ade]{margin:0 0 var(--spacing-md) 0;font-size:var(--font-md);font-weight:600;color:var(--text-color);border-bottom:1px solid var(--border-light);padding-bottom:var(--spacing-sm)}.setting-item[data-v-85be2ade]{display:flex;justify-content:space-between;align-items:center;padding:var(--spacing-md);background:var(--bg-secondary);border:1px solid var(--border-light);border-radius:var(--radius-md);margin-bottom:var(--spacing-sm);transition:all var(--transition-fast)}.setting-item[data-v-85be2ade]:hover:not(.disabled){border-color:var(--border-hover)}.setting-item.disabled[data-v-85be2ade]{opacity:.5;background:var(--bg-tertiary)}.setting-info[data-v-85be2ade]{flex:1;margin-right:var(--spacing-md)}.setting-label[data-v-85be2ade]{font-size:var(--font-sm);font-weight:500;color:var(--text-color);margin-bottom:var(--spacing-xs)}.setting-desc[data-v-85be2ade]{font-size:var(--font-xs);color:var(--text-secondary);line-height:1.5}.setting-control[data-v-85be2ade]{display:flex;align-items:center;gap:var(--spacing-sm)}.number-input[data-v-85be2ade],.text-input[data-v-85be2ade]{padding:var(--spacing-sm) var(--spacing-md);background:var(--bg-color);border:1px solid var(--border-color);border-radius:var(--radius-sm);color:var(--text-color);font-size:var(--font-sm);transition:all var(--transition-fast)}.number-input[data-v-85be2ade]:focus,.text-input[data-v-85be2ade]:focus{outline:none;border-color:var(--primary-color);box-shadow:0 0 0 2px var(--primary-light)}.number-input[data-v-85be2ade]:disabled,.text-input[data-v-85be2ade]:disabled{opacity:.5;cursor:not-allowed;background:var(--bg-tertiary)}.number-input[data-v-85be2ade]{width:80px;text-align:center}.text-input[data-v-85be2ade]{width:120px}.unit[data-v-85be2ade]{font-size:var(--font-xs);color:var(--text-secondary)}.toggle-switch[data-v-85be2ade]{position:relative;display:inline-block;width:48px;height:26px}.toggle-switch input[data-v-85be2ade]{opacity:0;width:0;height:0}.toggle-switch input:checked+.toggle-slider[data-v-85be2ade]{background:var(--primary-color)}.toggle-switch input:checked+.toggle-slider[data-v-85be2ade]::before{transform:translateX(22px)}.toggle-switch input:disabled+.toggle-slider[data-v-85be2ade]{opacity:.5;cursor:not-allowed}.toggle-slider[data-v-85be2ade]{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background:var(--bg-tertiary);border-radius:26px;transition:all var(--transition-normal);border:1px solid var(--border-color)}.toggle-slider[data-v-85be2ade]::before{position:absolute;content:"";height:20px;width:20px;left:2px;bottom:2px;background:#fff;border-radius:50%;transition:all var(--transition-normal);box-shadow:var(--shadow-sm)}.setting-actions[data-v-85be2ade]{display:flex;justify-content:flex-end;margin-top:var(--spacing-md);padding-top:var(--spacing-md);border-top:1px solid var(--border-light)}.status-section[data-v-85be2ade]{margin-top:var(--spacing-lg);padding:var(--spacing-md);background:var(--bg-secondary);border:1px solid var(--border-light);border-radius:var(--radius-md)}.status-title[data-v-85be2ade]{margin:0 0 var(--spacing-sm) 0;font-size:var(--font-sm);font-weight:600;color:var(--text-color)}.status-items[data-v-85be2ade]{display:flex;flex-direction:column;gap:var(--spacing-xs)}.status-item[data-v-85be2ade]{display:flex;align-items:center;gap:var(--spacing-sm);font-size:var(--font-sm)}.status-label[data-v-85be2ade]{color:var(--text-secondary)}.status-value[data-v-85be2ade]{color:var(--text-color);font-weight:500}.status-value.active[data-v-85be2ade]{color:var(--success-color)}.info-section[data-v-85be2ade]{margin-top:var(--spacing-md);padding:var(--spacing-md);background:var(--info-light);border:1px solid var(--info-color);border-radius:var(--radius-md)}.info-title[data-v-85be2ade]{margin:0 0 var(--spacing-sm) 0;font-size:var(--font-sm);font-weight:600;color:var(--info-color)}.info-list[data-v-85be2ade]{margin:0;padding-left:var(--spacing-lg);font-size:var(--font-xs);color:var(--text-secondary);line-height:1.8}.info-list li[data-v-85be2ade]{margin-bottom:var(--spacing-xs)}.btn[data-v-85be2ade]{display:inline-flex;align-items:center;justify-content:center;padding:var(--spacing-sm) var(--spacing-md);border:none;border-radius:var(--radius-sm);cursor:pointer;font-size:var(--font-sm);font-weight:500;transition:all var(--transition-fast)}.btn.btn-secondary[data-v-85be2ade]{background:var(--bg-secondary);color:var(--text-color);border:1px solid var(--border-color)}.btn.btn-secondary[data-v-85be2ade]:hover{background:var(--bg-hover);border-color:var(--border-hover)}@media (max-width:768px){.setting-item[data-v-85be2ade]{flex-direction:column;align-items:flex-start;gap:var(--spacing-sm)}.setting-info[data-v-85be2ade]{margin-right:0}.setting-control[data-v-85be2ade]{width:100%;justify-content:flex-end}}
.save-manager[data-v-7aa5842e]{display:flex;flex-direction:column;height:100%;background:var(--bg-secondary);color:var(--text-color);border-radius:var(--radius-lg);overflow:hidden}.save-header[data-v-7aa5842e]{display:flex;justify-content:space-between;align-items:center;padding:var(--spacing-md);background:var(--bg-tertiary);border-bottom:1px solid var(--border-color)}.save-title[data-v-7aa5842e]{margin:0;font-size:var(--font-lg);font-weight:600;display:flex;align-items:center;gap:var(--spacing-sm);color:var(--text-color)}.save-title .icon[data-v-7aa5842e]{font-size:var(--font-xl)}.header-actions[data-v-7aa5842e]{display:flex;gap:var(--spacing-xs)}.save-stats[data-v-7aa5842e]{display:flex;gap:var(--spacing-lg);padding:var(--spacing-sm) var(--spacing-md);background:var(--bg-color);border-bottom:1px solid var(--border-light)}.stat-item[data-v-7aa5842e]{display:flex;flex-direction:column;align-items:center;gap:2px}.stat-item .stat-label[data-v-7aa5842e]{font-size:var(--font-xs);color:var(--text-secondary)}.stat-item .stat-value[data-v-7aa5842e]{font-size:var(--font-lg);font-weight:600;color:var(--primary-color)}.tab-bar[data-v-7aa5842e]{display:flex;background:var(--bg-secondary);border-bottom:1px solid var(--border-color)}.tab-btn[data-v-7aa5842e]{flex:1;padding:var(--spacing-sm) var(--spacing-md);background:rgba(0,0,0,0);border:none;border-bottom:2px solid rgba(0,0,0,0);color:var(--text-secondary);font-size:var(--font-sm);cursor:pointer;transition:all var(--transition-fast)}.tab-btn[data-v-7aa5842e]:hover{background:var(--bg-hover);color:var(--text-color)}.tab-btn.active[data-v-7aa5842e]{color:var(--primary-color);border-bottom-color:var(--primary-color);background:var(--primary-light);font-weight:500}.save-content[data-v-7aa5842e]{flex:1;overflow-y:auto;padding:var(--spacing-md);background:var(--bg-color)}.save-list-container[data-v-7aa5842e]{display:flex;flex-direction:column;gap:var(--spacing-md)}.create-save-section[data-v-7aa5842e]{display:flex;gap:var(--spacing-sm)}.save-name-input[data-v-7aa5842e]{flex:1;padding:var(--spacing-sm) var(--spacing-md);background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-sm);color:var(--text-color);font-size:var(--font-sm);transition:border-color var(--transition-fast)}.save-name-input[data-v-7aa5842e]:focus{outline:none;border-color:var(--primary-color);box-shadow:0 0 0 2px var(--primary-light)}.save-name-input[data-v-7aa5842e]::placeholder{color:var(--text-disabled)}.auto-save-actions[data-v-7aa5842e]{display:flex;gap:var(--spacing-sm)}.save-list[data-v-7aa5842e]{display:flex;flex-direction:column;gap:var(--spacing-sm)}.save-item[data-v-7aa5842e]{display:flex;justify-content:space-between;align-items:center;padding:var(--spacing-md);background:var(--bg-secondary);border:1px solid var(--border-light);border-radius:var(--radius-md);transition:all var(--transition-fast)}.save-item[data-v-7aa5842e]:hover{border-color:var(--primary-color);box-shadow:var(--shadow-sm)}.save-item.active[data-v-7aa5842e]{border-color:var(--primary-color);background:var(--primary-light)}.save-item.auto-save[data-v-7aa5842e]{border-left:3px solid var(--warning-color)}.save-info[data-v-7aa5842e]{flex:1;min-width:0}.save-name[data-v-7aa5842e]{font-weight:500;font-size:var(--font-sm);margin-bottom:var(--spacing-xs);display:flex;align-items:center;gap:var(--spacing-sm);color:var(--text-color)}.auto-badge[data-v-7aa5842e]{font-size:10px;padding:2px 6px;background:var(--warning-color);color:var(--text-highlight);border-radius:var(--radius-xs);font-weight:500}.save-time[data-v-7aa5842e]{font-size:var(--font-xs);color:var(--text-secondary);display:flex;flex-wrap:wrap;gap:var(--spacing-sm)}.save-source[data-v-7aa5842e]{color:var(--primary-color)}.save-actions[data-v-7aa5842e]{display:flex;gap:var(--spacing-xs)}.empty-state[data-v-7aa5842e]{text-align:center;padding:var(--spacing-xxl) var(--spacing-lg);color:var(--text-secondary)}.empty-state p[data-v-7aa5842e]{margin:0}.empty-state .hint[data-v-7aa5842e]{font-size:var(--font-xs);margin-top:var(--spacing-sm);color:var(--text-disabled)}.save-footer[data-v-7aa5842e]{display:flex;justify-content:space-between;align-items:center;padding:var(--spacing-sm) var(--spacing-md);background:var(--bg-tertiary);border-top:1px solid var(--border-color)}.footer-left[data-v-7aa5842e],.footer-right[data-v-7aa5842e]{display:flex;gap:var(--spacing-sm)}.import-btn[data-v-7aa5842e]{cursor:pointer}.error-message[data-v-7aa5842e]{display:flex;justify-content:space-between;align-items:center;padding:var(--spacing-sm) var(--spacing-md);background:var(--error-light);color:var(--error-color);border-top:1px solid var(--error-color);font-size:var(--font-sm)}.btn-close[data-v-7aa5842e]{background:none;border:none;color:inherit;font-size:var(--font-lg);cursor:pointer;padding:var(--spacing-xs);border-radius:var(--radius-xs);transition:background var(--transition-fast)}.btn-close[data-v-7aa5842e]:hover{background:rgba(0,0,0,.1)}.btn[data-v-7aa5842e]{display:inline-flex;align-items:center;justify-content:center;padding:var(--spacing-sm) var(--spacing-md);border:none;border-radius:var(--radius-sm);cursor:pointer;font-size:var(--font-sm);font-weight:500;transition:all var(--transition-fast)}.btn[data-v-7aa5842e]:disabled{opacity:.5;cursor:not-allowed}.btn.btn-primary[data-v-7aa5842e]{background:var(--primary-color);color:#fff}.btn.btn-primary[data-v-7aa5842e]:hover:not(:disabled){background:var(--primary-hover)}.btn.btn-primary[data-v-7aa5842e]:active:not(:disabled){background:var(--primary-active)}.btn.btn-secondary[data-v-7aa5842e]{background:var(--bg-secondary);color:var(--text-color);border:1px solid var(--border-color)}.btn.btn-secondary[data-v-7aa5842e]:hover:not(:disabled){background:var(--bg-hover);border-color:var(--border-hover)}.btn.btn-danger[data-v-7aa5842e]{background:var(--error-color);color:#fff}.btn.btn-danger[data-v-7aa5842e]:hover:not(:disabled){background:var(--error-hover)}.btn.btn-sm[data-v-7aa5842e]{padding:var(--spacing-xs) var(--spacing-sm);font-size:var(--font-xs)}.btn.btn-icon[data-v-7aa5842e]{padding:var(--spacing-xs) var(--spacing-sm);background:rgba(0,0,0,0);color:var(--text-secondary)}.btn.btn-icon[data-v-7aa5842e]:hover:not(:disabled){background:var(--bg-hover);color:var(--text-color)}.spinning[data-v-7aa5842e]{display:inline-block;animation:spin-7aa5842e 1s linear infinite}@keyframes spin-7aa5842e{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}.confirm-overlay[data-v-7aa5842e]{position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);backdrop-filter:blur(2px);display:flex;justify-content:center;align-items:center;z-index:var(--z-modal)}.confirm-dialog[data-v-7aa5842e]{background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-lg);padding:var(--spacing-lg);min-width:300px;max-width:400px;box-shadow:var(--shadow-lg)}.confirm-title[data-v-7aa5842e]{font-size:var(--font-lg);font-weight:600;margin-bottom:var(--spacing-sm);color:var(--text-color)}.confirm-message[data-v-7aa5842e]{color:var(--text-secondary);margin-bottom:var(--spacing-lg);line-height:1.6;font-size:var(--font-sm)}.confirm-actions[data-v-7aa5842e]{display:flex;justify-content:flex-end;gap:var(--spacing-sm)}@media (max-width:768px){.save-stats[data-v-7aa5842e]{justify-content:space-around}.save-item[data-v-7aa5842e]{flex-direction:column;align-items:flex-start;gap:var(--spacing-sm)}.save-actions[data-v-7aa5842e]{width:100%;justify-content:flex-end}.save-footer[data-v-7aa5842e]{flex-direction:column;gap:var(--spacing-sm)}.footer-left[data-v-7aa5842e],.footer-right[data-v-7aa5842e]{width:100%;justify-content:center}}
.context-manager-panel[data-v-6b8678ab]{display:flex;flex-direction:column;height:100%;background:var(--bg-secondary);color:var(--text-color)}.panel-header[data-v-6b8678ab]{display:flex;align-items:center;justify-content:space-between;padding:var(--spacing-md) var(--spacing-lg);border-bottom:1px solid var(--border-color);flex-shrink:0}.panel-header h3[data-v-6b8678ab]{margin:0;font-size:var(--font-lg);display:flex;align-items:center;gap:var(--spacing-sm)}.btn-close[data-v-6b8678ab]{width:32px;height:32px;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0);border:none;color:var(--text-secondary);font-size:var(--font-lg);cursor:pointer;border-radius:var(--radius-sm);transition:all var(--transition-fast)}.btn-close[data-v-6b8678ab]:hover{background:var(--bg-hover);color:var(--text-color)}.panel-body[data-v-6b8678ab]{flex:1;overflow-y:auto;padding:var(--spacing-md);display:flex;flex-direction:column;gap:var(--spacing-md)}.section-title[data-v-6b8678ab]{font-size:var(--font-sm);font-weight:600;color:var(--text-color);margin-bottom:var(--spacing-sm);display:flex;align-items:center;gap:var(--spacing-xs)}.stats-section[data-v-6b8678ab]{background:var(--bg-color);border:1px solid var(--border-light);border-radius:var(--radius-sm);padding:var(--spacing-md)}.stats-grid[data-v-6b8678ab]{display:grid;grid-template-columns:repeat(2,1fr);gap:var(--spacing-sm)}.stat-item[data-v-6b8678ab]{display:flex;justify-content:space-between;align-items:center;padding:var(--spacing-xs) var(--spacing-sm);background:var(--bg-secondary);border-radius:var(--radius-xs)}.stat-item .stat-label[data-v-6b8678ab]{font-size:var(--font-xs);color:var(--text-secondary)}.stat-item .stat-value[data-v-6b8678ab]{font-size:var(--font-sm);font-weight:600;color:var(--primary-color)}.last-update[data-v-6b8678ab]{margin-top:var(--spacing-sm);font-size:10px;color:var(--text-muted);text-align:right}.enable-section[data-v-6b8678ab]{background:var(--bg-color);border:1px solid var(--border-light);border-radius:var(--radius-sm);padding:var(--spacing-md)}.enable-row[data-v-6b8678ab]{display:flex;justify-content:space-between;align-items:center;margin-top:var(--spacing-sm)}.enable-label[data-v-6b8678ab]{font-size:var(--font-sm);color:var(--text-color)}.toggle-switch[data-v-6b8678ab]{position:relative;display:inline-block;width:44px;height:22px}.toggle-switch input[data-v-6b8678ab]{opacity:0;width:0;height:0}.toggle-slider[data-v-6b8678ab]{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:var(--bg-tertiary,#555);transition:.3s;border-radius:22px}.toggle-slider[data-v-6b8678ab]:before{position:absolute;content:"";height:16px;width:16px;left:3px;bottom:3px;background-color:#fff;transition:.3s;border-radius:50%}input:checked+.toggle-slider[data-v-6b8678ab]{background-color:var(--success-color,#4ade80)}input:disabled+.toggle-slider[data-v-6b8678ab]{opacity:.5;cursor:not-allowed}input:checked+.toggle-slider[data-v-6b8678ab]:before{transform:translateX(22px)}.enable-status[data-v-6b8678ab]{margin-top:var(--spacing-sm);padding:var(--spacing-xs) var(--spacing-sm);border-radius:var(--radius-xs);font-size:var(--font-xs);text-align:center}.enable-status.enabled[data-v-6b8678ab]{background:rgba(74,222,128,.1);color:var(--success-color,#4ade80)}.enable-status.disabled[data-v-6b8678ab]{background:rgba(251,191,36,.1);color:var(--warning-color,#fbbf24)}.mode-section[data-v-6b8678ab]{background:var(--bg-color);border:1px solid var(--border-light);border-radius:var(--radius-sm);padding:var(--spacing-md)}.mode-selector[data-v-6b8678ab]{display:flex;gap:var(--spacing-sm)}.mode-option[data-v-6b8678ab]{flex:1;display:flex;align-items:center;justify-content:center;gap:var(--spacing-xs);padding:var(--spacing-sm);background:var(--bg-secondary);border:1px solid var(--border-light);border-radius:var(--radius-sm);cursor:pointer;transition:all var(--transition-fast);font-size:var(--font-sm)}.mode-option input[data-v-6b8678ab]{display:none}.mode-option[data-v-6b8678ab]:hover:not(.disabled){border-color:var(--primary-color)}.mode-option.active[data-v-6b8678ab]{background:var(--primary-light);border-color:var(--primary-color);color:var(--primary-color);font-weight:500}.mode-option.disabled[data-v-6b8678ab]{opacity:.5;cursor:not-allowed}.config-section[data-v-6b8678ab]{background:var(--bg-color);border:1px solid var(--border-light);border-radius:var(--radius-sm);padding:var(--spacing-md)}.config-item[data-v-6b8678ab]{margin-bottom:var(--spacing-md)}.config-item[data-v-6b8678ab]:last-child{margin-bottom:0}.config-item label[data-v-6b8678ab]{display:block;font-size:var(--font-sm);color:var(--text-color);margin-bottom:var(--spacing-xs)}.config-control[data-v-6b8678ab]{display:flex;gap:var(--spacing-xs)}.config-input[data-v-6b8678ab]{flex:1;padding:var(--spacing-xs) var(--spacing-sm);background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-sm);color:var(--text-color);font-size:var(--font-sm)}.config-input[data-v-6b8678ab]:focus{outline:none;border-color:var(--primary-color)}.btn-apply[data-v-6b8678ab]{padding:var(--spacing-xs) var(--spacing-md);background:var(--primary-color);color:#fff;border:none;border-radius:var(--radius-sm);font-size:var(--font-xs);cursor:pointer;transition:all var(--transition-fast)}.btn-apply[data-v-6b8678ab]:hover:not(:disabled){background:var(--primary-hover)}.btn-apply[data-v-6b8678ab]:disabled{opacity:.5;cursor:not-allowed}.config-hint[data-v-6b8678ab]{display:block;margin-top:4px;font-size:10px;color:var(--text-muted)}.actions-section[data-v-6b8678ab]{background:var(--bg-color);border:1px solid var(--border-light);border-radius:var(--radius-sm);padding:var(--spacing-md)}.action-buttons[data-v-6b8678ab]{display:flex;flex-direction:column;gap:var(--spacing-xs)}.btn[data-v-6b8678ab]{padding:var(--spacing-sm) var(--spacing-md);border:none;border-radius:var(--radius-sm);font-size:var(--font-sm);cursor:pointer;transition:all var(--transition-fast)}.btn[data-v-6b8678ab]:disabled{opacity:.5;cursor:not-allowed}.btn-primary[data-v-6b8678ab]{background:var(--primary-color);color:#fff}.btn-primary[data-v-6b8678ab]:hover:not(:disabled){background:var(--primary-hover)}.btn-secondary[data-v-6b8678ab]{background:var(--bg-secondary);color:var(--text-color);border:1px solid var(--border-color)}.btn-secondary[data-v-6b8678ab]:hover:not(:disabled){background:var(--bg-hover)}.btn-danger[data-v-6b8678ab]{background:var(--error-color);color:#fff}.btn-danger[data-v-6b8678ab]:hover:not(:disabled){opacity:.9}.btn-danger-outline[data-v-6b8678ab]{background:rgba(0,0,0,0);color:var(--error-color);border:1px solid var(--error-color)}.btn-danger-outline[data-v-6b8678ab]:hover:not(:disabled){background:rgba(244,67,54,.1)}.error-message[data-v-6b8678ab]{padding:var(--spacing-sm) var(--spacing-md);background:rgba(244,67,54,.1);border:1px solid var(--error-color);border-radius:var(--radius-sm);color:var(--error-color);font-size:var(--font-sm)}
.placeholder-panel[data-v-38c14460]{flex:1;display:flex;align-items:center;justify-content:center;background:var(--bg-color)}.placeholder-content[data-v-38c14460]{text-align:center;padding:var(--spacing-xl)}.placeholder-content .placeholder-icon[data-v-38c14460]{font-size:48px;margin-bottom:var(--spacing-md)}.placeholder-content h3[data-v-38c14460]{margin:0 0 var(--spacing-sm);color:var(--text-color);font-size:var(--font-lg)}.placeholder-content p[data-v-38c14460]{margin:0 0 var(--spacing-lg);color:var(--text-secondary);font-size:var(--font-sm)}.game-layout[data-v-38c14460]{display:flex;flex-direction:column;width:100%;height:100%;background:var(--bg-color);overflow:hidden}.game-layout.is-fullscreen[data-v-38c14460]{position:fixed;top:0;left:0;right:0;bottom:0;z-index:9999}.main-area[data-v-38c14460]{flex:1;display:flex;overflow:hidden;min-height:0}.modal-overlay[data-v-38c14460]{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:var(--z-modal);animation:fadeIn-38c14460 .2s ease}@keyframes fadeIn-38c14460{from{opacity:0}to{opacity:1}}.modal[data-v-38c14460]{background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-md);width:90%;max-width:480px;max-height:80vh;box-shadow:var(--shadow-lg);animation:slideUp-38c14460 .3s ease;display:flex;flex-direction:column}@keyframes slideUp-38c14460{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.modal-header[data-v-38c14460]{display:flex;align-items:center;justify-content:space-between;padding:var(--spacing-md) var(--spacing-lg);border-bottom:1px solid var(--border-color);flex-shrink:0}.modal-header h3[data-v-38c14460]{margin:0;font-size:var(--font-lg);color:var(--text-color);display:flex;align-items:center;gap:var(--spacing-sm)}.btn-close[data-v-38c14460]{width:32px;height:32px;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0);border:none;color:var(--text-secondary);font-size:var(--font-lg);cursor:pointer;border-radius:var(--radius-sm);transition:all var(--transition-fast)}.btn-close[data-v-38c14460]:hover{background:var(--bg-hover);color:var(--text-color)}.modal-body[data-v-38c14460]{padding:var(--spacing-lg);overflow-y:auto;flex:1}.modal-footer[data-v-38c14460]{display:flex;justify-content:flex-end;gap:var(--spacing-sm);padding:var(--spacing-md) var(--spacing-lg);border-top:1px solid var(--border-color);flex-shrink:0}.help-overlay[data-v-38c14460]{position:fixed !important;top:0 !important;left:0 !important;right:0 !important;bottom:0 !important;z-index:10004 !important}.help-overlay .help-modal[data-v-38c14460]{width:90%;max-width:480px;max-height:60vh;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-md);box-shadow:var(--shadow-lg)}.help-modal[data-v-38c14460]{max-width:480px}.help-steps[data-v-38c14460]{margin:0;padding-left:var(--spacing-lg);counter-reset:step-counter}.help-steps li[data-v-38c14460]{font-size:var(--font-sm);color:var(--text-color);line-height:1.8;margin-bottom:var(--spacing-sm);padding-left:var(--spacing-xs)}.help-steps li[data-v-38c14460]:last-child{margin-bottom:0}.help-steps li strong[data-v-38c14460]{color:var(--primary-color);font-weight:600}.help-section[data-v-38c14460]{margin-bottom:var(--spacing-lg)}.help-section[data-v-38c14460]:last-child{margin-bottom:0}.help-section h4[data-v-38c14460]{margin:0 0 var(--spacing-sm);font-size:var(--font-md);color:var(--text-color);display:flex;align-items:center;gap:var(--spacing-xs)}.help-section p[data-v-38c14460]{margin:0;font-size:var(--font-sm);color:var(--text-secondary);line-height:1.6}.help-section ul[data-v-38c14460]{margin:0;padding-left:var(--spacing-lg)}.help-section ul li[data-v-38c14460]{font-size:var(--font-sm);color:var(--text-secondary);line-height:1.8}.help-section ul li strong[data-v-38c14460]{color:var(--text-color)}.btn[data-v-38c14460]{padding:var(--spacing-sm) var(--spacing-lg);border:none;border-radius:var(--radius-sm);font-size:var(--font-sm);font-weight:500;cursor:pointer;transition:all var(--transition-fast)}.btn[data-v-38c14460]:disabled{opacity:.5;cursor:not-allowed}.btn-primary[data-v-38c14460]{background:var(--primary-color);color:#fff}.btn-primary[data-v-38c14460]:hover:not(:disabled){background:var(--primary-hover)}.btn-primary[data-v-38c14460]:active:not(:disabled){background:var(--primary-active)}.btn-secondary[data-v-38c14460]{background:var(--bg-color);color:var(--text-color);border:1px solid var(--border-color)}.btn-secondary[data-v-38c14460]:hover:not(:disabled){background:var(--bg-hover);border-color:var(--border-hover)}.fullscreen-modal[data-v-38c14460]{padding:var(--spacing-lg);z-index:10000 !important}.fullscreen-modal .ai-filter-modal[data-v-38c14460]{width:100%;max-width:1400px;height:90vh;max-height:none;display:flex;flex-direction:column}.context-manager-overlay[data-v-38c14460]{position:fixed !important;top:0 !important;left:0 !important;right:0 !important;bottom:0 !important;z-index:10001 !important}.context-manager-overlay .context-manager-modal[data-v-38c14460]{width:90%;max-width:520px;max-height:85vh;height:auto;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-md);box-shadow:var(--shadow-lg)}.context-manager-overlay .context-manager-modal .modal-body[data-v-38c14460]{padding:0}.save-manager-overlay[data-v-38c14460]{position:fixed !important;top:0 !important;left:0 !important;right:0 !important;bottom:0 !important;z-index:10002 !important}.save-manager-overlay .save-manager-modal[data-v-38c14460]{width:90%;max-width:600px;max-height:85vh;height:80vh;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-md);box-shadow:var(--shadow-lg);overflow:hidden}.history-text-overlay[data-v-38c14460]{position:fixed !important;top:0 !important;left:0 !important;right:0 !important;bottom:0 !important;z-index:10005 !important;padding:var(--spacing-md)}.history-text-overlay .history-text-modal[data-v-38c14460]{width:100%;max-width:700px;max-height:85vh;height:80vh;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-md);box-shadow:var(--shadow-lg);overflow:hidden}.roster-overlay[data-v-38c14460]{position:fixed !important;top:0 !important;left:0 !important;right:0 !important;bottom:0 !important;z-index:10006 !important;padding:var(--spacing-md)}.roster-overlay .roster-modal[data-v-38c14460]{width:100%;max-width:800px;max-height:85vh;height:80vh;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-md);box-shadow:var(--shadow-lg);overflow:hidden}.document-overlay[data-v-38c14460]{position:fixed !important;top:0 !important;left:0 !important;right:0 !important;bottom:0 !important;z-index:10007 !important;padding:var(--spacing-md)}.document-overlay .document-modal[data-v-38c14460]{width:100%;max-width:800px;max-height:85vh;height:80vh;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-md);box-shadow:var(--shadow-lg);overflow:hidden}.form-overlay[data-v-38c14460]{position:fixed !important;top:0 !important;left:0 !important;right:0 !important;bottom:0 !important;z-index:10008 !important;padding:var(--spacing-md)}.form-overlay .form-modal[data-v-38c14460]{width:100%;max-width:900px;max-height:90vh;height:85vh;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-md);box-shadow:var(--shadow-lg);overflow:hidden}.changelog-overlay[data-v-38c14460]{position:fixed !important;top:0 !important;left:0 !important;right:0 !important;bottom:0 !important;z-index:10008 !important;padding:var(--spacing-md)}.changelog-overlay .changelog-modal[data-v-38c14460]{width:100%;max-width:700px;max-height:85vh;height:80vh;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-md);box-shadow:var(--shadow-lg);overflow:hidden}.variable-manager-overlay[data-v-38c14460]{position:fixed !important;top:0 !important;left:0 !important;right:0 !important;bottom:0 !important;z-index:10009 !important;padding:var(--spacing-md)}.variable-manager-overlay .variable-manager-modal[data-v-38c14460]{width:100%;max-width:900px;max-height:90vh;height:85vh;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-md);box-shadow:var(--shadow-lg);overflow:hidden}.auto-save-indicator[data-v-38c14460]{position:fixed;bottom:80px;right:20px;display:flex;align-items:center;gap:8px;padding:10px 16px;background:var(--bg-secondary);border:1px solid var(--success-color,#4caf50);border-radius:var(--radius-md);box-shadow:var(--shadow-md);opacity:0;transform:translateY(20px);transition:all .3s ease;z-index:9998}.auto-save-indicator.visible[data-v-38c14460]{opacity:1;transform:translateY(0)}.auto-save-indicator .icon[data-v-38c14460]{font-size:16px}.auto-save-indicator .text[data-v-38c14460]{font-size:12px;color:var(--text-secondary);max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.sidebar-overlay[data-v-38c14460]{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.3);z-index:99;animation:fadeIn-38c14460 .2s ease}.mobile-menu-fab[data-v-38c14460]{position:fixed;right:12px;top:50%;transform:translateY(-50%);width:40px;height:40px;border-radius:var(--radius-sm);background:var(--primary-color);color:#fff;border:none;box-shadow:0 2px 8px rgba(99,102,241,.4);cursor:pointer;z-index:98;display:flex;align-items:center;justify-content:center;transition:all var(--transition-fast)}.mobile-menu-fab .fab-icon[data-v-38c14460]{font-size:18px;line-height:1}.mobile-menu-fab[data-v-38c14460]:hover{transform:translateY(-50%) scale(1.05);box-shadow:0 4px 12px rgba(99,102,241,.5)}.mobile-menu-fab[data-v-38c14460]:active{transform:translateY(-50%) scale(0.95)}@media (max-width:480px){.mobile-menu-fab[data-v-38c14460]{width:36px;height:36px;right:8px}.mobile-menu-fab .fab-icon[data-v-38c14460]{font-size:16px}}@media (max-width:768px){.main-area[data-v-38c14460]{position:relative}.modal[data-v-38c14460]{width:95%;max-height:90vh}.fullscreen-modal[data-v-38c14460]{padding:var(--spacing-sm)}.fullscreen-modal .ai-filter-modal[data-v-38c14460]{height:95vh}.save-manager-overlay .save-manager-modal[data-v-38c14460]{width:95%;height:90vh;max-height:90vh}.history-text-overlay[data-v-38c14460]{padding:var(--spacing-sm)}.history-text-overlay .history-text-modal[data-v-38c14460]{width:100%;height:85vh;max-height:90vh;border-radius:var(--radius-sm)}.auto-save-indicator[data-v-38c14460]{bottom:100px;right:10px;left:10px}.auto-save-indicator .text[data-v-38c14460]{max-width:none}.game-layout.sidebar-open .mobile-menu-fab[data-v-38c14460]{opacity:0;pointer-events:none}}@media (max-width:480px){.history-text-overlay[data-v-38c14460]{padding:var(--spacing-xs)}.history-text-overlay .history-text-modal[data-v-38c14460]{height:90vh;max-height:95vh;border-radius:var(--radius-xs)}.save-manager-overlay[data-v-38c14460]{padding:var(--spacing-xs)}.save-manager-overlay .save-manager-modal[data-v-38c14460]{width:100%;height:92vh;max-height:95vh}.context-manager-overlay[data-v-38c14460]{padding:var(--spacing-xs)}.context-manager-overlay .context-manager-modal[data-v-38c14460]{width:100%;max-height:90vh}.help-overlay[data-v-38c14460]{padding:var(--spacing-xs)}.help-overlay .help-modal[data-v-38c14460]{width:100%;max-height:80vh}}
.error-boundary[data-v-c0fce67a]{display:flex;align-items:center;justify-content:center;min-height:200px;padding:var(--spacing-lg)}.error-content[data-v-c0fce67a]{max-width:500px;text-align:center;padding:var(--spacing-xl);background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-md)}.error-icon[data-v-c0fce67a]{font-size:48px;margin-bottom:var(--spacing-md)}.error-title[data-v-c0fce67a]{margin:0 0 var(--spacing-sm);color:var(--text-color);font-size:var(--font-lg);font-weight:600}.error-message[data-v-c0fce67a]{margin:0 0 var(--spacing-lg);color:var(--text-secondary);font-size:var(--font-sm);line-height:1.5}.error-actions[data-v-c0fce67a]{display:flex;justify-content:center;gap:var(--spacing-sm);margin-bottom:var(--spacing-md)}.error-details[data-v-c0fce67a]{text-align:left;margin-top:var(--spacing-md)}.error-details summary[data-v-c0fce67a]{cursor:pointer;color:var(--text-secondary);font-size:var(--font-xs);padding:var(--spacing-sm)}.error-details summary[data-v-c0fce67a]:hover{color:var(--text-color)}.error-details pre[data-v-c0fce67a]{margin-top:var(--spacing-sm);padding:var(--spacing-md);background:var(--bg-tertiary);border-radius:var(--radius-sm);font-size:var(--font-xs);color:var(--text-secondary);overflow-x:auto;white-space:pre-wrap;word-break:break-all;max-height:200px;overflow-y:auto}
#app-container[data-v-caf9f040]{width:100%;height:100%;display:flex;flex-direction:column;overflow:hidden;background:var(--bg-color)}.loading-container[data-v-caf9f040]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;gap:var(--spacing-md);background:var(--bg-color)}.loading-spinner[data-v-caf9f040]{width:48px;height:48px;border:4px solid var(--border-color);border-top-color:var(--primary-color);border-radius:50%;animation:spin-caf9f040 .8s linear infinite}.loading-text[data-v-caf9f040]{color:var(--text-secondary);font-size:var(--font-md)}@keyframes spin-caf9f040{to{transform:rotate(360deg)}}
:root{--primary-color:#1a5fb4;--primary-hover:#3584e4;--primary-active:#154d93;--primary-light:rgba(26,95,180,0.1);--bg-color:#f6f5f4;--bg-secondary:#ffffff;--bg-tertiary:#deddda;--bg-panel:#ffffff;--bg-hover:#f0f0f0;--text-color:#2e3436;--text-secondary:#5e5c64;--text-disabled:#9a9996;--text-highlight:#000000;--border-color:#c0bfbc;--border-hover:#9a9996;--border-active:#77767b;--border-light:#e5e5e5;--success-color:#26a269;--success-hover:#2ec27e;--success-light:rgba(38,162,105,0.1);--warning-color:#e5a50a;--warning-hover:#f5c211;--warning-light:rgba(229,165,10,0.1);--error-color:#c01c28;--error-hover:#e01b24;--error-light:rgba(192,28,40,0.1);--danger-color:#c01c28;--danger-hover:#e01b24;--info-color:#1c71d8;--info-hover:#3584e4;--info-light:rgba(28,113,216,0.1);--office-header:#2c3e50;--office-sidebar:#34495e;--office-accent:#e74c3c;--office-gold:#d4af37;--office-stamp:#c0392b;--office-paper:#fffef5;--office-ink:#1a1a2e;--shadow-sm:0 1px 3px rgba(0,0,0,0.08);--shadow-md:0 4px 6px rgba(0,0,0,0.1);--shadow-lg:0 10px 20px rgba(0,0,0,0.12);--shadow-card:0 2px 8px rgba(0,0,0,0.06);--radius-xs:2px;--radius-sm:4px;--radius-md:6px;--radius-lg:8px;--spacing-xs:4px;--spacing-sm:8px;--spacing-md:16px;--spacing-lg:24px;--spacing-xl:32px;--spacing-xxl:48px;--font-xs:11px;--font-sm:13px;--font-md:15px;--font-lg:17px;--font-xl:20px;--font-2xl:24px;--handbook-bg:#fdfcf8;--handbook-text:#2c2c2c;--handbook-text-secondary:#5a5a5a;--handbook-text-muted:#8a8a8a;--handbook-accent:#1a4a7a;--handbook-divider:#b8b8b8;--handbook-border:#d4d0c8;--handbook-title-xl:22px;--handbook-title-lg:18px;--handbook-title-md:16px;--handbook-body:15px;--handbook-detail:14px;--handbook-sub-detail:13px;--handbook-line-height:2;--transition-fast:0.1s ease;--transition-normal:0.2s ease;--transition-slow:0.3s ease;--z-dropdown:100;--z-modal:200;--z-tooltip:300;--z-notification:400}:root.dark-theme{--primary-color:#3584e4;--primary-hover:#62a0ea;--primary-active:#1c71d8;--primary-light:rgba(53,132,228,0.15);--bg-color:#1e1e1e;--bg-secondary:#2d2d2d;--bg-tertiary:#3d3d3d;--bg-panel:#2d2d2d;--bg-hover:#3d3d3d;--text-color:#f5f5f5;--text-secondary:#b0b0b0;--text-disabled:#707070;--text-highlight:#ffffff;--border-color:#4d4d4d;--border-hover:#5d5d5d;--border-active:#6d6d6d;--border-light:#3d3d3d;--office-header:#1a1a2e;--office-sidebar:#252540;--office-paper:#2d2d3d;--shadow-sm:0 1px 3px rgba(0,0,0,0.3);--shadow-md:0 4px 6px rgba(0,0,0,0.4);--shadow-lg:0 10px 20px rgba(0,0,0,0.5);--shadow-card:0 2px 8px rgba(0,0,0,0.3);--handbook-bg:#1e1e24;--handbook-text:#e8e8e8;--handbook-text-secondary:#b0b0b0;--handbook-text-muted:#808080;--handbook-accent:#6ba3d6;--handbook-divider:#4a4a50;--handbook-border:#3a3a42}::-webkit-scrollbar{width:6px;height:6px}::-webkit-scrollbar-track{background:var(--bg-secondary);border-radius:var(--radius-xs)}::-webkit-scrollbar-thumb{background:var(--border-color);border-radius:var(--radius-xs)}::-webkit-scrollbar-thumb:hover{background:var(--border-hover)}.btn{display:inline-flex;align-items:center;justify-content:center;padding:var(--spacing-sm) var(--spacing-md);border:1px solid rgba(0,0,0,0);border-radius:var(--radius-sm);font-size:var(--font-sm);font-weight:500;cursor:pointer;transition:all var(--transition-fast);gap:var(--spacing-xs);background:var(--bg-tertiary);color:var(--text-color)}.btn:hover:not(:disabled){transform:translateY(-1px);box-shadow:var(--shadow-sm)}.btn:active:not(:disabled){transform:translateY(0)}.btn:disabled{opacity:.5;cursor:not-allowed}.btn:focus{outline:none;box-shadow:0 0 0 2px var(--primary-color)}.btn-primary{background:var(--primary-color);color:#fff;border-color:var(--primary-color)}.btn-primary:hover:not(:disabled){background:var(--primary-hover);border-color:var(--primary-hover)}.btn-secondary{background:var(--bg-tertiary);color:var(--text-color);border-color:var(--border-color)}.btn-secondary:hover:not(:disabled){background:var(--border-color)}.btn-success{background:var(--success-color);color:#fff;border-color:var(--success-color)}.btn-success:hover:not(:disabled){background:var(--success-hover);border-color:var(--success-hover)}.btn-danger{background:var(--danger-color);color:#fff;border-color:var(--danger-color)}.btn-danger:hover:not(:disabled){background:var(--danger-hover);border-color:var(--danger-hover)}.btn-warning{background:var(--warning-color);color:#fff;border-color:var(--warning-color)}.btn-warning:hover:not(:disabled){background:var(--warning-hover);border-color:var(--warning-hover)}.btn-ghost{background:rgba(0,0,0,0);border-color:rgba(0,0,0,0);color:var(--text-secondary)}.btn-ghost:hover:not(:disabled){background:var(--bg-tertiary);color:var(--text-color)}.btn-sm{padding:var(--spacing-xs) var(--spacing-sm);font-size:var(--font-xs)}.btn-lg{padding:var(--spacing-md) var(--spacing-lg);font-size:var(--font-md)}.btn-icon{width:32px;height:32px;padding:0;border-radius:var(--radius-sm)}.input,.select,.textarea{width:100%;padding:var(--spacing-sm) var(--spacing-md);background:var(--bg-tertiary);border:1px solid var(--border-color);border-radius:var(--radius-sm);color:var(--text-color);font-size:var(--font-sm);transition:border-color var(--transition-fast),box-shadow var(--transition-fast)}.input:focus,.select:focus,.textarea:focus{outline:none;border-color:var(--primary-color);box-shadow:0 0 0 2px rgba(74,159,74,.2)}.input::placeholder,.select::placeholder,.textarea::placeholder{color:var(--text-disabled)}.input:disabled,.select:disabled,.textarea:disabled{opacity:.5;cursor:not-allowed;background:var(--bg-secondary)}.textarea{min-height:80px;resize:vertical;line-height:1.5}.select{cursor:pointer;-webkit-appearance:none;appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23a0a0a0' d='M6 8L1 3h10z'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 12px center;padding-right:36px}.checkbox,.radio{display:inline-flex;align-items:center;gap:var(--spacing-sm);cursor:pointer;font-size:var(--font-sm);color:var(--text-color)}.checkbox input,.radio input{width:16px;height:16px;margin:0;cursor:pointer;accent-color:var(--primary-color)}.card{background:var(--bg-secondary);border-radius:var(--radius-md);padding:var(--spacing-md);border:1px solid var(--border-color)}.card-header{display:flex;align-items:center;justify-content:space-between;padding-bottom:var(--spacing-md);margin-bottom:var(--spacing-md);border-bottom:1px solid var(--border-color)}.card-header h3,.card-header h4{margin:0;color:var(--text-color);font-weight:600}.card-body{color:var(--text-secondary);line-height:1.6}.card-footer{display:flex;align-items:center;justify-content:flex-end;gap:var(--spacing-sm);padding-top:var(--spacing-md);margin-top:var(--spacing-md);border-top:1px solid var(--border-color)}.panel{background:var(--bg-panel);border:2px solid var(--border-color);border-radius:var(--radius-sm);box-shadow:var(--shadow-md)}.panel-header{background:var(--bg-tertiary);padding:var(--spacing-sm) var(--spacing-md);border-bottom:1px solid var(--border-color);font-weight:600;color:var(--text-color)}.panel-body{padding:var(--spacing-md)}.badge{display:inline-flex;align-items:center;padding:2px 8px;border-radius:var(--radius-xs);font-size:var(--font-xs);font-weight:500}.badge-primary{background:rgba(74,159,74,.2);color:var(--primary-color)}.badge-success{background:rgba(92,184,92,.2);color:var(--success-color)}.badge-warning{background:rgba(240,173,78,.2);color:var(--warning-color)}.badge-danger{background:rgba(217,83,79,.2);color:var(--danger-color)}.badge-info{background:rgba(91,192,222,.2);color:var(--info-color)}.progress{width:100%;height:8px;background:var(--bg-tertiary);border-radius:var(--radius-xs);overflow:hidden}.progress-bar{height:100%;background:var(--primary-color);transition:width var(--transition-normal)}.progress-bar-success{background:var(--success-color)}.progress-bar-warning{background:var(--warning-color)}.progress-bar-danger{background:var(--danger-color)}.divider{height:1px;background:var(--border-color);margin:var(--spacing-md) 0}.divider-vertical{width:1px;height:100%;background:var(--border-color);margin:0 var(--spacing-md)}.text-center{text-align:center}.text-left{text-align:left}.text-right{text-align:right}.text-primary{color:var(--primary-color)}.text-secondary{color:var(--text-secondary)}.text-success{color:var(--success-color)}.text-warning{color:var(--warning-color)}.text-danger{color:var(--danger-color)}.text-info{color:var(--info-color)}.flex{display:flex}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-start{align-items:flex-start}.items-center{align-items:center}.items-end{align-items:flex-end}.justify-start{justify-content:flex-start}.justify-center{justify-content:center}.justify-end{justify-content:flex-end}.justify-between{justify-content:space-between}.flex-1{flex:1}.gap-xs{gap:var(--spacing-xs)}.gap-sm{gap:var(--spacing-sm)}.gap-md{gap:var(--spacing-md)}.gap-lg{gap:var(--spacing-lg)}.w-full{width:100%}.h-full{height:100%}.w-auto{width:auto}.h-auto{height:auto}.m-0{margin:0}.p-0{padding:0}.mt-sm{margin-top:var(--spacing-sm)}.mt-md{margin-top:var(--spacing-md)}.mb-sm{margin-bottom:var(--spacing-sm)}.mb-md{margin-bottom:var(--spacing-md)}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes fadeOut{from{opacity:1}to{opacity:0}}@keyframes slideInUp{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@keyframes slideInDown{from{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}@keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}@keyframes spin{to{transform:rotate(360deg)}}.animate-fadeIn{animation:fadeIn var(--transition-normal)}.animate-slideInUp{animation:slideInUp var(--transition-normal)}.animate-slideInDown{animation:slideInDown var(--transition-normal)}.animate-pulse{animation:pulse 2s infinite}.animate-spin{animation:spin 1s linear infinite}.hidden{display:none !important}.visible{visibility:visible}.invisible{visibility:hidden}.overflow-hidden{overflow:hidden}.overflow-auto{overflow:auto}.overflow-scroll{overflow:scroll}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:root{--cb-dialogue-color:#1a5fb4;--cb-dialogue-bg:rgba(26,95,180,0.05);--cb-dialogue-border:rgba(26,95,180,0.2);--cb-dialogue-icon:'ğŸ’¬';--cb-thought-color:#8b5cf6;--cb-thought-bg:rgba(139,92,246,0.05);--cb-thought-border:rgba(139,92,246,0.15);--cb-thought-icon:'ğŸ’­';--cb-scenery-color:#059669;--cb-scenery-bg:rgba(5,150,105,0.05);--cb-scenery-border:rgba(5,150,105,0.15);--cb-scenery-icon:'ğŸï¸';--cb-system-color:#dc2626;--cb-system-bg:rgba(220,38,38,0.08);--cb-system-border:#dc2626;--cb-system-icon:'âš ï¸';--cb-text-color:var(--text-color,#2e3436);--cb-transition:0.15s ease;--cb-radius-sm:4px;--cb-radius-md:6px;--cb-radius-lg:8px}:root.dark-theme,.dark-theme{--cb-dialogue-color:#60a5fa;--cb-dialogue-bg:rgba(96,165,250,0.1);--cb-dialogue-border:rgba(96,165,250,0.3);--cb-thought-color:#a78bfa;--cb-thought-bg:rgba(167,139,250,0.1);--cb-thought-border:rgba(167,139,250,0.2);--cb-scenery-color:#34d399;--cb-scenery-bg:rgba(52,211,153,0.1);--cb-scenery-border:rgba(52,211,153,0.2);--cb-system-color:#f87171;--cb-system-bg:rgba(248,113,113,0.15);--cb-system-border:#f87171;--cb-text-color:var(--text-color,#f5f5f5)}.content-block-renderer{font-size:var(--font-md,15px);line-height:1.8;color:var(--cb-text-color);word-wrap:break-word;overflow-wrap:break-word}.content-block{display:inline;transition:all var(--cb-transition)}.content-block__icon{margin-right:4px;font-size:.9em;vertical-align:middle;opacity:.8}.content-block__content{vertical-align:baseline}.content-block--text{color:var(--cb-text-color)}.content-block--dialogue{display:inline-block;position:relative;color:var(--cb-dialogue-color);background:var(--cb-dialogue-bg);border-left:3px solid var(--cb-dialogue-border);border-radius:0 var(--cb-radius-sm) var(--cb-radius-sm) 0;padding:6px 12px;margin:4px 2px}.content-block--dialogue::before{content:"ã€Œ";position:absolute;left:-2px;top:-4px;font-size:1.5em;color:var(--cb-dialogue-border);opacity:.4;font-weight:bold}.content-block--dialogue:hover{background:var(--cb-dialogue-bg);border-left-color:var(--cb-dialogue-color);transform:translateX(2px);box-shadow:-2px 2px 8px rgba(26,95,180,.15)}.content-block--thought{display:inline-block;color:var(--cb-thought-color);background:var(--cb-thought-bg);font-style:italic;padding:4px 10px;margin:2px;border-radius:var(--cb-radius-sm);position:relative}.content-block--thought::after{content:"";position:absolute;bottom:2px;left:10%;right:10%;height:2px;background:linear-gradient(90deg,transparent 0%,var(--cb-thought-border) 20%,var(--cb-thought-color) 50%,var(--cb-thought-border) 80%,transparent 100%);opacity:.3;border-radius:1px}.content-block--thought .content-block__icon{animation:thoughtBubble 2s ease-in-out infinite}.content-block--thought:hover{background:rgba(139,92,246,.1)}.content-block--thought:hover::after{opacity:.5}@keyframes thoughtBubble{0%,100%{transform:translateY(0);opacity:.8}50%{transform:translateY(-2px);opacity:1}}.content-block--scenery{display:block;color:var(--cb-scenery-color);background:var(--cb-scenery-bg);border:1px dashed var(--cb-scenery-border);border-radius:var(--cb-radius-md);padding:12px 16px;margin:10px 0;line-height:1.9;position:relative}.content-block--scenery::before,.content-block--scenery::after{content:"";position:absolute;width:12px;height:12px;border:2px solid var(--cb-scenery-border);opacity:.4}.content-block--scenery::before{top:-1px;left:-1px;border-right:none;border-bottom:none;border-radius:var(--cb-radius-sm) 0 0 0}.content-block--scenery::after{bottom:-1px;right:-1px;border-left:none;border-top:none;border-radius:0 0 var(--cb-radius-sm) 0}.content-block--scenery:hover{border-style:solid;box-shadow:0 4px 12px rgba(5,150,105,.1)}.content-block--scenery:hover::before,.content-block--scenery:hover::after{opacity:.7}.content-block--scenery .content-block__content{display:block;text-indent:2em}.content-block--system{display:block;color:var(--cb-system-color);background:var(--cb-system-bg);border:2px solid var(--cb-system-border);border-radius:var(--cb-radius-lg);padding:14px 20px;margin:12px 0;text-align:center;font-weight:600;position:relative;overflow:hidden}.content-block--system::before{content:"";position:absolute;top:0;left:0;right:0;height:4px;background:repeating-linear-gradient(90deg,var(--cb-system-color),var(--cb-system-color) 10px,transparent 10px,transparent 20px);opacity:.3}.content-block--system .content-block__icon{font-size:1.2em;margin-right:8px;animation:systemPulse 1.5s ease-in-out infinite}.content-block--system:hover{transform:scale(1.01);box-shadow:0 4px 16px rgba(220,38,38,.2)}.content-block--system:hover::before{opacity:.5}@keyframes systemPulse{0%,100%{transform:scale(1)}50%{transform:scale(1.1)}}.streaming-cursor{display:inline-block;color:var(--primary-color,#1a5fb4);font-weight:bold;animation:cursorBlink 1s step-end infinite;margin-left:2px}@keyframes cursorBlink{0%,50%{opacity:1}51%,100%{opacity:0}}.content-block--animated{animation:blockFadeIn .3s ease-out}@keyframes blockFadeIn{from{opacity:0;transform:translateY(4px)}to{opacity:1;transform:translateY(0)}}@media print{.content-block{background:none !important;border:none !important;padding:0 !important;margin:0 !important}.content-block::before,.content-block::after{display:none !important}.content-block--dialogue::before{display:inline !important;content:"ã€Œ" !important;position:static !important}.content-block--dialogue::after{content:"ã€" !important}.content-block--scenery::before{content:"ã€" !important}.content-block--scenery::after{content:"ã€‘" !important}.content-block--system{border:1px solid #000 !important;text-align:center}.streaming-cursor{display:none !important}}@media (max-width:768px){.content-block--dialogue{padding:4px 8px;margin:2px 1px}.content-block--dialogue::before{font-size:1.2em}.content-block--thought{padding:3px 8px}.content-block--scenery{padding:8px 12px;margin:8px 0}.content-block--scenery .content-block__content{text-indent:1em}.content-block--system{padding:10px 14px;margin:8px 0}}@media (prefers-reduced-motion:reduce){.content-block,.content-block--animated,.streaming-cursor,.content-block__icon{animation:none !important;transition:none !important}}@media (prefers-contrast:high){:root{--cb-dialogue-color:#0055cc;--cb-dialogue-bg:rgba(0,85,204,0.15);--cb-dialogue-border:#0055cc;--cb-thought-color:#6b21a8;--cb-thought-bg:rgba(107,33,168,0.15);--cb-scenery-color:#047857;--cb-scenery-bg:rgba(4,120,87,0.15);--cb-scenery-border:#047857;--cb-system-color:#b91c1c;--cb-system-bg:rgba(185,28,28,0.15);--cb-system-border:#b91c1c}.content-block{border-width:2px !important}}*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}html,body{width:100%;height:100%;font-family:"Microsoft YaHei",-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;background-color:var(--bg-color);color:var(--text-color);font-size:var(--font-md);line-height:1.5;overflow:hidden}#app{width:100%;height:100%;display:flex;flex-direction:column}.no-select{user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none}input,textarea,.selectable{user-select:text;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text}a{color:var(--primary-color);text-decoration:none;transition:color var(--transition-fast)}a:hover{color:var(--primary-hover);text-decoration:underline}ul,ol{list-style:none}img{max-width:100%;height:auto;vertical-align:middle}code,pre{font-family:"Consolas","Monaco","Courier New",monospace;background:var(--bg-tertiary);border-radius:var(--radius-xs)}code{padding:2px 6px;font-size:var(--font-sm)}pre{padding:var(--spacing-md);overflow-x:auto}pre code{padding:0;background:none}table{width:100%;border-collapse:collapse;background:var(--bg-secondary)}table th,table td{padding:var(--spacing-sm) var(--spacing-md);border:1px solid var(--border-color);text-align:left}table th{background:var(--bg-tertiary);font-weight:600;color:var(--text-color)}table tr:hover{background:var(--bg-tertiary)}:focus-visible{outline:2px solid var(--primary-color);outline-offset:2px}.loading-spinner{width:32px;height:32px;border:3px solid var(--border-color);border-top-color:var(--primary-color);border-radius:50%;animation:spin .8s linear infinite}.loading-container{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:var(--spacing-md);min-height:200px}.loading-container p{color:var(--text-secondary);font-size:var(--font-sm)}.pixel-border{border:2px solid var(--border-color);box-shadow:inset 2px 2px 0 hsla(0,0%,100%,.1),inset -2px -2px 0 rgba(0,0,0,.2)}.mc-btn{display:inline-flex;align-items:center;justify-content:center;padding:var(--spacing-sm) var(--spacing-lg);background:linear-gradient(180deg,var(--bg-tertiary) 0%,var(--bg-secondary) 100%);border:2px solid var(--border-color);border-radius:0;color:var(--text-color);font-size:var(--font-sm);font-weight:500;cursor:pointer;transition:all var(--transition-fast);box-shadow:inset 1px 1px 0 hsla(0,0%,100%,.1),inset -1px -1px 0 rgba(0,0,0,.2)}.mc-btn:hover:not(:disabled){background:linear-gradient(180deg,var(--border-color) 0%,var(--bg-tertiary) 100%);border-color:var(--border-hover)}.mc-btn:active:not(:disabled){box-shadow:inset -1px -1px 0 hsla(0,0%,100%,.1),inset 1px 1px 0 rgba(0,0,0,.2)}.mc-btn:disabled{opacity:.5;cursor:not-allowed}.tooltip{position:absolute;padding:var(--spacing-xs) var(--spacing-sm);background:var(--bg-tertiary);border:1px solid var(--border-color);border-radius:var(--radius-sm);font-size:var(--font-xs);color:var(--text-color);white-space:nowrap;z-index:var(--z-tooltip);box-shadow:var(--shadow-md);pointer-events:none}.overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.6);z-index:var(--z-modal);display:flex;align-items:center;justify-content:center}.modal{background:var(--bg-secondary);border:2px solid var(--border-color);border-radius:var(--radius-md);box-shadow:var(--shadow-lg);max-width:90vw;max-height:90vh;overflow:auto}.modal-header{display:flex;align-items:center;justify-content:space-between;padding:var(--spacing-md);border-bottom:1px solid var(--border-color)}.modal-header h3{margin:0;font-weight:600;color:var(--text-color)}.modal-body{padding:var(--spacing-md)}.modal-footer{display:flex;align-items:center;justify-content:flex-end;gap:var(--spacing-sm);padding:var(--spacing-md);border-top:1px solid var(--border-color)}

/*# sourceMappingURL=main.css.map*/</style></head><body><div id="app"></div></body></html>