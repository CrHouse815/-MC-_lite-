<!doctype html><html lang="zh-CN"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>MCæˆ¿å­</title><script type="module">import{createPinia as e,defineStore as t,storeToRefs as a}from'https://testingcf.jsdelivr.net/npm/pinia/+esm';var n={772:(e,t)=>{t.A=(e,t)=>{const a=e.__vccOpts||e;for(const[e,n]of t)a[e]=n;return a}}},o={};const l=Vue,r={class:'top-bar'},s={class:'top-bar-left'},c={class:'player-card'},i={class:'player-info'},u={class:'player-name'},d={class:'player-role'},m={class:'top-bar-center'},v={class:'datetime-group'},p={class:'date-item'},g={class:'item-value'},f={class:'time-item'},h={class:'location-item'},y={class:'item-value location-text'},V={class:'top-bar-right'},E=['title'],b={class:'action-buttons'},S=['title'],N={class:'btn-icon'},k=['title'],C={class:'btn-icon'},w=(0,l.defineComponent)({__name:'TopBar',props:{connectionStatus:{default:'connected'},isFullscreen:{type:Boolean,default:!1},isDarkTheme:{type:Boolean,default:!1},gameDate:{default:''},gamePeriod:{default:''},gameLocation:{default:''},playerName:{default:''},playerPosition:{default:''},playerDepartment:{default:''}},emits:['toggle-fullscreen','toggle-theme'],setup(e){const t=e,a=(0,l.computed)(()=>{switch(t.connectionStatus){case'connected':return'åœ¨çº¿';case'connecting':return'è¿æ¥ä¸­...';case'disconnected':return'ç¦»çº¿';default:return'æœªçŸ¥'}}),n=(0,l.computed)(()=>t.playerName||'æœªç™»å½•'),o=(0,l.computed)(()=>t.playerPosition&&t.playerDepartment?`${t.playerDepartment}Â·${t.playerPosition}`:t.playerPosition?t.playerPosition:t.playerDepartment?t.playerDepartment:'ç­‰å¾…åˆ†é…'),w=(0,l.computed)(()=>t.gameDate||'ç­‰å¾…æ•°æ®...'),M=(0,l.computed)(()=>t.gamePeriod||'--:--'),A=(0,l.computed)(()=>t.gameLocation||'æœªçŸ¥åœ°ç‚¹'),I=(0,l.computed)(()=>{const e=(t.gamePeriod||'').match(/^(\d{1,2}):(\d{2})$/);if(!e)return'period-default';const a=parseInt(e[1],10);return a>=6&&a<12?'period-morning':a>=12&&a<14?'period-noon':a>=14&&a<18?'period-afternoon':a>=18&&a<21?'period-evening':'period-night'});return(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('header',r,[(0,l.createCommentVNode)(' å·¦ä¾§ï¼šç©å®¶ä¿¡æ¯ '),(0,l.createElementVNode)('div',s,[(0,l.createCommentVNode)(' ç©å®¶ä¿¡æ¯å¡ç‰‡ '),(0,l.createElementVNode)('div',c,[t[2]||(t[2]=(0,l.createElementVNode)('div',{class:'player-avatar'},[(0,l.createElementVNode)('span',{class:'avatar-icon'},'ğŸ‘¤')],-1)),(0,l.createElementVNode)('div',i,[(0,l.createElementVNode)('span',u,(0,l.toDisplayString)(n.value),1),(0,l.createElementVNode)('span',d,(0,l.toDisplayString)(o.value),1)])])]),(0,l.createCommentVNode)(' ä¸­é—´ï¼šæ¸¸æˆçŠ¶æ€ï¼ˆæ—¥æœŸæ—¶é—´ + åœ°ç‚¹ï¼‰ '),(0,l.createElementVNode)('div',m,[(0,l.createCommentVNode)(' æ—¥æœŸæ—¶é—´ç»„åˆæ˜¾ç¤º '),(0,l.createElementVNode)('div',v,[(0,l.createElementVNode)('div',p,[t[3]||(t[3]=(0,l.createElementVNode)('span',{class:'item-icon'},'ğŸ“…',-1)),(0,l.createElementVNode)('span',g,(0,l.toDisplayString)(w.value),1)]),(0,l.createElementVNode)('div',f,[(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(['period-badge',I.value])},(0,l.toDisplayString)(M.value),3)])]),(0,l.createCommentVNode)(' åœ°ç‚¹æ˜¾ç¤º '),(0,l.createElementVNode)('div',h,[t[4]||(t[4]=(0,l.createElementVNode)('span',{class:'item-icon'},'ğŸ“',-1)),(0,l.createElementVNode)('span',y,(0,l.toDisplayString)(A.value),1)])]),(0,l.createCommentVNode)(' å³ä¾§ï¼šçŠ¶æ€æŒ‡ç¤º + åŠŸèƒ½æŒ‰é’® '),(0,l.createElementVNode)('div',V,[(0,l.createCommentVNode)(' è¿æ¥çŠ¶æ€æŒ‡ç¤ºå™¨ '),(0,l.createElementVNode)('div',{class:(0,l.normalizeClass)(['connection-indicator',e.connectionStatus]),title:a.value},[...t[5]||(t[5]=[(0,l.createElementVNode)('span',{class:'status-dot'},null,-1)])],10,E),(0,l.createCommentVNode)(' åŠŸèƒ½æŒ‰é’®ç»„ '),(0,l.createElementVNode)('div',b,[(0,l.createElementVNode)('button',{class:'action-btn',title:e.isDarkTheme?'åˆ‡æ¢åˆ°æµ…è‰²æ¨¡å¼':'åˆ‡æ¢åˆ°æ·±è‰²æ¨¡å¼',onClick:t[0]||(t[0]=t=>e.$emit('toggle-theme'))},[(0,l.createElementVNode)('span',N,(0,l.toDisplayString)(e.isDarkTheme?'â˜€ï¸':'ğŸŒ™'),1)],8,S),(0,l.createElementVNode)('button',{class:'action-btn',title:e.isFullscreen?'é€€å‡ºå…¨å±':'å…¨å±æ˜¾ç¤º',onClick:t[1]||(t[1]=t=>e.$emit('toggle-fullscreen'))},[(0,l.createElementVNode)('span',C,(0,l.toDisplayString)(e.isFullscreen?'â¬œ':'â›¶'),1)],8,k)])])]))}});var M=function e(t){var a=o[t];if(void 0!==a)return a.exports;var l=o[t]={exports:{}};return n[t](l,l.exports,e),l.exports}(772);const A=(0,M.A)(w,[['__scopeId','data-v-255ae3ac']]),I=['innerHTML'],D={key:0,class:'streaming-cursor'},B=(0,l.defineComponent)({__name:'ContentBlockRenderer',props:{content:{default:''},isStreaming:{type:Boolean,default:!1},theme:{default:'auto'}},setup(e,{expose:t}){const a=e,n=(0,l.computed)(()=>'dark'===a.theme||'light'!==a.theme&&('undefined'!=typeof document&&(document.documentElement.classList.contains('dark-theme')||document.body.classList.contains('dark-theme')||window.matchMedia?.('(prefers-color-scheme: dark)').matches))),o=(0,l.computed)(()=>{if(!a.content)return'';let e=function(e){const t={'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'};return e.replace(/[&<>"]/g,e=>t[e]||e)}(a.content);return e=e.replace(/\n/g,'<br>'),e=e.replace(/ã€ã€([^ã€ã€‘]*)ã€‘ã€‘/g,(e,t)=>`<span class="block-system">ã€ã€${t}ã€‘ã€‘</span>`),e=e.replace(/ã€([^ã€ã€‘]+)ã€‘/g,(e,t)=>`<span class="block-scenery">ã€${t}ã€‘</span>`),e=e.replace(/ã€Œ([^ã€Œã€]+)ã€/g,(e,t)=>`<span class="block-dialogue">ã€Œ${t}ã€</span>`),e=e.replace(/\*([^*]+)\*/g,(e,t)=>`<span class="block-thought">*${t}*</span>`),e});return t({isDarkTheme:n}),(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{class:(0,l.normalizeClass)(['content-renderer',{'content-renderer--dark':n.value}])},[(0,l.createElementVNode)('span',{class:'content-text',innerHTML:o.value},null,8,I),e.isStreaming?((0,l.openBlock)(),(0,l.createElementBlock)('span',D,'â–Œ')):(0,l.createCommentVNode)('v-if',!0)],2))}}),x=(0,M.A)(B,[['__scopeId','data-v-17b96b08']]),T={class:'header-left'},L={key:0,class:'changes-count'},O={class:'header-right'},R={class:'toggle-icon'},U={key:0,class:'panel-content'},j={key:0,class:'no-changes'},P={class:'changes-list'},F={class:'change-path'},H={class:'path-icon'},W=['title'],G={class:'change-values'},J=['title'],K=['title'],Y={key:0,class:'change-comment'},q={class:'comment-text'},X={key:2,class:'panel-footer'},Q=(0,l.defineComponent)({__name:'VariableChangesPanel',props:{changes:{default:()=>[]},defaultExpanded:{type:Boolean,default:!1}},emits:['clear','copy'],setup(e,{expose:t,emit:a}){const n=e,o=a,r=(0,l.ref)(n.defaultExpanded),s=()=>{r.value=!r.value},c=e=>void 0!==e.oldValue&&null!==e.oldValue,i=e=>{if(!c(e))return'change-new';const t=typeof e.oldValue,a=typeof e.newValue;if('number'===t&&'number'===a){if(e.newValue>e.oldValue)return'change-increase';if(e.newValue<e.oldValue)return'change-decrease'}return'change-modify'},u=e=>{if(!c(e))return'âœ¨';const t=typeof e.oldValue,a=typeof e.newValue;if('number'===t&&'number'===a){if(e.newValue>e.oldValue)return'ğŸ“ˆ';if(e.newValue<e.oldValue)return'ğŸ“‰'}return'âœï¸'},d=e=>{if(e.length<=30)return e;const t=e.split('.');return t.length<=2?e.substring(0,27)+'...':`${t[0]}...${t.slice(-2).join('.')}`},m=e=>{if(null===e)return'null';if(void 0===e)return'undefined';const t=typeof e;if('string'===t){const t=20;return e.length>t?`"${e.substring(0,t)}..."`:`"${e}"`}if('number'===t)return String(e);if('boolean'===t)return e?'true':'false';if(Array.isArray(e))return`[${e.length}é¡¹]`;if('object'===t){return`{${Object.keys(e).length}é”®}`}return String(e)},v=e=>{if(null===e)return'null';if(void 0===e)return'undefined';try{return JSON.stringify(e,null,2)}catch{return String(e)}},p=()=>{o('clear')},g=()=>{const e=n.changes.map(e=>{let t=`${e.path}: `;return c(e)&&(t+=`${v(e.oldValue)} â†’ `),t+=v(e.newValue),e.comment&&(t+=` // ${e.comment}`),t}).join('\n');o('copy',e),navigator.clipboard&&navigator.clipboard.writeText(e).then(()=>{console.log('[VariableChangesPanel] å·²å¤åˆ¶åˆ°å‰ªè´´æ¿')}).catch(e=>{console.error('[VariableChangesPanel] å¤åˆ¶å¤±è´¥:',e)})};return t({expand:()=>{r.value=!0},collapse:()=>{r.value=!1},toggle:s}),(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{class:(0,l.normalizeClass)(['variable-changes-panel',{expanded:r.value,collapsed:!r.value}])},[(0,l.createCommentVNode)(' é¢æ¿å¤´éƒ¨ - å§‹ç»ˆå¯è§ '),(0,l.createElementVNode)('div',{class:'panel-header',onClick:s},[(0,l.createElementVNode)('div',T,[t[0]||(t[0]=(0,l.createElementVNode)('span',{class:'header-icon'},'ğŸ“Š',-1)),t[1]||(t[1]=(0,l.createElementVNode)('span',{class:'header-title'},'å˜é‡å˜åŒ–',-1)),e.changes.length>0?((0,l.openBlock)(),(0,l.createElementBlock)('span',L,(0,l.toDisplayString)(e.changes.length),1)):(0,l.createCommentVNode)('v-if',!0)]),(0,l.createElementVNode)('div',O,[(0,l.createElementVNode)('span',R,(0,l.toDisplayString)(r.value?'â–¼':'â–¶'),1)])]),(0,l.createCommentVNode)(' é¢æ¿å†…å®¹ - å±•å¼€æ—¶æ˜¾ç¤º '),(0,l.createVNode)(l.Transition,{name:'expand'},{default:(0,l.withCtx)(()=>[r.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',U,[(0,l.createCommentVNode)(' æ— å˜åŒ–æç¤º '),0===e.changes.length?((0,l.openBlock)(),(0,l.createElementBlock)('div',j,[...t[2]||(t[2]=[(0,l.createElementVNode)('span',{class:'empty-icon'},'ğŸ“­',-1),(0,l.createElementVNode)('span',{class:'empty-text'},'æœ¬æ¬¡å›å¤æ— å˜é‡æ›´æ–°',-1)])])):((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createCommentVNode)(' å˜é‡å˜åŒ–åˆ—è¡¨ '),(0,l.createElementVNode)('div',P,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(e.changes,(e,a)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:a,class:(0,l.normalizeClass)(['change-item',i(e)])},[(0,l.createCommentVNode)(' å˜é‡è·¯å¾„ '),(0,l.createElementVNode)('div',F,[(0,l.createElementVNode)('span',H,(0,l.toDisplayString)(u(e)),1),(0,l.createElementVNode)('span',{class:'path-text',title:e.path},(0,l.toDisplayString)(d(e.path)),9,W)]),(0,l.createCommentVNode)(' å€¼å˜åŒ– '),(0,l.createElementVNode)('div',G,[(0,l.createCommentVNode)(' æ—§å€¼ï¼ˆå¦‚æœæœ‰ï¼‰ '),c(e)?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:0},[(0,l.createElementVNode)('span',{class:'old-value',title:v(e.oldValue)},(0,l.toDisplayString)(m(e.oldValue)),9,J),t[3]||(t[3]=(0,l.createElementVNode)('span',{class:'arrow'},'â†’',-1))],64)):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' æ–°å€¼ '),(0,l.createElementVNode)('span',{class:'new-value',title:v(e.newValue)},(0,l.toDisplayString)(m(e.newValue)),9,K)]),(0,l.createCommentVNode)(' æ³¨é‡Šï¼ˆå¦‚æœæœ‰ï¼‰ '),e.comment?((0,l.openBlock)(),(0,l.createElementBlock)('div',Y,[t[4]||(t[4]=(0,l.createElementVNode)('span',{class:'comment-icon'},'ğŸ’¬',-1)),(0,l.createElementVNode)('span',q,(0,l.toDisplayString)(e.comment),1)])):(0,l.createCommentVNode)('v-if',!0)],2))),128))])],2112)),(0,l.createCommentVNode)(' åº•éƒ¨æ“ä½œæ  '),e.changes.length>0?((0,l.openBlock)(),(0,l.createElementBlock)('div',X,[(0,l.createElementVNode)('button',{class:'btn-clear',onClick:(0,l.withModifiers)(p,['stop']),title:'æ¸…ç©ºå˜åŒ–è®°å½•'},[...t[5]||(t[5]=[(0,l.createElementVNode)('span',{class:'btn-icon'},'ğŸ—‘ï¸',-1),(0,l.createTextVNode)(' æ¸…ç©º ',-1)])]),(0,l.createElementVNode)('button',{class:'btn-copy',onClick:(0,l.withModifiers)(g,['stop']),title:'å¤åˆ¶å˜åŒ–è®°å½•'},[...t[6]||(t[6]=[(0,l.createElementVNode)('span',{class:'btn-icon'},'ğŸ“‹',-1),(0,l.createTextVNode)(' å¤åˆ¶ ',-1)])])])):(0,l.createCommentVNode)('v-if',!0)])):(0,l.createCommentVNode)('v-if',!0)]),_:1})],2))}}),Z=(0,M.A)(Q,[['__scopeId','data-v-2e3cf9d4']]),ee={class:'main-content'},te={class:'game-text-container'},ae={key:0,class:'processing-state'},ne={class:'content-header'},oe={class:'content-meta'},le={key:0,class:'meta-item'},re={key:1,class:'meta-item streaming-badge'},se={class:'game-text'},ce=(0,l.defineComponent)({__name:'MainContent',props:{currentContent:{default:''},isProcessing:{type:Boolean,default:!1},isStreaming:{type:Boolean,default:!1},variableChanges:{default:()=>[]},lastUpdateTime:{default:''}},setup(e,{expose:t}){const a=e,n=(0,l.ref)(null),o=(0,l.ref)(null),r=(0,l.computed)(()=>a.variableChanges.length>0),s={enabled:!0,showIcons:!0,enableAnimations:!0},c=e=>{console.log('[MainContent] å†…å®¹å—è¢«ç‚¹å‡»:',e.block.type,e.block.displayContent.substring(0,50))},i=e=>{e.success&&console.log('[MainContent] å†…å®¹è§£æå®Œæˆ:',{æ€»å—æ•°:e.statistics.totalBlocks,å„ç±»å‹:e.statistics.blockCounts,è€—æ—¶:e.statistics.parseTime.toFixed(2)+'ms'})},u=()=>{(0,l.nextTick)(()=>{n.value&&(n.value.scrollTop=n.value.scrollHeight)})},d=()=>{console.log('[MainContent] æ¸…ç©ºå˜é‡å˜åŒ–è®°å½•')},m=e=>{console.log('[MainContent] å¤åˆ¶å˜é‡å˜åŒ–è®°å½•:',e.substring(0,100))};return(0,l.watch)(()=>a.currentContent,()=>{u()}),t({scrollToBottom:u,expandChangesPanel:()=>o.value?.expand(),collapseChangesPanel:()=>o.value?.collapse()}),(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('main',ee,[(0,l.createCommentVNode)(' æ¸¸æˆæ–‡æœ¬æ˜¾ç¤ºåŒºåŸŸ '),(0,l.createElementVNode)('div',te,[(0,l.createCommentVNode)(' AIæ­£åœ¨æ€è€ƒçŠ¶æ€ '),e.isProcessing&&!e.isStreaming?((0,l.openBlock)(),(0,l.createElementBlock)('div',ae,[...t[0]||(t[0]=[(0,l.createStaticVNode)('<div class="thinking-panel" data-v-38cea020><div class="thinking-animation" data-v-38cea020><span class="thinking-dot" data-v-38cea020></span><span class="thinking-dot" data-v-38cea020></span><span class="thinking-dot" data-v-38cea020></span></div><p class="thinking-text" data-v-38cea020>AIæ­£åœ¨æ€è€ƒ...</p></div>',1)])])):((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createCommentVNode)(' ä¸»å†…å®¹æ˜¾ç¤º '),(0,l.createElementVNode)('div',{class:'content-display',ref_key:'contentRef',ref:n},[(0,l.createCommentVNode)(' å†…å®¹å¤´éƒ¨ '),(0,l.createElementVNode)('div',ne,[(0,l.createElementVNode)('div',oe,[e.lastUpdateTime?((0,l.openBlock)(),(0,l.createElementBlock)('span',le,[t[1]||(t[1]=(0,l.createElementVNode)('span',{class:'meta-icon'},'ğŸ•',-1)),(0,l.createTextVNode)(' '+(0,l.toDisplayString)(e.lastUpdateTime),1)])):(0,l.createCommentVNode)('v-if',!0),e.isStreaming?((0,l.openBlock)(),(0,l.createElementBlock)('span',re,[...t[2]||(t[2]=[(0,l.createElementVNode)('span',{class:'streaming-dot'},null,-1),(0,l.createTextVNode)(' æ­£åœ¨ç”Ÿæˆ... ',-1)])])):(0,l.createCommentVNode)('v-if',!0)]),(0,l.createCommentVNode)(' ç‰ˆæœ¬å¾½ç«  '),t[3]||(t[3]=(0,l.createElementVNode)('div',{class:'version-badge',title:'MClite v0.5.5'},[(0,l.createElementVNode)('span',{class:'version-tag'},'MClite v0.5.5')],-1))]),(0,l.createCommentVNode)(' ä¸»æ–‡æœ¬å†…å®¹ - ä½¿ç”¨å†…å®¹å—å·®å¼‚åŒ–æ¸²æŸ“ç»„ä»¶ '),(0,l.createElementVNode)('div',se,[(0,l.createVNode)(x,{content:e.currentContent,'is-streaming':e.isStreaming,config:s,theme:'auto',onBlockClick:c,onParsed:i},null,8,['content','is-streaming'])]),(0,l.createCommentVNode)(' å˜é‡å˜åŒ–é¢æ¿ï¼ˆå¢å¼ºç‰ˆï¼‰ '),(0,l.createVNode)(Z,{ref_key:'variableChangesPanelRef',ref:o,changes:e.variableChanges,'default-expanded':r.value,onClear:d,onCopy:m},null,8,['changes','default-expanded'])],512)],2112))])]))}}),ie=(0,M.A)(ce,[['__scopeId','data-v-38cea020']]),ue={maxItems:50,storageKey:'mclite_input_history',autoSave:!0,deduplicate:!0};const de=(0,l.reactive)({visible:!1,title:'ç¡®è®¤',message:'',confirmText:'ç¡®è®¤',cancelText:'å–æ¶ˆ',type:'info',icon:'â“',showCancel:!0,isProcessing:!1});let me=null,ve=null;const pe={info:'â„¹ï¸',warning:'âš ï¸',danger:'ğŸ—‘ï¸',success:'âœ…'},ge=e=>new Promise(t=>{const a='string'==typeof e?{message:e}:e;de.title=a.title||'ç¡®è®¤',de.message=a.message,de.confirmText=a.confirmText||'ç¡®è®¤',de.cancelText=a.cancelText||'å–æ¶ˆ',de.type=a.type||'info',de.icon=a.icon||pe[a.type||'info']||'â“',de.showCancel=!1!==a.showCancel,de.isProcessing=!1,de.visible=!0,me=t,ve=a.beforeConfirm||null}),fe=async()=>{if(!de.isProcessing){if(ve){de.isProcessing=!0;try{if(!await ve())return void(de.isProcessing=!1)}catch(e){return console.error('[ConfirmDialog] beforeConfirm error:',e),void(de.isProcessing=!1)}}de.visible=!1,de.isProcessing=!1,me&&(me(!0),me=null),ve=null}},he=()=>{de.isProcessing||(de.visible=!1,me&&(me(!1),me=null),ve=null)},ye=(e,t='å±é™©æ“ä½œ')=>ge({title:t,message:e,type:'danger',confirmText:'ç¡®è®¤åˆ é™¤',cancelText:'å–æ¶ˆ',icon:'ğŸ—‘ï¸'}),Ve=(e,t='è­¦å‘Š')=>ge({title:t,message:e,type:'warning',confirmText:'ç»§ç»­',cancelText:'å–æ¶ˆ',icon:'âš ï¸'}),Ee=(e,t='æç¤º')=>ge({title:t,message:e,type:'info',confirmText:'çŸ¥é“äº†',showCancel:!1,icon:'â„¹ï¸'});function be(){return{state:(0,l.readonly)(de),confirm:ge,confirmDanger:ye,confirmWarning:Ve,confirmInfo:Ee,handleConfirm:fe,handleCancel:he}}const Se={class:'bottom-bar'},Ne={key:0,class:'history-panel'},ke={class:'history-header'},Ce={class:'history-count'},we={class:'history-actions'},Me={class:'history-search'},Ae={class:'history-list'},Ie=['onClick'],De={class:'history-content'},Be={class:'history-time'},xe=['onClick'],_e={key:0,class:'history-empty'},Te={class:'input-area'},$e=['title'],Le=['placeholder','disabled'],Oe=['disabled','title'],Re={key:0,class:'loading-icon'},Ue={key:1,class:'send-icon'},je={key:0,class:'navigation-hint'},Pe={class:'hint-text'},ze={key:1,class:'error-message'},Fe={class:'error-text'},He=(0,l.defineComponent)({__name:'BottomBar',props:{placeholder:{default:'è¾“å…¥ä½ æƒ³è¯´çš„è¯æˆ–æƒ³åšçš„äº‹...'},isLoading:{type:Boolean,default:!1},error:{default:null}},emits:['send','clearError'],setup(e,{expose:t,emit:a}){const n=e,o=a,{historyList:r,currentIndex:s,historyCount:c,hasHistory:i,isNavigating:u,addToHistory:d,navigateBack:m,navigateForward:v,resetNavigation:p,removeHistoryAt:g,clearHistory:f,searchHistory:h}=function(e={}){const t={...ue,...e},a=(0,l.ref)([]),n=(0,l.ref)(-1),o=(0,l.ref)(''),r=(0,l.ref)(!1),s=(0,l.computed)(()=>a.value.length),c=(0,l.computed)(()=>a.value.length>0),i=(0,l.computed)(()=>n.value>=0),u=(0,l.computed)(()=>n.value<a.value.length-1),d=(0,l.computed)(()=>n.value>=0),m=(0,l.computed)(()=>n.value>=0&&n.value<a.value.length?a.value[n.value]:null),v=(0,l.computed)(()=>a.value.map(e=>e.content)),p=()=>{try{const e=localStorage.getItem(t.storageKey);if(e){const t=JSON.parse(e);Array.isArray(t)&&(a.value=t.map(e=>'string'==typeof e?{content:e,timestamp:Date.now()}:e),console.log('[useInputHistory] å·²åŠ è½½å†å²è®°å½•ï¼Œå…±',a.value.length,'æ¡'))}}catch(e){console.error('[useInputHistory] åŠ è½½å†å²è®°å½•å¤±è´¥:',e),a.value=[]}r.value=!0},g=()=>{try{localStorage.setItem(t.storageKey,JSON.stringify(a.value)),console.log('[useInputHistory] å†å²è®°å½•å·²ä¿å­˜')}catch(e){console.error('[useInputHistory] ä¿å­˜å†å²è®°å½•å¤±è´¥:',e)}},f=e=>c.value?(-1===n.value&&(o.value=e),n.value<a.value.length-1?(n.value++,a.value[n.value].content):null):null,h=()=>n.value<0?null:(n.value--,n.value>=0?a.value[n.value].content:o.value),y=()=>{n.value=-1,o.value=''},V=e=>e>=0&&e<a.value.length&&(a.value.splice(e,1),n.value>=e&&n.value>0&&n.value--,t.autoSave&&g(),!0);return(0,l.onMounted)(()=>{p()}),{historyList:a,currentIndex:n,tempInput:o,isInitialized:r,historyCount:s,hasHistory:c,isNavigating:i,canGoBack:u,canGoForward:d,currentHistoryItem:m,historyContents:v,addToHistory:e=>{if(!e||!e.trim())return;const n=e.trim();if(t.deduplicate){const e=a.value.findIndex(e=>e.content===n);e>=0&&a.value.splice(e,1)}a.value.unshift({content:n,timestamp:Date.now()}),a.value.length>t.maxItems&&(a.value=a.value.slice(0,t.maxItems)),y(),t.autoSave&&g(),console.log('[useInputHistory] æ–°è®°å½•å·²æ·»åŠ :',n.slice(0,50)+'...')},navigateBack:f,navigateForward:h,startNavigation:e=>{-1===n.value&&(o.value=e)},resetNavigation:y,handleKeyboardNavigation:(e,t)=>{if('ArrowUp'===e.key&&(!t.trim()||i.value)){const a=f(t);if(null!==a)return e.preventDefault(),a}if('ArrowDown'===e.key&&i.value){const t=h();if(null!==t)return e.preventDefault(),t}if('Escape'===e.key&&i.value){const t=o.value;return y(),e.preventDefault(),t}return null},getHistoryAt:e=>e>=0&&e<a.value.length?a.value[e]:null,removeHistoryAt:V,removeHistoryByContent:e=>{const t=a.value.findIndex(t=>t.content===e);return t>=0&&V(t)},clearHistory:()=>{a.value=[],y(),t.autoSave&&g(),console.log('[useInputHistory] å†å²è®°å½•å·²æ¸…ç©º')},searchHistory:e=>{if(!e||!e.trim())return a.value;const t=e.toLowerCase();return a.value.filter(e=>e.content.toLowerCase().includes(t))},loadFromStorage:p,saveToStorage:g,exportHistory:()=>JSON.stringify(a.value,null,2),importHistory:(e,n=!1)=>{try{const o=JSON.parse(e);if(!Array.isArray(o))throw new Error('æ— æ•ˆçš„å†å²è®°å½•æ ¼å¼');const l=o.map(e=>'string'==typeof e?{content:e,timestamp:Date.now()}:e);return n?(l.forEach(e=>{a.value.some(t=>t.content===e.content)||a.value.push(e)}),a.value.sort((e,t)=>t.timestamp-e.timestamp),a.value.length>t.maxItems&&(a.value=a.value.slice(0,t.maxItems))):a.value=l.slice(0,t.maxItems),t.autoSave&&g(),console.log('[useInputHistory] å†å²è®°å½•å·²å¯¼å…¥'),!0}catch(e){return console.error('[useInputHistory] å¯¼å…¥å†å²è®°å½•å¤±è´¥:',e),!1}},config:t}}(),y=(0,l.ref)(''),V=(0,l.ref)(null),E=(0,l.ref)(!1),b=(0,l.ref)(''),S=(0,l.computed)(()=>y.value.trim().length>0&&!n.isLoading),N=(0,l.computed)(()=>n.isLoading?'AIæ­£åœ¨æ€è€ƒä¸­ï¼Œè¯·ç¨å€™...':u.value?'ä½¿ç”¨ â†‘â†“ å¯¼èˆªå†å²ï¼ŒEsc å–æ¶ˆ':n.placeholder),k=(0,l.computed)(()=>b.value.trim()?h(b.value):r.value),C=()=>{if(!S.value)return;const e=y.value.trim();d(e),o('send',e),y.value='',E.value=!1,(0,l.nextTick)(()=>{V.value&&(V.value.style.height='auto')})},w=e=>{if('Enter'===e.key&&!e.shiftKey)return e.preventDefault(),void C();if('ArrowUp'===e.key&&M()){const t=m(y.value);null!==t&&(e.preventDefault(),y.value=t,(0,l.nextTick)(()=>{V.value&&(V.value.selectionStart=V.value.selectionEnd=y.value.length)}))}if('ArrowDown'===e.key&&u.value&&A()){const t=v();null!==t&&(e.preventDefault(),y.value=t,(0,l.nextTick)(()=>{V.value&&(V.value.selectionStart=V.value.selectionEnd=y.value.length)}))}'Escape'===e.key&&(u.value?(I(),e.preventDefault()):E.value&&(E.value=!1,e.preventDefault()))},M=()=>{if(!V.value)return!0;const e=V.value.selectionStart||0;return!y.value.substring(0,e).includes('\n')},A=()=>{if(!V.value)return!0;const e=V.value.selectionStart||0;return!y.value.substring(e).includes('\n')},I=()=>{p(),y.value=''},D=()=>{if(!V.value)return;V.value.style.height='auto';const e=V.value.scrollHeight;V.value.style.height=Math.min(e,120)+'px'},B=()=>{V.value?.focus()},x=()=>{E.value=!E.value,E.value&&(b.value='')},T=async()=>{await ye('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰å†å²è®°å½•å—ï¼Ÿ','æ¸…ç©ºå†å²')&&(f(),b.value='')},L=e=>{const t=new Date(e),a=new Date,n=a.getTime()-e;return n<6e4?'åˆšåˆš':n<36e5?`${Math.floor(n/6e4)}åˆ†é’Ÿå‰`:n<864e5?`${Math.floor(n/36e5)}å°æ—¶å‰`:t.getFullYear()===a.getFullYear()?`${t.getMonth()+1}/${t.getDate()} ${t.getHours()}:${String(t.getMinutes()).padStart(2,'0')}`:`${t.getFullYear()}/${t.getMonth()+1}/${t.getDate()}`};return t({focus:B,clear:()=>{y.value='',p(),V.value&&(V.value.style.height='auto')},addToHistory:d,clearHistory:f}),(0,l.onMounted)(()=>{B()}),(0,l.watch)(y,(e,t)=>{if(u.value&&e!==t){const t=r.value[s.value];t&&e!==t.content&&p()}}),(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('footer',Se,[(0,l.createCommentVNode)(' å†å²è®°å½•é¢æ¿ '),(0,l.createVNode)(l.Transition,{name:'slide-up'},{default:(0,l.withCtx)(()=>[E.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',Ne,[(0,l.createElementVNode)('div',ke,[t[4]||(t[4]=(0,l.createElementVNode)('span',{class:'history-title'},'ğŸ“œ å†å²è¾“å…¥è®°å½•',-1)),(0,l.createElementVNode)('span',Ce,(0,l.toDisplayString)((0,l.unref)(c))+' æ¡',1),(0,l.createElementVNode)('div',we,[(0,l.unref)(i)?((0,l.openBlock)(),(0,l.createElementBlock)('button',{key:0,class:'history-clear-btn',title:'æ¸…ç©ºå†å²',onClick:T},'ğŸ—‘ï¸')):(0,l.createCommentVNode)('v-if',!0),(0,l.createElementVNode)('button',{class:'history-close-btn',title:'å…³é—­',onClick:t[0]||(t[0]=e=>E.value=!1)},'âœ•')])]),(0,l.createCommentVNode)(' æœç´¢æ¡† '),(0,l.createElementVNode)('div',Me,[(0,l.withDirectives)((0,l.createElementVNode)('input',{'onUpdate:modelValue':t[1]||(t[1]=e=>b.value=e),type:'text',class:'history-search-input',placeholder:'æœç´¢å†å²è®°å½•...'},null,512),[[l.vModelText,b.value]])]),(0,l.createCommentVNode)(' å†å²è®°å½•åˆ—è¡¨ '),(0,l.createElementVNode)('div',Ae,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(k.value,(e,t)=>{return(0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.timestamp,class:(0,l.normalizeClass)(['history-item',{'is-active':t===(0,l.unref)(s)}]),onClick:t=>{return a=e.content,y.value=a,E.value=!1,p(),B(),void(0,l.nextTick)(()=>{D()});var a}},[(0,l.createElementVNode)('span',De,(0,l.toDisplayString)((a=e.content,n=80,a.length<=n?a:a.substring(0,n)+'...')),1),(0,l.createElementVNode)('span',Be,(0,l.toDisplayString)(L(e.timestamp)),1),(0,l.createElementVNode)('button',{class:'history-delete-btn',title:'åˆ é™¤',onClick:(0,l.withModifiers)(e=>(e=>{g(e)})(t),['stop'])},'âœ•',8,xe)],10,Ie);var a,n}),128)),0===k.value.length?((0,l.openBlock)(),(0,l.createElementBlock)('div',_e,(0,l.toDisplayString)(b.value?'æœªæ‰¾åˆ°åŒ¹é…çš„è®°å½•':'æš‚æ— å†å²è®°å½•'),1)):(0,l.createCommentVNode)('v-if',!0)])])):(0,l.createCommentVNode)('v-if',!0)]),_:1}),(0,l.createCommentVNode)(' è¾“å…¥åŒºåŸŸ '),(0,l.createElementVNode)('div',Te,[(0,l.createElementVNode)('div',{class:(0,l.normalizeClass)(['input-container',{'is-loading':e.isLoading,'has-error':!!e.error}])},[(0,l.createCommentVNode)(' å†å²è®°å½•æŒ‰é’® '),(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['history-toggle-btn',{'has-history':(0,l.unref)(i),'is-active':E.value}]),title:(0,l.unref)(i)?`å†å²è®°å½• (${(0,l.unref)(c)})`:'æš‚æ— å†å²è®°å½•',onClick:x},[...t[5]||(t[5]=[(0,l.createElementVNode)('span',{class:'history-icon'},'ğŸ“œ',-1)])],10,$e),(0,l.withDirectives)((0,l.createElementVNode)('textarea',{ref_key:'inputRef',ref:V,'onUpdate:modelValue':t[2]||(t[2]=e=>y.value=e),class:'message-input',placeholder:N.value,disabled:e.isLoading,rows:'1',onKeydown:w,onInput:D},null,40,Le),[[l.vModelText,y.value]]),(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['send-btn',{'is-loading':e.isLoading}]),disabled:!S.value,title:e.isLoading?'æ­£åœ¨ç”Ÿæˆ...':'å‘é€æ¶ˆæ¯ (Enter)',onClick:C},[e.isLoading?((0,l.openBlock)(),(0,l.createElementBlock)('span',Re,'â³')):((0,l.openBlock)(),(0,l.createElementBlock)('span',Ue,'ğŸ“¤'))],10,Oe)],2),(0,l.createCommentVNode)(' å†å²å¯¼èˆªæç¤º '),(0,l.unref)(u)?((0,l.openBlock)(),(0,l.createElementBlock)('div',je,[t[6]||(t[6]=(0,l.createElementVNode)('span',{class:'hint-icon'},'â¬†ï¸â¬‡ï¸',-1)),(0,l.createElementVNode)('span',Pe,(0,l.toDisplayString)((0,l.unref)(s)+1)+'/'+(0,l.toDisplayString)((0,l.unref)(c)),1),(0,l.createElementVNode)('button',{class:'hint-cancel',title:'å–æ¶ˆ (Esc)',onClick:I},'âœ•')])):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' é”™è¯¯æç¤º '),e.error?((0,l.openBlock)(),(0,l.createElementBlock)('div',ze,[t[7]||(t[7]=(0,l.createElementVNode)('span',{class:'error-icon'},'âš ï¸',-1)),(0,l.createElementVNode)('span',Fe,(0,l.toDisplayString)(e.error),1),(0,l.createElementVNode)('button',{class:'error-dismiss',onClick:t[3]||(t[3]=t=>e.$emit('clearError'))},'âœ•')])):(0,l.createCommentVNode)('v-if',!0)])]))}}),We=(0,M.A)(He,[['__scopeId','data-v-1712b424']]);function Ge(){try{if('undefined'!=typeof window&&window.Mvu)return window.Mvu}catch{}return null}const Je={isMvuAvailable(){const e=Ge();return!(!e||'function'!=typeof e.getMvuData)},getMvuData(e){try{const t=Ge();return t&&t.getMvuData(e||{type:'message',message_id:'latest'})||null}catch(e){return console.error('[MvuService] è·å–MVUæ•°æ®å¤±è´¥:',e),null}},getVariable(e,t){try{const a=Ge();if(!a)return t?.default_value;const n=this.getMvuData(t);return n?a.getMvuVariable(n,e,{category:'stat',default_value:t?.default_value}):t?.default_value}catch(e){return console.error('[MvuService] è·å–å˜é‡å¤±è´¥:',e),t?.default_value}},async setVariable(e,t,a){try{const n=Ge();if(!n)return console.error('[MvuService] è®¾ç½®å˜é‡å¤±è´¥: Mvu å¯¹è±¡ä¸å¯ç”¨'),!1;const o=this.getMvuData(a);if(!o)return console.error('[MvuService] è®¾ç½®å˜é‡å¤±è´¥: æ— æ³•è·å– MvuData'),!1;o.stat_data||(console.warn('[MvuService] stat_data ä¸ºç©ºï¼Œåˆå§‹åŒ–ä¸ºç©ºå¯¹è±¡'),o.stat_data={}),o.display_data||(o.display_data={}),console.log('[MvuService] å°è¯•è®¾ç½®å˜é‡:',{path:e,valueType:typeof t,valuePreview:'object'==typeof t?JSON.stringify(t).substring(0,100)+'...':t,stat_data_keys:Object.keys(o.stat_data||{})});let l=!1;try{l=await n.setMvuVariable(o,e,t,{reason:a?.reason,is_recursive:!0})}catch(e){console.warn('[MvuService] MVUåŸç”ŸAPIè°ƒç”¨å¼‚å¸¸:',e),l=!1}if(!l){console.log('[MvuService] MVUåŸç”ŸAPIå¤±è´¥ï¼Œå°è¯•ç›´æ¥è®¾ç½® stat_data...');try{o.stat_data||(console.warn('[MvuService] stat_data åœ¨ API è°ƒç”¨åå˜ä¸ºç©ºï¼Œé‡æ–°åˆå§‹åŒ–'),o.stat_data={});const n=e.split('.');if(n.length>1){let e=o.stat_data;for(let t=0;t<n.length-1;t++){const a=n[t];if(void 0===e[a]||null===e[a])console.log(`[MvuService] åˆ›å»ºä¸­é—´è·¯å¾„: ${n.slice(0,t+1).join('.')}`),e[a]={};else if('object'!=typeof e[a])return console.warn(`[MvuService] è·¯å¾„ "${n.slice(0,t+1).join('.')}" ä¸æ˜¯å¯¹è±¡ï¼Œæ— æ³•ç»§ç»­`),!1;e=e[a]}}this.setNestedValue(o.stat_data,e,t),o.display_data||(o.display_data={});const r=a?.reason?`æ–°å»º (${a.reason})`:'æ–°å»º';try{this.setNestedValue(o.display_data,e,r)}catch(e){console.warn('[MvuService] è®¾ç½® display_data å¤±è´¥:',e)}l=!0,console.log('[MvuService] ç›´æ¥è®¾ç½® stat_data æˆåŠŸ')}catch(e){console.error('[MvuService] ç›´æ¥è®¾ç½® stat_data å¤±è´¥:',e),l=!1}}if(l)try{await n.replaceMvuData(o,a||{type:'message',message_id:'latest'}),console.log('[MvuService] æ•°æ®å·²æ›¿æ¢ä¿å­˜')}catch(e){return console.error('[MvuService] æ›¿æ¢æ•°æ®å¤±è´¥:',e),!1}else console.error('[MvuService] å˜é‡è®¾ç½®å¤±è´¥');return l}catch(e){return console.error('[MvuService] è®¾ç½®å˜é‡å¤±è´¥:',e),!1}},setNestedValue(e,t,a){if(null==e)throw new Error(`[setNestedValue] ç›®æ ‡å¯¹è±¡ä¸º ${e}ï¼Œæ— æ³•è®¾ç½®è·¯å¾„ "${t}"`);if('object'!=typeof e)throw new Error(`[setNestedValue] ç›®æ ‡å¯¹è±¡ä¸æ˜¯å¯¹è±¡ç±»å‹ï¼Œæ— æ³•è®¾ç½®è·¯å¾„ "${t}"`);const n=t.split('.');let o=e;for(let e=0;e<n.length-1;e++){const t=n[e];if(null==o||'object'!=typeof o)throw new Error(`[setNestedValue] è·¯å¾„ "${n.slice(0,e).join('.')}" å¤„çš„å€¼ä¸æ˜¯å¯¹è±¡ï¼Œæ— æ³•ç»§ç»­è®¾ç½®`);t in o&&'object'==typeof o[t]&&null!==o[t]||(o[t]={}),o=o[t]}o[n[n.length-1]]=a},async setVariables(e,t){try{const a=Ge();if(!a)return!1;const n=this.getMvuData(t);if(!n)return!1;for(const[o,l]of Object.entries(e))await a.setMvuVariable(n,o,l,{reason:t?.reason,is_recursive:!1});return await a.replaceMvuData(n,t||{type:'message',message_id:'latest'}),!0}catch(e){return console.error('[MvuService] æ‰¹é‡è®¾ç½®å˜é‡å¤±è´¥:',e),!1}},getAllVariableKeys(e){try{const t=this.getMvuData(e);return t?Object.keys(t.stat_data||{}):[]}catch{return[]}},getEvents(){const e=Ge();return e?.events||null}},Ke=t('mvu',()=>{const e=(0,l.shallowRef)(null),t=(0,l.ref)(!1),a=(0,l.ref)(!1),n=(0,l.ref)(null),o=(0,l.ref)({type:'message',message_id:'latest'}),r=(0,l.ref)([]),s=(0,l.ref)([]),c=(0,l.ref)(!1),i=(0,l.ref)(!1),u=t=>{if(console.log('[MvuStore] å˜é‡æ›´æ–°å¼€å§‹'),t)try{e.value=JSON.parse(JSON.stringify(t))}catch(a){e.value=t}},d=(e,t,a,n)=>{console.log(`[MvuStore] å˜é‡æ›´æ–°: ${t}`,{oldValue:a,newValue:n}),r.value.forEach(e=>{if(t===e.path||t.startsWith(e.path+'.'))try{e.callback(a,n)}catch(t){console.error(`[MvuStore] å˜é‡ç›‘å¬å™¨å›è°ƒå¤±è´¥ (${e.path}):`,t)}})},m=['MC'],v=(e,t)=>t.split('.').reduce((e,t)=>e&&'object'==typeof e?e[t]:void 0,e),p=t=>{if(console.log('[MvuStore] å˜é‡æ›´æ–°ç»“æŸäº‹ä»¶è§¦å‘'),i.value)return void console.log('[MvuStore] æ­£åœ¨æ‰§è¡Œå†…éƒ¨æ›´æ–°ï¼Œè·³è¿‡äº‹ä»¶å¤„ç†ï¼ˆé¿å…æ•°æ®è¦†ç›–ï¼‰');const a=Je.getMvuData(o.value);if(!a)return void console.warn('[MvuStore] è·å–åˆ°çš„æœ€æ–°æ•°æ®ä¸ºç©ºï¼Œä¿æŒç°æœ‰æ•°æ®ä¸å˜');if(!((e,t)=>{if(!e?.stat_data)return!0;const a=Object.keys(e.stat_data),n=Object.keys(t.stat_data||{});if(a.length>0&&n.length<.5*a.length)return console.warn('[MvuStore] æ•°æ®éªŒè¯å¤±è´¥ï¼šé”®æ•°é‡å‡å°‘è¿‡å¤š',{oldCount:a.length,newCount:n.length}),!1;for(const a of m){const n=v(e.stat_data,a),o=v(t.stat_data||{},a);if(void 0!==n&&void 0===o)return console.warn('[MvuStore] æ•°æ®éªŒè¯å¤±è´¥ï¼šå…³é”®è·¯å¾„ä¸¢å¤±',a),!1}return!0})(e.value,a))return void console.warn('[MvuStore] æ•°æ®éªŒè¯å¤±è´¥ï¼Œä¿æŒç°æœ‰æ•°æ®ä¸å˜');const n=Object.keys(a.stat_data||{});try{e.value=JSON.parse(JSON.stringify(a)),console.log('[MvuStore] å·²ä» MVU API è·å–æœ€æ–°æ•°æ®ï¼Œstat_data é”®:',n)}catch(t){e.value=a}g()},g=()=>{e.value&&s.value.forEach(t=>{try{t(e.value)}catch(e){console.error('[MvuStore] æ›´æ–°ç»“æŸç›‘å¬å™¨å›è°ƒå¤±è´¥:',e)}})},f=(0,l.computed)(()=>e.value?.stat_data||{}),h=(0,l.computed)(()=>e.value?.display_data||{}),y=(0,l.computed)(()=>e.value?.delta_data||{}),V=(0,l.computed)(()=>e.value?.initialized_lorebooks||[]),E=(0,l.computed)(()=>e.value?Je.getAllVariableKeys(o.value):[]),b=()=>{if(c.value)return;const e=function(){try{if('undefined'!=typeof window&&'function'==typeof window.eventOn)return window.eventOn}catch{}return null}(),t=Je.getEvents();if(e&&t)try{e(t.VARIABLE_UPDATE_STARTED,u),e(t.SINGLE_VARIABLE_UPDATED,d),e(t.VARIABLE_UPDATE_ENDED,p),c.value=!0,console.log('[MvuStore] å·²æ³¨å†Œ MVU äº‹ä»¶ç›‘å¬')}catch(e){console.error('[MvuStore] æ³¨å†Œäº‹ä»¶ç›‘å¬å¤±è´¥:',e)}else console.warn('[MvuStore] æ— æ³•æ³¨å†Œäº‹ä»¶ç›‘å¬ï¼ševentOn æˆ– Mvu.events ä¸å¯ç”¨')},S=()=>{if(!c.value)return;const e=function(){try{if('undefined'!=typeof window&&'function'==typeof window.eventOff)return window.eventOff}catch{}return null}(),t=Je.getEvents();if(e&&t)try{e(t.VARIABLE_UPDATE_STARTED,u),e(t.SINGLE_VARIABLE_UPDATED,d),e(t.VARIABLE_UPDATE_ENDED,p),c.value=!1,console.log('[MvuStore] å·²å–æ¶ˆ MVU äº‹ä»¶ç›‘å¬')}catch(e){console.error('[MvuStore] å–æ¶ˆäº‹ä»¶ç›‘å¬å¤±è´¥:',e)}},N=async l=>{try{a.value=!0,n.value=null,l&&(o.value=l),console.log('[MvuStore] ç­‰å¾…MVUæ¡†æ¶åŠ è½½...');const r=await(async(e=3e3,t=100)=>{const a=Date.now();for(;Date.now()-a<e;){if(Je.isMvuAvailable())return!0;await new Promise(e=>setTimeout(e,t))}return Je.isMvuAvailable()})();if(t.value=r,!t.value)return console.warn('[MvuStore] MVUå˜é‡æ¡†æ¶æœªåŠ è½½ï¼Œä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®'),e.value={stat_data:{},display_data:{},delta_data:{},initialized_lorebooks:[]},void w();console.log('[MvuStore] MVUæ¡†æ¶å·²å°±ç»ªï¼Œå¼€å§‹åˆå§‹åŒ–...'),await M(),await A(),console.log('[MvuStore] åˆå§‹åŒ–å®Œæˆ')}catch(e){n.value=e instanceof Error?e.message:'åˆå§‹åŒ–å¤±è´¥',console.error('[MvuStore] åˆå§‹åŒ–å¤±è´¥:',e),w()}finally{a.value=!1}};let k=0,C=null;const w=()=>{if(k>=3)return void console.warn('[MvuStore] å·²è¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°ï¼Œåœæ­¢é‡è¯•');C&&clearTimeout(C),k++;const e=500*k;console.log(`[MvuStore] å°†åœ¨ ${e}ms åè¿›è¡Œç¬¬ ${k} æ¬¡é‡è¯•...`),C=setTimeout(async()=>{if(Je.isMvuAvailable()&&!t.value){console.log('[MvuStore] MVUæ¡†æ¶ç°åœ¨å¯ç”¨ï¼Œé‡æ–°åˆå§‹åŒ–...'),t.value=!0;try{await M(),await A(),console.log('[MvuStore] é‡è¯•åˆå§‹åŒ–æˆåŠŸ'),k=0}catch(e){console.error('[MvuStore] é‡è¯•åˆå§‹åŒ–å¤±è´¥:',e),w()}}else Je.isMvuAvailable()||(console.log('[MvuStore] MVUæ¡†æ¶ä»ä¸å¯ç”¨ï¼Œç»§ç»­ç­‰å¾…...'),w())},e)},M=async()=>{for(let e=0;e<3;e++){if(b(),c.value)return;console.log(`[MvuStore] äº‹ä»¶ç›‘å¬å™¨æ³¨å†Œå¤±è´¥ï¼Œé‡è¯• ${e+1}/3...`),await new Promise(e=>setTimeout(e,500))}console.warn('[MvuStore] äº‹ä»¶ç›‘å¬å™¨æ³¨å†Œæœ€ç»ˆå¤±è´¥ï¼Œéƒ¨åˆ†åŠŸèƒ½å¯èƒ½ä¸å¯ç”¨')},A=async()=>{let t=null;for(let a=0;a<3;a++){try{if(await I(),e.value&&e.value.stat_data)return;console.log(`[MvuStore] æ•°æ®åŠ è½½ä¸å®Œæ•´ï¼Œé‡è¯• ${a+1}/3...`)}catch(e){t=e instanceof Error?e:new Error(String(e)),console.warn(`[MvuStore] åŠ è½½æ•°æ®å¤±è´¥ï¼Œé‡è¯• ${a+1}/3:`,e)}await new Promise(e=>setTimeout(e,500))}if(t)throw t},I=async()=>{try{a.value=!0,n.value=null;const t=Je.getMvuData(o.value);e.value=t?JSON.parse(JSON.stringify(t)):null,console.log('[MvuStore] åŠ è½½MVUæ•°æ®å®Œæˆ:',{hasData:!!t,stat_data_keys:e.value?Object.keys(e.value.stat_data||{}):[],has_è§„ç« åˆ¶åº¦:void 0!==e.value?.stat_data?.['è§„ç« åˆ¶åº¦'],è§„ç« åˆ¶åº¦_type:e.value?.stat_data?.['è§„ç« åˆ¶åº¦']?typeof e.value.stat_data['è§„ç« åˆ¶åº¦']:'undefined',è§„ç« åˆ¶åº¦_keys:e.value?.stat_data?.['è§„ç« åˆ¶åº¦']?Object.keys(e.value.stat_data['è§„ç« åˆ¶åº¦']):[]})}catch(e){n.value=e instanceof Error?e.message:'åŠ è½½MVUæ•°æ®å¤±è´¥',console.error('[MvuStore] åŠ è½½MVUæ•°æ®å¤±è´¥:',e)}finally{a.value=!1}},D=(t,a)=>{try{const n=Je.getVariable(t,{...o.value,default_value:a});if(void 0!==n)return n;const l=t.split('.').reduce((e,t)=>e&&'object'==typeof e?e[t]:void 0,e.value?.stat_data);return void 0!==l?l:a}catch(e){return n.value=e instanceof Error?e.message:'è·å–å˜é‡å¤±è´¥',console.error(`[MvuStore] getVariable("${t}") å¤±è´¥:`,e),a}},B=async(e,t,a)=>{try{n.value=null;const l=await Je.setVariable(e,t,{...o.value,reason:a});return l&&await I(),l}catch(e){return n.value=e instanceof Error?e.message:'è®¾ç½®å˜é‡å¤±è´¥',!1}},x=e=>(s.value.push(e),()=>{const t=s.value.indexOf(e);t>-1&&s.value.splice(t,1)}),T=async(e=5e3,t=200)=>{const a=Date.now();let n=null;for(console.log('[MvuStore] ç­‰å¾… MVU æ•°æ®å‡†å¤‡å°±ç»ª...');Date.now()-a<e;){if(!Je.isMvuAvailable()){await new Promise(e=>setTimeout(e,t));continue}const e=Je.getMvuData(o.value),a=e?JSON.stringify(Object.keys(e.stat_data||{})):'null';if(e&&e.stat_data&&Object.keys(e.stat_data).length>0){if(a===n)return console.log('[MvuStore] MVU æ•°æ®å·²ç¨³å®šï¼Œé”®:',Object.keys(e.stat_data)),!0;n=a}await new Promise(e=>setTimeout(e,t))}return console.warn('[MvuStore] ç­‰å¾… MVU æ•°æ®è¶…æ—¶ï¼Œå°è¯•ç»§ç»­åˆå§‹åŒ–...'),Je.isMvuAvailable()},L=e=>{if(!e||'string'!=typeof e)return null;const t=[...e.matchAll(/<UpdateVariable>([\s\S]*?)<\/UpdateVariable>/gi)];return t.length>0?t[t.length-1][1].trim():null},O=e=>{const t=[];if(!e||'string'!=typeof e)return t;const a=e.split('\n');let n,o='',l=0,r=0,s=!1,c='';for(let e=0;e<a.length;e++){const i=a[e].trim();if(!i)continue;if(i.startsWith('//')){n=i.slice(2).trim();continue}o+=(o?'\n':'')+i;for(let e=0;e<i.length;e++){const t=i[e],a=e>0?i[e-1]:'';'"'!==t&&'\''!==t||'\\'===a?s||('{'===t?l++:'}'===t?l--:'['===t?r++:']'===t&&r--):s?t===c&&(s=!1):(s=!0,c=t)}const u=o.trim();if(0===l&&0===r&&(u.endsWith(');')||u.endsWith(')'))){const e=R(o,n);e&&t.push(e),o='',n=void 0,l=0,r=0,s=!1}}if(o.trim()){const e=R(o,n);e&&t.push(e)}return t},R=(e,t)=>{if(!e||'string'!=typeof e)return null;let a=e.trim();a.endsWith(';')&&(a=a.slice(0,-1).trim());const n=U(a);if(n>-1){const e=a.slice(n+2).trim();!t&&e&&(t=e),a=a.slice(0,n).trim()}if(!a)return null;const o=a.match(/^_\.(set|assign|add|remove)\s*\(\s*([\s\S]*)\s*\)$/i);if(o)return j(o[1].toLowerCase(),o[2],t);const l=a.match(/^(SET|ADD|SUB|MUL|DIV|APPEND|REMOVE|CLEAR|TOGGLE|INIT)\s*\(\s*([\s\S]*)\s*\)$/i);return l?P(l[1].toUpperCase(),l[2],t):(console.warn('[MvuStore] æ— æ³•è§£æå‘½ä»¤:',a.substring(0,100)+(a.length>100?'...':'')),null)},U=e=>{let t=!1,a='',n=-1;for(let o=0;o<e.length-1;o++){const l=e[o],r=e[o+1],s=o>0?e[o-1]:'';'"'!==l&&'\''!==l||'\\'===s?t||'/'!==l||'/'!==r||(n=o):t?l===a&&(t=!1):(t=!0,a=l)}return n},j=(e,t,a)=>{const n=F(t);if(n.length<1)return console.warn('[MvuStore] lodashå‘½ä»¤å‚æ•°ä¸è¶³:',e,t.substring(0,50)),null;const o='string'==typeof n[0]?n[0]:String(n[0]);switch(e){case'set':return{type:'SET',path:o,value:n.length>=3?n[2]:n[1],comment:a};case'assign':{if(n.length<3)return console.warn('[MvuStore] _.assignéœ€è¦3ä¸ªå‚æ•°:',t.substring(0,50)),null;const e='string'==typeof n[1]?n[1]:String(n[1]);return{type:'ASSIGN',path:`${o}.${e}`,parentPath:o,key:e,value:n[2],comment:a}}case'add':{const e=n.length>=2?n[1]:1;return{type:'ADD',path:o,value:'number'==typeof e?e:parseFloat(e)||1,comment:a}}case'remove':return n.length>=2?{type:'REMOVE',path:o,value:n[1],comment:a}:{type:'CLEAR',path:o,comment:a};default:return console.warn('[MvuStore] æœªçŸ¥çš„lodashæ–¹æ³•:',e),null}},P=(e,t,a)=>{const n=F(t);if(n.length<1)return console.warn('[MvuStore] å‘½ä»¤å‚æ•°ä¸è¶³:',e),null;return{type:e,path:'string'==typeof n[0]?n[0]:String(n[0]),value:n.length>=2?n[1]:void 0,comment:a}},F=e=>{const t=[];let a='',n=0,o=0,l=!1,r='';const s=e.trim();for(let e=0;e<s.length;e++){const c=s[e],i=e>0?s[e-1]:'';if('"'!==c&&'\''!==c||'\\'===i)if(l)a+=c;else if('{'!==c)if('}'!==c)if('['!==c)if(']'!==c){if(','===c&&0===n&&0===o){const e=a.trim();e&&t.push(H(e)),a='';continue}a+=c}else o--,a+=c;else o++,a+=c;else n--,a+=c;else n++,a+=c;else l?c===r&&(l=!1):(l=!0,r=c),a+=c}const c=a.trim();return c&&t.push(H(c)),t},H=e=>{const t=e.trim();if(t){if('null'===t)return null;if('true'===t)return!0;if('false'===t)return!1;if(/^-?\d+(\.\d+)?$/.test(t))return parseFloat(t);if(t.startsWith('\'')&&t.endsWith('\'')||t.startsWith('"')&&t.endsWith('"'))return t.slice(1,-1);if(t.startsWith('{')&&t.endsWith('}')||t.startsWith('[')&&t.endsWith(']'))try{return JSON.parse(t)}catch{try{const e=t.replace(/'/g,'"');return JSON.parse(e)}catch{return console.warn('[MvuStore] JSONè§£æå¤±è´¥:',t.substring(0,100)),t}}return t}},W=async e=>{try{const{type:t,path:a,value:n,parentPath:l}=e;let r,s;switch(console.log('[MvuStore] æ‰§è¡Œå‘½ä»¤:',{type:t,path:a,valueType:typeof n,valuePreview:'object'==typeof n?JSON.stringify(n).substring(0,200)+'...':n}),'SET'!==t&&'INIT'!==t&&'ASSIGN'!==t&&(r=D(a)),t){case'SET':case'INIT':s=n;break;case'ASSIGN':if(l){console.log(`[MvuStore] ASSIGN æ“ä½œï¼šç¡®ä¿çˆ¶è·¯å¾„ "${l}" å­˜åœ¨...`);await(async e=>{try{const t=Ge();if(!t)return!1;const a=Je.getMvuData(o.value);if(!a)return!1;a.stat_data||(a.stat_data={});const n=e.split('.');let l=a.stat_data;for(let e=0;e<n.length;e++){const t=n[e];if(void 0===l[t]||null===l[t])console.log(`[MvuStore] åˆ›å»ºè·¯å¾„: ${n.slice(0,e+1).join('.')}`),l[t]={};else if('object'!=typeof l[t])return console.warn(`[MvuStore] è·¯å¾„ "${n.slice(0,e+1).join('.')}" ä¸æ˜¯å¯¹è±¡ï¼Œæ— æ³•åˆ›å»ºå­è·¯å¾„`),!1;l=l[t]}return await t.replaceMvuData(a,o.value),await I(),!0}catch(e){return console.error('[MvuStore] ç¡®ä¿è·¯å¾„å­˜åœ¨å¤±è´¥:',e),!1}})(l)||console.warn(`[MvuStore] æ— æ³•åˆ›å»ºçˆ¶è·¯å¾„ "${l}"ï¼Œå°è¯•ç›´æ¥è®¾ç½®å®Œæ•´è·¯å¾„...`)}s=n;break;case'ADD':if('number'!=typeof r||'number'!=typeof n)return{success:!1,command:e,error:'ADDæ“ä½œéœ€è¦æ•°å€¼ç±»å‹'};s=r+n;break;case'SUB':if('number'!=typeof r||'number'!=typeof n)return{success:!1,command:e,error:'SUBæ“ä½œéœ€è¦æ•°å€¼ç±»å‹'};s=r-n;break;case'MUL':if('number'!=typeof r||'number'!=typeof n)return{success:!1,command:e,error:'MULæ“ä½œéœ€è¦æ•°å€¼ç±»å‹'};s=r*n;break;case'DIV':if('number'!=typeof r||'number'!=typeof n)return{success:!1,command:e,error:'DIVæ“ä½œéœ€è¦æ•°å€¼ç±»å‹'};if(0===n)return{success:!1,command:e,error:'DIVæ“ä½œä¸èƒ½é™¤ä»¥é›¶'};s=r/n;break;case'APPEND':if(Array.isArray(r))s=[...r,n];else{if('string'!=typeof r||'string'!=typeof n)return{success:!1,command:e,error:'APPENDæ“ä½œéœ€è¦æ•°ç»„æˆ–å­—ç¬¦ä¸²ç±»å‹'};s=r+n}break;case'REMOVE':if(!Array.isArray(r))return{success:!1,command:e,error:'REMOVEæ“ä½œéœ€è¦æ•°ç»„ç±»å‹'};s=r.filter(e=>e!==n);break;case'CLEAR':s=Array.isArray(r)?[]:'object'==typeof r&&null!==r?{}:'string'==typeof r?'':'number'==typeof r?0:null;break;case'TOGGLE':if('boolean'!=typeof r)return{success:!1,command:e,error:'TOGGLEæ“ä½œéœ€è¦å¸ƒå°”ç±»å‹'};s=!r;break;default:return{success:!1,command:e,error:`æœªçŸ¥çš„å‘½ä»¤ç±»å‹: ${t}`}}const c=await B(a,s,e.comment||`${t}æ“ä½œ`);return{success:c,command:e,oldValue:r,newValue:s,error:c?void 0:'è®¾ç½®å˜é‡å¤±è´¥'}}catch(t){return{success:!1,command:e,error:t instanceof Error?t.message:'æ‰§è¡Œå‘½ä»¤å¤±è´¥'}}};let G=0;return{mvuData:e,isMvuAvailable:t,isLoading:a,error:n,currentOptions:o,statData:f,displayData:h,deltaData:y,initializedLorebooks:V,allVariableKeys:E,initialize:N,loadMvuData:I,refresh:async()=>{await I()},getVariable:D,setVariable:B,setVariables:async(e,t)=>{try{n.value=null;const a=await Je.setVariables(e,{...o.value,reason:t});return a&&await I(),a}catch(e){return n.value=e instanceof Error?e.message:'æ‰¹é‡è®¾ç½®å˜é‡å¤±è´¥',!1}},updateVariable:async(e,t,a)=>{try{n.value=null;const o=t(D(e));return await B(e,o,a)}catch(e){return n.value=e instanceof Error?e.message:'æ›´æ–°å˜é‡å¤±è´¥',!1}},watchVariable:(e,t)=>{const a={path:e,callback:t};return r.value.push(a),()=>{const e=r.value.indexOf(a);e>-1&&r.value.splice(e,1)}},onUpdateEnd:x,switchOptions:async e=>{o.value=e,await I()},clearError:()=>{n.value=null},onChatSwitch:async()=>{console.log('[MvuStore] æ£€æµ‹åˆ°èŠå¤©åˆ‡æ¢ï¼Œé‡æ–°åˆå§‹åŒ–...'),e.value=null,n.value=null,a.value=!0,await T(),t.value&&await N(o.value),a.value=!1},destroy:()=>{S(),r.value=[],s.value=[]},registerEventListeners:b,unregisterEventListeners:S,extractUpdateVariableContent:L,parseCommand:e=>{const t=O(e);return t.length>0?t[0]:null},executeCommand:W,parseAndExecuteCommands:async t=>{const a=[];i.value=!0;try{const l=L(t);if(!l)return{success:!0,results:a,error:'æœªæ‰¾åˆ°UpdateVariableæ ‡ç­¾'};console.log('[MvuStore] æå–åˆ°UpdateVariableå†…å®¹ï¼Œé•¿åº¦:',l.length);const r=e.value?JSON.parse(JSON.stringify(e.value)):null,s=await(async t=>{const a=Ge();if(!a)return console.warn('[MvuStore] ensureBasicStructure: MVUå…¨å±€å¯¹è±¡ä¸å¯ç”¨'),!1;let l=t||e.value;l||(l=Je.getMvuData(o.value)),l||(console.log('[MvuStore] åˆ›å»ºæ–°çš„ MVU æ•°æ®ç»“æ„...'),l={stat_data:{},display_data:{},delta_data:{},initialized_lorebooks:[]}),l.stat_data||(l.stat_data={});const r=l.stat_data.MC;if(r&&'object'==typeof r&&Object.keys(r).length>0)return console.log('[MvuStore] MC å¯¹è±¡å·²å­˜åœ¨ï¼Œè·³è¿‡åˆå§‹åŒ–'),!0;if(!r||'object'!=typeof r){console.log('[MvuStore] åˆå§‹åŒ–ç©ºçš„ MC å¯¹è±¡...'),l.stat_data.MC={};try{return await a.replaceMvuData(l,o.value),e.value=JSON.parse(JSON.stringify(l)),console.log('[MvuStore] MC åŸºç¡€ç»“æ„åˆå§‹åŒ–å®Œæˆ'),!0}catch(e){return console.error('[MvuStore] ä¿å­˜ MC åŸºç¡€ç»“æ„å¤±è´¥:',e),n.value='åˆå§‹åŒ–åŸºç¡€ç»“æ„å¤±è´¥: '+(e instanceof Error?e.message:String(e)),!1}}return!0})(r);s||console.warn('[MvuStore] åŸºç¡€ç»“æ„åˆå§‹åŒ–å¤±è´¥ï¼Œå°è¯•ç»§ç»­æ‰§è¡Œå‘½ä»¤...');const c=e.value?JSON.parse(JSON.stringify(e.value)):null,i=Ge();if(i&&'function'==typeof i.parseMessage&&(console.log('[MvuStore] å°è¯•ä½¿ç”¨ MVU åŸç”Ÿ parseMessage è§£æ...'),c))try{const t=JSON.parse(JSON.stringify(c));console.log('[MvuStore] parseMessage ä½¿ç”¨çš„æ•°æ®ï¼Œstat_data é”®:',Object.keys(t.stat_data||{})),await(async(e,t)=>{const a=(e=>{const t=[],a=/_\.assign\s*\(\s*['"]([^'"]+)['"]/gi;let n;for(;null!==(n=a.exec(e));){const e=n[1];e&&!t.includes(e)&&t.push(e)}return t})(e);if(0===a.length)return;console.log('[MvuStore] å‘ç° _.assign å‘½ä»¤ï¼Œéœ€è¦ç¡®ä¿ä»¥ä¸‹çˆ¶è·¯å¾„å­˜åœ¨:',a),t.stat_data||(t.stat_data={});let n=!1;for(const e of a){const a=e.split('.');let o=t.stat_data;for(let e=0;e<a.length;e++){const t=a[e];if(void 0===o[t]||null===o[t])console.log(`[MvuStore] åˆ›å»ºç¼ºå¤±è·¯å¾„: ${a.slice(0,e+1).join('.')}`),o[t]={},n=!0;else if('object'!=typeof o[t]){console.warn(`[MvuStore] è·¯å¾„ "${a.slice(0,e+1).join('.')}" ä¸æ˜¯å¯¹è±¡ï¼Œè·³è¿‡`);break}o=o[t]}}if(n){const e=Ge();if(e)try{await e.replaceMvuData(t,o.value),console.log('[MvuStore] å·²ä¿å­˜åˆ›å»ºçš„è·¯å¾„ç»“æ„')}catch(e){console.error('[MvuStore] ä¿å­˜è·¯å¾„ç»“æ„å¤±è´¥:',e)}}})(l,t);const a=await i.parseMessage(l,t);if(a){const n=Object.keys(a.stat_data||{}),l=Object.keys(t.stat_data||{});if(console.log('[MvuStore] parseMessage ç»“æœéªŒè¯:',{oldKeys:l.length,newKeys:n.length}),l.length>0&&0===n.length)throw console.warn('[MvuStore] parseMessage è¿”å›çš„æ•°æ®ä¸¢å¤±äº†æ‰€æœ‰é”®ï¼Œå°è¯•æ¢å¤...'),r&&(e.value=r),new Error('parseMessage è¿”å›æ•°æ®ä¸å®Œæ•´');return await i.replaceMvuData(a,o.value),e.value=JSON.parse(JSON.stringify(a)),console.log('[MvuStore] MVU parseMessage æ‰§è¡ŒæˆåŠŸï¼Œæœ¬åœ°ç¼“å­˜å·²æ›´æ–°'),console.log('[MvuStore] æ›´æ–°åçš„ stat_data é”®:',Object.keys(a.stat_data||{})),g(),{success:!0,results:[{success:!0,command:{type:'SET',path:'MVU_NATIVE',value:null}}],error:void 0}}console.log('[MvuStore] MVU parseMessage è¿”å› undefinedï¼Œå°è¯•è‡ªå®šä¹‰è§£æ...')}catch(e){console.warn('[MvuStore] MVU parseMessage å¤±è´¥ï¼Œå›é€€åˆ°è‡ªå®šä¹‰è§£æ:',e)}console.log('[MvuStore] ä½¿ç”¨è‡ªå®šä¹‰è§£æå™¨...');const u=O(l);console.log('[MvuStore] è§£æåˆ°',u.length,'æ¡å‘½ä»¤');for(const e of u){const t=await W(e);a.push(t),t.success?console.log(`[MvuStore] å‘½ä»¤æ‰§è¡ŒæˆåŠŸ: ${e.type}('${e.path}')`):console.warn(`[MvuStore] å‘½ä»¤æ‰§è¡Œå¤±è´¥: ${e.type}('${e.path}') - ${t.error}`)}const d=a.every(e=>e.success),m=a.filter(e=>e.success).length,v=a.length-m,p=Je.getMvuData(o.value);if(p){const t=Object.keys(p.stat_data||{});Object.keys(e.value?.stat_data||{}).length>0&&0===t.length?console.warn('[MvuStore] æœ€æ–°æ•°æ®ä¸¢å¤±äº†æ‰€æœ‰é”®ï¼Œä¿æŒç°æœ‰æ•°æ®ä¸å˜'):(e.value=JSON.parse(JSON.stringify(p)),console.log('[MvuStore] æœ¬åœ°ç¼“å­˜å·²åŒæ­¥ï¼Œstat_data é”®:',t))}return console.log(`[MvuStore] å‘½ä»¤æ‰§è¡Œå®Œæˆ: ${m}æˆåŠŸ, ${v}å¤±è´¥`),g(),{success:d,results:a,error:d?void 0:`${v}æ¡å‘½ä»¤æ‰§è¡Œå¤±è´¥`}}catch(e){console.error('[MvuStore] è§£ææ‰§è¡Œå‘½ä»¤å¤±è´¥:',e);try{await I()}catch(e){console.error('[MvuStore] åˆ·æ–°MVUæ•°æ®å¤±è´¥:',e)}return{success:!1,results:a,error:e instanceof Error?e.message:'è§£ææ‰§è¡Œå‘½ä»¤å¤±è´¥'}}finally{const e=()=>{G=Math.max(0,G-1),0===G&&(i.value=!1,console.log('[MvuStore] å†…éƒ¨æ›´æ–°æ ‡å¿—å·²æ¸…é™¤'))};let t=!1;const a=x(()=>{t||(t=!0,a(),e())});setTimeout(()=>{t||(a(),e(),console.log('[MvuStore] å†…éƒ¨æ›´æ–°æ ‡å¿—è¶…æ—¶æ¸…é™¤'))},500)}}}}),Ye=t('app',()=>{const e=(0,l.ref)({isFullscreen:!1,theme:'dark',language:'zh-CN',volume:1,isMuted:!1}),t=(0,l.ref)(!0),a=(0,l.ref)(!1),n=(0,l.ref)(null),o=(0,l.ref)([]),r=()=>{try{if('undefined'!=typeof window){const e=window.SillyTavern;if(e){if(e.chatId)return String(e.chatId);if('function'==typeof e.getCurrentChatId){const t=e.getCurrentChatId();if(t)return String(t)}}if('function'==typeof window.getContext){const e=window.getContext();if(e?.chatId)return String(e.chatId)}}return null}catch{return null}},s=async()=>{const e=r();if(e===n.value)return void console.log('[AppStore] èŠå¤©IDæœªå˜åŒ–ï¼Œè·³è¿‡åˆ‡æ¢å¤„ç†');console.log('[AppStore] æ£€æµ‹åˆ°èŠå¤©åˆ‡æ¢:',n.value,'->',e),n.value=e;const t=Ke();if(t.isMvuAvailable)try{await t.onChatSwitch(),console.log('[AppStore] MVU StoreèŠå¤©åˆ‡æ¢å¤„ç†å®Œæˆ')}catch(e){console.error('[AppStore] MVU StoreèŠå¤©åˆ‡æ¢å¤„ç†å¤±è´¥:',e)}for(const e of o.value)try{await e()}catch(e){console.error('[AppStore] èŠå¤©åˆ‡æ¢å›è°ƒæ‰§è¡Œå¤±è´¥:',e)}},c=(0,l.ref)(0);let i=null;const u=async(e=5e3,t=100)=>{const a=Date.now();for(console.log('[AppStore] ç­‰å¾…é…’é¦†ç¯å¢ƒå°±ç»ª...');Date.now()-a<e;){const e='function'==typeof window.eventOn,a=void 0!==window.Mvu,n='function'==typeof window.generate,o=void 0!==window.TavernHelper,l=r();if(e&&a&&n&&o&&!!l)return console.log('[AppStore] é…’é¦†ç¯å¢ƒå·²å°±ç»ª:',{eventOn:e,Mvu:a,generate:n,TavernHelper:o,chatId:l}),!0;await new Promise(e=>setTimeout(e,t))}return console.warn('[AppStore] ç­‰å¾…é…’é¦†ç¯å¢ƒè¶…æ—¶ï¼Œç»§ç»­åˆå§‹åŒ–ï¼ˆéƒ¨åˆ†åŠŸèƒ½å¯èƒ½ä¸å¯ç”¨ï¼‰'),!1},d=async()=>{const e=Ke();if('undefined'!=typeof window)try{if(await e.initialize(),e.isMvuAvailable&&e.mvuData)return console.log('[AppStore] MVU Storeåˆå§‹åŒ–æˆåŠŸ'),void(c.value=0);e.isMvuAvailable||(console.warn('[AppStore] MVUæ¡†æ¶æš‚ä¸å¯ç”¨ï¼Œå°†å®‰æ’é‡è¯•...'),m())}catch(e){console.warn('[AppStore] MVUåˆå§‹åŒ–å¤±è´¥ï¼Œå°†å®‰æ’é‡è¯•:',e),m()}else console.log('[AppStore] éæµè§ˆå™¨ç¯å¢ƒï¼Œè·³è¿‡MVUåˆå§‹åŒ–')},m=()=>{if(c.value>=5)return console.error('[AppStore] MVUåˆå§‹åŒ–é‡è¯•å·²è¾¾æœ€å¤§æ¬¡æ•°ï¼Œæ”¾å¼ƒé‡è¯•'),void('undefined'!=typeof toastr&&toastr.warning('å˜é‡ç³»ç»Ÿåˆå§‹åŒ–å¤±è´¥ï¼Œéƒ¨åˆ†åŠŸèƒ½å¯èƒ½ä¸å¯ç”¨ã€‚è¯·å°è¯•åˆ·æ–°é¡µé¢ã€‚','åˆå§‹åŒ–è­¦å‘Š',{timeOut:5e3}));i&&clearTimeout(i),c.value++;const e=1e3*c.value;console.log(`[AppStore] å°†åœ¨ ${e}ms åè¿›è¡Œç¬¬ ${c.value} æ¬¡MVUåˆå§‹åŒ–é‡è¯•...`),i=setTimeout(async()=>{const e=Ke();try{await e.initialize(),e.isMvuAvailable&&e.mvuData?(console.log('[AppStore] MVU Storeé‡è¯•åˆå§‹åŒ–æˆåŠŸ'),c.value=0,'undefined'!=typeof toastr&&toastr.success('å˜é‡ç³»ç»Ÿå·²å°±ç»ª','åˆå§‹åŒ–æˆåŠŸ',{timeOut:2e3})):m()}catch(e){console.warn(`[AppStore] ç¬¬ ${c.value} æ¬¡MVUåˆå§‹åŒ–é‡è¯•å¤±è´¥:`,e),m()}},e)};return{state:e,isInitialized:a,currentChatId:n,streamingEnabled:t,mvuInitRetryCount:c,initialize:async()=>{if(!a.value){console.log('[AppStore] æ­£åœ¨åˆå§‹åŒ–MCæˆ¿å­åº”ç”¨...');try{const a=localStorage.getItem('mc-app-theme');a&&(e.value.theme=a);const n=localStorage.getItem('mc-app-language');n&&(e.value.language=n);const o=localStorage.getItem('mc-app-volume');o&&(e.value.volume=parseFloat(o));const l=localStorage.getItem('mc-app-muted');l&&(e.value.isMuted='true'===l);const r=localStorage.getItem('mc-app-streaming');null!==r&&(t.value='true'===r)}catch(e){console.warn('[AppStore] åŠ è½½è®¾ç½®å¤±è´¥:',e)}n.value=r(),console.log('[AppStore] åˆå§‹èŠå¤©ID:',n.value),(()=>{try{if('undefined'==typeof window)return;if('function'==typeof window.eventOn)if(void 0!==window.iframe_events){const e=window.iframe_events;e.CHAT_CHANGED&&(window.eventOn(e.CHAT_CHANGED,s),console.log('[AppStore] å·²æ³¨å†ŒèŠå¤©åˆ‡æ¢äº‹ä»¶ç›‘å¬å™¨ (CHAT_CHANGED)'))}else window.eventOn('js_chat_changed',s),console.log('[AppStore] å·²æ³¨å†ŒèŠå¤©åˆ‡æ¢äº‹ä»¶ç›‘å¬å™¨ (js_chat_changed)');const e=window.SillyTavern;e?.eventSource?.on&&e.eventTypes?.CHAT_CHANGED&&(e.eventSource.on(e.eventTypes.CHAT_CHANGED,s),console.log('[AppStore] å·²é€šè¿‡SillyTavern.eventSourceæ³¨å†ŒèŠå¤©åˆ‡æ¢ç›‘å¬å™¨'))}catch(e){console.warn('[AppStore] è®¾ç½®èŠå¤©åˆ‡æ¢ç›‘å¬å™¨å¤±è´¥:',e)}})(),await u(),await d(),a.value=!0,console.log('[AppStore] MCæˆ¿å­åº”ç”¨åˆå§‹åŒ–å®Œæˆ')}},toggleFullscreen:()=>{e.value.isFullscreen=!e.value.isFullscreen},toggleTheme:()=>{e.value.theme='dark'===e.value.theme?'light':'dark',localStorage.setItem('mc-app-theme',e.value.theme),'light'===e.value.theme?document.documentElement.classList.add('light-theme'):document.documentElement.classList.remove('light-theme')},setTheme:t=>{e.value.theme=t,localStorage.setItem('mc-app-theme',t),'light'===t?document.documentElement.classList.add('light-theme'):document.documentElement.classList.remove('light-theme')},setLanguage:t=>{e.value.language=t,localStorage.setItem('mc-app-language',t)},setVolume:t=>{e.value.volume=Math.max(0,Math.min(1,t)),localStorage.setItem('mc-app-volume',String(e.value.volume))},toggleMute:()=>{e.value.isMuted=!e.value.isMuted,localStorage.setItem('mc-app-muted',String(e.value.isMuted))},setMuted:t=>{e.value.isMuted=t,localStorage.setItem('mc-app-muted',String(t))},toggleStreaming:()=>{t.value=!t.value,localStorage.setItem('mc-app-streaming',String(t.value)),console.log('[AppStore] æµå¼ä¼ è¾“:',t.value?'å¼€å¯':'å…³é—­')},setStreaming:e=>{t.value=e,localStorage.setItem('mc-app-streaming',String(e)),console.log('[AppStore] æµå¼ä¼ è¾“:',e?'å¼€å¯':'å…³é—­')},onChatSwitch:e=>(o.value.push(e),()=>{const t=o.value.indexOf(e);t>-1&&o.value.splice(t,1)}),handleChatSwitch:s,getCurrentChatId:r,retryMvuInitialization:async()=>{console.log('[AppStore] ç”¨æˆ·æ‰‹åŠ¨è§¦å‘MVUé‡æ–°åˆå§‹åŒ–...'),c.value=0;const e=Ke();try{return await e.initialize(),!(!e.isMvuAvailable||!e.mvuData)&&(console.log('[AppStore] MVU Storeæ‰‹åŠ¨é‡æ–°åˆå§‹åŒ–æˆåŠŸ'),!0)}catch(e){return console.error('[AppStore] MVU Storeæ‰‹åŠ¨é‡æ–°åˆå§‹åŒ–å¤±è´¥:',e),!1}}}}),qe=['title'],Xe={class:'collapse-icon'},Qe={class:'nav-menu'},Ze=['onClick'],et={class:'nav-icon'},tt={key:0,class:'nav-label'},at={key:1,class:'lite-tag'},nt={key:0,class:'info-panels desktop-only'},ot={class:'info-panel settings-panel'},lt={class:'panel-body'},rt={class:'setting-item'},st={class:'toggle-switch'},ct=['checked'],it={class:'setting-hint'},ut={class:'sidebar-footer'},dt={class:'mobile-settings'},mt={class:'mobile-setting-item'},vt={class:'toggle-switch small'},pt=['checked'],gt={key:0,class:'nav-label'},ft={key:0,class:'nav-label'},ht={key:0,class:'nav-label'},yt={key:0,class:'nav-label'},Vt={key:0,class:'nav-label'},Et={key:0,class:'nav-label'},bt=(0,l.defineComponent)({__name:'Sidebar',props:{activeMenu:{default:'workplace'},collapsed:{type:Boolean,default:!1},unreadNotifications:{default:0},mobileVisible:{type:Boolean,default:!1}},emits:['menu-change','update:collapsed','open-help','open-ai-filter','open-save-manager','open-context-manager','open-history-text','open-changelog','open-variable-manager','view-notice','close-mobile'],setup(e,{emit:t}){const a=e,n=t,o=(0,l.ref)(a.collapsed),r=Ye(),s=(0,l.computed)(()=>r.streamingEnabled),c=()=>{r.toggleStreaming()},i=(0,l.computed)(()=>[{id:'workplace',icon:'ğŸ–¥ï¸',label:'æˆ‘çš„å·¥ä½'},{id:'personnel',icon:'ğŸ‘¥',label:'äººäº‹ç³»ç»Ÿ',liteTag:!0},{id:'handbook',icon:'ğŸ“–',label:'æ–‡æ¡£æŸ¥çœ‹'}]),u=()=>{o.value=!o.value,n('update:collapsed',o.value)};return(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('aside',{class:(0,l.normalizeClass)(['sidebar',{'is-collapsed':o.value,'is-visible':e.mobileVisible}])},[(0,l.createCommentVNode)(' ç§»åŠ¨ç«¯å…³é—­æŒ‰é’® '),(0,l.createElementVNode)('button',{class:'mobile-close-btn',onClick:t[0]||(t[0]=t=>e.$emit('close-mobile')),title:'å…³é—­èœå•'},[...t[7]||(t[7]=[(0,l.createElementVNode)('span',{class:'close-icon'},'âœ•',-1)])]),(0,l.createCommentVNode)(' æŠ˜å æŒ‰é’®ï¼ˆä»…æ¡Œé¢ç«¯æ˜¾ç¤ºï¼‰ '),(0,l.createElementVNode)('button',{class:'collapse-btn',onClick:u,title:o.value?'å±•å¼€èœå•':'æ”¶èµ·èœå•'},[(0,l.createElementVNode)('span',Xe,(0,l.toDisplayString)(o.value?'â—€':'â–¶'),1)],8,qe),(0,l.createCommentVNode)(' å¯¼èˆªèœå• '),(0,l.createElementVNode)('nav',Qe,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(i.value,t=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:t.id,class:(0,l.normalizeClass)(['nav-item',{'is-active':e.activeMenu===t.id,'is-disabled':t.disabled}]),onClick:e=>{return o=t.id,void(t.disabled||(n('menu-change',o),a.mobileVisible&&n('close-mobile')));var o}},[(0,l.createElementVNode)('span',et,(0,l.toDisplayString)(t.icon),1),o.value?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('span',tt,(0,l.toDisplayString)(t.label),1)),!o.value&&t.liteTag?((0,l.openBlock)(),(0,l.createElementBlock)('span',at,'Lite')):(0,l.createCommentVNode)('v-if',!0)],10,Ze))),128))]),(0,l.createCommentVNode)(' ä¿¡æ¯é¢æ¿åŒºåŸŸï¼ˆå±•å¼€æ—¶æ˜¾ç¤ºï¼Œæ¡Œé¢ç«¯ï¼‰ '),o.value?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('div',nt,[(0,l.createCommentVNode)(' è®¾ç½®é¢æ¿ '),(0,l.createElementVNode)('div',ot,[t[10]||(t[10]=(0,l.createElementVNode)('div',{class:'panel-header'},[(0,l.createElementVNode)('span',{class:'panel-icon'},'âš™ï¸'),(0,l.createElementVNode)('span',{class:'panel-title'},'è®¾ç½®')],-1)),(0,l.createElementVNode)('div',lt,[(0,l.createCommentVNode)(' æµå¼ä¼ è¾“å¼€å…³ '),(0,l.createElementVNode)('div',rt,[t[9]||(t[9]=(0,l.createElementVNode)('div',{class:'setting-label'},[(0,l.createElementVNode)('span',{class:'setting-icon'},'ğŸ“¡'),(0,l.createElementVNode)('span',{class:'setting-text'},'æµå¼ä¼ è¾“')],-1)),(0,l.createElementVNode)('label',st,[(0,l.createElementVNode)('input',{type:'checkbox',checked:s.value,onChange:c},null,40,ct),t[8]||(t[8]=(0,l.createElementVNode)('span',{class:'toggle-slider'},null,-1))])]),(0,l.createElementVNode)('div',it,(0,l.toDisplayString)(s.value?'å®æ—¶æ˜¾ç¤ºAIå›å¤':'ç­‰å¾…å®Œæ•´å›å¤'),1)])]),(0,l.createCommentVNode)(' Liteç‰ˆæœ¬æç¤º '),t[11]||(t[11]=(0,l.createStaticVNode)('<div class="info-panel lite-info-panel" data-v-0cb86708><div class="panel-header" data-v-0cb86708><span class="panel-icon" data-v-0cb86708>ğŸ’¡</span><span class="panel-title" data-v-0cb86708>Liteç‰ˆæœ¬</span></div><div class="panel-body" data-v-0cb86708><div class="lite-notice" data-v-0cb86708><p data-v-0cb86708>å½“å‰ä¸ºMCliteç®€åŒ–ç‰ˆ</p><p class="lite-detail" data-v-0cb86708>éƒ¨åˆ†åŠŸèƒ½å·²ç®€åŒ–æˆ–ç¦ç”¨</p></div></div></div>',1))])),(0,l.createCommentVNode)(' åº•éƒ¨å¿«æ·æ“ä½œ '),(0,l.createElementVNode)('div',ut,[(0,l.createCommentVNode)(' ç§»åŠ¨ç«¯æµå¼ä¼ è¾“è®¾ç½®ï¼ˆç´§å‡‘ç‰ˆï¼‰ '),(0,l.createElementVNode)('div',dt,[(0,l.createElementVNode)('div',mt,[t[13]||(t[13]=(0,l.createElementVNode)('span',{class:'setting-icon'},'ğŸ“¡',-1)),t[14]||(t[14]=(0,l.createElementVNode)('span',{class:'setting-text'},'æµå¼',-1)),(0,l.createElementVNode)('label',vt,[(0,l.createElementVNode)('input',{type:'checkbox',checked:s.value,onChange:c},null,40,pt),t[12]||(t[12]=(0,l.createElementVNode)('span',{class:'toggle-slider'},null,-1))])])]),t[21]||(t[21]=(0,l.createElementVNode)('div',{class:'divider'},null,-1)),(0,l.createCommentVNode)(' æ ¸å¿ƒåŠŸèƒ½æŒ‰é’® '),(0,l.createElementVNode)('div',{class:'nav-item footer-item highlight-item',onClick:t[1]||(t[1]=t=>e.$emit('open-save-manager'))},[t[15]||(t[15]=(0,l.createElementVNode)('span',{class:'nav-icon'},'ğŸ’¾',-1)),o.value?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('span',gt,'å­˜æ¡£ç®¡ç†'))]),(0,l.createElementVNode)('div',{class:'nav-item footer-item highlight-item',onClick:t[2]||(t[2]=t=>e.$emit('open-context-manager'))},[t[16]||(t[16]=(0,l.createElementVNode)('span',{class:'nav-icon'},'ğŸ“š',-1)),o.value?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('span',ft,'ä¸Šä¸‹æ–‡ç®¡ç†'))]),(0,l.createElementVNode)('div',{class:'nav-item footer-item highlight-item secondary',onClick:t[3]||(t[3]=t=>e.$emit('open-history-text'))},[t[17]||(t[17]=(0,l.createElementVNode)('span',{class:'nav-icon'},'ğŸ“œ',-1)),o.value?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('span',ht,'å†å²æ­£æ–‡'))]),(0,l.createElementVNode)('div',{class:'nav-item footer-item highlight-item dev-tool',onClick:t[4]||(t[4]=t=>e.$emit('open-variable-manager'))},[t[18]||(t[18]=(0,l.createElementVNode)('span',{class:'nav-icon'},'ğŸ”§',-1)),o.value?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('span',yt,'å˜é‡ç®¡ç†å™¨'))]),t[22]||(t[22]=(0,l.createElementVNode)('div',{class:'divider'},null,-1)),(0,l.createElementVNode)('div',{class:'nav-item footer-item',onClick:t[5]||(t[5]=t=>e.$emit('open-changelog'))},[t[19]||(t[19]=(0,l.createElementVNode)('span',{class:'nav-icon'},'ğŸ“‹',-1)),o.value?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('span',Vt,'æ›´æ–°æ—¥å¿—'))]),(0,l.createElementVNode)('div',{class:'nav-item footer-item',onClick:t[6]||(t[6]=t=>e.$emit('open-help'))},[t[20]||(t[20]=(0,l.createElementVNode)('span',{class:'nav-icon'},'â“',-1)),o.value?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('span',Et,'å¸®åŠ©è¯´æ˜'))]),(0,l.createCommentVNode)(' AIè¿‡æ»¤æµ‹è¯•æŒ‰é’®å·²éšè—ï¼ˆåŠŸèƒ½å·²ç¦ç”¨ï¼‰\r\n      <div class="nav-item footer-item debug-item" @click="$emit(\'open-ai-filter\')">\r\n        <span class="nav-icon">ğŸ”¬</span>\r\n        <span v-if="!isCollapsed" class="nav-label">AIè¿‡æ»¤æµ‹è¯•</span>\r\n      </div>\r\n      ')])],2))}}),St=(0,M.A)(bt,[['__scopeId','data-v-0cb86708']]),Nt='MC.èŠ±åå†Œ',kt={$meta:{extensible:!0,version:'2.0'},$schema:{primaryKey:'',displayField:'',groupByField:'',fields:{$meta:{extensible:!0}},groups:{$meta:{extensible:!0}}},entries:{$meta:{extensible:!0}}};function Ct(e){return Object.keys(e).filter(e=>!('$meta'===e))}function wt(e){return Ct(e.fields).map(t=>({id:t,...e.fields[t]})).sort((e,t)=>(e.order??999)-(t.order??999))}const Mt=t('roster',()=>{const e=Ke(),t=(0,l.ref)(!1),a=(0,l.ref)(!1),n=(0,l.ref)(null),o=(0,l.ref)(null),r=(0,l.ref)(0);let s=null;const c=(0,l.computed)(()=>{r.value;return e.getVariable(Nt,kt)}),i=(0,l.computed)(()=>c.value.$schema),u=(0,l.computed)(()=>{const e=c.value.entries||{},t={};for(const a of Ct(e)){const n=e[a];n&&'object'==typeof n&&!('extensible'in n)&&(t[a]=n)}return t}),d=(0,l.computed)(()=>Object.values(u.value)),m=(0,l.computed)(()=>d.value.length),v=(0,l.computed)(()=>0===m.value),p=(0,l.computed)(()=>wt(i.value)),g=(0,l.computed)(()=>function(e){return Ct(e.groups).map(t=>({id:t,...e.groups[t]})).sort((e,t)=>(e.order??999)-(t.order??999))}(i.value)),f=(0,l.computed)(()=>function(e){return wt(e).filter(e=>e.showInList)}(i.value)),h=(0,l.computed)(()=>function(e){return wt(e).filter(e=>e.showInSummary)}(i.value)),y=(0,l.computed)(()=>{const e=i.value.groupByField;if(!e)return{å…¨éƒ¨:d.value};const t={};for(const a of d.value){const n=String(a[e]||'æœªåˆ†ç»„');t[n]||(t[n]=[]),t[n].push(a)}return t}),V=(0,l.computed)(()=>Object.keys(y.value)),E=(0,l.computed)(()=>o.value?u.value[o.value]:null),b=e=>{const t=i.value.fields[e];return t&&'object'==typeof t&&'label'in t?t:void 0},S=e=>{const t=i.value.groups[e];return t&&'object'==typeof t&&'label'in t?t:void 0},N=e=>u.value[e];return{isInitialized:t,isLoading:a,error:n,selectedEntryId:o,updateVersion:r,roster:c,schema:i,entries:u,entriesArray:d,entryCount:m,isEmpty:v,fieldsSorted:p,groupsSorted:g,listFields:f,summaryFields:h,entriesByGroup:y,groupNames:V,selectedEntry:E,initialize:async()=>{if(!t.value)try{a.value=!0,e.isMvuAvailable||await e.initialize(),s||(s=e.onUpdateEnd(()=>{console.log('[RosterStore] æ”¶åˆ° MVU æ›´æ–°ç»“æŸäº‹ä»¶ï¼Œè§¦å‘åˆ·æ–°'),r.value++})),t.value=!0}catch(e){n.value=e instanceof Error?e.message:'åˆå§‹åŒ–å¤±è´¥'}finally{a.value=!1}},refresh:async()=>{await e.refresh(),r.value++},destroy:()=>{s&&(s(),s=null)},selectEntry:e=>{o.value=e},getField:b,getGroup:S,getFieldsForGroup:e=>{const t=S(e);return t?t.fields.map(e=>{const t=b(e);return t?{id:e,...t}:null}).filter(e=>null!==e):[]},getEntry:N,getEntryDisplayValue:e=>{const t=i.value.displayField;return t?String(e[t]||''):''},getEntryPrimaryKey:e=>{const t=i.value.primaryKey;return t?String(e[t]||''):''},addEntry:async(t,a)=>{const n=`${Nt}.entries.${t}`;return await e.setVariable(n,a,'æ·»åŠ æ¡ç›®')},updateEntry:async(t,a)=>{const n=N(t);if(!n)return!1;const o=`${Nt}.entries.${t}`;return await e.setVariable(o,{...n,...a},'æ›´æ–°æ¡ç›®')},removeEntry:async t=>{const a={...u.value};return delete a[t],await e.setVariable(`${Nt}.entries`,a,'åˆ é™¤æ¡ç›®')},addField:async(t,a)=>{const n=`${Nt}.$schema.fields.${t}`;return await e.setVariable(n,a,'æ·»åŠ å­—æ®µ')},updateSchema:async t=>{const a=`${Nt}.$schema`;return await e.setVariable(a,{...i.value,...t},'æ›´æ–° Schema')}}}),At={class:'field-label'},It={class:'field-value'},Dt={key:0,class:'value-text'},Bt={class:'text-content'},xt={class:'enum-badge'},_t={class:'tags-container'},Tt={key:0,class:'empty-tags'},$t={class:'boolean-icon'},Lt={class:'value-text'},Ot=(0,l.defineComponent)({__name:'SchemaFieldRenderer',props:{field:{},value:{}},setup(e){const t=e,a=(0,l.computed)(()=>null===t.value||void 0===t.value?'-':'object'==typeof t.value?JSON.stringify(t.value):String(t.value)),n=(0,l.computed)(()=>Array.isArray(t.value)?t.value.map(String):[]);return(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{class:(0,l.normalizeClass)(['schema-field',`field-type-${e.field.type}`])},[(0,l.createElementVNode)('span',At,(0,l.toDisplayString)(e.field.label),1),(0,l.createElementVNode)('div',It,[(0,l.createCommentVNode)(' string / number '),'string'===e.field.type||'number'===e.field.type?((0,l.openBlock)(),(0,l.createElementBlock)('span',Dt,(0,l.toDisplayString)(a.value),1)):'text'===e.field.type?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createCommentVNode)(' text (å¤šè¡Œæ–‡æœ¬) '),(0,l.createElementVNode)('p',Bt,(0,l.toDisplayString)(a.value),1)],64)):'enum'===e.field.type?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:2},[(0,l.createCommentVNode)(' enum (æšä¸¾) '),(0,l.createElementVNode)('span',xt,(0,l.toDisplayString)(a.value),1)],64)):'tags'===e.field.type?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:3},[(0,l.createCommentVNode)(' tags (æ ‡ç­¾æ•°ç»„) '),(0,l.createElementVNode)('div',_t,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(n.value,(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('span',{key:t,class:'tag'},(0,l.toDisplayString)(e),1))),128)),0===n.value.length?((0,l.openBlock)(),(0,l.createElementBlock)('span',Tt,'æ— ')):(0,l.createCommentVNode)('v-if',!0)])],64)):'boolean'===e.field.type?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:4},[(0,l.createCommentVNode)(' boolean '),(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(['boolean-value',e.value?'is-true':'is-false'])},[(0,l.createElementVNode)('span',$t,(0,l.toDisplayString)(e.value?'âœ“':'âœ—'),1),(0,l.createTextVNode)(' '+(0,l.toDisplayString)(e.value?'æ˜¯':'å¦'),1)],2)],64)):((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:5},[(0,l.createCommentVNode)(' æœªçŸ¥ç±»å‹ '),(0,l.createElementVNode)('span',Lt,(0,l.toDisplayString)(a.value),1)],64))])],2))}}),Rt=(0,M.A)(Ot,[['__scopeId','data-v-7e8ff355']]),Ut={class:'roster-panel'},jt={class:'panel-header'},Pt={class:'header-left'},zt={class:'header-right'},Ft={class:'entry-count'},Ht={class:'panel-main'},Wt={class:'category-sidebar'},Gt={class:'category-list'},Jt=['onClick'],Kt={class:'category-name'},Yt={class:'category-count'},qt={class:'panel-body'},Xt={key:0,class:'state-container loading-state'},Qt={class:'state-container error-state'},Zt={class:'content-area'},ea={class:'group-header'},ta={class:'group-title'},aa={class:'group-count'},na={class:'entry-table'},oa={class:'table-header'},la={class:'table-body'},ra=['onClick'],sa={class:'col-name'},ca={class:'person-avatar'},ia={class:'person-name'},ua={class:'summary-value'},da={class:'col-action'},ma={class:'expand-btn'},va={key:0,class:'row-details'},pa={class:'details-content'},ga={class:'section-title'},fa={class:'field-grid'},ha=(0,l.defineComponent)({__name:'RosterPanel',emits:['close'],setup(e){const t=Mt(),{roster:n,isEmpty:o,entryCount:r,entriesByGroup:s,groupsSorted:c,summaryFields:i,selectedEntryId:u,isLoading:d,error:m,updateVersion:v}=a(t),{selectEntry:p,getEntryPrimaryKey:g,getEntryDisplayValue:f,getFieldsForGroup:h,refresh:y,initialize:V,destroy:E}=t,b=(0,l.ref)(null);(0,l.watch)(v,e=>{console.log('[RosterPanel] updateVersion å˜åŒ–:',e,'å½“å‰æ¡ç›®æ•°:',r.value)},{immediate:!1});const S=(0,l.computed)(()=>b.value?s.value[b.value]||[]:Object.values(s.value).flat()),N=e=>{const t=f(e);return t?t.charAt(0):'?'},k=(e,t)=>null==e?'-':'tags'===t.type&&Array.isArray(e)?e.length>0?e.join(', '):'-':String(e);return(0,l.onMounted)(()=>{V();const e=Object.keys(s.value);e.length>0&&(b.value=e[0]),console.log('[RosterPanel] é¢æ¿å·²æŒ‚è½½ï¼Œåˆå§‹æ¡ç›®æ•°:',r.value)}),(0,l.onUnmounted)(()=>{console.log('[RosterPanel] é¢æ¿å·²å¸è½½')}),(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',Ut,[(0,l.createCommentVNode)(' é¡¶éƒ¨å¤´æ  '),(0,l.createElementVNode)('div',jt,[(0,l.createElementVNode)('div',Pt,[t[2]||(t[2]=(0,l.createElementVNode)('span',{class:'panel-icon'},'ğŸ‘¥',-1)),(0,l.createElementVNode)('h2',null,(0,l.toDisplayString)((0,l.unref)(n).$meta?.description||'èŠ±åå†Œ'),1)]),(0,l.createElementVNode)('div',zt,[(0,l.createElementVNode)('span',Ft,(0,l.toDisplayString)((0,l.unref)(r))+' äºº',1),(0,l.createElementVNode)('button',{class:'close-btn',onClick:t[0]||(t[0]=t=>e.$emit('close')),title:'å…³é—­'},'âœ•')])]),(0,l.createCommentVNode)(' ä¸»ä½“åŒºåŸŸ '),(0,l.createElementVNode)('div',Ht,[(0,l.createCommentVNode)(' å·¦ä¾§åˆ†ç±»å¯¼èˆª '),(0,l.createElementVNode)('aside',Wt,[t[3]||(t[3]=(0,l.createElementVNode)('div',{class:'sidebar-header'},[(0,l.createElementVNode)('span',{class:'sidebar-title'},'åˆ†ç±»')],-1)),(0,l.createElementVNode)('div',Gt,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)((0,l.unref)(s),(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:t,class:(0,l.normalizeClass)(['category-item',{active:b.value===t}]),onClick:e=>(e=>{b.value===e?b.value=null:b.value=e})(t)},[(0,l.createElementVNode)('span',Kt,(0,l.toDisplayString)(t),1),(0,l.createElementVNode)('span',Yt,(0,l.toDisplayString)(e.length),1)],10,Jt))),128))])]),(0,l.createCommentVNode)(' å³ä¾§å†…å®¹åŒº '),(0,l.createElementVNode)('div',qt,[(0,l.createCommentVNode)(' åŠ è½½çŠ¶æ€ '),(0,l.unref)(d)?((0,l.openBlock)(),(0,l.createElementBlock)('div',Xt,[...t[4]||(t[4]=[(0,l.createElementVNode)('div',{class:'state-icon'},'â³',-1),(0,l.createElementVNode)('p',null,'åŠ è½½ä¸­...',-1)])])):(0,l.unref)(m)?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createCommentVNode)(' é”™è¯¯çŠ¶æ€ '),(0,l.createElementVNode)('div',Qt,[t[5]||(t[5]=(0,l.createElementVNode)('div',{class:'state-icon'},'âš ï¸',-1)),(0,l.createElementVNode)('p',null,(0,l.toDisplayString)((0,l.unref)(m)),1),(0,l.createElementVNode)('button',{class:'retry-btn',onClick:t[1]||(t[1]=(...e)=>(0,l.unref)(y)&&(0,l.unref)(y)(...e))},'é‡è¯•')])],2112)):(0,l.unref)(o)?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:2},[(0,l.createCommentVNode)(' ç©ºçŠ¶æ€ '),t[6]||(t[6]=(0,l.createElementVNode)('div',{class:'state-container empty-state'},[(0,l.createElementVNode)('div',{class:'state-icon'},'ğŸ“­'),(0,l.createElementVNode)('p',null,'æš‚æ— äººå‘˜æ•°æ®'),(0,l.createElementVNode)('p',{class:'empty-hint'},[(0,l.createTextVNode)('æ•°æ®ä» '),(0,l.createElementVNode)('code',null,'MC.èŠ±åå†Œ'),(0,l.createTextVNode)(' å˜é‡ä¸­è¯»å–')])],-1))],2112)):((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:3},[(0,l.createCommentVNode)(' äººå‘˜åˆ—è¡¨ '),(0,l.createElementVNode)('div',Zt,[(0,l.createCommentVNode)(' å½“å‰åˆ†ç»„æ ‡é¢˜ '),(0,l.createElementVNode)('div',ea,[(0,l.createElementVNode)('h3',ta,(0,l.toDisplayString)(b.value||'å…¨éƒ¨äººå‘˜'),1),(0,l.createElementVNode)('span',aa,'å…± '+(0,l.toDisplayString)(S.value.length)+' äºº',1)]),(0,l.createCommentVNode)(' æ¡ç›®è¡¨æ ¼ '),(0,l.createElementVNode)('div',na,[(0,l.createCommentVNode)(' è¡¨å¤´ '),(0,l.createElementVNode)('div',oa,[t[7]||(t[7]=(0,l.createElementVNode)('div',{class:'col-name'},'å§“å',-1)),((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)((0,l.unref)(i),e=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.id,class:'col-summary'},(0,l.toDisplayString)(e.label),1))),128)),t[8]||(t[8]=(0,l.createElementVNode)('div',{class:'col-action'},'æ“ä½œ',-1))]),(0,l.createCommentVNode)(' è¡¨æ ¼å†…å®¹ '),(0,l.createElementVNode)('div',la,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(S.value,e=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:(0,l.unref)(g)(e),class:(0,l.normalizeClass)(['table-row',{'is-expanded':(0,l.unref)(u)===(0,l.unref)(g)(e)}])},[(0,l.createCommentVNode)(' ä¸»è¡Œ '),(0,l.createElementVNode)('div',{class:'row-main',onClick:t=>{return a=(0,l.unref)(g)(e),void(u.value===a?p(null):p(a));var a}},[(0,l.createElementVNode)('div',sa,[(0,l.createElementVNode)('span',ca,(0,l.toDisplayString)(N(e)),1),(0,l.createElementVNode)('span',ia,(0,l.toDisplayString)((0,l.unref)(f)(e)),1)]),((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)((0,l.unref)(i),t=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:t.id,class:'col-summary'},[(0,l.createElementVNode)('span',ua,(0,l.toDisplayString)(k(e[t.id],t)),1)]))),128)),(0,l.createElementVNode)('div',da,[(0,l.createElementVNode)('span',ma,(0,l.toDisplayString)((0,l.unref)(u)===(0,l.unref)(g)(e)?'æ”¶èµ· â–²':'è¯¦æƒ… â–¼'),1)])],8,ra),(0,l.createCommentVNode)(' å±•å¼€çš„è¯¦æƒ…é¢æ¿ '),(0,l.unref)(u)===(0,l.unref)(g)(e)?((0,l.openBlock)(),(0,l.createElementBlock)('div',va,[(0,l.createElementVNode)('div',pa,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)((0,l.unref)(c),t=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:t.id,class:'detail-section'},[(0,l.createElementVNode)('h4',ga,(0,l.toDisplayString)(t.label),1),(0,l.createElementVNode)('div',fa,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)((0,l.unref)(h)(t.id),t=>((0,l.openBlock)(),(0,l.createBlock)(Rt,{key:t.id,field:t,value:e[t.id]},null,8,['field','value']))),128))])]))),128))])])):(0,l.createCommentVNode)('v-if',!0)],2))),128))])])])],2112))])])]))}}),ya=(0,M.A)(ha,[['__scopeId','data-v-7a96e4b1']]),Va='MC.æ–‡æ¡£',Ea={$meta:{extensible:!0,version:'2.0',description:'å¤šæ–‡æ¡£ç®¡ç†å®¹å™¨'}},ba={title:'',description:'',order:0,sections:{$meta:{extensible:!0}}};function Sa(e){return Object.keys(e).filter(e=>!('$meta'===e))}function Na(e){return Sa(e).map(t=>({id:t,...e[t]})).sort((e,t)=>(e.order??999)-(t.order??999))}function ka(e,t=0){const a=[];for(const n of Na(e))a.push({...n,depth:t}),n.children&&a.push(...ka(n.children,t+1));return a}const Ca=t('document',()=>{const e=Ke(),t=(0,l.ref)(!1),a=(0,l.ref)(!1),n=(0,l.ref)(null),o=(0,l.ref)(null),r=(0,l.ref)(0);let s=null;const c=(0,l.computed)(()=>{const t=r.value,a=e.getVariable(Va,Ea);return console.log('[DocumentStore] è¯»å– MC.æ–‡æ¡£ å˜é‡ (version='+t+'):',{path:Va,rawDataType:typeof a,rawDataKeys:a&&'object'==typeof a?Object.keys(a):[],hasData:null!=a}),function(e){if(!e||'object'!=typeof e)return!1;const t=e;return'string'==typeof t.title&&'object'==typeof t.sections&&null!==t.sections}(a)?(console.log('[DocumentStore] æ£€æµ‹åˆ°æ—§ç‰ˆå•æ–‡æ¡£ç»“æ„ï¼Œè¿›è¡Œè½¬æ¢'),{$meta:{extensible:!0,version:'2.0',description:'ä»æ—§ç‰ˆè½¬æ¢çš„æ–‡æ¡£å®¹å™¨'},default:{title:(n=a).title,description:n.description,order:0,sections:n.sections}}):a;var n}),i=(0,l.computed)(()=>{return Sa(e=c.value).map(t=>({id:t,...e[t]})).sort((e,t)=>(e.order??999)-(t.order??999));var e}),u=(0,l.computed)(()=>i.value.length),d=(0,l.computed)(()=>0===u.value),m=(0,l.computed)(()=>{const e=o.value;if(console.log('[DocumentStore] effectiveDocId è®¡ç®—è¢«è§¦å‘, currentDocId:',e),e)return console.log('[DocumentStore] effectiveDocId è®¡ç®—: ä½¿ç”¨é€‰ä¸­çš„æ–‡æ¡£',e),e;const t=i.value;return t.length>0?(console.log('[DocumentStore] effectiveDocId è®¡ç®—: ä½¿ç”¨é»˜è®¤æ–‡æ¡£',t[0].id),t[0].id):null}),v=(0,l.computed)(()=>{const e=m.value;if(console.log('[DocumentStore] currentDocument è®¡ç®—, docId:',e),!e)return null;const t=c.value[e];return t&&'object'==typeof t&&'title'in t?(console.log('[DocumentStore] currentDocument æ‰¾åˆ°æ–‡æ¡£:',t.title),t):(console.log('[DocumentStore] currentDocument æœªæ‰¾åˆ°æ–‡æ¡£'),null)}),p=(0,l.computed)(()=>v.value?.title||''),g=(0,l.computed)(()=>v.value?.description||''),f=(0,l.computed)(()=>v.value?.sections||{$meta:{extensible:!0}}),h=(0,l.computed)(()=>Na(f.value)),y=(0,l.computed)(()=>ka(f.value).length),V=(0,l.computed)(()=>0===y.value),E=(0,l.computed)(()=>ka(f.value)),b=()=>m.value,S=e=>{const t=f.value[e];return t&&'object'==typeof t&&'title'in t?t:void 0};return{isInitialized:t,isLoading:a,error:n,currentDocId:o,documentsContainer:c,documentList:i,documentCount:u,hasNoDocuments:d,effectiveDocId:m,currentDocument:v,title:p,description:g,sections:f,sectionsSorted:h,sectionCount:y,isEmpty:V,flatSections:E,initialize:async()=>{if(!t.value)try{a.value=!0,e.isMvuAvailable||await e.initialize(),s||(s=e.onUpdateEnd(()=>{console.log('[DocumentStore] æ”¶åˆ° MVU æ›´æ–°ç»“æŸäº‹ä»¶ï¼Œé€’å¢ dataVersion'),r.value++})),i.value.length>0&&!o.value&&(o.value=i.value[0].id),t.value=!0}catch(e){n.value=e instanceof Error?e.message:'åˆå§‹åŒ–å¤±è´¥'}finally{a.value=!1}},refresh:async()=>{await e.refresh(),r.value++},selectDocument:e=>{console.log('[DocumentStore] selectDocument è¢«è°ƒç”¨, docId:',e),console.log('[DocumentStore] å½“å‰ currentDocId:',o.value),console.log('[DocumentStore] documentsContainer keys:',Object.keys(c.value));const t=c.value[e];console.log('[DocumentStore] æŸ¥æ‰¾åˆ°çš„æ–‡æ¡£:',t?'å­˜åœ¨':'ä¸å­˜åœ¨',t),t&&'object'==typeof t&&'title'in t?(console.log('[DocumentStore] åˆ‡æ¢åˆ°æ–‡æ¡£:',e,'å½“å‰æ–‡æ¡£ID:',o.value),o.value!==e?(o.value=e,console.log('[DocumentStore] æ–‡æ¡£åˆ‡æ¢å®Œæˆï¼Œæ–°çš„æ–‡æ¡£ID:',o.value),console.log('[DocumentStore] effectiveDocId åº”è¯¥æ›´æ–°ä¸º:',m.value),console.log('[DocumentStore] currentDocument title:',v.value?.title)):console.log('[DocumentStore] æ–‡æ¡£IDæœªå˜åŒ–ï¼Œè·³è¿‡æ›´æ–°')):(console.warn('[DocumentStore] å°è¯•é€‰æ‹©ä¸å­˜åœ¨çš„æ–‡æ¡£:',e,'å¯ç”¨æ–‡æ¡£:',Object.keys(c.value)),console.warn('[DocumentStore] doc å†…å®¹:',JSON.stringify(t)))},getEffectiveDocId:b,getSection:S,getSectionChildren:e=>e.children?Na(e.children):[],addSection:async(t,a,n)=>{const o=b();if(!o)return!1;const l=n?`${Va}.${o}.sections.${n}.children.${t}`:`${Va}.${o}.sections.${t}`;return await e.setVariable(l,a,'æ·»åŠ èŠ‚ç‚¹')},updateSection:async(t,a,n)=>{const o=S(t);if(!o)return!1;const l=b();if(!l)return!1;const r=n?`${Va}.${l}.sections.${n}.children.${t}`:`${Va}.${l}.sections.${t}`;return await e.setVariable(r,{...o,...a},'æ›´æ–°èŠ‚ç‚¹')},removeSection:async(t,a)=>{const n=b();if(!n)return!1;const o=a?`${Va}.${n}.sections.${a}.children`:`${Va}.${n}.sections`,l={...e.getVariable(o,{})};return delete l[t],await e.setVariable(o,l,'åˆ é™¤èŠ‚ç‚¹')},updateTitle:async t=>{const a=b();return!!a&&await e.setVariable(`${Va}.${a}.title`,t,'æ›´æ–°æ ‡é¢˜')},updateDescription:async t=>{const a=b();return!!a&&await e.setVariable(`${Va}.${a}.description`,t,'æ›´æ–°æè¿°')},addDocument:async(t,a)=>await e.setVariable(`${Va}.${t}`,a,'æ·»åŠ æ–‡æ¡£'),removeDocument:async t=>{const a={...e.getVariable(Va,{})};if(delete a[t],o.value===t){const e=Object.keys(a).filter(e=>'$meta'!==e);o.value=e.length>0?e[0]:null}return await e.setVariable(Va,a,'åˆ é™¤æ–‡æ¡£')},DEFAULT_DOCUMENT_ENTRY:ba,destroy:()=>{s&&(s(),s=null)},dataVersion:r}}),wa={key:0,class:'expand-icon'},Ma={key:1,class:'expand-placeholder'},Aa={class:'node-title'},Ia={key:0,class:'node-content'},Da={key:1,class:'node-children'},Ba=(0,l.defineComponent)({__name:'TreeNodeRenderer',props:{section:{},depth:{default:0},defaultExpanded:{type:Boolean,default:!0}},setup(e){const t=e,a=(0,l.ref)(t.defaultExpanded),n=(0,l.computed)(()=>{if(!t.section.children)return!1;return Object.keys(t.section.children).filter(e=>'$meta'!==e).length>0}),o=(0,l.computed)(()=>t.section.children?Na(t.section.children):[]),r=()=>{n.value&&(a.value=!a.value)};return(e,t)=>{const s=(0,l.resolveComponent)('TreeNodeRenderer',!0);return(0,l.openBlock)(),(0,l.createElementBlock)('div',{class:(0,l.normalizeClass)(['tree-node',`depth-${e.depth}`])},[(0,l.createCommentVNode)(' èŠ‚ç‚¹æ ‡é¢˜ '),(0,l.createElementVNode)('div',{class:'node-header',onClick:r},[n.value?((0,l.openBlock)(),(0,l.createElementBlock)('span',wa,(0,l.toDisplayString)(a.value?'â–¼':'â–¶'),1)):((0,l.openBlock)(),(0,l.createElementBlock)('span',Ma)),(0,l.createElementVNode)('span',Aa,(0,l.toDisplayString)(e.section.title),1)]),(0,l.createCommentVNode)(' èŠ‚ç‚¹å†…å®¹ '),!e.section.content||!a.value&&n.value?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('div',Ia,(0,l.toDisplayString)(e.section.content),1)),(0,l.createCommentVNode)(' å­èŠ‚ç‚¹ï¼ˆé€’å½’ï¼‰ '),n.value&&a.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',Da,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(o.value,t=>((0,l.openBlock)(),(0,l.createBlock)(s,{key:t.id,section:t,depth:e.depth+1,'default-expanded':e.defaultExpanded},null,8,['section','depth','default-expanded']))),128))])):(0,l.createCommentVNode)('v-if',!0)],2)}}}),xa=(0,M.A)(Ba,[['__scopeId','data-v-644583f3']]),_a={class:'panel-header'},Ta={class:'doc-count'},$a={class:'panel-main'},La={class:'sidebar-header'},Oa={key:0,class:'sidebar-title'},Ra=['title'],Ua={key:0,class:'document-list'},ja=['onClick','onKeydown'],Pa={class:'doc-info'},za={class:'doc-title'},Fa={key:0,class:'doc-desc'},Ha={key:1,class:'sidebar-empty'},Wa={key:2,class:'collapsed-list'},Ga=['onClick','title','onKeydown'],Ja={class:'panel-body'},Ka={key:0,class:'loading-state'},Ya={class:'error-state'},qa={class:'document-content'},Xa={class:'current-doc-header'},Qa={class:'current-doc-title'},Za={class:'section-count'},en={key:0,class:'document-description'},tn=(0,l.defineComponent)({__name:'DocumentPanel',emits:['close'],setup(e){const t=Ca(),{documentList:n,documentCount:o,hasNoDocuments:r,currentDocId:s,isLoading:c,error:i}=a(t),{refresh:u,initialize:d,selectDocument:m}=t,v=(0,l.computed)(()=>t.effectiveDocId),p=(0,l.computed)(()=>t.title),g=(0,l.computed)(()=>t.description),f=(0,l.computed)(()=>t.isEmpty),h=(0,l.computed)(()=>t.sectionCount),y=(0,l.computed)(()=>t.sectionsSorted),V=(0,l.ref)(!1),E=()=>{V.value=!V.value},b=(e,t=30)=>e.length>t?e.slice(0,t)+'...':e,S=e=>v.value===e,N=e=>{console.log('[DocumentPanel] ç‚¹å‡»é€‰æ‹©æ–‡æ¡£:',e,'å½“å‰æœ‰æ•ˆæ–‡æ¡£:',v.value),console.log('[DocumentPanel] currentDocId.value:',s.value),console.log('[DocumentPanel] å¯ç”¨æ–‡æ¡£åˆ—è¡¨:',n.value.map(e=>e.id)),m(e),console.log('[DocumentPanel] é€‰æ‹©å currentDocId:',s.value),console.log('[DocumentPanel] é€‰æ‹©å effectiveDocId:',v.value),console.log('[DocumentPanel] é€‰æ‹©å title:',p.value)};return(0,l.watch)(s,(e,t)=>{console.log('[DocumentPanel] currentDocId å˜åŒ–:',t,'->',e)}),(0,l.watch)(v,(e,t)=>{console.log('[DocumentPanel] effectiveDocId å˜åŒ–:',t,'->',e)}),(0,l.watch)(p,(e,t)=>{console.log('[DocumentPanel] title å˜åŒ–:',t,'->',e)}),(0,l.watch)(y,e=>{console.log('[DocumentPanel] sectionsSorted å˜åŒ–, èŠ‚ç‚¹æ•°:',e.length)},{deep:!0}),(0,l.onMounted)(()=>{d()}),(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{class:(0,l.normalizeClass)(['document-panel',{'sidebar-collapsed':V.value}])},[(0,l.createCommentVNode)(' é¡¶éƒ¨å¤´æ  '),(0,l.createElementVNode)('div',_a,[t[2]||(t[2]=(0,l.createElementVNode)('h2',null,'ğŸ“„ æ–‡æ¡£æŸ¥çœ‹',-1)),(0,l.createElementVNode)('span',Ta,(0,l.toDisplayString)((0,l.unref)(o))+' ä»½æ–‡æ¡£',1),(0,l.createElementVNode)('button',{class:'close-btn',onClick:t[0]||(t[0]=t=>e.$emit('close'))},'âœ•')]),(0,l.createElementVNode)('div',$a,[(0,l.createCommentVNode)(' å·¦ä¾§æ–‡æ¡£åˆ—è¡¨ä¾§æ  '),(0,l.createElementVNode)('aside',{class:(0,l.normalizeClass)(['document-sidebar',{collapsed:V.value}])},[(0,l.createElementVNode)('div',La,[V.value?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('span',Oa,'æ–‡æ¡£åˆ—è¡¨')),(0,l.createElementVNode)('button',{class:'toggle-btn',onClick:E,title:V.value?'å±•å¼€ä¾§æ ':'æ”¶èµ·ä¾§æ '},(0,l.toDisplayString)(V.value?'â–¶':'â—€'),9,Ra)]),!V.value&&(0,l.unref)(o)>0?((0,l.openBlock)(),(0,l.createElementBlock)('div',Ua,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)((0,l.unref)(n),e=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.id,class:(0,l.normalizeClass)(['doc-item',{active:S(e.id)}]),onClick:(0,l.withModifiers)(t=>N(e.id),['stop','prevent']),role:'button',tabindex:'0',onKeydown:(0,l.withKeys)(t=>N(e.id),['enter'])},[t[3]||(t[3]=(0,l.createElementVNode)('span',{class:'doc-icon'},'ğŸ“–',-1)),(0,l.createElementVNode)('div',Pa,[(0,l.createElementVNode)('span',za,(0,l.toDisplayString)(e.title||e.id),1),e.description?((0,l.openBlock)(),(0,l.createElementBlock)('span',Fa,(0,l.toDisplayString)(b(e.description)),1)):(0,l.createCommentVNode)('v-if',!0)])],42,ja))),128))])):(0,l.createCommentVNode)('v-if',!0),V.value||0!==(0,l.unref)(o)?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('div',Ha,[...t[4]||(t[4]=[(0,l.createElementVNode)('span',null,'æš‚æ— æ–‡æ¡£',-1)])])),(0,l.createCommentVNode)(' æ”¶ç¼©çŠ¶æ€ä¸‹çš„å›¾æ ‡åˆ—è¡¨ '),V.value&&(0,l.unref)(o)>0?((0,l.openBlock)(),(0,l.createElementBlock)('div',Wa,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)((0,l.unref)(n),e=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.id,class:(0,l.normalizeClass)(['collapsed-item',{active:S(e.id)}]),onClick:(0,l.withModifiers)(t=>N(e.id),['stop','prevent']),title:e.title||e.id,role:'button',tabindex:'0',onKeydown:(0,l.withKeys)(t=>N(e.id),['enter'])},' ğŸ“– ',42,Ga))),128))])):(0,l.createCommentVNode)('v-if',!0)],2),(0,l.createCommentVNode)(' å³ä¾§æ–‡æ¡£å†…å®¹åŒº '),(0,l.createElementVNode)('div',Ja,[(0,l.createCommentVNode)(' åŠ è½½çŠ¶æ€ '),(0,l.unref)(c)?((0,l.openBlock)(),(0,l.createElementBlock)('div',Ka,[...t[5]||(t[5]=[(0,l.createElementVNode)('p',null,'åŠ è½½ä¸­...',-1)])])):(0,l.unref)(i)?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createCommentVNode)(' é”™è¯¯çŠ¶æ€ '),(0,l.createElementVNode)('div',Ya,[(0,l.createElementVNode)('p',null,(0,l.toDisplayString)((0,l.unref)(i)),1),(0,l.createElementVNode)('button',{onClick:t[1]||(t[1]=(...e)=>(0,l.unref)(u)&&(0,l.unref)(u)(...e))},'é‡è¯•')])],2112)):(0,l.unref)(r)?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:2},[(0,l.createCommentVNode)(' æ— æ–‡æ¡£çŠ¶æ€ '),t[6]||(t[6]=(0,l.createElementVNode)('div',{class:'empty-state'},[(0,l.createElementVNode)('p',null,'ğŸ“­ æš‚æ— æ–‡æ¡£'),(0,l.createElementVNode)('p',{class:'empty-hint'},[(0,l.createTextVNode)('æ–‡æ¡£æ•°æ®ä» '),(0,l.createElementVNode)('code',null,'MC.æ–‡æ¡£'),(0,l.createTextVNode)(' å˜é‡ä¸­è¯»å–')]),(0,l.createElementVNode)('p',{class:'empty-hint'},'AI ä¼šåœ¨æ¸¸æˆè¿›ç¨‹ä¸­è‡ªåŠ¨æ›´æ–°æ–‡æ¡£å†…å®¹')],-1))],2112)):f.value?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:3},[(0,l.createCommentVNode)(' å½“å‰æ–‡æ¡£ä¸ºç©º '),t[7]||(t[7]=(0,l.createElementVNode)('div',{class:'empty-state'},[(0,l.createElementVNode)('p',null,'ğŸ“ è¯¥æ–‡æ¡£æš‚æ— å†…å®¹')],-1))],2112)):((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:4},[(0,l.createCommentVNode)(' æ–‡æ¡£å†…å®¹ '),(0,l.createElementVNode)('div',qa,[(0,l.createElementVNode)('div',Xa,[(0,l.createElementVNode)('h3',Qa,(0,l.toDisplayString)(p.value),1),(0,l.createElementVNode)('span',Za,(0,l.toDisplayString)(h.value)+' èŠ‚',1)]),g.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',en,(0,l.toDisplayString)(g.value),1)):(0,l.createCommentVNode)('v-if',!0),((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(y.value,e=>((0,l.openBlock)(),(0,l.createBlock)(xa,{key:e.id,section:e,depth:0},null,8,['section']))),128))])],2112))])])],2))}}),an=(0,M.A)(tn,[['__scopeId','data-v-40ace65a']]),nn={HISTORY_TEXT:'å†å²æ­£æ–‡',HISTORY_RECORD:'å†å²è®°å½•',SEGMENTED_TEXT:'åˆ†æ®µæ­£æ–‡',SMALL_SUMMARY:'å°æ€»ç»“',LARGE_SUMMARY:'å¤§æ€»ç»“'},on={segmentCount:3,smallSummaryCount:25},ln={[nn.HISTORY_TEXT]:{name:nn.HISTORY_TEXT,enabled:!1,depth:2,order:100,role:'system'},[nn.HISTORY_RECORD]:{name:nn.HISTORY_RECORD,enabled:!1,depth:2,order:99,role:'system'},[nn.SEGMENTED_TEXT]:{name:nn.SEGMENTED_TEXT,enabled:!0,depth:2,order:100,role:'system'},[nn.SMALL_SUMMARY]:{name:nn.SMALL_SUMMARY,enabled:!0,depth:4,order:90,role:'system'},[nn.LARGE_SUMMARY]:{name:nn.LARGE_SUMMARY,enabled:!0,depth:6,order:80,role:'system'}},rn='\nâ€”â€”â€”â€”â€”â€”\n',sn='\n\n---\n\n';class cn{static extractHistoryRecordTag(e){if(!e||'string'!=typeof e)return null;const t=[...e.matchAll(/<å†å²è®°å½•>([\s\S]*?)<\/å†å²è®°å½•>/gi)];return t.length>0?t[t.length-1][1].trim():null}static extractGameTextTag(e){if(!e||'string'!=typeof e)return null;const t=[...e.matchAll(/<gametxt>([\s\S]*?)<\/gametxt>/gi)];if(t.length>0){return t[t.length-1][1].trim().replace(/<!--[\s\S]*?-->/g,'').trim()}return null}static KNOWN_FIELDS=['åºå·','æ—¥æœŸ','åœ°ç‚¹','æè¿°','æ ‡ç­¾','é‡è¦ä¿¡æ¯','è‡ªåŠ¨åŒ–ç³»ç»Ÿ'];static isFieldLine(e){const t=e.indexOf('|');if(-1===t)return null;const a=e.substring(0,t).trim();return this.KNOWN_FIELDS.includes(a)?a:null}static parseRecord(e){if(!e||'string'!=typeof e)return null;const t={_raw:e},a=e.split('\n');let n=null,o=[];const l=()=>{if(n&&o.length>0){const e=o.join('\n').trim();this.setFieldValue(t,n,e)}n=null,o=[]};for(const e of a){const t=e.trim(),a=this.isFieldLine(t);if(a){l(),n=a;const e=t.indexOf('|'),r=t.substring(e+1).trim();r&&o.push(r)}else n&&t&&o.push(t)}return l(),'number'!=typeof t.åºå·||isNaN(t.åºå·)?(console.warn('[HistoryRecordParser] è§£æå¤±è´¥ï¼šç¼ºå°‘æœ‰æ•ˆçš„åºå·å­—æ®µ'),null):{åºå·:t.åºå·,æ—¥æœŸ:t.æ—¥æœŸ||'',åœ°ç‚¹:t.åœ°ç‚¹||'',æè¿°:t.æè¿°||'',æ ‡ç­¾:t.æ ‡ç­¾||[],é‡è¦ä¿¡æ¯:t.é‡è¦ä¿¡æ¯||'',è‡ªåŠ¨åŒ–ç³»ç»Ÿ:t.è‡ªåŠ¨åŒ–ç³»ç»Ÿ||'',_raw:t._raw}}static setFieldValue(e,t,a){switch(t){case'åºå·':e.åºå·=parseInt(a,10);break;case'æ—¥æœŸ':e.æ—¥æœŸ=a;break;case'åœ°ç‚¹':e.åœ°ç‚¹=a;break;case'æè¿°':e.æè¿°=a;break;case'æ ‡ç­¾':e.æ ‡ç­¾=a.split('|').map(e=>e.trim()).filter(e=>e);break;case'é‡è¦ä¿¡æ¯':e.é‡è¦ä¿¡æ¯=a;break;case'è‡ªåŠ¨åŒ–ç³»ç»Ÿ':e.è‡ªåŠ¨åŒ–ç³»ç»Ÿ=a}}static parseRecords(e){if(!e||'string'!=typeof e)return[];const t=[],a=e.split(rn).filter(e=>e.trim());for(const e of a){const a=this.parseRecord(e.trim());a&&t.push(a)}if(0===t.length){const a=/<å†å²è®°å½•>([\s\S]*?)<\/å†å²è®°å½•>/gi,n=[...e.matchAll(a)];for(const e of n){const a=this.parseRecord(e[1].trim());a&&t.push(a)}}return t.sort((e,t)=>e.åºå·-t.åºå·),t}static parseHistoryTexts(e){if(!e||'string'!=typeof e)return[];const t=[],a=e.split(sn).filter(e=>e.trim());for(let e=0;e<a.length;e++){const n=a[e].trim().replace(/<!--[\s\S]*?-->/g,'').trim();n&&t.push({åºå·:e+1,å†…å®¹:n})}if(0===t.length){const a=/<gametxt>([\s\S]*?)<\/gametxt>/gi,n=[...e.matchAll(a)];for(let e=0;e<n.length;e++){const a=n[e][1].trim().replace(/<!--[\s\S]*?-->/g,'').trim();a&&t.push({åºå·:e+1,å†…å®¹:a})}}return t}static formatRecordFields(e,t){const a=[];for(const n of t){if('_raw'===n)continue;const t=e[n];null!=t&&''!==t&&('æ ‡ç­¾'===n&&Array.isArray(t)?t.length>0&&a.push(t.join('|')):'æ—¥æœŸ'===n||'æè¿°'===n?a.push(String(t)):'è‡ªåŠ¨åŒ–ç³»ç»Ÿ'===n?a.push(`è‡ªåŠ¨åŒ–ç³»ç»Ÿ|${t}`):a.push(String(t)))}return a.join(' ')}static formatSmallSummary(e){if(!e||0===e.length)return'';return e.map(e=>{const t=[];return e.æ—¥æœŸ&&t.push(e.æ—¥æœŸ),e.é‡è¦ä¿¡æ¯&&t.push(e.é‡è¦ä¿¡æ¯),e.è‡ªåŠ¨åŒ–ç³»ç»Ÿ&&t.push(`è‡ªåŠ¨åŒ–ç³»ç»Ÿ|${e.è‡ªåŠ¨åŒ–ç³»ç»Ÿ}`),t.join(' ')}).join(rn)}static formatLargeSummary(e){if(!e||0===e.length)return'';return e.map(e=>{const t=[];return e.æ—¥æœŸ&&t.push(e.æ—¥æœŸ),e.æè¿°&&t.push(e.æè¿°),t.join(' ')}).join(rn)}static formatSegmentedText(e){return e&&0!==e.length?e.map(e=>e.å†…å®¹).join(sn):''}static serializeRecords(e){return e&&0!==e.length?e.map(e=>{const t=[];return t.push(`åºå·|${e.åºå·}`),e.æ—¥æœŸ&&t.push(`æ—¥æœŸ|${e.æ—¥æœŸ}`),e.åœ°ç‚¹&&t.push(`åœ°ç‚¹|${e.åœ°ç‚¹}`),e.æè¿°&&t.push(`æè¿°|${e.æè¿°}`),e.æ ‡ç­¾&&e.æ ‡ç­¾.length>0&&t.push(`æ ‡ç­¾|${e.æ ‡ç­¾.join('|')}`),e.é‡è¦ä¿¡æ¯&&t.push(`é‡è¦ä¿¡æ¯|${e.é‡è¦ä¿¡æ¯}`),e.è‡ªåŠ¨åŒ–ç³»ç»Ÿ&&t.push(`è‡ªåŠ¨åŒ–ç³»ç»Ÿ|${e.è‡ªåŠ¨åŒ–ç³»ç»Ÿ}`),t.join('\n')}).join(rn):''}static serializeTexts(e){return e&&0!==e.length?e.map(e=>e.å†…å®¹).join(sn):''}static getRecordCount(e){if(!e)return 0;const t=e.split(rn).filter(e=>e.trim());if(t.length>0)return t.length;const a=e.match(/<å†å²è®°å½•>/gi);return a&&a.length>0?a.length:0}static getTextCount(e){if(!e)return 0;const t=e.split(sn).filter(e=>e.trim());if(t.length>0)return t.length;const a=e.match(/<gametxt>/gi);return a&&a.length>0?a.length:0}static getLatestSequence(e){return e&&0!==e.length?Math.max(...e.map(e=>e.åºå·)):0}static appendRecord(e,t){return e&&e.trim()?`${e}${rn}${t}`:t}static appendText(e,t){return e&&e.trim()?`${e}${sn}${t}`:t}}const un=new class{lorebook='ã€MCæˆ¿å­ã€‘';initialized=!1;isAvailable(){return'function'==typeof getWorldbook&&'function'==typeof updateWorldbookWith}async initialize(e){try{if(e&&(this.lorebook=e),!this.isAvailable())return console.warn('[WorldbookService] ä¸–ç•Œä¹¦å…¨å±€APIä¸å¯ç”¨ï¼Œå¯èƒ½ä¸åœ¨é…’é¦†ç¯å¢ƒä¸­'),this.initialized=!0,!0;try{const e=await getWorldbook(this.lorebook);console.log(`[WorldbookService] ä¸–ç•Œä¹¦"${this.lorebook}"å·²å­˜åœ¨ï¼ŒåŒ…å«${e.length}ä¸ªæ¡ç›®`)}catch{console.log(`[WorldbookService] ä¸–ç•Œä¹¦"${this.lorebook}"ä¸å­˜åœ¨ï¼Œå°†åœ¨éœ€è¦æ—¶åˆ›å»º`)}return this.initialized=!0,console.log('[WorldbookService] åˆå§‹åŒ–å®Œæˆï¼Œä¸–ç•Œä¹¦:',this.lorebook),!0}catch(e){return console.error('[WorldbookService] åˆå§‹åŒ–å¤±è´¥:',e),!1}}async getEntry(e){try{if(!this.isAvailable())return console.warn('[WorldbookService] ä¸–ç•Œä¹¦APIä¸å¯ç”¨'),null;const t=await getWorldbook(this.lorebook);if(!t||!Array.isArray(t))return null;return t.find(t=>t.name===e)||null}catch(t){return console.error(`[WorldbookService] è·å–æ¡ç›®"${e}"å¤±è´¥:`,t),null}}async getEntryContent(e){const t=await this.getEntry(e);return t?.content||''}async setEntryContent(e,t){try{if(!this.isAvailable())return console.warn('[WorldbookService] ä¸–ç•Œä¹¦APIä¸å¯ç”¨'),!1;return await this.getEntry(e)?(await updateWorldbookWith(this.lorebook,a=>a.map(a=>a.name===e?{...a,content:t}:a)),console.log(`[WorldbookService] æ›´æ–°æ¡ç›®"${e}"æˆåŠŸï¼Œå†…å®¹é•¿åº¦: ${t.length}`),!0):(console.log(`[WorldbookService] æ¡ç›®"${e}"ä¸å­˜åœ¨ï¼Œè·³è¿‡æ›´æ–°ï¼ˆä¸è‡ªåŠ¨åˆ›å»ºï¼‰`),!1)}catch(t){return console.error(`[WorldbookService] è®¾ç½®æ¡ç›®"${e}"å†…å®¹å¤±è´¥:`,t),!1}}async appendToEntry(e,t,a='\n'){try{const n=await this.getEntryContent(e),o=n?`${n}${a}${t}`:t;return await this.setEntryContent(e,o)}catch(t){return console.error(`[WorldbookService] è¿½åŠ å†…å®¹åˆ°"${e}"å¤±è´¥:`,t),!1}}async ensureWorldbookExists(){try{if(!this.isAvailable())return!1;try{return await getWorldbook(this.lorebook),!0}catch{return console.log(`[WorldbookService] æ‡’åˆ›å»ºä¸–ç•Œä¹¦"${this.lorebook}"`),await createWorldbook(this.lorebook,[]),!0}}catch(e){return console.error('[WorldbookService] ç¡®ä¿ä¸–ç•Œä¹¦å­˜åœ¨å¤±è´¥:',e),!1}}async createEntry(e,t,a){try{return this.isAvailable()?(await this.ensureWorldbookExists(),await createWorldbookEntries(this.lorebook,[{name:e,content:t,enabled:a.enabled,strategy:{type:'constant',keys:[],keys_secondary:{logic:'and_any',keys:[]},scan_depth:'same_as_global'},position:{type:'at_depth',role:a.role,depth:a.depth,order:a.order},probability:100,recursion:{prevent_incoming:!1,prevent_outgoing:!1,delay_until:null},effect:{sticky:null,cooldown:null,delay:null}}]),console.log(`[WorldbookService] åˆ›å»ºæ¡ç›®"${e}"æˆåŠŸ`),!0):(console.warn('[WorldbookService] ä¸–ç•Œä¹¦APIä¸å¯ç”¨'),!1)}catch(t){return console.error(`[WorldbookService] åˆ›å»ºæ¡ç›®"${e}"å¤±è´¥:`,t),!1}}async setEntryEnabled(e,t){try{if(!this.isAvailable())return!1;return await this.getEntry(e)?(await updateWorldbookWith(this.lorebook,a=>a.map(a=>a.name===e?{...a,enabled:t}:a)),console.log(`[WorldbookService] ${t?'å¯ç”¨':'ç¦ç”¨'}æ¡ç›®"${e}"`),!0):(console.warn(`[WorldbookService] æ¡ç›®"${e}"ä¸å­˜åœ¨`),!1)}catch(t){return console.error(`[WorldbookService] è®¾ç½®æ¡ç›®"${e}"å¯ç”¨çŠ¶æ€å¤±è´¥:`,t),!1}}async entryExists(e){return null!==await this.getEntry(e)}async ensureAllEntries(){try{const e=Object.values(nn);for(const t of e){if(!await this.entryExists(t)){const e=ln[t];e&&(await this.createEntry(t,'',e),console.log(`[WorldbookService] åˆ›å»ºç¼ºå¤±çš„æ¡ç›®: ${t}`))}}return!0}catch(e){return console.error('[WorldbookService] ç¡®ä¿æ¡ç›®å­˜åœ¨å¤±è´¥:',e),!1}}async switchToFullMode(){try{return await this.setEntryEnabled(nn.HISTORY_TEXT,!0),await this.setEntryEnabled(nn.HISTORY_RECORD,!0),await this.setEntryEnabled(nn.SEGMENTED_TEXT,!1),await this.setEntryEnabled(nn.SMALL_SUMMARY,!1),await this.setEntryEnabled(nn.LARGE_SUMMARY,!1),console.log('[WorldbookService] å·²åˆ‡æ¢åˆ°å…¨é‡æ¨¡å¼'),!0}catch(e){return console.error('[WorldbookService] åˆ‡æ¢åˆ°å…¨é‡æ¨¡å¼å¤±è´¥:',e),!1}}async switchToSegmentedMode(){try{return await this.setEntryEnabled(nn.HISTORY_TEXT,!1),await this.setEntryEnabled(nn.HISTORY_RECORD,!1),await this.setEntryEnabled(nn.SEGMENTED_TEXT,!0),await this.setEntryEnabled(nn.SMALL_SUMMARY,!0),await this.setEntryEnabled(nn.LARGE_SUMMARY,!0),console.log('[WorldbookService] å·²åˆ‡æ¢åˆ°åˆ†æ®µæ¨¡å¼'),!0}catch(e){return console.error('[WorldbookService] åˆ‡æ¢åˆ°åˆ†æ®µæ¨¡å¼å¤±è´¥:',e),!1}}async getContextSnapshot(){const e={};for(const t of Object.values(nn))e[t]=await this.getEntryContent(t);return e}async restoreFromSnapshot(e){try{for(const[t,a]of Object.entries(e))await this.setEntryContent(t,a);return console.log('[WorldbookService] ä»å¿«ç…§æ¢å¤å®Œæˆ'),!0}catch(e){return console.error('[WorldbookService] ä»å¿«ç…§æ¢å¤å¤±è´¥:',e),!1}}async clearAllContextEntries(){try{for(const e of Object.values(nn))await this.setEntryContent(e,'');return console.log('[WorldbookService] å·²æ¸…ç©ºæ‰€æœ‰ä¸Šä¸‹æ–‡æ¡ç›®'),!0}catch(e){return console.error('[WorldbookService] æ¸…ç©ºæ¡ç›®å¤±è´¥:',e),!1}}},dn={class:'history-text-panel'},mn={class:'panel-header'},vn={class:'header-left'},pn={key:0,class:'text-count'},gn={class:'header-actions'},fn=['disabled'],hn={class:'search-bar'},yn={key:0,class:'search-result-count'},Vn={class:'panel-body'},En={key:0,class:'state-container loading-state'},bn={class:'state-container error-state'},Sn={class:'state-text'},Nn={class:'text-list'},kn=['onClick'],Cn={class:'text-meta'},wn={class:'text-number'},Mn={key:0,class:'text-preview'},An={class:'expand-icon'},In={key:0,class:'text-content'},Dn=['innerHTML'],Bn={class:'content-actions'},xn=['onClick'],_n={key:0,class:'panel-footer'},Tn={class:'footer-info'},$n={class:'info-text'},Ln=(0,l.defineComponent)({__name:'HistoryTextPanel',emits:['close'],setup(e){const t=(0,l.ref)(!1),a=(0,l.ref)(null),n=(0,l.ref)([]),o=(0,l.ref)(''),r=(0,l.ref)(new Set),s=(0,l.computed)(()=>{if(!o.value.trim())return n.value;const e=o.value.toLowerCase();return n.value.filter(t=>t.å†…å®¹.toLowerCase().includes(e))}),c=async()=>{t.value=!0,a.value=null;try{await un.initialize();const e=await un.getEntryContent(nn.HISTORY_TEXT);n.value=cn.parseHistoryTexts(e),console.log('[HistoryTextPanel] å·²åŠ è½½',n.value.length,'æ¡å†å²æ­£æ–‡')}catch(e){console.error('[HistoryTextPanel] åŠ è½½å¤±è´¥:',e),a.value=e instanceof Error?e.message:'åŠ è½½å†å²æ­£æ–‡å¤±è´¥'}finally{t.value=!1}},i=()=>{},u=()=>{s.value.forEach(e=>{r.value.add(e.åºå·)})},d=()=>{r.value.clear()},m=e=>{const t=e.replace(/\n/g,' ').replace(/\s+/g,' ').trim();return t.length<=60?t:t.substring(0,60)+'...'};return(0,l.onMounted)(()=>{c()}),(e,v)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',dn,[(0,l.createCommentVNode)(' é¢æ¿å¤´éƒ¨ '),(0,l.createElementVNode)('div',mn,[(0,l.createElementVNode)('div',vn,[v[2]||(v[2]=(0,l.createElementVNode)('span',{class:'panel-icon'},'ğŸ“œ',-1)),v[3]||(v[3]=(0,l.createElementVNode)('h2',{class:'panel-title'},'å†å²æ­£æ–‡',-1)),n.value.length>0?((0,l.openBlock)(),(0,l.createElementBlock)('span',pn,' å…± '+(0,l.toDisplayString)(n.value.length)+' æ¡ ',1)):(0,l.createCommentVNode)('v-if',!0)]),(0,l.createElementVNode)('div',gn,[(0,l.createElementVNode)('button',{class:'btn-refresh',onClick:c,disabled:t.value,title:'åˆ·æ–°'},'ğŸ”„',8,fn),(0,l.createElementVNode)('button',{class:'btn-close',onClick:v[0]||(v[0]=t=>e.$emit('close'))},'âœ•')])]),(0,l.createCommentVNode)(' æœç´¢æ  '),(0,l.createElementVNode)('div',hn,[(0,l.withDirectives)((0,l.createElementVNode)('input',{'onUpdate:modelValue':v[1]||(v[1]=e=>o.value=e),type:'text',class:'search-input',placeholder:'æœç´¢æ­£æ–‡å†…å®¹...',onInput:i},null,544),[[l.vModelText,o.value]]),o.value?((0,l.openBlock)(),(0,l.createElementBlock)('span',yn,' æ‰¾åˆ° '+(0,l.toDisplayString)(s.value.length)+' æ¡ ',1)):(0,l.createCommentVNode)('v-if',!0)]),(0,l.createCommentVNode)(' é¢æ¿ä¸»ä½“ '),(0,l.createElementVNode)('div',Vn,[(0,l.createCommentVNode)(' åŠ è½½çŠ¶æ€ '),t.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',En,[...v[4]||(v[4]=[(0,l.createElementVNode)('span',{class:'state-icon loading-spinner'},'â³',-1),(0,l.createElementVNode)('span',{class:'state-text'},'åŠ è½½ä¸­...',-1)])])):a.value?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createCommentVNode)(' é”™è¯¯æç¤º '),(0,l.createElementVNode)('div',bn,[v[5]||(v[5]=(0,l.createElementVNode)('span',{class:'state-icon error-icon'},'âš ï¸',-1)),(0,l.createElementVNode)('span',Sn,(0,l.toDisplayString)(a.value),1),(0,l.createElementVNode)('button',{class:'btn btn-secondary',onClick:c},'é‡æ–°åŠ è½½')])],2112)):0===n.value.length?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:2},[(0,l.createCommentVNode)(' ç©ºçŠ¶æ€ '),v[6]||(v[6]=(0,l.createElementVNode)('div',{class:'state-container empty-state'},[(0,l.createElementVNode)('span',{class:'state-icon'},'ğŸ“'),(0,l.createElementVNode)('span',{class:'state-text'},'æš‚æ— å†å²æ­£æ–‡'),(0,l.createElementVNode)('p',{class:'state-hint'},'å†å²æ­£æ–‡ä¼šåœ¨æ¸¸æˆè¿›è¡Œè¿‡ç¨‹ä¸­è‡ªåŠ¨è®°å½•')],-1))],2112)):0===s.value.length?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:3},[(0,l.createCommentVNode)(' æœç´¢æ— ç»“æœ '),v[7]||(v[7]=(0,l.createElementVNode)('div',{class:'state-container empty-state'},[(0,l.createElementVNode)('span',{class:'state-icon'},'ğŸ”'),(0,l.createElementVNode)('span',{class:'state-text'},'æœªæ‰¾åˆ°åŒ¹é…å†…å®¹'),(0,l.createElementVNode)('p',{class:'state-hint'},'å°è¯•ä½¿ç”¨å…¶ä»–å…³é”®è¯æœç´¢')],-1))],2112)):((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:4},[(0,l.createCommentVNode)(' å†å²æ­£æ–‡åˆ—è¡¨ '),(0,l.createElementVNode)('div',Nn,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(s.value,(e,t)=>{return(0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.åºå·,class:(0,l.normalizeClass)(['text-item',{'is-expanded':r.value.has(e.åºå·)}])},[(0,l.createCommentVNode)(' æ¡ç›®å¤´éƒ¨ '),(0,l.createElementVNode)('div',{class:'text-header',onClick:t=>{return a=e.åºå·,void(r.value.has(a)?r.value.delete(a):r.value.add(a));var a}},[(0,l.createElementVNode)('div',Cn,[(0,l.createElementVNode)('span',wn,'#'+(0,l.toDisplayString)(e.åºå·),1),r.value.has(e.åºå·)?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('span',Mn,(0,l.toDisplayString)(m(e.å†…å®¹)),1))]),(0,l.createElementVNode)('span',An,(0,l.toDisplayString)(r.value.has(e.åºå·)?'â–¼':'â–¶'),1)],8,kn),(0,l.createCommentVNode)(' æ¡ç›®å†…å®¹ï¼ˆå±•å¼€æ—¶æ˜¾ç¤ºï¼‰ '),r.value.has(e.åºå·)?((0,l.openBlock)(),(0,l.createElementBlock)('div',In,[(0,l.createElementVNode)('div',{class:'content-body',innerHTML:(a=e.å†…å®¹,a.replace(/\n/g,'<br>'))},null,8,Dn),(0,l.createElementVNode)('div',Bn,[(0,l.createElementVNode)('button',{class:'btn-action',onClick:t=>(async e=>{try{await navigator.clipboard.writeText(e),'undefined'!=typeof toastr&&toastr.success('å·²å¤åˆ¶åˆ°å‰ªè´´æ¿')}catch(e){console.error('[HistoryTextPanel] å¤åˆ¶å¤±è´¥:',e),'undefined'!=typeof toastr&&toastr.error('å¤åˆ¶å¤±è´¥')}})(e.å†…å®¹),title:'å¤åˆ¶å†…å®¹'},'ğŸ“‹ å¤åˆ¶',8,xn)])])):(0,l.createCommentVNode)('v-if',!0)],2);var a}),128))])],2112))]),(0,l.createCommentVNode)(' åº•éƒ¨å·¥å…·æ  '),n.value.length>0?((0,l.openBlock)(),(0,l.createElementBlock)('div',_n,[(0,l.createElementVNode)('div',Tn,[(0,l.createElementVNode)('span',$n,' æ˜¾ç¤º '+(0,l.toDisplayString)(s.value.length)+' / '+(0,l.toDisplayString)(n.value.length)+' æ¡ ',1)]),(0,l.createElementVNode)('div',{class:'footer-actions'},[(0,l.createElementVNode)('button',{class:'btn btn-secondary',onClick:u},'å…¨éƒ¨å±•å¼€'),(0,l.createElementVNode)('button',{class:'btn btn-secondary',onClick:d},'å…¨éƒ¨æ”¶èµ·')])])):(0,l.createCommentVNode)('v-if',!0)]))}}),On=(0,M.A)(Ln,[['__scopeId','data-v-9256f22a']]),Rn={class:'changelog-panel'},Un={class:'panel-header'},jn={class:'header-right'},Pn=['disabled'],zn={class:'panel-body'},Fn={key:0,class:'loading-state'},Hn={class:'error-state'},Wn={class:'error-message'},Gn=['innerHTML'],Jn={class:'panel-footer'},Kn={class:'footer-info'},Yn={key:0,class:'update-time'},qn={key:1,class:'cache-status'},Xn={class:'footer-actions'},Qn=['disabled'],Zn=['href'],eo={class:'cache-dialog'},to={class:'dialog-body'},ao={class:'cache-options'},no={class:'cache-option'},oo={class:'cache-option'},lo={class:'dialog-footer'},ro=['disabled'],so='CrHouse815',co='-MC-_lite-',io=(0,l.defineComponent)({__name:'ChangelogPanel',emits:['close'],setup(e,{emit:t}){const a=`https://cdn.jsdelivr.net/gh/${so}/${co}@main`,n=`https://github.com/${so}/${co}`,o=(0,l.ref)(!1),r=(0,l.ref)('æ­£åœ¨åŠ è½½æ›´æ–°æ—¥å¿—...'),s=(0,l.ref)(null),c=(0,l.ref)(''),i=(0,l.ref)(null),u=(0,l.ref)(!1),d=(0,l.ref)(!1),m=(0,l.ref)({browserCache:!0,forceRefresh:!0}),v=(0,l.computed)(()=>n),p=(0,l.computed)(()=>c.value?b(c.value):''),g=(0,l.computed)(()=>m.value.browserCache||m.value.forceRefresh),f=async(e=!1)=>{o.value=!0,r.value='æ­£åœ¨åŠ è½½æ›´æ–°æ—¥å¿—...',s.value=null;try{const t=Date.now(),n=`${a}/CHANGELOG.md?t=${t}`;console.log('[ChangelogPanel] æ­£åœ¨è·å–æ›´æ–°æ—¥å¿—:',n,e?'(å¼ºåˆ¶æ— ç¼“å­˜)':'');const o=e?{cache:'no-store',headers:{'Cache-Control':'no-cache, no-store, must-revalidate',Pragma:'no-cache'}}:{},l=await fetch(n,o);if(!l.ok)throw new Error(`HTTP ${l.status}: ${l.statusText}`);c.value=await l.text(),i.value=new Date,console.log('[ChangelogPanel] æ›´æ–°æ—¥å¿—è·å–æˆåŠŸ, é•¿åº¦:',c.value.length)}catch(e){console.error('[ChangelogPanel] è·å–æ›´æ–°æ—¥å¿—å¤±è´¥:',e),s.value=`è·å–æ›´æ–°æ—¥å¿—å¤±è´¥: ${e.message||'ç½‘ç»œé”™è¯¯'}`,c.value=E(),c.value&&(s.value=null,console.log('[ChangelogPanel] ä½¿ç”¨æœ¬åœ°æ›´æ–°æ—¥å¿—'))}finally{o.value=!1}},h=()=>{d.value=!0},y=async()=>{d.value=!1,o.value=!0,u.value=!1;const e=[];try{m.value.browserCache&&(r.value='æ­£åœ¨æ¸…ç†æµè§ˆå™¨ç¼“å­˜...',await V(),e.push('æµè§ˆå™¨ç¼“å­˜'),console.log('[ChangelogPanel] æµè§ˆå™¨ç¼“å­˜å·²æ¸…ç†')),m.value.forceRefresh?(r.value='æ­£åœ¨å¼ºåˆ¶åˆ·æ–°å†…å®¹...',await f(!0)):await f(!1),u.value=!0,setTimeout(()=>{u.value=!1},3e3),e.length>0&&console.log('[ChangelogPanel] å·²æ¸…ç†:',e.join(', '))}catch(e){console.error('[ChangelogPanel] ç¼“å­˜æ¸…ç†å¤±è´¥:',e),s.value=`ç¼“å­˜æ¸…ç†å¤±è´¥: ${e.message||'æœªçŸ¥é”™è¯¯'}`}finally{o.value=!1,r.value='æ­£åœ¨åŠ è½½æ›´æ–°æ—¥å¿—...'}},V=async()=>{try{if('caches'in window){const e=await caches.keys(),t=e.filter(e=>e.includes('jsdelivr')||e.includes('workbox')||e.includes('runtime'));for(const e of t)await caches.delete(e),console.log('[ChangelogPanel] å·²åˆ é™¤ç¼“å­˜:',e);for(const t of e)try{const e=await caches.open(t),a=await e.keys();for(const t of a)(t.url.includes('jsdelivr.net')||t.url.includes(so))&&(await e.delete(t),console.log('[ChangelogPanel] å·²åˆ é™¤ç¼“å­˜æ¡ç›®:',t.url))}catch(e){}}const e=[];for(let t=0;t<localStorage.length;t++){const a=localStorage.key(t);a&&(a.includes('jsdelivr')||a.includes('changelog')||a.includes('CHANGELOG'))&&e.push(a)}e.forEach(e=>{localStorage.removeItem(e),console.log('[ChangelogPanel] å·²åˆ é™¤ localStorage:',e)});const t=[];for(let e=0;e<sessionStorage.length;e++){const a=sessionStorage.key(e);a&&(a.includes('jsdelivr')||a.includes('changelog')||a.includes('CHANGELOG'))&&t.push(a)}t.forEach(e=>{sessionStorage.removeItem(e),console.log('[ChangelogPanel] å·²åˆ é™¤ sessionStorage:',e)})}catch(e){console.warn('[ChangelogPanel] æ¸…ç†æµè§ˆå™¨ç¼“å­˜æ—¶å‡ºç°è­¦å‘Š:',e)}},E=()=>`# MClite æ›´æ–°æ—¥å¿—\n\n> æ­¤ä¸ºæœ¬åœ°ç¼“å­˜ç‰ˆæœ¬ï¼Œå¦‚éœ€æŸ¥çœ‹æœ€æ–°æ›´æ–°æ—¥å¿—ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥åé‡è¯•ã€‚\n\n**ä¸»è¦æ›´æ–°**ï¼š\n- æ–°å¢æ›´æ–°æ—¥å¿—é¢æ¿\n- æ·»åŠ ç‰ˆæœ¬å·æ˜¾ç¤º\n- æ”¯æŒä» GitHub è¿œç¨‹è·å–æ›´æ–°æ—¥å¿—\n\n---\n\n*å®Œæ•´æ›´æ–°æ—¥å¿—è¯·è®¿é—® [GitHub ä»“åº“](${n})*\n`,b=e=>{const t=e.split('\n'),a=[];let n=!1,o=[],l='';for(let e=0;e<t.length;e++){let r=t[e];if(r.startsWith('```')){if(n){n=!1;const e=l?' language-'+l:'',t=S(o.join('\n'));a.push('<pre class="code-block'+e+'"><code>'+t+'</code></pre>'),l=''}else n=!0,l=r.slice(3).trim(),o=[];continue}if(n){o.push(r);continue}if(r=S(r),r.startsWith('### ')){a.push('<h4 class="md-h4">'+C(r.slice(4))+'</h4>');continue}if(r.startsWith('## ')){a.push('<h3 class="md-h3">'+C(r.slice(3))+'</h3>');continue}if(r.startsWith('# ')){a.push('<h2 class="md-h2">'+C(r.slice(2))+'</h2>');continue}if('---'===r||'----'===r||'-----'===r){a.push('<hr class="md-hr">');continue}if(r.startsWith('&gt; ')){a.push('<blockquote class="md-quote">'+C(r.slice(5))+'</blockquote>');continue}if(r.startsWith('- ')){a.push('<li class="md-li">'+C(r.slice(2))+'</li>');continue}const s=N(r);s?a.push('<li class="md-li-ordered">'+C(s)+'</li>'):r.trim()?a.push('<p class="md-p">'+C(r)+'</p>'):a.push('')}let r=a.join('\n');return r=r.split('</blockquote>\n<blockquote class="md-quote">').join('<br>'),r},S=e=>e.split('&').join('&amp;').split('<').join('&lt;').split('>').join('&gt;').split('"').join('&quot;'),N=e=>{for(let t=1;t<=3;t++){const a=e.slice(0,t);if(k(a)&&'.'===e.charAt(t)&&' '===e.charAt(t+1))return e.slice(t+2)}return null},k=e=>{for(let t=0;t<e.length;t++){const a=e.charCodeAt(t);if(a<48||a>57)return!1}return e.length>0},C=e=>{let t='',a=0;for(;a<e.length;){if('`'===e.charAt(a)){const n=e.indexOf('`',a+1);if(n>a){t+='<code class="inline-code">'+e.slice(a+1,n)+'</code>',a=n+1;continue}}if('*'===e.charAt(a)&&'*'===e.charAt(a+1)){const n=w(e,a+2);if(n>a){t+='<strong>'+e.slice(a+2,n)+'</strong>',a=n+2;continue}}if('*'===e.charAt(a)&&'*'!==e.charAt(a+1)){const n=M(e,a+1);if(n>a){t+='<em>'+e.slice(a+1,n)+'</em>',a=n+1;continue}}if('['===e.charAt(a)){const n=e.indexOf(']',a+1);if(n>a&&'('===e.charAt(n+1)){const o=e.indexOf(')',n+2);if(o>n){const l=e.slice(a+1,n);t+='<a href="'+e.slice(n+2,o)+'" target="_blank" rel="noopener">'+l+'</a>',a=o+1;continue}}}if('v'===e.charAt(a)&&A(e.charAt(a+1))){const n=I(e,a+1);if(n>a+1){const o=e.slice(a,n);if(D(o)){t+='<span class="version-highlight">'+o+'</span>',a=n;continue}}}t+=e.charAt(a),a++}return t},w=(e,t)=>{for(let a=t;a<e.length-1;a++)if('*'===e.charAt(a)&&'*'===e.charAt(a+1))return a;return-1},M=(e,t)=>{for(let a=t;a<e.length;a++)if('*'===e.charAt(a)&&'*'!==e.charAt(a+1)&&(0===a||'*'!==e.charAt(a-1)))return a;return-1},A=e=>{const t=e.charCodeAt(0);return t>=48&&t<=57},I=(e,t)=>{let a=t,n=0;for(;a<e.length;){const o=e.charAt(a);if(A(o))a++;else{if(!('.'===o&&n<2&&a>t&&A(e.charAt(a-1))))break;n++,a++}}return a},D=e=>{let t=0;for(let a=0;a<e.length;a++)'.'===e.charAt(a)&&t++;return t>=1};return(0,l.onMounted)(()=>{f()}),(e,t)=>{return(0,l.openBlock)(),(0,l.createElementBlock)('div',Rn,[(0,l.createCommentVNode)(' é¢æ¿å¤´éƒ¨ '),(0,l.createElementVNode)('div',Un,[t[5]||(t[5]=(0,l.createElementVNode)('div',{class:'header-left'},[(0,l.createElementVNode)('span',{class:'header-icon'},'ğŸ“‹'),(0,l.createElementVNode)('h3',{class:'header-title'},'æ›´æ–°æ—¥å¿—')],-1)),(0,l.createElementVNode)('div',jn,[(0,l.createElementVNode)('button',{class:'btn-refresh',onClick:f,disabled:o.value,title:'åˆ·æ–°'},[(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(['refresh-icon',{spinning:o.value}])},'ğŸ”„',2)],8,Pn),(0,l.createElementVNode)('button',{class:'btn-close',onClick:t[0]||(t[0]=t=>e.$emit('close')),title:'å…³é—­'},'âœ•')])]),(0,l.createCommentVNode)(' é¢æ¿å†…å®¹ '),(0,l.createElementVNode)('div',zn,[(0,l.createCommentVNode)(' åŠ è½½çŠ¶æ€ '),o.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',Fn,[t[6]||(t[6]=(0,l.createElementVNode)('div',{class:'loading-spinner'},null,-1)),(0,l.createElementVNode)('p',null,(0,l.toDisplayString)(r.value),1)])):s.value?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createCommentVNode)(' é”™è¯¯çŠ¶æ€ '),(0,l.createElementVNode)('div',Hn,[t[7]||(t[7]=(0,l.createElementVNode)('span',{class:'error-icon'},'âš ï¸',-1)),(0,l.createElementVNode)('p',Wn,(0,l.toDisplayString)(s.value),1),(0,l.createElementVNode)('button',{class:'btn-retry',onClick:f},'é‡è¯•')])],2112)):((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:2},[(0,l.createCommentVNode)(' æ›´æ–°æ—¥å¿—å†…å®¹ '),(0,l.createElementVNode)('div',{class:'changelog-content',innerHTML:p.value},null,8,Gn)],2112))]),(0,l.createCommentVNode)(' é¢æ¿åº•éƒ¨ '),(0,l.createElementVNode)('div',Jn,[(0,l.createElementVNode)('div',Kn,[i.value?((0,l.openBlock)(),(0,l.createElementBlock)('span',Yn,' æœ€åæ›´æ–°ï¼š'+(0,l.toDisplayString)((a=i.value,a.toLocaleString('zh-CN',{year:'numeric',month:'2-digit',day:'2-digit',hour:'2-digit',minute:'2-digit'}))),1)):(0,l.createCommentVNode)('v-if',!0),u.value?((0,l.openBlock)(),(0,l.createElementBlock)('span',qn,' âœ“ ç¼“å­˜å·²æ¸…ç† ')):(0,l.createCommentVNode)('v-if',!0)]),(0,l.createElementVNode)('div',Xn,[(0,l.createElementVNode)('button',{class:'btn-clear-cache',onClick:h,disabled:o.value,title:'æ¸…ç†æµè§ˆå™¨ç¼“å­˜å¹¶ä» CDN è·å–æœ€æ–°ç‰ˆæœ¬'},[...t[8]||(t[8]=[(0,l.createElementVNode)('span',{class:'cache-icon'},'ğŸ—‘ï¸',-1),(0,l.createElementVNode)('span',null,'æ¸…ç†ç¼“å­˜',-1)])],8,Qn),(0,l.createElementVNode)('a',{class:'btn-github',href:v.value,target:'_blank',rel:'noopener noreferrer',title:'åœ¨ GitHub ä¸ŠæŸ¥çœ‹'},[...t[9]||(t[9]=[(0,l.createElementVNode)('span',{class:'github-icon'},'ğŸ“‚',-1),(0,l.createElementVNode)('span',null,'GitHub',-1)])],8,Zn)])]),(0,l.createCommentVNode)(' ç¼“å­˜æ¸…ç†ç¡®è®¤å¯¹è¯æ¡† '),d.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'cache-dialog-overlay',onClick:t[4]||(t[4]=(0,l.withModifiers)(e=>d.value=!1,['self']))},[(0,l.createElementVNode)('div',eo,[t[13]||(t[13]=(0,l.createElementVNode)('div',{class:'dialog-header'},[(0,l.createElementVNode)('span',{class:'dialog-icon'},'ğŸ—‘ï¸'),(0,l.createElementVNode)('h4',null,'æ¸…ç†ç¼“å­˜')],-1)),(0,l.createElementVNode)('div',to,[t[12]||(t[12]=(0,l.createElementVNode)('p',null,'é€‰æ‹©è¦æ‰§è¡Œçš„ç¼“å­˜æ¸…ç†æ“ä½œï¼š',-1)),(0,l.createElementVNode)('div',ao,[(0,l.createElementVNode)('label',no,[(0,l.withDirectives)((0,l.createElementVNode)('input',{type:'checkbox','onUpdate:modelValue':t[1]||(t[1]=e=>m.value.browserCache=e)},null,512),[[l.vModelCheckbox,m.value.browserCache]]),t[10]||(t[10]=(0,l.createElementVNode)('span',{class:'option-text'},[(0,l.createElementVNode)('strong',null,'æµè§ˆå™¨ç¼“å­˜'),(0,l.createElementVNode)('small',null,'æ¸…ç†æœ¬åœ°æµè§ˆå™¨å­˜å‚¨çš„ jsdelivr èµ„æºç¼“å­˜')],-1))]),(0,l.createElementVNode)('label',oo,[(0,l.withDirectives)((0,l.createElementVNode)('input',{type:'checkbox','onUpdate:modelValue':t[2]||(t[2]=e=>m.value.forceRefresh=e)},null,512),[[l.vModelCheckbox,m.value.forceRefresh]]),t[11]||(t[11]=(0,l.createElementVNode)('span',{class:'option-text'},[(0,l.createElementVNode)('strong',null,'å¼ºåˆ¶åˆ·æ–°'),(0,l.createElementVNode)('small',null,'ä½¿ç”¨ no-cache æ¨¡å¼é‡æ–°è·å–èµ„æº')],-1))])])]),(0,l.createElementVNode)('div',lo,[(0,l.createElementVNode)('button',{class:'btn-cancel',onClick:t[3]||(t[3]=e=>d.value=!1)},'å–æ¶ˆ'),(0,l.createElementVNode)('button',{class:'btn-confirm',onClick:y,disabled:!g.value},'ç¡®è®¤æ¸…ç†',8,ro)])])])):(0,l.createCommentVNode)('v-if',!0)]);var a}}}),uo=(0,M.A)(io,[['__scopeId','data-v-64d33b34']]),mo={key:0,viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'2'},vo={key:1,viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'2'},po={key:1,class:'toggle-placeholder'},go={key:3,class:'edit-actions'},fo={key:4,class:'children-hint'},ho={class:'item-actions'},yo={key:0,class:'item-children'},Vo=(0,l.defineComponent)({__name:'TreeItem',props:{name:{},value:{},path:{},depth:{},expandedPaths:{},editingPath:{},searchQuery:{default:''}},emits:['toggle','edit','save','cancel','delete','add-child','copy-path'],setup(e,{emit:t}){const a=e,n=t,o=(0,l.ref)(null),r=(0,l.ref)(!1),s=(0,l.ref)(null),c=(0,l.computed)(()=>null===a.value?'null':void 0===a.value?'undefined':Array.isArray(a.value)?'array':typeof a.value),i=(0,l.computed)(()=>'object'===c.value||'array'===c.value),u=(0,l.computed)(()=>a.expandedPaths.has(a.path)),d=(0,l.computed)(()=>a.editingPath===a.path),m=(0,l.computed)(()=>{if(!a.searchQuery)return!1;const e=a.searchQuery.toLowerCase();return a.path.toLowerCase().includes(e)||a.name.toLowerCase().includes(e)||!i.value&&String(a.value).toLowerCase().includes(e)}),v=(0,l.computed)(()=>/^\d+$/.test(a.name)?`[${a.name}]`:a.name),p=(0,l.computed)(()=>{if(null===a.value)return'null';if(void 0===a.value)return'undefined';switch(c.value){case'string':{const e=String(a.value),t=80;return`"${e.length>t?e.substring(0,t)+'...':e}"`}case'number':default:return String(a.value);case'boolean':return a.value?'true':'false';case'array':return`Array(${a.value.length})`;case'object':return`Object {${Object.keys(a.value).length}}`}}),g=(0,l.computed)(()=>'array'===c.value?`[${a.value.length}]`:'object'===c.value?`{${Object.keys(a.value).length}}`:''),f=(0,l.computed)(()=>'array'===c.value||'object'===c.value?a.value:{});function h(e){return'array'===c.value?`${a.path}[${e}]`:`${a.path}.${e}`}function y(){i.value&&n('toggle',a.path)}function V(){i.value||(s.value=a.value,n('edit',a.path),(0,l.nextTick)(()=>{o.value?.focus(),o.value instanceof HTMLInputElement&&o.value.select()}))}function E(){n('save',a.path,s.value)}return(0,l.watch)(()=>a.editingPath,e=>{e===a.path&&(s.value=a.value,(0,l.nextTick)(()=>{o.value?.focus(),o.value instanceof HTMLInputElement&&o.value.select()}))}),(e,t)=>{const a=(0,l.resolveComponent)('TreeItem',!0);return(0,l.openBlock)(),(0,l.createElementBlock)('div',{class:(0,l.normalizeClass)(['tree-item',{'is-expanded':u.value,'is-match':m.value}])},[(0,l.createCommentVNode)(' èŠ‚ç‚¹è¡Œ '),(0,l.createElementVNode)('div',{class:'item-row',style:(0,l.normalizeStyle)({paddingLeft:16*e.depth+8+'px'}),onClick:y,onMouseenter:t[11]||(t[11]=e=>r.value=!0),onMouseleave:t[12]||(t[12]=e=>r.value=!1)},[(0,l.createCommentVNode)(' å±•å¼€/æŠ˜å å›¾æ ‡ '),i.value?((0,l.openBlock)(),(0,l.createElementBlock)('span',{key:0,class:'toggle-btn',onClick:t[0]||(t[0]=(0,l.withModifiers)(t=>e.$emit('toggle',e.path),['stop']))},[u.value?((0,l.openBlock)(),(0,l.createElementBlock)('svg',mo,[...t[20]||(t[20]=[(0,l.createElementVNode)('path',{d:'M19 9l-7 7-7-7'},null,-1)])])):((0,l.openBlock)(),(0,l.createElementBlock)('svg',vo,[...t[21]||(t[21]=[(0,l.createElementVNode)('path',{d:'M9 5l7 7-7 7'},null,-1)])]))])):((0,l.openBlock)(),(0,l.createElementBlock)('span',po)),(0,l.createCommentVNode)(' é”®å '),(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(['item-key',{'is-meta':'$meta'===e.name}])},(0,l.toDisplayString)(v.value),3),(0,l.createCommentVNode)(' åˆ†éš”ç¬¦ '),t[27]||(t[27]=(0,l.createElementVNode)('span',{class:'separator'},':',-1)),(0,l.createCommentVNode)(' å€¼æ˜¾ç¤º/ç¼–è¾‘ '),d.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:2,class:'inline-editor',onClick:t[7]||(t[7]=(0,l.withModifiers)(()=>{},['stop']))},['string'===c.value?(0,l.withDirectives)(((0,l.openBlock)(),(0,l.createElementBlock)('input',{key:0,ref_key:'editorInput',ref:o,type:'text','onUpdate:modelValue':t[1]||(t[1]=e=>s.value=e),class:'edit-input',onKeydown:[(0,l.withKeys)(E,['enter']),t[2]||(t[2]=(0,l.withKeys)(t=>e.$emit('cancel'),['escape']))]},null,544)),[[l.vModelText,s.value]]):'number'===c.value?(0,l.withDirectives)(((0,l.openBlock)(),(0,l.createElementBlock)('input',{key:1,ref_key:'editorInput',ref:o,type:'number','onUpdate:modelValue':t[3]||(t[3]=e=>s.value=e),class:'edit-input',step:'any',onKeydown:[(0,l.withKeys)(E,['enter']),t[4]||(t[4]=(0,l.withKeys)(t=>e.$emit('cancel'),['escape']))]},null,544)),[[l.vModelText,s.value,void 0,{number:!0}]]):'boolean'===c.value?(0,l.withDirectives)(((0,l.openBlock)(),(0,l.createElementBlock)('select',{key:2,ref_key:'editorInput',ref:o,'onUpdate:modelValue':t[5]||(t[5]=e=>s.value=e),class:'edit-select',onChange:E},[...t[22]||(t[22]=[(0,l.createElementVNode)('option',{value:!0},'true',-1),(0,l.createElementVNode)('option',{value:!1},'false',-1)])],544)),[[l.vModelSelect,s.value]]):((0,l.openBlock)(),(0,l.createElementBlock)('div',go,[(0,l.createElementVNode)('button',{class:'btn-edit-save',onClick:E},'âœ“'),(0,l.createElementVNode)('button',{class:'btn-edit-cancel',onClick:t[6]||(t[6]=t=>e.$emit('cancel'))},'âœ—')]))])):((0,l.openBlock)(),(0,l.createElementBlock)('span',{key:3,class:(0,l.normalizeClass)(['item-value',[`type-${c.value}`]]),onDblclick:(0,l.withModifiers)(V,['stop'])},(0,l.toDisplayString)(p.value),35)),(0,l.createCommentVNode)(' å­èŠ‚ç‚¹æ•°é‡æç¤º '),i.value&&!u.value?((0,l.openBlock)(),(0,l.createElementBlock)('span',fo,(0,l.toDisplayString)(g.value),1)):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' æ“ä½œæŒ‰é’® '),(0,l.withDirectives)((0,l.createElementVNode)('div',ho,[(0,l.createElementVNode)('button',{class:'action-btn',onClick:t[8]||(t[8]=(0,l.withModifiers)(t=>e.$emit('copy-path',e.path),['stop'])),title:'å¤åˆ¶è·¯å¾„'},[...t[23]||(t[23]=[(0,l.createElementVNode)('svg',{viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'2'},[(0,l.createElementVNode)('rect',{x:'9',y:'9',width:'13',height:'13',rx:'2'}),(0,l.createElementVNode)('path',{d:'M5 15H4a2 2 0 01-2-2V4a2 2 0 012-2h9a2 2 0 012 2v1'})],-1)])]),i.value?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('button',{key:0,class:'action-btn',onClick:(0,l.withModifiers)(V,['stop']),title:'ç¼–è¾‘'},[...t[24]||(t[24]=[(0,l.createElementVNode)('svg',{viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'2'},[(0,l.createElementVNode)('path',{d:'M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7'}),(0,l.createElementVNode)('path',{d:'M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z'})],-1)])])),i.value?((0,l.openBlock)(),(0,l.createElementBlock)('button',{key:1,class:'action-btn',onClick:t[9]||(t[9]=(0,l.withModifiers)(t=>e.$emit('add-child',e.path),['stop'])),title:'æ·»åŠ å­é¡¹'},[...t[25]||(t[25]=[(0,l.createElementVNode)('svg',{viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'2'},[(0,l.createElementVNode)('circle',{cx:'12',cy:'12',r:'10'}),(0,l.createElementVNode)('path',{d:'M12 8v8M8 12h8'})],-1)])])):(0,l.createCommentVNode)('v-if',!0),(0,l.createElementVNode)('button',{class:'action-btn action-delete',onClick:t[10]||(t[10]=(0,l.withModifiers)(t=>e.$emit('delete',e.path),['stop'])),title:'åˆ é™¤'},[...t[26]||(t[26]=[(0,l.createElementVNode)('svg',{viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'2'},[(0,l.createElementVNode)('path',{d:'M3 6h18M19 6v14a2 2 0 01-2 2H7a2 2 0 01-2-2V6m3 0V4a2 2 0 012-2h4a2 2 0 012 2v2'})],-1)])])],512),[[l.vShow,r.value&&!d.value]])],36),(0,l.createCommentVNode)(' å­èŠ‚ç‚¹ '),i.value&&u.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',yo,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(f.value,(n,o)=>((0,l.openBlock)(),(0,l.createBlock)(a,{key:o,name:String(o),value:n,path:h(o),depth:e.depth+1,'expanded-paths':e.expandedPaths,'editing-path':e.editingPath,'search-query':e.searchQuery,onToggle:t[13]||(t[13]=t=>e.$emit('toggle',t)),onEdit:t[14]||(t[14]=t=>e.$emit('edit',t)),onSave:t[15]||(t[15]=(t,a)=>e.$emit('save',t,a)),onCancel:t[16]||(t[16]=t=>e.$emit('cancel')),onDelete:t[17]||(t[17]=t=>e.$emit('delete',t)),onAddChild:t[18]||(t[18]=t=>e.$emit('add-child',t)),onCopyPath:t[19]||(t[19]=t=>e.$emit('copy-path',t))},null,8,['name','value','path','depth','expanded-paths','editing-path','search-query']))),128))])):(0,l.createCommentVNode)('v-if',!0)],2)}}}),Eo=(0,M.A)(Vo,[['__scopeId','data-v-78809202']]),bo={class:'variable-manager-panel'},So={class:'panel-header'},No={class:'header-left'},ko={class:'header-actions'},Co=['disabled'],wo={class:'toolbar'},Mo={class:'search-box'},Ao={class:'view-options'},Io={class:'option-toggle'},Do={key:0,class:'state-container'},Bo={class:'tree-view'},xo={class:'tree-root'},_o={class:'status-bar'},To={class:'stat-item'},$o={key:0,class:'stat-item'},Lo={key:1,class:'stat-item'},Oo={class:'modal-dialog'},Ro={class:'modal-header'},Uo={class:'modal-body'},jo={class:'form-group'},Po={class:'path-input-group'},zo={key:0,class:'path-prefix'},Fo={class:'form-group'},Ho={class:'type-selector'},Wo=['onClick'],Go={class:'type-icon'},Jo={class:'type-name'},Ko={key:0,class:'form-group'},Yo={key:2,class:'boolean-toggle'},qo={class:'modal-footer'},Xo=['disabled'],Qo=(0,l.defineComponent)({__name:'VariableManagerPanel',emits:['close','variable-updated'],setup(e,{emit:t}){const a=t,n=Ke(),o=(0,l.ref)(null),r=(0,l.ref)(''),s=(0,l.ref)(!1),c=(0,l.ref)(new Set),i=(0,l.ref)(null),u=(0,l.ref)(!1),d=(0,l.ref)(''),m=(0,l.ref)(!1),v=(0,l.ref)(null),p=(0,l.ref)(''),g=(0,l.ref)('string'),f=(0,l.ref)(''),h=[{value:'string',label:'å­—ç¬¦ä¸²',icon:'T'},{value:'number',label:'æ•°å­—',icon:'#'},{value:'boolean',label:'å¸ƒå°”',icon:'?'},{value:'object',label:'å¯¹è±¡',icon:'{}'},{value:'array',label:'æ•°ç»„',icon:'[]'},{value:'null',label:'ç©ºå€¼',icon:'Ã¸'}],y=(0,l.computed)(()=>n.isMvuAvailable),V=(0,l.computed)(()=>n.statData),E=(0,l.computed)(()=>{if(!V.value)return{};const e=(t,a='')=>{if(null===t||'object'!=typeof t)return t;if(Array.isArray(t))return t.map((t,n)=>e(t,`${a}[${n}]`));const n={};for(const[o,l]of Object.entries(t)){if(!s.value&&'$meta'===o)continue;const t=a?`${a}.${o}`:o;if(r.value){const a=r.value.toLowerCase(),s=t.toLowerCase().includes(a),i='object'!=typeof l||null===l?String(l).toLowerCase().includes(a):JSON.stringify(l).toLowerCase().includes(a);if(!s&&!i){if('object'==typeof l&&null!==l){const a=e(l,t);(Object.keys(a).length>0||Array.isArray(a)&&a.length>0)&&(n[o]=a,c.value.add(t))}continue}{const e=t.split('.');let a='';for(const t of e)a=a?`${a}.${t}`:t,c.value.add(a)}}n[o]='object'==typeof l&&null!==l?e(l,t):l}return n};return e(V.value)}),b=(0,l.computed)(()=>{const e=t=>{if(null===t||'object'!=typeof t)return 1;let a=0;const n=Array.isArray(t)?t:Object.values(t);for(const t of n)'object'==typeof t&&null!==t?a+=e(t):a++;return a};return V.value?e(V.value):0});function S(e){c.value.has(e)?c.value.delete(e):c.value.add(e)}function N(){const e=(t,a='')=>{if(null!==t&&'object'==typeof t)if(Array.isArray(t))t.forEach((t,n)=>{const o=`${a}[${n}]`;'object'==typeof t&&null!==t&&(c.value.add(o),e(t,o))});else for(const[n,o]of Object.entries(t)){if(!s.value&&'$meta'===n)continue;const t=a?`${a}.${n}`:n;'object'==typeof o&&null!==o&&(c.value.add(t),e(o,t))}};V.value&&e(V.value)}function k(){c.value.clear()}async function C(){u.value=!0;try{await n.refresh(),d.value=(new Date).toLocaleTimeString()}catch(e){console.error('[VariableManager] åˆ·æ–°å¤±è´¥:',e)}finally{u.value=!1}}function w(e){i.value=e}async function M(e,t){try{await n.setVariable(e,t,'å˜é‡ç®¡ç†å™¨ç¼–è¾‘')&&(a('variable-updated',e,t),await C())}catch(e){console.error('[VariableManager] ä¿å­˜å¤±è´¥:',e)}finally{i.value=null}}function A(){i.value=null}async function I(e){if(confirm(`ç¡®å®šè¦åˆ é™¤å˜é‡ "${e}" å—ï¼Ÿ`))try{await n.setVariable(e,void 0,'å˜é‡ç®¡ç†å™¨åˆ é™¤')&&await C()}catch(e){console.error('[VariableManager] åˆ é™¤å¤±è´¥:',e)}}function D(e){v.value=e,p.value='',g.value='string',f.value='',m.value=!0}async function B(e){try{await navigator.clipboard.writeText(e)}catch(e){console.error('[VariableManager] å¤åˆ¶å¤±è´¥:',e)}}function x(){v.value=null,p.value='',g.value='string',f.value='',m.value=!0}function T(){m.value=!1,v.value=null}async function L(){if(!p.value.trim())return;const e=v.value?`${v.value}.${p.value.trim()}`:p.value.trim();let t;switch(g.value){case'string':t=f.value||'';break;case'number':t='number'==typeof f.value?f.value:0;break;case'boolean':t=!0===f.value;break;case'object':t={};break;case'array':t=[];break;case'null':t=null}try{await n.setVariable(e,t,'å˜é‡ç®¡ç†å™¨æ–°å¢')&&(a('variable-updated',e,t),v.value&&c.value.add(v.value),await C(),T())}catch(e){console.error('[VariableManager] æ·»åŠ å¤±è´¥:',e)}}return(0,l.onMounted)(async()=>{if(V.value&&0!==Object.keys(V.value).length?d.value=(new Date).toLocaleTimeString():await C(),V.value)for(const e of Object.keys(V.value))(s.value||'$meta'!==e)&&c.value.add(e)}),(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',bo,[(0,l.createCommentVNode)(' é¢æ¿å¤´éƒ¨ '),(0,l.createElementVNode)('div',So,[(0,l.createElementVNode)('div',No,[t[9]||(t[9]=(0,l.createElementVNode)('span',{class:'header-title'},'å˜é‡ç®¡ç†å™¨',-1)),(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(['status-dot',{connected:y.value}])},null,2)]),(0,l.createElementVNode)('div',ko,[(0,l.createElementVNode)('button',{class:'btn-text',onClick:x,title:'åœ¨æ ¹çº§æ·»åŠ å˜é‡'},[...t[10]||(t[10]=[(0,l.createElementVNode)('span',{class:'btn-icon'},'+',-1),(0,l.createElementVNode)('span',{class:'btn-label'},'æ–°å¢',-1)])]),(0,l.createElementVNode)('button',{class:'btn-icon-only',onClick:N,title:'å±•å¼€å…¨éƒ¨'},[...t[11]||(t[11]=[(0,l.createElementVNode)('svg',{viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'2'},[(0,l.createElementVNode)('path',{d:'M4 4h16M4 12h16M4 20h16'}),(0,l.createElementVNode)('path',{d:'M9 8l3-3 3 3M9 16l3 3 3-3'})],-1)])]),(0,l.createElementVNode)('button',{class:'btn-icon-only',onClick:k,title:'æŠ˜å å…¨éƒ¨'},[...t[12]||(t[12]=[(0,l.createElementVNode)('svg',{viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'2'},[(0,l.createElementVNode)('path',{d:'M4 4h16M4 12h16M4 20h16'}),(0,l.createElementVNode)('path',{d:'M9 4l3 3 3-3M9 20l3-3 3 3'})],-1)])]),(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['btn-icon-only',{loading:u.value}]),onClick:C,disabled:u.value},[...t[13]||(t[13]=[(0,l.createElementVNode)('svg',{class:'icon-refresh',viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'2'},[(0,l.createElementVNode)('path',{d:'M23 4v6h-6M1 20v-6h6M3.51 9a9 9 0 0114.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0020.49 15'})],-1)])],10,Co),(0,l.createElementVNode)('button',{class:'btn-icon-only btn-close',onClick:t[0]||(t[0]=t=>e.$emit('close'))},[...t[14]||(t[14]=[(0,l.createElementVNode)('svg',{viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'2'},[(0,l.createElementVNode)('path',{d:'M18 6L6 18M6 6l12 12'})],-1)])])])]),(0,l.createCommentVNode)(' å·¥å…·æ  '),(0,l.createElementVNode)('div',wo,[(0,l.createCommentVNode)(' æœç´¢æ¡† '),(0,l.createElementVNode)('div',Mo,[t[16]||(t[16]=(0,l.createElementVNode)('svg',{class:'search-icon',viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'2'},[(0,l.createElementVNode)('circle',{cx:'11',cy:'11',r:'8'}),(0,l.createElementVNode)('path',{d:'M21 21l-4.35-4.35'})],-1)),(0,l.withDirectives)((0,l.createElementVNode)('input',{'onUpdate:modelValue':t[1]||(t[1]=e=>r.value=e),type:'text',placeholder:'æœç´¢å˜é‡è·¯å¾„æˆ–å€¼...',class:'search-input'},null,512),[[l.vModelText,r.value]]),r.value?((0,l.openBlock)(),(0,l.createElementBlock)('button',{key:0,class:'btn-clear',onClick:t[2]||(t[2]=e=>r.value='')},[...t[15]||(t[15]=[(0,l.createElementVNode)('svg',{viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'2'},[(0,l.createElementVNode)('path',{d:'M18 6L6 18M6 6l12 12'})],-1)])])):(0,l.createCommentVNode)('v-if',!0)]),(0,l.createCommentVNode)(' æ˜¾ç¤ºé€‰é¡¹ '),(0,l.createElementVNode)('div',Ao,[(0,l.createElementVNode)('label',Io,[(0,l.withDirectives)((0,l.createElementVNode)('input',{type:'checkbox','onUpdate:modelValue':t[3]||(t[3]=e=>s.value=e)},null,512),[[l.vModelCheckbox,s.value]]),t[17]||(t[17]=(0,l.createElementVNode)('span',null,'æ˜¾ç¤º $meta',-1))])])]),(0,l.createCommentVNode)(' ä¸»å†…å®¹åŒº - æ ‘å½¢è§†å›¾ '),(0,l.createElementVNode)('div',{class:'main-content',ref_key:'treeContainerRef',ref:o},[(0,l.createCommentVNode)(' åŠ è½½çŠ¶æ€ '),u.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',Do,[...t[18]||(t[18]=[(0,l.createElementVNode)('div',{class:'loading-spinner'},null,-1),(0,l.createElementVNode)('span',{class:'state-text'},'æ­£åœ¨åŠ è½½...',-1)])])):V.value&&0!==Object.keys(V.value).length?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:2},[(0,l.createCommentVNode)(' æ ‘å½¢è§†å›¾ '),(0,l.createElementVNode)('div',Bo,[(0,l.createElementVNode)('div',xo,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(E.value,(e,t)=>((0,l.openBlock)(),(0,l.createBlock)(Eo,{key:String(t),name:String(t),value:e,path:String(t),depth:0,'expanded-paths':c.value,'editing-path':i.value,'search-query':r.value,onToggle:S,onEdit:w,onSave:M,onCancel:A,onDelete:I,onAddChild:D,onCopyPath:B},null,8,['name','value','path','expanded-paths','editing-path','search-query']))),128))])])],2112)):((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createCommentVNode)(' ç©ºæ•°æ®çŠ¶æ€ '),(0,l.createElementVNode)('div',{class:'state-container'},[t[19]||(t[19]=(0,l.createElementVNode)('svg',{class:'state-icon',viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'1.5'},[(0,l.createElementVNode)('rect',{x:'3',y:'3',width:'18',height:'18',rx:'2'}),(0,l.createElementVNode)('path',{d:'M9 9h6M9 13h6M9 17h4'})],-1)),t[20]||(t[20]=(0,l.createElementVNode)('span',{class:'state-text'},'æš‚æ— å˜é‡æ•°æ®',-1)),(0,l.createElementVNode)('button',{class:'btn-primary',onClick:C},'åˆ·æ–°')])],2112))],512),(0,l.createCommentVNode)(' åº•éƒ¨çŠ¶æ€æ  '),(0,l.createElementVNode)('div',_o,[(0,l.createElementVNode)('span',To,'å…± '+(0,l.toDisplayString)(b.value)+' ä¸ªå¶å­èŠ‚ç‚¹',1),c.value.size>0?((0,l.openBlock)(),(0,l.createElementBlock)('span',$o,'å·²å±•å¼€ '+(0,l.toDisplayString)(c.value.size)+' é¡¹',1)):(0,l.createCommentVNode)('v-if',!0),d.value?((0,l.openBlock)(),(0,l.createElementBlock)('span',Lo,'æ›´æ–°äº '+(0,l.toDisplayString)(d.value),1)):(0,l.createCommentVNode)('v-if',!0)]),(0,l.createCommentVNode)(' æ·»åŠ å˜é‡å¯¹è¯æ¡† '),m.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'modal-overlay',onClick:(0,l.withModifiers)(T,['self'])},[(0,l.createElementVNode)('div',Oo,[(0,l.createElementVNode)('div',Ro,[(0,l.createElementVNode)('h3',null,(0,l.toDisplayString)(v.value?'æ·»åŠ å­å˜é‡':'æ·»åŠ æ–°å˜é‡'),1),(0,l.createElementVNode)('button',{class:'btn-close-modal',onClick:T},[...t[21]||(t[21]=[(0,l.createElementVNode)('svg',{viewBox:'0 0 24 24',fill:'none',stroke:'currentColor','stroke-width':'2'},[(0,l.createElementVNode)('path',{d:'M18 6L6 18M6 6l12 12'})],-1)])])]),(0,l.createElementVNode)('div',Uo,[(0,l.createElementVNode)('div',jo,[t[22]||(t[22]=(0,l.createElementVNode)('label',{class:'form-label'},'å˜é‡åç§°',-1)),(0,l.createElementVNode)('div',Po,[v.value?((0,l.openBlock)(),(0,l.createElementBlock)('span',zo,(0,l.toDisplayString)(v.value)+'.',1)):(0,l.createCommentVNode)('v-if',!0),(0,l.withDirectives)((0,l.createElementVNode)('input',{'onUpdate:modelValue':t[4]||(t[4]=e=>p.value=e),type:'text',placeholder:'è¾“å…¥å˜é‡å...',class:'form-input',onKeydown:(0,l.withKeys)(L,['enter'])},null,544),[[l.vModelText,p.value]])])]),(0,l.createElementVNode)('div',Fo,[t[23]||(t[23]=(0,l.createElementVNode)('label',{class:'form-label'},'ç±»å‹',-1)),(0,l.createElementVNode)('div',Ho,[((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)(h,e=>(0,l.createElementVNode)('button',{key:e.value,class:(0,l.normalizeClass)(['type-option',{active:g.value===e.value,[`type-${e.value}`]:!0}]),onClick:t=>g.value=e.value},[(0,l.createElementVNode)('span',Go,(0,l.toDisplayString)(e.icon),1),(0,l.createElementVNode)('span',Jo,(0,l.toDisplayString)(e.label),1)],10,Wo)),64))])]),'object'!==g.value&&'array'!==g.value&&'null'!==g.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',Ko,[t[24]||(t[24]=(0,l.createElementVNode)('label',{class:'form-label'},'åˆå§‹å€¼',-1)),'string'===g.value?(0,l.withDirectives)(((0,l.openBlock)(),(0,l.createElementBlock)('input',{key:0,'onUpdate:modelValue':t[5]||(t[5]=e=>f.value=e),type:'text',placeholder:'è¾“å…¥å­—ç¬¦ä¸²å€¼...',class:'form-input'},null,512)),[[l.vModelText,f.value]]):'number'===g.value?(0,l.withDirectives)(((0,l.openBlock)(),(0,l.createElementBlock)('input',{key:1,'onUpdate:modelValue':t[6]||(t[6]=e=>f.value=e),type:'number',step:'any',placeholder:'è¾“å…¥æ•°å­—...',class:'form-input'},null,512)),[[l.vModelText,f.value,void 0,{number:!0}]]):'boolean'===g.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',Yo,[(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['bool-btn',{active:!0===f.value}]),onClick:t[7]||(t[7]=e=>f.value=!0)},' true ',2),(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['bool-btn',{active:!1===f.value}]),onClick:t[8]||(t[8]=e=>f.value=!1)},' false ',2)])):(0,l.createCommentVNode)('v-if',!0)])):(0,l.createCommentVNode)('v-if',!0)]),(0,l.createElementVNode)('div',qo,[(0,l.createElementVNode)('button',{class:'btn-secondary',onClick:T},'å–æ¶ˆ'),(0,l.createElementVNode)('button',{class:'btn-primary',onClick:L,disabled:!p.value.trim()},'æ·»åŠ ',8,Xo)])])])):(0,l.createCommentVNode)('v-if',!0)]))}}),Zo=(0,M.A)(Qo,[['__scopeId','data-v-2eea0e48']]);const el=new class{state;initialized=!1;enabled=!0;constructor(){this.state={mode:'segmented',config:{...on},historyRecords:[],historyTexts:[],segmentedContent:null,isProcessing:!1,lastUpdateTime:0,error:null}}isEnabled(){return this.enabled}enable(){this.enabled=!0,console.log('[ContextManager] ä¸Šä¸‹æ–‡ç®¡ç†åŠŸèƒ½å·²å¯ç”¨')}disable(){this.enabled=!1,console.log('[ContextManager] ä¸Šä¸‹æ–‡ç®¡ç†åŠŸèƒ½å·²ç¦ç”¨ï¼ˆå°†ä½¿ç”¨å¤–æŒ‚ä¸–ç•Œä¹¦ï¼‰')}setEnabled(e){this.enabled=e,console.log('[ContextManager] ä¸Šä¸‹æ–‡ç®¡ç†åŠŸèƒ½å·²'+(e?'å¯ç”¨':'ç¦ç”¨'))}async initialize(){try{return console.log('[ContextManager] æ­£åœ¨åˆå§‹åŒ–...'),this.enabled?(await un.initialize(),await this.loadFromWorldbook(),this.initialized=!0,console.log('[ContextManager] åˆå§‹åŒ–å®Œæˆ'),!0):(console.log('[ContextManager] ä¸Šä¸‹æ–‡ç®¡ç†åŠŸèƒ½å·²ç¦ç”¨ï¼Œè·³è¿‡åˆå§‹åŒ–ä¸–ç•Œä¹¦æœåŠ¡'),this.initialized=!0,!0)}catch(e){return console.error('[ContextManager] åˆå§‹åŒ–å¤±è´¥:',e),this.state.error=e instanceof Error?e.message:'åˆå§‹åŒ–å¤±è´¥',!1}}async loadFromWorldbook(){if(this.enabled)try{const e=await un.getEntryContent(nn.HISTORY_RECORD);this.state.historyRecords=cn.parseRecords(e);const t=await un.getEntryContent(nn.HISTORY_TEXT);this.state.historyTexts=cn.parseHistoryTexts(t),console.log(`[ContextManager] å·²åŠ è½½ ${this.state.historyRecords.length} æ¡å†å²è®°å½•ï¼Œ${this.state.historyTexts.length} æ¡å†å²æ­£æ–‡`)}catch(e){console.error('[ContextManager] ä»ä¸–ç•Œä¹¦åŠ è½½æ•°æ®å¤±è´¥:',e)}else console.log('[ContextManager] åŠŸèƒ½å·²ç¦ç”¨ï¼Œè·³è¿‡ä»ä¸–ç•Œä¹¦åŠ è½½æ•°æ®')}getState(){return this.state}getConfig(){return{...this.state.config}}async setConfig(e){this.state.config={...this.state.config,...e},await this.regenerateSegments()}async setSegmentCount(e){await this.setConfig({segmentCount:Math.max(0,e)})}async setSmallSummaryCount(e){await this.setConfig({smallSummaryCount:Math.max(0,e)})}getMode(){return this.state.mode}async switchMode(e){e!==this.state.mode&&(this.state.mode=e,'full'===e?await un.switchToFullMode():(await un.switchToSegmentedMode(),await this.regenerateSegments()),console.log(`[ContextManager] å·²åˆ‡æ¢åˆ°${'full'===e?'å…¨é‡':'åˆ†æ®µ'}æ¨¡å¼`))}calculateRanges(e,t,a){const n={totalCount:e,segmentRange:null,smallSummaryRange:null,largeSummaryRange:null};if(0===e)return n;if(t>0&&e>0){const a=Math.max(1,e-t+1),o=e;n.segmentRange=[a,o]}const o=t>0?Math.max(0,e-t):e;if(a>0&&o>0){const e=Math.max(1,o-a+1);n.smallSummaryRange=[e,o]}const l=a>0&&n.smallSummaryRange?n.smallSummaryRange[0]-1:t>0&&n.segmentRange?n.segmentRange[0]-1:e;return l>=1&&(n.largeSummaryRange=[1,l]),n}generateSegmentedContent(){const{historyRecords:e,historyTexts:t,config:a}=this.state,{segmentCount:n,smallSummaryCount:o}=a,l=e.length,r=this.calculateRanges(l,n,o);let s='';if(r.segmentRange&&t.length>0){const[e,a]=r.segmentRange,n=t.slice(e-1,a);s=cn.formatSegmentedText(n)}let c='';if(r.smallSummaryRange){const[t,a]=r.smallSummaryRange,n=e.slice(t-1,a);c=cn.formatSmallSummary(n)}let i='';if(r.largeSummaryRange){const[t,a]=r.largeSummaryRange,n=e.slice(t-1,a);i=cn.formatLargeSummary(n)}return{segmentedText:s,smallSummary:c,largeSummary:i,ranges:r}}async regenerateSegments(){if(!this.enabled)return console.log('[ContextManager] åŠŸèƒ½å·²ç¦ç”¨ï¼Œè·³è¿‡åˆ†æ®µç”Ÿæˆ'),!0;try{this.state.isProcessing=!0,this.state.error=null;if(!(this.state.historyRecords.length>0||this.state.historyTexts.length>0))return console.log('[ContextManager] æ²¡æœ‰å†å²æ•°æ®ï¼Œè·³è¿‡åˆ†æ®µç”Ÿæˆï¼ˆé¿å…è¦†ç›–ç°æœ‰ä¸–ç•Œä¹¦å†…å®¹ï¼‰'),!0;const e=this.generateSegmentedContent();return this.state.segmentedContent=e,e.segmentedText&&await un.setEntryContent(nn.SEGMENTED_TEXT,e.segmentedText),e.smallSummary&&await un.setEntryContent(nn.SMALL_SUMMARY,e.smallSummary),e.largeSummary&&await un.setEntryContent(nn.LARGE_SUMMARY,e.largeSummary),this.state.lastUpdateTime=Date.now(),console.log('[ContextManager] åˆ†æ®µå†…å®¹å·²æ›´æ–°',{åˆ†æ®µæ­£æ–‡æ¡æ•°:e.ranges.segmentRange?e.ranges.segmentRange[1]-e.ranges.segmentRange[0]+1:0,å°æ€»ç»“æ¡æ•°:e.ranges.smallSummaryRange?e.ranges.smallSummaryRange[1]-e.ranges.smallSummaryRange[0]+1:0,å¤§æ€»ç»“æ¡æ•°:e.ranges.largeSummaryRange?e.ranges.largeSummaryRange[1]-e.ranges.largeSummaryRange[0]+1:0}),!0}catch(e){return console.error('[ContextManager] é‡æ–°ç”Ÿæˆåˆ†æ®µå¤±è´¥:',e),this.state.error=e instanceof Error?e.message:'ç”Ÿæˆåˆ†æ®µå¤±è´¥',!1}finally{this.state.isProcessing=!1}}async processAIResponse(e){if(!this.enabled)return console.log('[ContextManager] åŠŸèƒ½å·²ç¦ç”¨ï¼Œè·³è¿‡å¤„ç†AIå›å¤'),!1;try{this.state.isProcessing=!0,this.state.error=null;let t=!1;const a=cn.extractGameTextTag(e);if(a){const e=await un.getEntryContent(nn.HISTORY_TEXT),n=cn.appendText(e,a);await un.setEntryContent(nn.HISTORY_TEXT,n);const o=this.state.historyTexts.length+1;this.state.historyTexts.push({åºå·:o,å†…å®¹:a}),t=!0,console.log('[ContextManager] å·²è¿½åŠ å†å²æ­£æ–‡ï¼Œå½“å‰å…±',this.state.historyTexts.length,'æ¡')}const n=cn.extractHistoryRecordTag(e);if(n){const e=cn.parseRecord(n);if(e){const a=await un.getEntryContent(nn.HISTORY_RECORD),o=cn.appendRecord(a,n);await un.setEntryContent(nn.HISTORY_RECORD,o),this.state.historyRecords.push(e),t=!0,console.log('[ContextManager] å·²è¿½åŠ å†å²è®°å½•ï¼Œå½“å‰å…±',this.state.historyRecords.length,'æ¡')}}return t&&'segmented'===this.state.mode&&await this.regenerateSegments(),this.state.lastUpdateTime=Date.now(),t}catch(e){return console.error('[ContextManager] å¤„ç†AIå›å¤å¤±è´¥:',e),this.state.error=e instanceof Error?e.message:'å¤„ç†AIå›å¤å¤±è´¥',!1}finally{this.state.isProcessing=!1}}getRecordCount(){return this.state.historyRecords.length}getTextCount(){return this.state.historyTexts.length}getLatestRecords(e){return this.state.historyRecords.slice(-e)}getLatestTexts(e){return this.state.historyTexts.slice(-e)}async clearAll(e=!1){if(!this.enabled&&!e)return console.log('[ContextManager] åŠŸèƒ½å·²ç¦ç”¨ï¼Œåªæ¸…ç©ºæœ¬åœ°çŠ¶æ€'),this.state.historyRecords=[],this.state.historyTexts=[],this.state.segmentedContent=null,this.state.lastUpdateTime=Date.now(),!0;try{return this.state.isProcessing=!0,(this.enabled||e)&&(un.isAvailable()?(await un.clearAllContextEntries(),console.log('[ContextManager] å·²æ¸…ç©ºä¸–ç•Œä¹¦æ¡ç›®')):console.warn('[ContextManager] ä¸–ç•Œä¹¦æœåŠ¡ä¸å¯ç”¨ï¼Œè·³è¿‡æ¸…ç©ºä¸–ç•Œä¹¦æ¡ç›®')),this.state.historyRecords=[],this.state.historyTexts=[],this.state.segmentedContent=null,this.state.lastUpdateTime=Date.now(),console.log('[ContextManager] å·²æ¸…ç©ºæ‰€æœ‰å†å²æ•°æ®'),!0}catch(e){return console.error('[ContextManager] æ¸…ç©ºæ•°æ®å¤±è´¥:',e),this.state.error=e instanceof Error?e.message:'æ¸…ç©ºæ•°æ®å¤±è´¥',!1}finally{this.state.isProcessing=!1}}async getSaveData(){const e=await un.getContextSnapshot();return{config:{...this.state.config},worldbookSnapshots:e,timestamp:Date.now()}}async restoreFromSaveData(e){try{return this.state.isProcessing=!0,this.state.config={...e.config},await un.restoreFromSnapshot(e.worldbookSnapshots),await this.loadFromWorldbook(),'segmented'===this.state.mode&&await this.regenerateSegments(),this.state.lastUpdateTime=Date.now(),console.log('[ContextManager] å·²ä»å­˜æ¡£æ¢å¤'),!0}catch(e){return console.error('[ContextManager] ä»å­˜æ¡£æ¢å¤å¤±è´¥:',e),this.state.error=e instanceof Error?e.message:'æ¢å¤å¤±è´¥',!1}finally{this.state.isProcessing=!1}}getStatistics(){const e=this.state.segmentedContent?.ranges||this.calculateRanges(this.state.historyRecords.length,this.state.config.segmentCount,this.state.config.smallSummaryCount);return{recordCount:this.state.historyRecords.length,textCount:this.state.historyTexts.length,segmentCount:e.segmentRange?e.segmentRange[1]-e.segmentRange[0]+1:0,smallSummaryCount:e.smallSummaryRange?e.smallSummaryRange[1]-e.smallSummaryRange[0]+1:0,largeSummaryCount:e.largeSummaryRange?e.largeSummaryRange[1]-e.largeSummaryRange[0]+1:0,mode:this.state.mode}}},tl={enabled:!0,saveOnAIResponse:!0,maxAutoSaves:10,autoSavePrefix:'[è‡ªåŠ¨]',debounceMs:1e3},al='saves',nl='config',ol='1.0.0',ll='mc_house_auto_save_config';const rl=new class{db=null;initialized=!1;autoSaveConfig={...tl};autoSaveDebounceTimer=null;lastAutoSaveTime=0;onAutoSaveCallbacks=[];onLoadCompleteCallbacks=[];async initialize(){return!(!this.initialized||!this.db)||(this.loadAutoSaveConfig(),new Promise((e,t)=>{const a=indexedDB.open('MC_House_SaveDB',2);a.onerror=()=>{console.error('[SaveService] æ‰“å¼€æ•°æ®åº“å¤±è´¥:',a.error),t(a.error)},a.onsuccess=()=>{this.db=a.result,this.initialized=!0,console.log('[SaveService] æ•°æ®åº“åˆå§‹åŒ–æˆåŠŸ'),e(!0)},a.onupgradeneeded=e=>{const t=e.target.result,a=e.oldVersion;if(t.objectStoreNames.contains(al)){if(a<2){const t=e.target.transaction;if(t){const e=t.objectStore(al);e.indexNames.contains('isAutoSave')||e.createIndex('isAutoSave','isAutoSave',{unique:!1}),e.indexNames.contains('saveSource')||e.createIndex('saveSource','saveSource',{unique:!1})}}}else{const e=t.createObjectStore(al,{keyPath:'id'});e.createIndex('name','name',{unique:!1}),e.createIndex('createdAt','createdAt',{unique:!1}),e.createIndex('updatedAt','updatedAt',{unique:!1}),e.createIndex('isAutoSave','isAutoSave',{unique:!1}),e.createIndex('saveSource','saveSource',{unique:!1})}t.objectStoreNames.contains(nl)||t.createObjectStore(nl,{keyPath:'key'})}}))}generateId(e='save'){return`${e}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`}loadAutoSaveConfig(){try{const e=localStorage.getItem(ll);if(e){const t=JSON.parse(e);this.autoSaveConfig={...tl,...t}}}catch(e){console.warn('[SaveService] åŠ è½½è‡ªåŠ¨å­˜æ¡£é…ç½®å¤±è´¥ï¼Œä½¿ç”¨é»˜è®¤é…ç½®:',e),this.autoSaveConfig={...tl}}}saveAutoSaveConfigToStorage(){try{localStorage.setItem(ll,JSON.stringify(this.autoSaveConfig))}catch(e){console.error('[SaveService] ä¿å­˜è‡ªåŠ¨å­˜æ¡£é…ç½®å¤±è´¥:',e)}}getAutoSaveConfig(){return{...this.autoSaveConfig}}updateAutoSaveConfig(e){this.autoSaveConfig={...this.autoSaveConfig,...e},this.saveAutoSaveConfigToStorage(),console.log('[SaveService] è‡ªåŠ¨å­˜æ¡£é…ç½®å·²æ›´æ–°:',this.autoSaveConfig)}resetAutoSaveConfig(){this.autoSaveConfig={...tl},this.saveAutoSaveConfigToStorage()}onAutoSave(e){return this.onAutoSaveCallbacks.push(e),()=>{const t=this.onAutoSaveCallbacks.indexOf(e);t>-1&&this.onAutoSaveCallbacks.splice(t,1)}}emitAutoSaveEvent(e,t){this.onAutoSaveCallbacks.forEach(a=>{try{a(e,t)}catch(e){console.error('[SaveService] è‡ªåŠ¨å­˜æ¡£å›è°ƒæ‰§è¡Œå¤±è´¥:',e)}})}onLoadComplete(e){return this.onLoadCompleteCallbacks.push(e),()=>{const t=this.onLoadCompleteCallbacks.indexOf(e);t>-1&&this.onLoadCompleteCallbacks.splice(t,1)}}emitLoadCompleteEvent(e){console.log('[SaveService] è§¦å‘å­˜æ¡£åŠ è½½å®Œæˆäº‹ä»¶ï¼Œé€šçŸ¥',this.onLoadCompleteCallbacks.length,'ä¸ªå›è°ƒ'),this.onLoadCompleteCallbacks.forEach(t=>{try{t(e)}catch(e){console.error('[SaveService] å­˜æ¡£åŠ è½½å®Œæˆå›è°ƒæ‰§è¡Œå¤±è´¥:',e)}})}getMvuData(){try{return'undefined'!=typeof window&&window.Mvu&&window.Mvu.getMvuData({type:'message',message_id:'latest'})||null}catch(e){return console.error('[SaveService] è·å–MVUæ•°æ®å¤±è´¥:',e),null}}async restoreMvuData(e){try{return!('undefined'==typeof window||!window.Mvu)&&(await window.Mvu.replaceMvuData(e,{type:'message',message_id:'latest'}),!0)}catch(e){return console.error('[SaveService] æ¢å¤MVUæ•°æ®å¤±è´¥:',e),!1}}aiContentDataProvider=null;aiContentDataRestorer=null;setAIContentDataProvider(e){this.aiContentDataProvider=e,console.log('[SaveService] AIå†…å®¹æ•°æ®æä¾›è€…å·²æ³¨å†Œ')}setAIContentDataRestorer(e){this.aiContentDataRestorer=e,console.log('[SaveService] AIå†…å®¹æ•°æ®æ¢å¤è€…å·²æ³¨å†Œ')}getAIContentData(){if(this.aiContentDataProvider)try{return this.aiContentDataProvider()}catch(e){console.error('[SaveService] è·å–AIå†…å®¹æ•°æ®å¤±è´¥:',e)}return null}async restoreAIContentData(e){if(this.aiContentDataRestorer&&e)try{return this.aiContentDataRestorer(e),await new Promise(e=>setTimeout(e,10)),console.log('[SaveService] AIå†…å®¹æ•°æ®å·²æ¢å¤'),!0}catch(e){console.error('[SaveService] æ¢å¤AIå†…å®¹æ•°æ®å¤±è´¥:',e)}return!1}async createSave(e,t){try{await this.initialize();const a=this.getMvuData(),n=await el.getSaveData(),o=this.getAIContentData(),l={id:this.generateId(),name:e,createdAt:Date.now(),updatedAt:Date.now(),mvuData:a,contextData:n,aiContentData:o||void 0,version:ol,customData:t};return await this.putSave(l),console.log('[SaveService] å­˜æ¡£åˆ›å»ºæˆåŠŸ:',l.id,o?'(å«AIå†…å®¹)':''),l}catch(e){return console.error('[SaveService] åˆ›å»ºå­˜æ¡£å¤±è´¥:',e),null}}async updateSave(e,t){try{await this.initialize();const a=await this.getSave(e);if(!a)return console.warn('[SaveService] å­˜æ¡£ä¸å­˜åœ¨:',e),!1;const n=this.getMvuData(),o=await el.getSaveData(),l=this.getAIContentData(),r={...a,updatedAt:Date.now(),mvuData:n,contextData:o,aiContentData:l||a.aiContentData,customData:t||a.customData};return await this.putSave(r),console.log('[SaveService] å­˜æ¡£æ›´æ–°æˆåŠŸ:',e),!0}catch(e){return console.error('[SaveService] æ›´æ–°å­˜æ¡£å¤±è´¥:',e),!1}}async autoSaveOnAIResponse(e){if(!this.autoSaveConfig.enabled||!this.autoSaveConfig.saveOnAIResponse)return console.log('[SaveService] è‡ªåŠ¨å­˜æ¡£æœªå¯ç”¨'),null;const t=Date.now();if(t-this.lastAutoSaveTime<this.autoSaveConfig.debounceMs)return console.log('[SaveService] è‡ªåŠ¨å­˜æ¡£é˜²æŠ–ä¸­ï¼Œè·³è¿‡'),null;this.lastAutoSaveTime=t;try{console.log('[SaveService] å¼€å§‹AIå›å¤åè‡ªåŠ¨å­˜æ¡£...');const t=(new Date).toLocaleString('zh-CN',{month:'2-digit',day:'2-digit',hour:'2-digit',minute:'2-digit'}),a=`${this.autoSaveConfig.autoSavePrefix} ${t}`,n=await this.createAutoSave(a,'ai_response',e);return n&&(await this.cleanupAutoSaves(),this.emitAutoSaveEvent(n)),n}catch(e){const t=e instanceof Error?e.message:'è‡ªåŠ¨å­˜æ¡£å¤±è´¥';return console.error('[SaveService] AIå›å¤åè‡ªåŠ¨å­˜æ¡£å¤±è´¥:',e),this.emitAutoSaveEvent(null,t),null}}async createAutoSave(e,t='auto',a){try{await this.initialize();const n=this.getMvuData(),o=await el.getSaveData(),l=this.getAIContentData(),r={id:this.generateId('auto'),name:e,createdAt:Date.now(),updatedAt:Date.now(),mvuData:n,contextData:o,aiContentData:l||void 0,version:ol,isAutoSave:!0,saveSource:t,messageId:a};return await this.putSave(r),console.log('[SaveService] è‡ªåŠ¨å­˜æ¡£åˆ›å»ºæˆåŠŸ:',r.id,l?'(å«AIå†…å®¹)':''),r}catch(e){return console.error('[SaveService] åˆ›å»ºè‡ªåŠ¨å­˜æ¡£å¤±è´¥:',e),null}}async cleanupAutoSaves(){try{const e=await this.listAutoSaves();if(e.length<=this.autoSaveConfig.maxAutoSaves)return;const t=e.sort((e,t)=>t.updatedAt-e.updatedAt).slice(this.autoSaveConfig.maxAutoSaves);for(const e of t)await this.deleteSave(e.id),console.log('[SaveService] æ¸…ç†æ—§çš„è‡ªåŠ¨å­˜æ¡£:',e.id);console.log('[SaveService] è‡ªåŠ¨å­˜æ¡£æ¸…ç†å®Œæˆï¼Œåˆ é™¤äº†',t.length,'ä¸ªæ—§å­˜æ¡£')}catch(e){console.error('[SaveService] æ¸…ç†è‡ªåŠ¨å­˜æ¡£å¤±è´¥:',e)}}async listAutoSaves(){return(await this.listSaves()).filter(e=>!0===e.isAutoSave)}async listManualSaves(){return(await this.listSaves()).filter(e=>!0!==e.isAutoSave)}debouncedAutoSave(e){this.autoSaveDebounceTimer&&clearTimeout(this.autoSaveDebounceTimer),this.autoSaveDebounceTimer=setTimeout(async()=>{await this.autoSaveOnAIResponse(e)},this.autoSaveConfig.debounceMs)}cancelDebouncedAutoSave(){this.autoSaveDebounceTimer&&(clearTimeout(this.autoSaveDebounceTimer),this.autoSaveDebounceTimer=null)}async loadSave(e){try{await this.initialize();const t=await this.getSave(e);if(!t)return console.warn('[SaveService] å­˜æ¡£ä¸å­˜åœ¨:',e),!1;console.log('[SaveService] å¼€å§‹åŠ è½½å­˜æ¡£:',e);const a={mvu:!1,context:!1,aiContent:!1};if(t.mvuData)try{a.mvu=await this.restoreMvuData(t.mvuData),a.mvu?console.log('[SaveService] MVUæ•°æ®æ¢å¤æˆåŠŸï¼Œstat_dataé”®:',Object.keys(t.mvuData.stat_data||{})):console.warn('[SaveService] MVUæ•°æ®æ¢å¤å¤±è´¥')}catch(e){console.error('[SaveService] MVUæ•°æ®æ¢å¤å¼‚å¸¸:',e)}else a.mvu=!0;if(t.contextData)try{await el.restoreFromSaveData(t.contextData),a.context=!0,console.log('[SaveService] ä¸Šä¸‹æ–‡ç®¡ç†æ•°æ®æ¢å¤æˆåŠŸ')}catch(e){console.error('[SaveService] ä¸Šä¸‹æ–‡ç®¡ç†æ•°æ®æ¢å¤å¼‚å¸¸:',e)}else a.context=!0;if(t.aiContentData)try{a.aiContent=await this.restoreAIContentData(t.aiContentData),console.log('[SaveService] AIå†…å®¹æ•°æ®æ¢å¤æˆåŠŸ')}catch(e){console.error('[SaveService] AIå†…å®¹æ•°æ®æ¢å¤å¼‚å¸¸:',e)}else a.aiContent=!0;await new Promise(e=>setTimeout(e,50));const n=a.mvu&&a.context&&a.aiContent;return console.log('[SaveService] å­˜æ¡£åŠ è½½å®Œæˆ:',{id:e,mvu:a.mvu?'æˆåŠŸ':'å¤±è´¥',context:a.context?'æˆåŠŸ':'å¤±è´¥',aiContent:a.aiContent?'æˆåŠŸ':'å¤±è´¥',overall:n?'å…¨éƒ¨æˆåŠŸ':'éƒ¨åˆ†å¤±è´¥'}),this.emitLoadCompleteEvent(t),n||'undefined'==typeof toastr||toastr.warning('éƒ¨åˆ†æ•°æ®æ¢å¤å¤±è´¥ï¼Œè¯·æ£€æŸ¥æ§åˆ¶å°','å­˜æ¡£åŠ è½½è­¦å‘Š',{timeOut:3e3}),n}catch(e){return console.error('[SaveService] åŠ è½½å­˜æ¡£å¤±è´¥:',e),!1}}async getSave(e){return this.db||await this.initialize(),this.db?new Promise((t,a)=>{const n=this.db.transaction([al],'readonly').objectStore(al).get(e);n.onerror=()=>a(n.error),n.onsuccess=()=>t(n.result||null)}):null}async putSave(e){if(this.db||await this.initialize(),!this.db)throw new Error('æ•°æ®åº“æœªåˆå§‹åŒ–');return new Promise((t,a)=>{const n=this.db.transaction([al],'readwrite').objectStore(al).put(e);n.onerror=()=>a(n.error),n.onsuccess=()=>t()})}async deleteSave(e){return this.db||await this.initialize(),!!this.db&&new Promise((t,a)=>{const n=this.db.transaction([al],'readwrite').objectStore(al).delete(e);n.onerror=()=>a(n.error),n.onsuccess=()=>{console.log('[SaveService] å­˜æ¡£åˆ é™¤æˆåŠŸ:',e),t(!0)}})}async listSaves(){return this.db||await this.initialize(),this.db?new Promise((e,t)=>{const a=this.db.transaction([al],'readonly').objectStore(al).getAll();a.onerror=()=>t(a.error),a.onsuccess=()=>{const t=a.result.map(e=>({id:e.id,name:e.name,createdAt:e.createdAt,updatedAt:e.updatedAt,version:e.version,isAutoSave:e.isAutoSave,saveSource:e.saveSource})).sort((e,t)=>t.updatedAt-e.updatedAt);e(t)}}):[]}async getSaveStats(){const e=await this.listSaves(),t=e.filter(e=>!e.isAutoSave),a=e.filter(e=>e.isAutoSave);return{total:e.length,manual:t.length,auto:a.length,oldestSave:e.length>0?e[e.length-1]:null,newestSave:e.length>0?e[0]:null}}async exportSave(e){try{const t=await this.getSave(e);return t?JSON.stringify(t,null,2):null}catch(e){return console.error('[SaveService] å¯¼å‡ºå­˜æ¡£å¤±è´¥:',e),null}}async importSave(e,t){try{await this.initialize();const a=JSON.parse(e);return a.id=this.generateId(),t&&(a.name=t),a.updatedAt=Date.now(),await this.putSave(a),console.log('[SaveService] å­˜æ¡£å¯¼å…¥æˆåŠŸ:',a.id),a}catch(e){return console.error('[SaveService] å¯¼å…¥å­˜æ¡£å¤±è´¥:',e),null}}async quickSave(){try{const e=await this.listSaves();if(e.length>0)return await this.updateSave(e[0].id);return null!==await this.createSave('å¿«é€Ÿå­˜æ¡£')}catch(e){return console.error('[SaveService] å¿«é€Ÿä¿å­˜å¤±è´¥:',e),!1}}async quickLoad(){try{const e=await this.listSaves();return 0===e.length?(console.warn('[SaveService] æ²¡æœ‰å¯åŠ è½½çš„å­˜æ¡£'),!1):await this.loadSave(e[0].id)}catch(e){return console.error('[SaveService] å¿«é€ŸåŠ è½½å¤±è´¥:',e),!1}}};function sl(){const e=(0,l.ref)(!1),t=(0,l.ref)(!1),a=(0,l.ref)(null),n=(0,l.ref)([]),o=(0,l.ref)(null),r=(0,l.ref)(rl.getAutoSaveConfig()),s=(0,l.ref)({total:0,manual:0,auto:0,oldestSave:null,newestSave:null}),c=(0,l.ref)(null);let i=null,u=null;const d=(0,l.computed)(()=>n.value.filter(e=>!e.isAutoSave)),m=(0,l.computed)(()=>n.value.filter(e=>!0===e.isAutoSave)),v=(0,l.computed)(()=>n.value.length>0),p=(0,l.computed)(()=>r.value.enabled),g=async()=>{try{return t.value=!0,a.value=null,await rl.initialize(),await f(),await h(),r.value=rl.getAutoSaveConfig(),i=rl.onAutoSave((e,t)=>{e?(c.value={id:e.id,name:e.name,createdAt:e.createdAt,updatedAt:e.updatedAt,version:e.version,isAutoSave:e.isAutoSave,saveSource:e.saveSource},f(),h(),console.log('[useSave] è‡ªåŠ¨å­˜æ¡£å®Œæˆ:',e.name)):t&&console.error('[useSave] è‡ªåŠ¨å­˜æ¡£å¤±è´¥:',t)}),u=rl.onLoadComplete(async e=>{console.log('[useSave] å­˜æ¡£åŠ è½½å®Œæˆï¼Œé€šçŸ¥ mvuStore åˆ·æ–°æ•°æ®...');try{const e=Ke();await e.loadMvuData(),console.log('[useSave] mvuStore æ•°æ®å·²åˆ·æ–°ï¼Œstat_data é”®:',Object.keys(e.statData||{}))}catch(e){console.error('[useSave] åˆ·æ–° mvuStore æ•°æ®å¤±è´¥:',e)}}),e.value=!0,!0}catch(e){return a.value=e instanceof Error?e.message:'åˆå§‹åŒ–å¤±è´¥',!1}finally{t.value=!1}},f=async()=>{try{n.value=await rl.listSaves()}catch(e){console.error('[useSave] åˆ·æ–°åˆ—è¡¨å¤±è´¥:',e)}},h=async()=>{try{s.value=await rl.getSaveStats()}catch(e){console.error('[useSave] åˆ·æ–°ç»Ÿè®¡å¤±è´¥:',e)}},y=async e=>{try{return t.value=!0,a.value=null,await rl.exportSave(e)}catch(e){return a.value=e instanceof Error?e.message:'å¯¼å‡ºå­˜æ¡£å¤±è´¥',null}finally{t.value=!1}},V=async(e,n)=>{try{t.value=!0,a.value=null;const o=await rl.importSave(e,n);return o&&await f(),o}catch(e){return a.value=e instanceof Error?e.message:'å¯¼å…¥å­˜æ¡£å¤±è´¥',null}finally{t.value=!1}},E=e=>{rl.updateAutoSaveConfig(e),r.value=rl.getAutoSaveConfig()};return(0,l.onMounted)(()=>{g()}),(0,l.onUnmounted)(()=>{i&&(i(),i=null),u&&(u(),u=null)}),{isInitialized:e,isProcessing:t,error:a,saveList:n,currentSave:o,autoSaveConfig:r,saveStats:s,lastAutoSave:c,manualSaveList:d,autoSaveList:m,hasSaves:v,isAutoSaveEnabled:p,initialize:g,refreshList:f,refreshStats:h,createSave:async(e,n)=>{try{t.value=!0,a.value=null;const l=await rl.createSave(e,n);return l&&(await f(),o.value={id:l.id,name:l.name,createdAt:l.createdAt,updatedAt:l.updatedAt,version:l.version}),l}catch(e){return a.value=e instanceof Error?e.message:'åˆ›å»ºå­˜æ¡£å¤±è´¥',null}finally{t.value=!1}},updateSave:async(e,n)=>{try{t.value=!0,a.value=null;const o=await rl.updateSave(e,n);return o&&await f(),o}catch(e){return a.value=e instanceof Error?e.message:'æ›´æ–°å­˜æ¡£å¤±è´¥',!1}finally{t.value=!1}},loadSave:async e=>{try{t.value=!0,a.value=null;const l=await rl.loadSave(e);if(l){const t=n.value.find(t=>t.id===e);t&&(o.value=t)}return l}catch(e){return a.value=e instanceof Error?e.message:'åŠ è½½å­˜æ¡£å¤±è´¥',!1}finally{t.value=!1}},deleteSave:async e=>{try{t.value=!0,a.value=null;const n=await rl.deleteSave(e);return n&&(await f(),o.value?.id===e&&(o.value=null)),n}catch(e){return a.value=e instanceof Error?e.message:'åˆ é™¤å­˜æ¡£å¤±è´¥',!1}finally{t.value=!1}},exportSave:y,importSave:V,quickSave:async()=>{try{t.value=!0,a.value=null;const e=await rl.quickSave();return e&&await f(),e}catch(e){return a.value=e instanceof Error?e.message:'å¿«é€Ÿä¿å­˜å¤±è´¥',!1}finally{t.value=!1}},quickLoad:async()=>{try{t.value=!0,a.value=null;const e=await rl.quickLoad();return e&&(await f(),n.value.length>0&&(o.value=n.value[0])),e}catch(e){return a.value=e instanceof Error?e.message:'å¿«é€ŸåŠ è½½å¤±è´¥',!1}finally{t.value=!1}},downloadSave:async(e,t)=>{try{const a=await y(e);if(!a)return;const o=n.value.find(t=>t.id===e),l=t||`${o?.name||'save'}_${(new Date).toISOString().slice(0,10)}.json`,r=new Blob([a],{type:'application/json'}),s=URL.createObjectURL(r),c=document.createElement('a');c.href=s,c.download=l,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(s)}catch(e){a.value=e instanceof Error?e.message:'ä¸‹è½½å­˜æ¡£å¤±è´¥'}},uploadSave:async(e,n)=>{try{t.value=!0,a.value=null;const o=await e.text();return await V(o,n)}catch(e){return a.value=e instanceof Error?e.message:'ä¸Šä¼ å­˜æ¡£å¤±è´¥',null}finally{t.value=!1}},updateAutoSaveConfig:E,toggleAutoSave:()=>{E({enabled:!r.value.enabled})},toggleSaveOnAIResponse:()=>{E({saveOnAIResponse:!r.value.saveOnAIResponse})},setMaxAutoSaves:e=>{e>=1&&e<=50&&E({maxAutoSaves:e})},setAutoSavePrefix:e=>{E({autoSavePrefix:e||'[è‡ªåŠ¨]'})},resetAutoSaveConfig:()=>{rl.resetAutoSaveConfig(),r.value=rl.getAutoSaveConfig()},triggerAutoSave:async()=>{try{t.value=!0,a.value=null;const e=await rl.autoSaveOnAIResponse();return e&&(await f(),await h()),e}catch(e){return a.value=e instanceof Error?e.message:'è‡ªåŠ¨å­˜æ¡£å¤±è´¥',null}finally{t.value=!1}},clearAllAutoSaves:async()=>{try{t.value=!0,a.value=null;const e=await rl.listAutoSaves();for(const t of e)await rl.deleteSave(t.id);return await f(),await h(),console.log('[useSave] å·²æ¸…ç†æ‰€æœ‰è‡ªåŠ¨å­˜æ¡£ï¼Œå…±',e.length,'ä¸ª'),!0}catch(e){return a.value=e instanceof Error?e.message:'æ¸…ç†è‡ªåŠ¨å­˜æ¡£å¤±è´¥',!1}finally{t.value=!1}},convertAutoSaveToManual:async(e,n)=>{try{t.value=!0,a.value=null;const o=await rl.getSave(e);if(!o||!o.isAutoSave)return a.value='å­˜æ¡£ä¸å­˜åœ¨æˆ–ä¸æ˜¯è‡ªåŠ¨å­˜æ¡£',!1;const l=await rl.exportSave(e);if(!l)return a.value='å¯¼å‡ºå­˜æ¡£å¤±è´¥',!1;return!!await rl.importSave(l,n||o.name.replace(/^\[è‡ªåŠ¨\]\s*/,''))&&(await rl.deleteSave(e),await f(),await h(),!0)}catch(e){return a.value=e instanceof Error?e.message:'è½¬æ¢å­˜æ¡£å¤±è´¥',!1}finally{t.value=!1}},service:rl}}const cl={class:'auto-save-settings'},il={class:'setting-item'},ul={class:'toggle-switch'},dl=['checked'],ml={class:'toggle-switch'},vl=['checked','disabled'],pl={class:'setting-control'},gl=['value','disabled'],fl={class:'setting-control'},hl=['value','disabled'],yl={class:'setting-control'},Vl=['value','disabled'],El={class:'status-section'},bl={class:'status-items'},Sl={class:'status-item'},Nl={class:'status-item'},kl={key:0,class:'status-item'},Cl={class:'status-value'},wl=(0,l.defineComponent)({__name:'AutoSaveSettings',setup(e){const{autoSaveConfig:t,lastAutoSave:a,toggleAutoSave:n,toggleSaveOnAIResponse:o,setMaxAutoSaves:r,setAutoSavePrefix:s,updateAutoSaveConfig:c,resetAutoSaveConfig:i}=sl(),u=e=>{const t=e.target,a=parseInt(t.value,10);!isNaN(a)&&a>=1&&a<=50&&r(a)},d=e=>{const t=e.target;s(t.value)},m=e=>{const t=e.target,a=parseInt(t.value,10);!isNaN(a)&&a>=500&&a<=1e4&&c({debounceMs:a})},v=async()=>{await Ve('ç¡®å®šè¦é‡ç½®æ‰€æœ‰è‡ªåŠ¨å­˜æ¡£è®¾ç½®ä¸ºé»˜è®¤å€¼å—ï¼Ÿ','é‡ç½®è®¾ç½®')&&i()};return(e,r)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',cl,[r[15]||(r[15]=(0,l.createElementVNode)('h4',{class:'settings-title'},'è‡ªåŠ¨å­˜æ¡£è®¾ç½®',-1)),(0,l.createCommentVNode)(' ä¸»å¼€å…³ '),(0,l.createElementVNode)('div',il,[r[3]||(r[3]=(0,l.createElementVNode)('div',{class:'setting-info'},[(0,l.createElementVNode)('div',{class:'setting-label'},'å¯ç”¨è‡ªåŠ¨å­˜æ¡£'),(0,l.createElementVNode)('div',{class:'setting-desc'},'æ€»å¼€å…³ï¼Œå…³é—­åå°†ä¸ä¼šè‡ªåŠ¨åˆ›å»ºä»»ä½•å­˜æ¡£')],-1)),(0,l.createElementVNode)('label',ul,[(0,l.createElementVNode)('input',{type:'checkbox',checked:(0,l.unref)(t).enabled,onChange:r[0]||(r[0]=(...e)=>(0,l.unref)(n)&&(0,l.unref)(n)(...e))},null,40,dl),r[2]||(r[2]=(0,l.createElementVNode)('span',{class:'toggle-slider'},null,-1))])]),(0,l.createCommentVNode)(' AIå›å¤åè‡ªåŠ¨å­˜æ¡£ '),(0,l.createElementVNode)('div',{class:(0,l.normalizeClass)(['setting-item',{disabled:!(0,l.unref)(t).enabled}])},[r[5]||(r[5]=(0,l.createElementVNode)('div',{class:'setting-info'},[(0,l.createElementVNode)('div',{class:'setting-label'},'AIå›å¤åè‡ªåŠ¨å­˜æ¡£'),(0,l.createElementVNode)('div',{class:'setting-desc'},'æ¯æ¬¡AIç”Ÿæˆå›å¤ç»“æŸåè‡ªåŠ¨åˆ›å»ºå­˜æ¡£')],-1)),(0,l.createElementVNode)('label',ml,[(0,l.createElementVNode)('input',{type:'checkbox',checked:(0,l.unref)(t).saveOnAIResponse,disabled:!(0,l.unref)(t).enabled,onChange:r[1]||(r[1]=(...e)=>(0,l.unref)(o)&&(0,l.unref)(o)(...e))},null,40,vl),r[4]||(r[4]=(0,l.createElementVNode)('span',{class:'toggle-slider'},null,-1))])],2),(0,l.createCommentVNode)(' æœ€å¤§è‡ªåŠ¨å­˜æ¡£æ•°é‡ '),(0,l.createElementVNode)('div',{class:(0,l.normalizeClass)(['setting-item',{disabled:!(0,l.unref)(t).enabled}])},[r[7]||(r[7]=(0,l.createElementVNode)('div',{class:'setting-info'},[(0,l.createElementVNode)('div',{class:'setting-label'},'æœ€å¤§è‡ªåŠ¨å­˜æ¡£æ•°é‡'),(0,l.createElementVNode)('div',{class:'setting-desc'},'è¶…è¿‡æ­¤æ•°é‡æ—¶ä¼šè‡ªåŠ¨åˆ é™¤æœ€æ—§çš„è‡ªåŠ¨å­˜æ¡£')],-1)),(0,l.createElementVNode)('div',pl,[(0,l.createElementVNode)('input',{type:'number',class:'number-input',value:(0,l.unref)(t).maxAutoSaves,disabled:!(0,l.unref)(t).enabled,min:'1',max:'50',onChange:u},null,40,gl),r[6]||(r[6]=(0,l.createElementVNode)('span',{class:'unit'},'ä¸ª',-1))])],2),(0,l.createCommentVNode)(' è‡ªåŠ¨å­˜æ¡£å‰ç¼€ '),(0,l.createElementVNode)('div',{class:(0,l.normalizeClass)(['setting-item',{disabled:!(0,l.unref)(t).enabled}])},[r[8]||(r[8]=(0,l.createElementVNode)('div',{class:'setting-info'},[(0,l.createElementVNode)('div',{class:'setting-label'},'è‡ªåŠ¨å­˜æ¡£å‰ç¼€'),(0,l.createElementVNode)('div',{class:'setting-desc'},'è‡ªåŠ¨å­˜æ¡£åç§°çš„å‰ç¼€ï¼Œä¾¿äºåŒºåˆ†')],-1)),(0,l.createElementVNode)('div',fl,[(0,l.createElementVNode)('input',{type:'text',class:'text-input',value:(0,l.unref)(t).autoSavePrefix,disabled:!(0,l.unref)(t).enabled,placeholder:'[è‡ªåŠ¨]',onChange:d},null,40,hl)])],2),(0,l.createCommentVNode)(' é˜²æŠ–é—´éš” '),(0,l.createElementVNode)('div',{class:(0,l.normalizeClass)(['setting-item',{disabled:!(0,l.unref)(t).enabled}])},[r[10]||(r[10]=(0,l.createElementVNode)('div',{class:'setting-info'},[(0,l.createElementVNode)('div',{class:'setting-label'},'é˜²æŠ–é—´éš”'),(0,l.createElementVNode)('div',{class:'setting-desc'},'ä¸¤æ¬¡è‡ªåŠ¨å­˜æ¡£ä¹‹é—´çš„æœ€å°é—´éš”æ—¶é—´')],-1)),(0,l.createElementVNode)('div',yl,[(0,l.createElementVNode)('input',{type:'number',class:'number-input',value:(0,l.unref)(t).debounceMs,disabled:!(0,l.unref)(t).enabled,min:'500',max:'10000',step:'100',onChange:m},null,40,Vl),r[9]||(r[9]=(0,l.createElementVNode)('span',{class:'unit'},'æ¯«ç§’',-1))])],2),(0,l.createCommentVNode)(' é‡ç½®æŒ‰é’® '),(0,l.createElementVNode)('div',{class:'setting-actions'},[(0,l.createElementVNode)('button',{class:'btn btn-secondary',onClick:v},'é‡ç½®ä¸ºé»˜è®¤å€¼')]),(0,l.createCommentVNode)(' å½“å‰çŠ¶æ€ '),(0,l.createElementVNode)('div',El,[r[14]||(r[14]=(0,l.createElementVNode)('h5',{class:'status-title'},'å½“å‰çŠ¶æ€',-1)),(0,l.createElementVNode)('div',bl,[(0,l.createElementVNode)('div',Sl,[r[11]||(r[11]=(0,l.createElementVNode)('span',{class:'status-label'},'è‡ªåŠ¨å­˜æ¡£:',-1)),(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(['status-value',{active:(0,l.unref)(t).enabled}])},(0,l.toDisplayString)((0,l.unref)(t).enabled?'å·²å¯ç”¨':'å·²ç¦ç”¨'),3)]),(0,l.createElementVNode)('div',Nl,[r[12]||(r[12]=(0,l.createElementVNode)('span',{class:'status-label'},'AIå›å¤å­˜æ¡£:',-1)),(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)(['status-value',{active:(0,l.unref)(t).saveOnAIResponse&&(0,l.unref)(t).enabled}])},(0,l.toDisplayString)((0,l.unref)(t).saveOnAIResponse&&(0,l.unref)(t).enabled?'å·²å¯ç”¨':'å·²ç¦ç”¨'),3)]),(0,l.unref)(a)?((0,l.openBlock)(),(0,l.createElementBlock)('div',kl,[r[13]||(r[13]=(0,l.createElementVNode)('span',{class:'status-label'},'æœ€åå­˜æ¡£:',-1)),(0,l.createElementVNode)('span',Cl,(0,l.toDisplayString)((0,l.unref)(a).name),1)])):(0,l.createCommentVNode)('v-if',!0)])]),(0,l.createCommentVNode)(' è¯´æ˜ä¿¡æ¯ '),r[16]||(r[16]=(0,l.createElementVNode)('div',{class:'info-section'},[(0,l.createElementVNode)('h5',{class:'info-title'},'ğŸ’¡ è¯´æ˜'),(0,l.createElementVNode)('ul',{class:'info-list'},[(0,l.createElementVNode)('li',null,'è‡ªåŠ¨å­˜æ¡£ä¼šåœ¨æ¯æ¬¡AIå›å¤ç»“æŸåè‡ªåŠ¨åˆ›å»º'),(0,l.createElementVNode)('li',null,'è‡ªåŠ¨å­˜æ¡£ä¸æ‰‹åŠ¨å­˜æ¡£åˆ†å¼€ç®¡ç†ï¼Œäº’ä¸å½±å“'),(0,l.createElementVNode)('li',null,'è¶…å‡ºæ•°é‡é™åˆ¶æ—¶ï¼Œæœ€æ—§çš„è‡ªåŠ¨å­˜æ¡£ä¼šè¢«è‡ªåŠ¨åˆ é™¤'),(0,l.createElementVNode)('li',null,'å¯ä»¥å°†é‡è¦çš„è‡ªåŠ¨å­˜æ¡£è½¬æ¢ä¸ºæ‰‹åŠ¨å­˜æ¡£ä»¥æ°¸ä¹…ä¿ç•™')])],-1))]))}}),Ml=(0,M.A)(wl,[['__scopeId','data-v-1d1dfdc8']]),Al={class:'save-manager'},Il={class:'save-header'},Dl={class:'header-actions'},Bl=['disabled'],xl={class:'save-stats'},_l={class:'stat-item'},Tl={class:'stat-value'},$l={class:'stat-item'},Ll={class:'stat-value'},Ol={class:'stat-item'},Rl={class:'stat-value'},Ul={class:'tab-bar'},jl={class:'save-content'},Pl={key:0,class:'save-list-container'},zl={class:'create-save-section'},Fl=['disabled'],Hl={key:0,class:'save-list'},Wl={class:'save-info'},Gl={class:'save-name'},Jl={class:'save-time'},Kl={class:'save-actions'},Yl=['onClick','disabled'],ql=['onClick','disabled'],Xl=['onClick','disabled'],Ql=['onClick','disabled'],Zl={key:1,class:'empty-state'},er={class:'save-list-container'},tr={class:'auto-save-actions'},ar=['disabled'],nr=['disabled'],or={key:0,class:'save-list'},lr={class:'save-info'},rr={class:'save-name'},sr={class:'save-time'},cr={key:0,class:'save-source'},ir={class:'save-actions'},ur=['onClick','disabled'],dr=['onClick','disabled'],mr=['onClick','disabled'],vr={key:1,class:'empty-state'},pr={class:'settings-container'},gr={class:'save-footer'},fr={class:'footer-left'},hr=['disabled'],yr=['disabled'],Vr={class:'footer-right'},Er={class:'import-btn btn btn-secondary'},br={key:0,class:'error-message'},Sr={class:'confirm-dialog'},Nr={class:'confirm-title'},kr={class:'confirm-message'},Cr=(0,l.defineComponent)({__name:'SaveManager',emits:['close','save-loaded','save-created'],setup(e,{emit:t}){const a=t,{isProcessing:n,error:o,saveList:r,currentSave:s,saveStats:c,manualSaveList:i,autoSaveList:u,hasSaves:d,refreshList:m,refreshStats:v,createSave:p,updateSave:g,loadSave:f,deleteSave:h,quickSave:y,quickLoad:V,downloadSave:E,uploadSave:b,triggerAutoSave:S,clearAllAutoSaves:N,convertAutoSaveToManual:k}=sl(),C=(0,l.ref)('manual'),w=(0,l.ref)(''),M=(0,l.ref)(!1),A=(0,l.ref)(''),I=(0,l.ref)('');let D=null;const B=e=>new Date(e).toLocaleString('zh-CN',{month:'2-digit',day:'2-digit',hour:'2-digit',minute:'2-digit'}),x=()=>{},T=(e,t,a)=>{A.value=e,I.value=t,D=a,M.value=!0},L=()=>{M.value=!1,D=null},O=()=>{D&&D(),M.value=!1,D=null},R=async()=>{if(!w.value.trim())return;const e=await p(w.value.trim());e&&(w.value='',a('save-created',e.id))},U=async e=>{T('è¯»å–å­˜æ¡£','ç¡®å®šè¦è¯»å–æ­¤å­˜æ¡£å—ï¼Ÿå½“å‰æœªä¿å­˜çš„è¿›åº¦å°†ä¸¢å¤±ã€‚',async()=>{await f(e)&&a('save-loaded',e)})},j=(e,t)=>{T('åˆ é™¤å­˜æ¡£',`ç¡®å®šè¦åˆ é™¤å­˜æ¡£"${t}"å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚`,async()=>{await h(e)})},P=async e=>{const t=e.target,a=t.files?.[0];a&&(await b(a),t.value='')},F=async()=>{await y()},H=async()=>{T('å¿«é€ŸåŠ è½½','ç¡®å®šè¦åŠ è½½æœ€è¿‘çš„å­˜æ¡£å—ï¼Ÿå½“å‰æœªä¿å­˜çš„è¿›åº¦å°†ä¸¢å¤±ã€‚',async()=>{await V()})},W=async()=>{await S()},G=()=>{T('æ¸…ç©ºè‡ªåŠ¨å­˜æ¡£','ç¡®å®šè¦åˆ é™¤æ‰€æœ‰è‡ªåŠ¨å­˜æ¡£å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚',async()=>{await N()})};return(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',Al,[(0,l.createCommentVNode)(' é¡¶éƒ¨æ ‡é¢˜æ  '),(0,l.createElementVNode)('div',Il,[t[6]||(t[6]=(0,l.createElementVNode)('h3',{class:'save-title'},[(0,l.createElementVNode)('span',{class:'icon'},'ğŸ’¾'),(0,l.createTextVNode)(' å­˜æ¡£ç®¡ç† ')],-1)),(0,l.createElementVNode)('div',Dl,[(0,l.createElementVNode)('button',{class:'btn btn-icon',onClick:t[0]||(t[0]=(...e)=>(0,l.unref)(m)&&(0,l.unref)(m)(...e)),disabled:(0,l.unref)(n),title:'åˆ·æ–°'},[(0,l.createElementVNode)('span',{class:(0,l.normalizeClass)({spinning:(0,l.unref)(n)})},'ğŸ”„',2)],8,Bl),(0,l.createElementVNode)('button',{class:'btn btn-icon',onClick:t[1]||(t[1]=t=>e.$emit('close')),title:'å…³é—­'},'âœ–')])]),(0,l.createCommentVNode)(' å­˜æ¡£ç»Ÿè®¡ '),(0,l.createElementVNode)('div',xl,[(0,l.createElementVNode)('div',_l,[t[7]||(t[7]=(0,l.createElementVNode)('span',{class:'stat-label'},'æ€»è®¡',-1)),(0,l.createElementVNode)('span',Tl,(0,l.toDisplayString)((0,l.unref)(c).total),1)]),(0,l.createElementVNode)('div',$l,[t[8]||(t[8]=(0,l.createElementVNode)('span',{class:'stat-label'},'æ‰‹åŠ¨',-1)),(0,l.createElementVNode)('span',Ll,(0,l.toDisplayString)((0,l.unref)(c).manual),1)]),(0,l.createElementVNode)('div',Ol,[t[9]||(t[9]=(0,l.createElementVNode)('span',{class:'stat-label'},'è‡ªåŠ¨',-1)),(0,l.createElementVNode)('span',Rl,(0,l.toDisplayString)((0,l.unref)(c).auto),1)])]),(0,l.createCommentVNode)(' æ ‡ç­¾é¡µåˆ‡æ¢ '),(0,l.createElementVNode)('div',Ul,[(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['tab-btn',{active:'manual'===C.value}]),onClick:t[2]||(t[2]=e=>C.value='manual')},' æ‰‹åŠ¨å­˜æ¡£ ('+(0,l.toDisplayString)((0,l.unref)(i).length)+') ',3),(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['tab-btn',{active:'auto'===C.value}]),onClick:t[3]||(t[3]=e=>C.value='auto')},' è‡ªåŠ¨å­˜æ¡£ ('+(0,l.toDisplayString)((0,l.unref)(u).length)+') ',3),(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['tab-btn',{active:'settings'===C.value}]),onClick:t[4]||(t[4]=e=>C.value='settings')},' è®¾ç½® ',2)]),(0,l.createCommentVNode)(' å†…å®¹åŒºåŸŸ '),(0,l.createElementVNode)('div',jl,[(0,l.createCommentVNode)(' æ‰‹åŠ¨å­˜æ¡£åˆ—è¡¨ '),'manual'===C.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',Pl,[(0,l.createCommentVNode)(' åˆ›å»ºæ–°å­˜æ¡£ '),(0,l.createElementVNode)('div',zl,[(0,l.withDirectives)((0,l.createElementVNode)('input',{'onUpdate:modelValue':t[5]||(t[5]=e=>w.value=e),type:'text',class:'save-name-input',placeholder:'è¾“å…¥å­˜æ¡£åç§°...',onKeyup:(0,l.withKeys)(R,['enter'])},null,544),[[l.vModelText,w.value]]),(0,l.createElementVNode)('button',{class:'btn btn-primary',onClick:R,disabled:(0,l.unref)(n)||!w.value.trim()},' åˆ›å»ºå­˜æ¡£ ',8,Fl)]),(0,l.createCommentVNode)(' å­˜æ¡£åˆ—è¡¨ '),(0,l.unref)(i).length>0?((0,l.openBlock)(),(0,l.createElementBlock)('div',Hl,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)((0,l.unref)(i),e=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.id,class:(0,l.normalizeClass)(['save-item',{active:(0,l.unref)(s)?.id===e.id}])},[(0,l.createElementVNode)('div',Wl,[(0,l.createElementVNode)('div',Gl,(0,l.toDisplayString)(e.name),1),(0,l.createElementVNode)('div',Jl,[(0,l.createElementVNode)('span',null,'åˆ›å»º: '+(0,l.toDisplayString)(B(e.createdAt)),1),(0,l.createElementVNode)('span',null,'æ›´æ–°: '+(0,l.toDisplayString)(B(e.updatedAt)),1)])]),(0,l.createElementVNode)('div',Kl,[(0,l.createElementVNode)('button',{class:'btn btn-sm btn-primary',onClick:t=>U(e.id),disabled:(0,l.unref)(n),title:'è¯»å–'},' ğŸ“‚ ',8,Yl),(0,l.createElementVNode)('button',{class:'btn btn-sm btn-secondary',onClick:t=>(async e=>{T('è¦†ç›–å­˜æ¡£','ç¡®å®šè¦è¦†ç›–æ­¤å­˜æ¡£å—ï¼ŸåŸæœ‰æ•°æ®å°†è¢«æ›¿æ¢ã€‚',async()=>{await g(e)})})(e.id),disabled:(0,l.unref)(n),title:'è¦†ç›–'},' ğŸ’¾ ',8,ql),(0,l.createElementVNode)('button',{class:'btn btn-sm btn-secondary',onClick:t=>(async e=>{await E(e)})(e.id),disabled:(0,l.unref)(n),title:'å¯¼å‡º'},' ğŸ“¤ ',8,Xl),(0,l.createElementVNode)('button',{class:'btn btn-sm btn-danger',onClick:t=>j(e.id,e.name),disabled:(0,l.unref)(n),title:'åˆ é™¤'},' ğŸ—‘ï¸ ',8,Ql)])],2))),128))])):((0,l.openBlock)(),(0,l.createElementBlock)('div',Zl,[...t[10]||(t[10]=[(0,l.createElementVNode)('p',null,'æš‚æ— æ‰‹åŠ¨å­˜æ¡£',-1),(0,l.createElementVNode)('p',{class:'hint'},'åœ¨ä¸Šæ–¹è¾“å…¥åç§°åˆ›å»ºæ–°å­˜æ¡£',-1)])]))])):'auto'===C.value?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:1},[(0,l.createCommentVNode)(' è‡ªåŠ¨å­˜æ¡£åˆ—è¡¨ '),(0,l.createElementVNode)('div',er,[(0,l.createCommentVNode)(' è‡ªåŠ¨å­˜æ¡£æ“ä½œ '),(0,l.createElementVNode)('div',tr,[(0,l.createElementVNode)('button',{class:'btn btn-secondary',onClick:W,disabled:(0,l.unref)(n)},' ç«‹å³è‡ªåŠ¨å­˜æ¡£ ',8,ar),(0,l.createElementVNode)('button',{class:'btn btn-danger',onClick:G,disabled:(0,l.unref)(n)||0===(0,l.unref)(u).length},' æ¸…ç©ºè‡ªåŠ¨å­˜æ¡£ ',8,nr)]),(0,l.createCommentVNode)(' è‡ªåŠ¨å­˜æ¡£åˆ—è¡¨ '),(0,l.unref)(u).length>0?((0,l.openBlock)(),(0,l.createElementBlock)('div',or,[((0,l.openBlock)(!0),(0,l.createElementBlock)(l.Fragment,null,(0,l.renderList)((0,l.unref)(u),e=>{return(0,l.openBlock)(),(0,l.createElementBlock)('div',{key:e.id,class:'save-item auto-save'},[(0,l.createElementVNode)('div',lr,[(0,l.createElementVNode)('div',rr,[t[11]||(t[11]=(0,l.createElementVNode)('span',{class:'auto-badge'},'è‡ªåŠ¨',-1)),(0,l.createTextVNode)(' '+(0,l.toDisplayString)(e.name),1)]),(0,l.createElementVNode)('div',sr,[(0,l.createElementVNode)('span',null,(0,l.toDisplayString)(B(e.updatedAt)),1),e.saveSource?((0,l.openBlock)(),(0,l.createElementBlock)('span',cr,' æ¥æº: '+(0,l.toDisplayString)((a=e.saveSource,{manual:'æ‰‹åŠ¨',auto:'è‡ªåŠ¨',ai_response:'AIå›å¤'}[a]||a)),1)):(0,l.createCommentVNode)('v-if',!0)])]),(0,l.createElementVNode)('div',ir,[(0,l.createElementVNode)('button',{class:'btn btn-sm btn-primary',onClick:t=>U(e.id),disabled:(0,l.unref)(n),title:'è¯»å–'},' ğŸ“‚ ',8,ur),(0,l.createElementVNode)('button',{class:'btn btn-sm btn-secondary',onClick:t=>(async e=>{T('è½¬ä¸ºæ‰‹åŠ¨å­˜æ¡£','ç¡®å®šè¦å°†æ­¤è‡ªåŠ¨å­˜æ¡£è½¬ä¸ºæ‰‹åŠ¨å­˜æ¡£å—ï¼Ÿ',async()=>{await k(e)})})(e.id),disabled:(0,l.unref)(n),title:'è½¬ä¸ºæ‰‹åŠ¨å­˜æ¡£'},' ğŸ“Œ ',8,dr),(0,l.createElementVNode)('button',{class:'btn btn-sm btn-danger',onClick:t=>j(e.id,e.name),disabled:(0,l.unref)(n),title:'åˆ é™¤'},' ğŸ—‘ï¸ ',8,mr)])]);var a}),128))])):((0,l.openBlock)(),(0,l.createElementBlock)('div',vr,[...t[12]||(t[12]=[(0,l.createElementVNode)('p',null,'æš‚æ— è‡ªåŠ¨å­˜æ¡£',-1),(0,l.createElementVNode)('p',{class:'hint'},'AIå›å¤ç»“æŸåä¼šè‡ªåŠ¨åˆ›å»ºå­˜æ¡£',-1)])]))])],2112)):'settings'===C.value?((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,{key:2},[(0,l.createCommentVNode)(' è®¾ç½®é¢æ¿ '),(0,l.createElementVNode)('div',pr,[(0,l.createVNode)(Ml)])],2112)):(0,l.createCommentVNode)('v-if',!0)]),(0,l.createCommentVNode)(' åº•éƒ¨æ“ä½œæ  '),(0,l.createElementVNode)('div',gr,[(0,l.createElementVNode)('div',fr,[(0,l.createElementVNode)('button',{class:'btn btn-secondary',onClick:F,disabled:(0,l.unref)(n)},'å¿«é€Ÿä¿å­˜',8,hr),(0,l.createElementVNode)('button',{class:'btn btn-secondary',onClick:H,disabled:(0,l.unref)(n)||!(0,l.unref)(d)},' å¿«é€ŸåŠ è½½ ',8,yr)]),(0,l.createElementVNode)('div',Vr,[(0,l.createElementVNode)('label',Er,[t[13]||(t[13]=(0,l.createTextVNode)(' å¯¼å…¥å­˜æ¡£ ',-1)),(0,l.createElementVNode)('input',{type:'file',accept:'.json',onChange:P,hidden:''},null,32)])])]),(0,l.createCommentVNode)(' é”™è¯¯æç¤º '),(0,l.unref)(o)?((0,l.openBlock)(),(0,l.createElementBlock)('div',br,[(0,l.createTextVNode)((0,l.toDisplayString)((0,l.unref)(o))+' ',1),(0,l.createElementVNode)('button',{class:'btn-close',onClick:x},'Ã—')])):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' ç¡®è®¤å¯¹è¯æ¡† '),M.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:1,class:'confirm-overlay',onClick:(0,l.withModifiers)(L,['self'])},[(0,l.createElementVNode)('div',Sr,[(0,l.createElementVNode)('div',Nr,(0,l.toDisplayString)(A.value),1),(0,l.createElementVNode)('div',kr,(0,l.toDisplayString)(I.value),1),(0,l.createElementVNode)('div',{class:'confirm-actions'},[(0,l.createElementVNode)('button',{class:'btn btn-secondary',onClick:L},'å–æ¶ˆ'),(0,l.createElementVNode)('button',{class:'btn btn-danger',onClick:O},'ç¡®è®¤')])])])):(0,l.createCommentVNode)('v-if',!0)]))}}),wr=(0,M.A)(Cr,[['__scopeId','data-v-63e5f2b9']]);const Mr={class:'context-manager-panel'},Ar={class:'panel-header'},Ir={class:'panel-body'},Dr={class:'enable-section'},Br={class:'enable-row'},xr={class:'toggle-switch'},_r=['checked','disabled'],Tr={class:'stats-section'},$r={class:'stats-grid'},Lr={class:'stat-item'},Or={class:'stat-value'},Rr={class:'stat-item'},Ur={class:'stat-value'},jr={class:'stat-item'},Pr={class:'stat-value'},zr={class:'stat-item'},Fr={class:'stat-value'},Hr={key:0,class:'last-update'},Wr={class:'mode-section'},Gr={class:'mode-selector'},Jr=['disabled'],Kr=['disabled'],Yr={class:'config-section'},qr={class:'config-item'},Xr={class:'config-control'},Qr=['disabled'],Zr={class:'config-item'},es={class:'config-control'},ts=['disabled'],as={class:'actions-section'},ns={class:'action-buttons'},os=['disabled'],ls={key:0},rs={key:1},ss=['disabled'],cs=['disabled'],is=['disabled'],us={key:0,class:'error-message'},ds=(0,l.defineComponent)({__name:'ContextManagerPanel',emits:['close'],setup(e){const{isProcessing:t,error:a,mode:n,config:o,statistics:r,formattedLastUpdateTime:s,isEnabled:c,refresh:i,setSegmentCount:u,setSmallSummaryCount:d,switchMode:m,regenerateSegments:v,clearAll:p,setEnabled:g}=function(){const e=(0,l.ref)(!1),t=(0,l.ref)(!1),a=(0,l.ref)(null),n=(0,l.ref)('segmented'),o=(0,l.ref)(!1),r=(0,l.ref)({segmentCount:3,smallSummaryCount:25}),s=(0,l.ref)({recordCount:0,textCount:0,segmentCount:0,smallSummaryCount:0,largeSummaryCount:0,mode:'segmented'}),c=(0,l.ref)([]),i=(0,l.ref)([]),u=(0,l.ref)(null),d=(0,l.ref)(0),m=(0,l.computed)(()=>s.value.recordCount>0),v=(0,l.computed)(()=>'segmented'===n.value),p=(0,l.computed)(()=>d.value?new Date(d.value).toLocaleString('zh-CN'):''),g=()=>{const e=el.getState(),l=el.getStatistics(),m=el.getConfig();n.value=e.mode,r.value=m,s.value=l,t.value=e.isProcessing,a.value=e.error,d.value=e.lastUpdateTime,u.value=e.segmentedContent,o.value=el.isEnabled(),c.value=el.getLatestRecords(10),i.value=el.getLatestTexts(5)};return(0,l.onMounted)(async()=>{console.log('[useContextManager] Composableå·²æŒ‚è½½'),g()}),{isInitialized:e,isProcessing:t,error:a,mode:n,config:r,statistics:s,latestRecords:c,latestTexts:i,segmentedContent:u,lastUpdateTime:d,isEnabled:o,hasRecords:m,isSegmentedMode:v,formattedLastUpdateTime:p,initialize:async()=>{try{t.value=!0,a.value=null;const n=await el.initialize();return n&&(e.value=!0,g()),n}catch(e){return a.value=e instanceof Error?e.message:'åˆå§‹åŒ–å¤±è´¥',!1}finally{t.value=!1}},refresh:async()=>{await el.loadFromWorldbook(),g()},setSegmentCount:async e=>{try{return t.value=!0,a.value=null,await el.setSegmentCount(e),g(),!0}catch(e){return a.value=e instanceof Error?e.message:'è®¾ç½®å¤±è´¥',!1}finally{t.value=!1}},setSmallSummaryCount:async e=>{try{return t.value=!0,a.value=null,await el.setSmallSummaryCount(e),g(),!0}catch(e){return a.value=e instanceof Error?e.message:'è®¾ç½®å¤±è´¥',!1}finally{t.value=!1}},updateConfig:async e=>{try{return t.value=!0,a.value=null,await el.setConfig(e),g(),!0}catch(e){return a.value=e instanceof Error?e.message:'æ›´æ–°é…ç½®å¤±è´¥',!1}finally{t.value=!1}},switchMode:async e=>{try{return t.value=!0,a.value=null,await el.switchMode(e),g(),!0}catch(e){return a.value=e instanceof Error?e.message:'åˆ‡æ¢æ¨¡å¼å¤±è´¥',!1}finally{t.value=!1}},regenerateSegments:async()=>{try{t.value=!0,a.value=null;const e=await el.regenerateSegments();return g(),e}catch(e){return a.value=e instanceof Error?e.message:'é‡æ–°ç”Ÿæˆå¤±è´¥',!1}finally{t.value=!1}},clearAll:async(e=!1)=>{try{t.value=!0,a.value=null;const n=await el.clearAll(e);return g(),n}catch(e){return a.value=e instanceof Error?e.message:'æ¸…ç©ºå¤±è´¥',!1}finally{t.value=!1}},getSaveData:async()=>await el.getSaveData(),restoreFromSaveData:async e=>{try{t.value=!0,a.value=null;const n=await el.restoreFromSaveData(e);return g(),n}catch(e){return a.value=e instanceof Error?e.message:'æ¢å¤å¤±è´¥',!1}finally{t.value=!1}},syncState:g,setEnabled:async e=>{try{return t.value=!0,a.value=null,el.setEnabled(e),e&&await el.initialize(),g(),!0}catch(e){return a.value=e instanceof Error?e.message:'è®¾ç½®å¯ç”¨çŠ¶æ€å¤±è´¥',!1}finally{t.value=!1}},service:el}}(),f=(0,l.reactive)({segmentCount:3,smallSummaryCount:25}),h=async()=>{await i(),'undefined'!=typeof toastr&&toastr.success('æ•°æ®å·²åˆ·æ–°')},y=async()=>{await u(f.segmentCount)&&'undefined'!=typeof toastr&&toastr.success('åˆ†æ®µæ•°é‡å·²æ›´æ–°')},V=async()=>{await d(f.smallSummaryCount)&&'undefined'!=typeof toastr&&toastr.success('å°æ€»ç»“èŒƒå›´å·²æ›´æ–°')},E=async()=>{await m(n.value)&&'undefined'!=typeof toastr&&toastr.success(`å·²åˆ‡æ¢åˆ°${'segmented'===n.value?'åˆ†æ®µ':'å®Œæ•´'}æ¨¡å¼`)},b=async()=>{await v()&&'undefined'!=typeof toastr&&toastr.success('åˆ†æ®µå·²é‡æ–°ç”Ÿæˆ')},S=async()=>{const e=c.value?'ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰ä¸Šä¸‹æ–‡æ•°æ®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚':'åŠŸèƒ½æœªå¯ç”¨ï¼Œä»…æ¸…ç©ºæœ¬åœ°çŠ¶æ€ã€‚ç¡®å®šç»§ç»­å—ï¼Ÿ';if(!await ye(e,'æ¸…ç©ºæ•°æ®'))return;await p(!1)&&'undefined'!=typeof toastr&&toastr.success('æ•°æ®å·²æ¸…ç©º')},N=async()=>{if(!await ye('ç¡®å®šè¦å¼ºåˆ¶æ¸…ç©ºä¸–ç•Œä¹¦ä¸­çš„ä¸Šä¸‹æ–‡æ¡ç›®å—ï¼Ÿæ­¤æ“ä½œä¼šå½±å“ä¸–ç•Œä¹¦å†…å®¹ï¼Œä¸å¯æ¢å¤ï¼','å¼ºåˆ¶æ¸…ç©ºä¸–ç•Œä¹¦'))return;await p(!0)&&'undefined'!=typeof toastr&&toastr.success('ä¸–ç•Œä¹¦æ¡ç›®å·²æ¸…ç©º')},k=async e=>{const t=e.target;if(t.checked){if(await Ve('å¯ç”¨åå°†ç”±æœ¬ç³»ç»Ÿç®¡ç†ä¸–ç•Œä¹¦æ¡ç›®ã€‚å¦‚æœæ‚¨ä½¿ç”¨å¤–æŒ‚çš„ä¸–ç•Œä¹¦æ¥æä¾›ä¸Šä¸‹æ–‡ï¼Œè¯·ä¿æŒç¦ç”¨çŠ¶æ€ã€‚ç¡®å®šå¯ç”¨å—ï¼Ÿ','å¯ç”¨ä¸Šä¸‹æ–‡ç®¡ç†')){await g(!0)&&'undefined'!=typeof toastr&&toastr.success('ä¸Šä¸‹æ–‡ç®¡ç†å·²å¯ç”¨')}else t.checked=!1}else{await g(!1)&&'undefined'!=typeof toastr&&toastr.info('ä¸Šä¸‹æ–‡ç®¡ç†å·²ç¦ç”¨')}};return(0,l.onMounted)(()=>{f.segmentCount=o.value.segmentCount,f.smallSummaryCount=o.value.smallSummaryCount}),(e,o)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',Mr,[(0,l.createCommentVNode)(' å¤´éƒ¨ '),(0,l.createElementVNode)('div',Ar,[o[5]||(o[5]=(0,l.createElementVNode)('h3',null,'ğŸ“š ä¸Šä¸‹æ–‡ç®¡ç†',-1)),(0,l.createElementVNode)('button',{class:'btn-close',onClick:o[0]||(o[0]=t=>e.$emit('close'))},'âœ•')]),(0,l.createCommentVNode)(' å†…å®¹ '),(0,l.createElementVNode)('div',Ir,[(0,l.createCommentVNode)(' åŠŸèƒ½å¯ç”¨å¼€å…³ '),(0,l.createElementVNode)('div',Dr,[o[8]||(o[8]=(0,l.createElementVNode)('div',{class:'section-title'},'âš¡ åŠŸèƒ½å¼€å…³',-1)),(0,l.createElementVNode)('div',Br,[o[7]||(o[7]=(0,l.createElementVNode)('span',{class:'enable-label'},'ä¸Šä¸‹æ–‡ç®¡ç†åŠŸèƒ½',-1)),(0,l.createElementVNode)('label',xr,[(0,l.createElementVNode)('input',{type:'checkbox',checked:(0,l.unref)(c),onChange:k,disabled:(0,l.unref)(t)},null,40,_r),o[6]||(o[6]=(0,l.createElementVNode)('span',{class:'toggle-slider'},null,-1))])]),(0,l.createElementVNode)('div',{class:(0,l.normalizeClass)(['enable-status',{enabled:(0,l.unref)(c),disabled:!(0,l.unref)(c)}])},(0,l.toDisplayString)((0,l.unref)(c)?'âœ… å·²å¯ç”¨ - æ­£åœ¨ç®¡ç†ä¸–ç•Œä¹¦':'âš ï¸ å·²ç¦ç”¨ - ä½¿ç”¨å¤–æŒ‚ä¸–ç•Œä¹¦'),3)]),(0,l.createCommentVNode)(' ç»Ÿè®¡ä¿¡æ¯ '),(0,l.createElementVNode)('div',Tr,[o[13]||(o[13]=(0,l.createElementVNode)('div',{class:'section-title'},'ğŸ“Š ç»Ÿè®¡ä¿¡æ¯',-1)),(0,l.createElementVNode)('div',$r,[(0,l.createElementVNode)('div',Lr,[o[9]||(o[9]=(0,l.createElementVNode)('span',{class:'stat-label'},'å†å²è®°å½•',-1)),(0,l.createElementVNode)('span',Or,(0,l.toDisplayString)((0,l.unref)(r).recordCount),1)]),(0,l.createElementVNode)('div',Rr,[o[10]||(o[10]=(0,l.createElementVNode)('span',{class:'stat-label'},'å†å²æ­£æ–‡',-1)),(0,l.createElementVNode)('span',Ur,(0,l.toDisplayString)((0,l.unref)(r).textCount),1)]),(0,l.createElementVNode)('div',jr,[o[11]||(o[11]=(0,l.createElementVNode)('span',{class:'stat-label'},'åˆ†æ®µæ­£æ–‡',-1)),(0,l.createElementVNode)('span',Pr,(0,l.toDisplayString)((0,l.unref)(r).segmentCount),1)]),(0,l.createElementVNode)('div',zr,[o[12]||(o[12]=(0,l.createElementVNode)('span',{class:'stat-label'},'å°æ€»ç»“',-1)),(0,l.createElementVNode)('span',Fr,(0,l.toDisplayString)((0,l.unref)(r).smallSummaryCount),1)])]),(0,l.unref)(s)?((0,l.openBlock)(),(0,l.createElementBlock)('div',Hr,'æœ€åæ›´æ–°: '+(0,l.toDisplayString)((0,l.unref)(s)),1)):(0,l.createCommentVNode)('v-if',!0)]),(0,l.createCommentVNode)(' æ¨¡å¼åˆ‡æ¢ '),(0,l.createElementVNode)('div',Wr,[o[16]||(o[16]=(0,l.createElementVNode)('div',{class:'section-title'},'ğŸ›ï¸ æ¨¡å¼é…ç½®',-1)),(0,l.createElementVNode)('div',Gr,[(0,l.createElementVNode)('label',{class:(0,l.normalizeClass)(['mode-option',{active:'segmented'===(0,l.unref)(n),disabled:!(0,l.unref)(c)}])},[(0,l.withDirectives)((0,l.createElementVNode)('input',{type:'radio','onUpdate:modelValue':o[1]||(o[1]=e=>(0,l.isRef)(n)?n.value=e:null),value:'segmented',onChange:E,disabled:!(0,l.unref)(c)},null,40,Jr),[[l.vModelRadio,(0,l.unref)(n)]]),o[14]||(o[14]=(0,l.createElementVNode)('span',null,'åˆ†æ®µæ¨¡å¼',-1))],2),(0,l.createElementVNode)('label',{class:(0,l.normalizeClass)(['mode-option',{active:'full'===(0,l.unref)(n),disabled:!(0,l.unref)(c)}])},[(0,l.withDirectives)((0,l.createElementVNode)('input',{type:'radio','onUpdate:modelValue':o[2]||(o[2]=e=>(0,l.isRef)(n)?n.value=e:null),value:'full',onChange:E,disabled:!(0,l.unref)(c)},null,40,Kr),[[l.vModelRadio,(0,l.unref)(n)]]),o[15]||(o[15]=(0,l.createElementVNode)('span',null,'å®Œæ•´æ¨¡å¼',-1))],2)])]),(0,l.createCommentVNode)(' é…ç½®é€‰é¡¹ '),(0,l.createElementVNode)('div',Yr,[o[21]||(o[21]=(0,l.createElementVNode)('div',{class:'section-title'},'âš™ï¸ åˆ†æ®µé…ç½®',-1)),(0,l.createElementVNode)('div',qr,[o[17]||(o[17]=(0,l.createElementVNode)('label',null,'åˆ†æ®µæ­£æ–‡æ•°é‡',-1)),(0,l.createElementVNode)('div',Xr,[(0,l.withDirectives)((0,l.createElementVNode)('input',{type:'number','onUpdate:modelValue':o[3]||(o[3]=e=>f.segmentCount=e),min:'0',max:'20',class:'config-input'},null,512),[[l.vModelText,f.segmentCount,void 0,{number:!0}]]),(0,l.createElementVNode)('button',{class:'btn-apply',onClick:y,disabled:(0,l.unref)(t)},'åº”ç”¨',8,Qr)]),o[18]||(o[18]=(0,l.createElementVNode)('span',{class:'config-hint'},'è®¾ä¸º0åˆ™ä¸ä½¿ç”¨åˆ†æ®µæ­£æ–‡',-1))]),(0,l.createElementVNode)('div',Zr,[o[19]||(o[19]=(0,l.createElementVNode)('label',null,'å°æ€»ç»“èŒƒå›´',-1)),(0,l.createElementVNode)('div',es,[(0,l.withDirectives)((0,l.createElementVNode)('input',{type:'number','onUpdate:modelValue':o[4]||(o[4]=e=>f.smallSummaryCount=e),min:'0',max:'100',class:'config-input'},null,512),[[l.vModelText,f.smallSummaryCount,void 0,{number:!0}]]),(0,l.createElementVNode)('button',{class:'btn-apply',onClick:V,disabled:(0,l.unref)(t)},'åº”ç”¨',8,ts)]),o[20]||(o[20]=(0,l.createElementVNode)('span',{class:'config-hint'},'è®¾ä¸º0åˆ™ä¸ä½¿ç”¨å°æ€»ç»“',-1))])]),(0,l.createCommentVNode)(' æ“ä½œæŒ‰é’® '),(0,l.createElementVNode)('div',as,[o[22]||(o[22]=(0,l.createElementVNode)('div',{class:'section-title'},'ğŸ”§ æ“ä½œ',-1)),(0,l.createElementVNode)('div',ns,[(0,l.createElementVNode)('button',{class:'btn btn-primary',onClick:h,disabled:(0,l.unref)(t)},[(0,l.unref)(t)?((0,l.openBlock)(),(0,l.createElementBlock)('span',ls,'å¤„ç†ä¸­...')):((0,l.openBlock)(),(0,l.createElementBlock)('span',rs,'ğŸ”„ åˆ·æ–°æ•°æ®'))],8,os),(0,l.createElementVNode)('button',{class:'btn btn-secondary',onClick:b,disabled:(0,l.unref)(t)||!(0,l.unref)(c)},' ğŸ”€ é‡æ–°åˆ†æ®µ ',8,ss),(0,l.createElementVNode)('button',{class:'btn btn-danger',onClick:S,disabled:(0,l.unref)(t)},'ğŸ—‘ï¸ æ¸…ç©ºæ‰€æœ‰',8,cs),(0,l.unref)(c)?(0,l.createCommentVNode)('v-if',!0):((0,l.openBlock)(),(0,l.createElementBlock)('button',{key:0,class:'btn btn-danger-outline',onClick:N,disabled:(0,l.unref)(t)},' ğŸ—‘ï¸ å¼ºåˆ¶æ¸…ç©ºä¸–ç•Œä¹¦ ',8,is))])]),(0,l.createCommentVNode)(' é”™è¯¯æç¤º '),(0,l.unref)(a)?((0,l.openBlock)(),(0,l.createElementBlock)('div',us,'âš ï¸ '+(0,l.toDisplayString)((0,l.unref)(a)),1)):(0,l.createCommentVNode)('v-if',!0)])]))}}),ms=(0,M.A)(ds,[['__scopeId','data-v-71562640']]);function vs(){const e=(0,l.ref)(''),t=(0,l.ref)(''),a=(0,l.ref)([]),n=(0,l.ref)(0),o=(0,l.ref)(!1),r=(0,l.ref)(!1),s=(0,l.ref)(null),c=(0,l.ref)(''),i=(0,l.ref)([]),u=(0,l.ref)(''),d=(0,l.ref)('idle'),m=(0,l.ref)(null),v=(0,l.ref)(!1),p=(0,l.ref)('standard');let g=null,f=null,h=!1;const y=(0,l.computed)(()=>!!e.value),V=(0,l.computed)(()=>a.value.length>1),E=()=>(new Date).toLocaleTimeString('zh-CN',{hour:'2-digit',minute:'2-digit'}),b=e=>{if(!e||'string'!=typeof e)return'';const t=[...e.matchAll(/<gametxt>([\s\S]*?)<\/gametxt>/gi)];if(t.length>0){return t[t.length-1][1].trim().replace(/<!--[\s\S]*?-->/g,'').trim()}return e},S=e=>{if(!e||'string'!=typeof e)return null;const t=[...e.matchAll(/<UpdateVariable>([\s\S]*?)<\/UpdateVariable>/gi)];return t.length>0?t[t.length-1][1].trim():null},N=(e,t=['gametxt'])=>{const a={isValid:!0,hasGameText:/<gametxt>[\s\S]*?<\/gametxt>/i.test(e),hasUpdateVariable:/<UpdateVariable>[\s\S]*?<\/UpdateVariable>/i.test(e),hasHistoryRecord:/<å†å²è®°å½•>[\s\S]*?<\/å†å²è®°å½•>/i.test(e),missingTags:[]};return t.includes('gametxt')&&!a.hasGameText&&a.missingTags.push('gametxt'),t.includes('UpdateVariable')&&!a.hasUpdateVariable&&a.missingTags.push('UpdateVariable'),t.includes('å†å²è®°å½•')&&!a.hasHistoryRecord&&a.missingTags.push('å†å²è®°å½•'),a.isValid=0===a.missingTags.length,a};let k=null;const C=(e,t,a,n)=>{const o=new Set([...Object.keys(e||{}),...Object.keys(t||{})]);for(const l of o){const o=a?`${a}.${l}`:l,r=e?.[l],s=t?.[l];if(void 0===r&&void 0===s)continue;if(void 0===r&&void 0!==s){n.push({path:o,oldValue:void 0,newValue:s,comment:'æ–°å¢'});continue}if(void 0!==r&&void 0===s)continue;const c=typeof r;if(c===typeof s)if('object'===c&&null!==r&&null!==s){if(Array.isArray(r)||Array.isArray(s)){JSON.stringify(r)!==JSON.stringify(s)&&n.push({path:o,oldValue:r,newValue:s,comment:'æ•°ç»„å˜åŒ–'});continue}C(r,s,o,n)}else r!==s&&n.push({path:o,oldValue:r,newValue:s});else n.push({path:o,oldValue:r,newValue:s,comment:'ç±»å‹å˜åŒ–'})}},w=e=>{const t=[],a=e.deltaData;if(a&&'object'==typeof a&&Object.keys(a).length>0&&(console.log('[useAIInteraction] ä» delta_data æå–å˜é‡å˜åŒ–:',Object.keys(a)),console.log('[useAIInteraction] delta_data å†…å®¹:',JSON.stringify(a).substring(0,500)),M(a,'',t),t.length>0))return t;const n=e.displayData;return n&&'object'==typeof n&&Object.keys(n).length>0&&(console.log('[useAIInteraction] ä» display_data æå–å˜é‡å˜åŒ–:',Object.keys(n)),console.log('[useAIInteraction] display_data å†…å®¹:',JSON.stringify(n).substring(0,500)),I(n,'',t,e),t.length>0)?t:(console.log('[useAIInteraction] delta_data å’Œ display_data éƒ½æ²¡æœ‰å˜åŒ–ï¼Œå°è¯•å¿«ç…§å¯¹æ¯”...'),(e=>{const t=[];if(!k)return console.log('[useAIInteraction] æ²¡æœ‰æ›´æ–°å‰å¿«ç…§ï¼Œæ— æ³•å¯¹æ¯”æ£€æµ‹å˜åŒ–'),t;const a=e.statData;return a&&'object'==typeof a?(C(k,a,'',t),console.log('[useAIInteraction] é€šè¿‡å¯¹æ¯”æ£€æµ‹åˆ°',t.length,'ä¸ªå˜é‡å˜åŒ–'),t):(console.log('[useAIInteraction] å½“å‰æ•°æ®ä¸ºç©ºï¼Œæ— æ³•å¯¹æ¯”æ£€æµ‹å˜åŒ–'),t)})(e))},M=(e,t,a)=>{for(const n of Object.keys(e)){const o=e[n],l=t?`${t}.${n}`:n;if(o&&'object'==typeof o&&'new'in o)a.push({path:l,oldValue:o.old,newValue:o.new,comment:o.reason||o.comment});else if(o&&'object'==typeof o&&'newValue'in o)a.push({path:l,oldValue:o.oldValue,newValue:o.newValue,comment:o.reason||o.comment});else{if(null!=o&&'object'!=typeof o){const e=k?A(k,l):void 0;e!==o&&a.push({path:l,oldValue:e,newValue:o});continue}o&&'object'==typeof o&&!Array.isArray(o)&&M(o,l,a)}}},A=(e,t)=>t.split('.').reduce((e,t)=>e&&'object'==typeof e?e[t]:void 0,e),I=(e,t,a,n)=>{for(const o of Object.keys(e)){const l=e[o],r=t?`${t}.${o}`:o;if('string'==typeof l){const e=n.getVariable(r),t=k?A(k,r):void 0;a.push({path:r,oldValue:t,newValue:e,comment:l})}else l&&'object'==typeof l&&!Array.isArray(l)&&I(l,r,a,n)}},D=async e=>{try{const t=Ke();if(i.value=[],!t.isMvuAvailable)return void console.log('[useAIInteraction] MVUä¸å¯ç”¨ï¼Œè·³è¿‡å˜é‡æ›´æ–°');if(!t.mvuData){console.warn('[useAIInteraction] MVUæ•°æ®æœªåŠ è½½ï¼Œå°è¯•åˆå§‹åŒ–...');try{await t.initialize({type:'message',message_id:'latest'}),console.log('[useAIInteraction] MVUåˆå§‹åŒ–æˆåŠŸ')}catch(e){return void console.error('[useAIInteraction] MVUåˆå§‹åŒ–å¤±è´¥:',e)}}if(!S(e))return void console.log('[useAIInteraction] æœªå‘ç°å˜é‡æ›´æ–°æŒ‡ä»¤');console.log('[useAIInteraction] å‘ç°å˜é‡æ›´æ–°æŒ‡ä»¤ï¼Œå¼€å§‹è§£ææ‰§è¡Œ...'),(e=>{try{const t=e.statData;t&&'object'==typeof t?(k=JSON.parse(JSON.stringify(t)),console.log('[useAIInteraction] å·²ä¿å­˜å˜é‡æ›´æ–°å‰å¿«ç…§ï¼Œé¡¶çº§é”®:',Object.keys(k||{}))):k=null}catch(e){console.warn('[useAIInteraction] ä¿å­˜å˜é‡å¿«ç…§å¤±è´¥:',e),k=null}})(t);const a=await t.parseAndExecuteCommands(e);if(a.success){console.log('[useAIInteraction] å˜é‡æ›´æ–°æˆåŠŸï¼Œå…±æ‰§è¡Œ',a.results.length,'æ¡æŒ‡ä»¤'),await t.refresh();if(1===a.results.length&&'MVU_NATIVE'===a.results[0].command?.path){console.log('[useAIInteraction] ä½¿ç”¨ MVU åŸç”Ÿè§£æï¼Œä» MVU æ•°æ®æå–å˜é‡å˜åŒ–...');const e=w(t);i.value=e,console.log('[useAIInteraction] æå–åˆ°',e.length,'ä¸ªå˜é‡å˜åŒ–'),0===e.length&&(console.log('[useAIInteraction] è°ƒè¯•ä¿¡æ¯ - delta_data:',JSON.stringify(t.deltaData).substring(0,300)),console.log('[useAIInteraction] è°ƒè¯•ä¿¡æ¯ - display_data:',JSON.stringify(t.displayData).substring(0,300)),console.log('[useAIInteraction] è°ƒè¯•ä¿¡æ¯ - å¿«ç…§å­˜åœ¨:',!!k))}else a.results.forEach(e=>{e.success&&'MVU_NATIVE'!==e.command?.path&&i.value.push({path:e.command.path,oldValue:e.oldValue,newValue:e.newValue,comment:e.command.comment})});console.log('[useAIInteraction] æœ€ç»ˆå˜é‡å˜åŒ–æ•°:',i.value.length),k=null}else console.warn('[useAIInteraction] å˜é‡æ›´æ–°å¤±è´¥:',a.error),k=null}catch(e){console.error('[useAIInteraction] è§£æå˜é‡æ›´æ–°å¤±è´¥:',e),k=null}},B=async e=>{try{if(await el.processAIResponse(e)){const e=el.getStatistics();console.log('[useAIInteraction] ä¸Šä¸‹æ–‡å·²æ›´æ–°:',{å†å²è®°å½•æ•°:e.recordCount,å†å²æ­£æ–‡æ•°:e.textCount,åˆ†æ®µæ­£æ–‡æ•°:e.segmentCount,å°æ€»ç»“æ•°:e.smallSummaryCount,å¤§æ€»ç»“æ•°:e.largeSummaryCount})}}catch(e){console.error('[useAIInteraction] ä¸Šä¸‹æ–‡ç®¡ç†å¤„ç†å¤±è´¥:',e)}},x=async()=>{try{const e=rl.getAutoSaveConfig();if(!e.enabled||!e.saveOnAIResponse)return void console.log('[useAIInteraction] è‡ªåŠ¨å­˜æ¡£æœªå¯ç”¨ï¼Œè·³è¿‡');let t;d.value='saving',console.log('[useAIInteraction] å¼€å§‹æ‰§è¡Œè‡ªåŠ¨å­˜æ¡£...'),'function'==typeof window.getLastMessageId&&(t=window.getLastMessageId());const a=await rl.autoSaveOnAIResponse(t);a?(d.value='success',m.value=a.name,console.log('[useAIInteraction] è‡ªåŠ¨å­˜æ¡£æˆåŠŸ:',a.name),'undefined'!=typeof toastr&&toastr.info(`å·²è‡ªåŠ¨å­˜æ¡£: ${a.name}`,'è‡ªåŠ¨å­˜æ¡£',{timeOut:2e3})):d.value='idle'}catch(e){d.value='error',console.error('[useAIInteraction] è‡ªåŠ¨å­˜æ¡£å¤±è´¥:',e)}},T=async e=>{let t=[],a=!1;try{if(console.log('[useAIInteraction] ä¿å­˜AIå›å¤åˆ°é…’é¦†èŠå¤©è®°å½•ï¼ˆåŒå±‚åŒ–æ¨¡å¼ + é”™è¯¯æ¢å¤ï¼‰'),'function'!=typeof window.TavernHelper?.setChatMessages)return console.warn('[useAIInteraction] TavernHelperä¸å¯ç”¨'),!1;try{const e='function'==typeof window.getLastMessageId?window.getLastMessageId()??-1:-1;e>=0&&(t=await window.TavernHelper.getChatMessages(`0-${e}`),t&&t.length>0&&(t=JSON.parse(JSON.stringify(t)),a=!0,console.log('[useAIInteraction] å·²åˆ›å»ºæ¶ˆæ¯å¿«ç…§ï¼Œå…±',t.length,'æ¡æ¶ˆæ¯')))}catch(e){console.warn('[useAIInteraction] è·å–æ¶ˆæ¯å¿«ç…§å¤±è´¥ï¼Œç»§ç»­æ‰§è¡Œï¼ˆæ— å›æ»šèƒ½åŠ›ï¼‰:',e)}const n=await window.TavernHelper.getChatMessages('0');if(!n||0===n.length)throw new Error('æ¶ˆæ¯0ä¸å­˜åœ¨ï¼Œæ— æ³•ä¿å­˜AIå›å¤');const o=n[0];return o.message=e,await window.TavernHelper.setChatMessages([o],{refresh:'none'}),console.log('[useAIInteraction] AIå›å¤å·²ä¿å­˜åˆ°æ¶ˆæ¯0'),await L(),console.log('[useAIInteraction] åŒå±‚åŒ–ä¿å­˜æˆåŠŸ'),!0}catch(e){if(console.error('[useAIInteraction] ä¿å­˜AIå›å¤å¤±è´¥ï¼Œå°è¯•å›æ»š:',e),a&&t.length>0)try{await window.TavernHelper.setChatMessages(t,{refresh:'none'}),console.log('[useAIInteraction] å›æ»šæˆåŠŸï¼Œå·²æ¢å¤åŸå§‹æ¶ˆæ¯'),'undefined'!=typeof toastr&&toastr.warning('ä¿å­˜å¤±è´¥ï¼Œå·²å›æ»šåˆ°åŸå§‹çŠ¶æ€','åŒå±‚åŒ–é”™è¯¯',{timeOut:3e3})}catch(e){console.error('[useAIInteraction] å›æ»šå¤±è´¥:',e),'undefined'!=typeof toastr&&toastr.error('ä¿å­˜å¤±è´¥ä¸”æ— æ³•å›æ»šï¼Œæ¶ˆæ¯å¯èƒ½å·²æŸå','ä¸¥é‡é”™è¯¯',{timeOut:5e3})}return!1}},L=async()=>{let e=0;for(;e<3;)try{if('function'!=typeof window.getLastMessageId)return!0;const e=window.getLastMessageId?.()??-1;if(e<=0)return console.log('[useAIInteraction] æ— éœ€æ¸…ç†å¤šä½™æ¶ˆæ¯ï¼Œå½“å‰åªæœ‰æ¶ˆæ¯0'),!0;if('function'==typeof window.deleteChatMessages){const t=Array.from({length:e},(_,e)=>e+1);return console.log('[useAIInteraction] åˆ é™¤å¤šä½™æ¶ˆæ¯:',t),await window.deleteChatMessages(t,{refresh:'none'}),console.log('[useAIInteraction] å¤šä½™æ¶ˆæ¯å·²åˆ é™¤ï¼Œä¿æŒåŒå±‚åŒ–'),!0}return!0}catch(t){if(e++,console.warn(`[useAIInteraction] æ¸…ç†å¤šä½™æ¶ˆæ¯å¤±è´¥ (å°è¯• ${e}/3):`,t),e>=3)return console.error('[useAIInteraction] æ¸…ç†å¤šä½™æ¶ˆæ¯æœ€ç»ˆå¤±è´¥ï¼Œæ¶ˆæ¯å±‚çº§å¯èƒ½æ··ä¹±'),'undefined'!=typeof toastr&&toastr.warning('æ¶ˆæ¯æ¸…ç†å¤±è´¥ï¼Œå±‚çº§å¯èƒ½æ··ä¹±','åŒå±‚åŒ–è­¦å‘Š',{timeOut:3e3}),!1;await new Promise(t=>setTimeout(t,100*e))}return!1},O=async()=>{try{if('function'!=typeof window.TavernHelper?.getChatMessages)return!1;const e=await window.TavernHelper.getChatMessages();if(e&&e.length>0)for(let t=0;t<e.length;t++)if(!e[t].is_user)return e.splice(t,1),await window.TavernHelper.setChatMessages(e,{refresh:'none'}),!0;return!1}catch(e){return console.error('[useAIInteraction] åˆ é™¤é…’é¦†æ¶ˆæ¯å¤±è´¥:',e),!1}},R=async()=>{try{if('function'!=typeof window.getChatMessages)return console.warn('[useAIInteraction] getChatMessageså‡½æ•°ä¸å¯ç”¨'),!1;const o=window.getLastMessageId?.()??-1;if(o<0)return console.log('[useAIInteraction] é…’é¦†èŠå¤©è®°å½•ä¸ºç©º'),!1;const l=await window.getChatMessages(`0-${o}`,{role:'all',hide_state:'unhidden',include_swipes:!0});for(let o=l.length-1;o>=0;o--){const r=l[o];if('user'!==r.role){const o=r.swipes?.[r.swipe_id||0]||r.message||'',l=b(o);if(l)return e.value=l,a.value=r.swipes?r.swipes.map(e=>b(e)):[l],n.value=r.swipe_id||0,c.value=E(),t.value=o,console.log('[useAIInteraction] å·²åŠ è½½æœ€æ–°å†…å®¹ï¼Œå¹¶æ¢å¤lastAIResponseï¼Œé•¿åº¦:',o.length),!0}}return!1}catch(e){return console.error('[useAIInteraction] ä»é…’é¦†åŠ è½½å†…å®¹å¤±è´¥:',e),!1}},U=e=>{const a=Ke();let n,o={};try{if('undefined'!=typeof window&&window.Mvu){const e=window.Mvu;if('function'==typeof e.getMvuData){const t=e.getMvuData({type:'message',message_id:'latest'});t&&t.stat_data?(o=t.stat_data,console.log('[useAIInteraction] ä» MVU API è·å–åˆ°å˜é‡æ•°æ®ï¼Œé”®æ•°é‡:',Object.keys(o).length)):console.warn('[useAIInteraction] MVU API è¿”å›æ•°æ®ä¸ºç©º')}}0===Object.keys(o).length&&(a.mvuData?.stat_data?(o=a.mvuData.stat_data,console.log('[useAIInteraction] ä» store ç¼“å­˜è·å–å˜é‡æ•°æ®ï¼Œé”®æ•°é‡:',Object.keys(o).length)):console.warn('[useAIInteraction] store ç¼“å­˜ä¸­ä¹Ÿæ²¡æœ‰å˜é‡æ•°æ®')),0===Object.keys(o).length&&a.isMvuAvailable&&(console.log('[useAIInteraction] å°è¯•å¼ºåˆ¶åˆ·æ–° store...'),a.refresh().catch(e=>{console.error('[useAIInteraction] åˆ·æ–° store å¤±è´¥:',e)}),a.mvuData?.stat_data&&(o=a.mvuData.stat_data))}catch(e){console.error('[useAIInteraction] è·å– MVU æ•°æ®å¤±è´¥:',e)}try{n=JSON.stringify(o,null,2)}catch(e){console.error('[useAIInteraction] åºåˆ—åŒ–å˜é‡æ•°æ®å¤±è´¥:',e),n='{}'}let l='';l+=`<status_current_variables>\n${n}\n</status_current_variables>\n\n`,t.value&&(l+=`<last_ai_response>\n${t.value}\n</last_ai_response>\n\n`,console.log('[useAIInteraction] å·²æ³¨å…¥ä¸Šä¸€æ¬¡AIå›å¤ï¼Œé•¿åº¦:',t.value.length)),l+=e;const r=Object.keys(o);return console.log('[useAIInteraction] å·²æ„å»ºåŒ…å«å˜é‡æ•°æ®å’Œä¸Šä¸‹æ–‡çš„prompt:',{å˜é‡æ•°æ®å¤§å°:n.length+'å­—ç¬¦',é¡¶çº§é”®:r,MCé”®:o.MC?Object.keys(o.MC):'æ— MCå¯¹è±¡',ç”¨æˆ·è¾“å…¥é•¿åº¦:e.length+'å­—ç¬¦',ä¸Šä¸€æ¬¡AIå›å¤é•¿åº¦:t.value?t.value.length+'å­—ç¬¦':'æ— '}),l},j=()=>{try{return h?(console.log('[useAIInteraction] ç›‘å¬å™¨å·²å­˜åœ¨ï¼Œè·³è¿‡é‡å¤ç»‘å®š'),!0):(console.log('[useAIInteraction] è®¾ç½®AIäº‹ä»¶ç›‘å¬å™¨'),'function'!=typeof window.eventOn?(console.warn('[useAIInteraction] eventOnå‡½æ•°ä¸å¯ç”¨'),!1):(P(),g=(t,a)=>(t=>{if(!t)return;console.log('[useAIInteraction] æ”¶åˆ°æµå¼æ–‡æœ¬ï¼Œé•¿åº¦:',t.length);const a=b(t);a&&(r.value=!0,o.value=!1,e.value=a)})(t),f=(l,i)=>(async(l,i)=>{if(!l)return console.warn('[useAIInteraction] æ”¶åˆ°ç©ºçš„AIå›å¤'),o.value=!1,void(r.value=!1);console.log('[useAIInteraction] AIç”Ÿæˆç»“æŸï¼ŒID:',i),console.log('[useAIInteraction] AIå›å¤é•¿åº¦:',l.length);try{s.value=null;const i=N(l);i.isValid||(console.warn('[useAIInteraction] AIå“åº”æ ¼å¼ä¸å®Œæ•´:',i.missingTags),'undefined'!=typeof toastr&&toastr.warning(`AIå“åº”ç¼ºå°‘: ${i.missingTags.join(', ')}`,'æ ¼å¼è­¦å‘Š',{timeOut:3e3})),t.value=l,console.log('[useAIInteraction] å·²ä¿å­˜AIå›å¤ç”¨äºä¸‹æ¬¡ä¸Šä¸‹æ–‡æ³¨å…¥');const u=i.hasGameText?b(l):'';u?(window.__currentSwipeGeneration?(a.value.push(u),n.value=a.value.length-1,e.value=u,delete window.__currentSwipeGeneration,console.log('[useAIInteraction] æ–°swipeå·²æ·»åŠ ')):(e.value=u,a.value=[u],n.value=0,console.log('[useAIInteraction] å†…å®¹å·²æ›´æ–°')),c.value=E()):i.hasGameText||console.warn('[useAIInteraction] æœªæå–åˆ°æœ‰æ•ˆçš„æ˜¾ç¤ºæ–‡æœ¬ï¼ˆç¼ºå°‘gametxtæ ‡ç­¾ï¼‰'),i.hasUpdateVariable&&await D(l),await B(l),await T(l),await x(),o.value=!1,r.value=!1}catch(e){console.error('[useAIInteraction] å¤„ç†AIå›å¤å¤±è´¥:',e),s.value=e instanceof Error?e.message:'å¤„ç†AIå›å¤å¤±è´¥',o.value=!1,r.value=!1}})(l,i),void 0!==window.iframe_events?(window.eventOn(window.iframe_events.STREAM_TOKEN_RECEIVED_FULLY,g),window.eventOn(window.iframe_events.GENERATION_ENDED,f)):(window.eventOn('js_stream_token_received_fully',g),window.eventOn('js_generation_ended',f)),h=!0,console.log('[useAIInteraction] ç›‘å¬å™¨è®¾ç½®æˆåŠŸ'),!0))}catch(e){return console.error('[useAIInteraction] è®¾ç½®AIç›‘å¬å™¨å¤±è´¥:',e),!1}},P=()=>{try{if(!h&&!g&&!f)return;console.log('[useAIInteraction] æ¸…ç†AIäº‹ä»¶ç›‘å¬å™¨'),'function'==typeof window.eventRemoveListener&&(g&&(void 0!==window.iframe_events?window.eventRemoveListener(window.iframe_events.STREAM_TOKEN_RECEIVED_FULLY,g):window.eventRemoveListener('js_stream_token_received_fully',g)),f&&(void 0!==window.iframe_events?window.eventRemoveListener(window.iframe_events.GENERATION_ENDED,f):window.eventRemoveListener('js_generation_ended',f))),g=null,f=null,h=!1}catch(e){console.error('[useAIInteraction] æ¸…ç†AIç›‘å¬å™¨å¤±è´¥:',e)}},F=()=>e.value||0!==a.value.length||t.value?{currentContent:e.value,swipes:[...a.value],currentSwipeIndex:n.value,lastUserInput:u.value,lastUpdateTime:c.value,lastAIResponse:t.value}:null,H=o=>{console.log('[useAIInteraction] æ¢å¤AIå†…å®¹æ•°æ®'),e.value=o.currentContent||'',a.value=o.swipes||[],n.value=o.currentSwipeIndex||0,u.value=o.lastUserInput||'',c.value=o.lastUpdateTime||'',t.value=o.lastAIResponse||'',console.log('[useAIInteraction] AIå†…å®¹å·²æ¢å¤:',{contentLength:e.value.length,swipesCount:a.value.length,currentIndex:n.value,lastAIResponseLength:t.value.length})};(0,l.onMounted)(async()=>{console.log('[useAIInteraction] Composableå·²æŒ‚è½½'),j(),rl.setAIContentDataProvider(F),rl.setAIContentDataRestorer(H),await el.initialize(),await W(),await R()});const W=async(e=3e3,t=100)=>{const a=Ke(),n=Date.now();for(;Date.now()-n<e;){if(a.isMvuAvailable&&a.mvuData?.stat_data)return void console.log('[useAIInteraction] MVU Store å·²å°±ç»ª');if(a.isLoading)await new Promise(e=>setTimeout(e,t));else{if(!a.isLoading&&!a.mvuData){console.log('[useAIInteraction] è§¦å‘ MVU Store åˆå§‹åŒ–...');try{await a.initialize()}catch(e){console.warn('[useAIInteraction] MVU Store åˆå§‹åŒ–å¤±è´¥:',e)}}await new Promise(e=>setTimeout(e,t))}}console.warn('[useAIInteraction] ç­‰å¾… MVU Store è¶…æ—¶ï¼Œç»§ç»­æ‰§è¡Œ')};return(0,l.onUnmounted)(()=>{console.log('[useAIInteraction] Composableæ­£åœ¨å¸è½½'),P()}),{currentContent:e,swipes:a,currentSwipeIndex:n,isProcessing:o,isStreaming:r,error:s,lastUpdateTime:c,variableChanges:i,lastAIResponse:t,hasContent:y,hasMultipleSwipes:V,sendMessageToAI:async t=>{if(!t.trim())return s.value='æ¶ˆæ¯ä¸èƒ½ä¸ºç©º',!1;try{if(console.log('[useAIInteraction] å‘é€æ¶ˆæ¯ç»™AIï¼ˆåŒå±‚åŒ–æ¨¡å¼ + ä¸»åŠ¨å˜é‡æ³¨å…¥ï¼‰:',t),u.value=t.trim(),e.value='',a.value=[],n.value=0,i.value=[],'function'!=typeof window.generate)throw new Error('generateå‡½æ•°ä¸å¯ç”¨ï¼Œè¯·ç¡®ä¿åœ¨é…’é¦†ç¯å¢ƒä¸­è¿è¡Œ');o.value=!0,s.value=null;const l=U(t.trim()),r=Ye().streamingEnabled;return console.log('[useAIInteraction] æµå¼ä¼ è¾“æ¨¡å¼:',r?'å¼€å¯':'å…³é—­'),await window.generate({user_input:l,should_stream:r,max_chat_history:0}),!0}catch(e){return console.error('[useAIInteraction] å‘é€æ¶ˆæ¯å¤±è´¥:',e),s.value=e instanceof Error?e.message:'å‘é€æ¶ˆæ¯å¤±è´¥',o.value=!1,!1}},regenerateAIResponse:async()=>{try{if(console.log('[useAIInteraction] é‡æ–°ç”ŸæˆAIå›å¤ï¼ˆä¸»åŠ¨å˜é‡æ³¨å…¥ï¼‰'),!u.value)return console.warn('[useAIInteraction] æ²¡æœ‰å¯é‡æ–°ç”Ÿæˆçš„ç”¨æˆ·è¾“å…¥'),!1;if('function'!=typeof window.generate)throw new Error('generateå‡½æ•°ä¸å¯ç”¨');await O(),e.value='',a.value=[],n.value=0,i.value=[],o.value=!0,s.value=null;const t=U(u.value),l=Ye().streamingEnabled;return await window.generate({user_input:t,should_stream:l,max_chat_history:0}),!0}catch(e){return console.error('[useAIInteraction] é‡æ–°ç”Ÿæˆå¤±è´¥:',e),s.value=e instanceof Error?e.message:'é‡æ–°ç”Ÿæˆå¤±è´¥',o.value=!1,!1}},generateSwipe:async()=>{try{if(console.log('[useAIInteraction] ç”Ÿæˆæ›´å¤šå›å¤ï¼ˆä¸»åŠ¨å˜é‡æ³¨å…¥ï¼‰'),!u.value)return console.warn('[useAIInteraction] æ²¡æœ‰å¯ç”Ÿæˆswipeçš„ç”¨æˆ·è¾“å…¥'),!1;if('function'!=typeof window.generate)throw new Error('generateå‡½æ•°ä¸å¯ç”¨');await O(),window.__currentSwipeGeneration=!0,o.value=!0,s.value=null;const e=U(u.value),t=Ye().streamingEnabled;return await window.generate({user_input:e,should_stream:t,max_chat_history:0}),!0}catch(e){return console.error('[useAIInteraction] ç”Ÿæˆswipeå¤±è´¥:',e),s.value=e instanceof Error?e.message:'ç”Ÿæˆswipeå¤±è´¥',o.value=!1,delete window.__currentSwipeGeneration,!1}},switchSwipe:t=>{if(a.value.length<=1)return;let o=n.value;o='prev'===t?o>0?o-1:a.value.length-1:o<a.value.length-1?o+1:0,n.value=o,e.value=a.value[o]},clearContent:async()=>{if(e.value='',a.value=[],n.value=0,i.value=[],u.value='',t.value='',s.value=null,c.value='','function'==typeof window.deleteChatMessages)try{const e=window.getLastMessageId?.()??-1;if(e>=0){const t=Array.from({length:e+1},(_,e)=>e);await window.deleteChatMessages(t,{refresh:'none'})}}catch(e){console.error('[useAIInteraction] æ¸…é™¤é…’é¦†èŠå¤©è®°å½•å¤±è´¥:',e)}},loadLatestFromTavern:R,setupAIListeners:j,cleanupAIListeners:P,extractGameText:b,extractUpdateVariableContent:S,buildPromptWithVariables:U,validateResponseFormat:N,contextManagerService:el,autoSaveStatus:d,lastAutoSaveName:m,performAutoSave:x,triggerManualAutoSave:async()=>{try{let e;d.value='saving','function'==typeof window.getLastMessageId&&(e=window.getLastMessageId());const t=await rl.createAutoSave(`[æ‰‹åŠ¨è§¦å‘] ${(new Date).toLocaleTimeString('zh-CN')}`,'auto',e);return t?(d.value='success',m.value=t.name,!0):(d.value='error',!1)}catch(e){return d.value='error',console.error('[useAIInteraction] æ‰‹åŠ¨è§¦å‘è‡ªåŠ¨å­˜æ¡£å¤±è´¥:',e),!1}},getAIContentData:F,restoreAIContentData:H,isMvuInterceptorEnabled:v,currentFilterPreset:p,initializeMvuInterceptor:()=>(console.log('[useAIInteraction] MVUæ‹¦æˆªå™¨å·²ç¦ç”¨ï¼Œè·³è¿‡åˆå§‹åŒ–'),!1),toggleMvuInterceptor:()=>(console.log('[useAIInteraction] MVUæ‹¦æˆªå™¨å·²ç¦ç”¨'),!1),enableMvuInterceptor:()=>{console.log('[useAIInteraction] MVUæ‹¦æˆªå™¨å·²ç¦ç”¨')},disableMvuInterceptor:()=>{console.log('[useAIInteraction] MVUæ‹¦æˆªå™¨å·²ç¦ç”¨')},setFilterPreset:e=>{console.log('[useAIInteraction] MVUæ‹¦æˆªå™¨å·²ç¦ç”¨ï¼Œæ— æ³•è®¾ç½®é¢„è®¾:',e)},getMvuInterceptorStats:()=>null,getAverageCompressionRatio:()=>0,mvuInterceptorService:null}}const ps={class:'main-area'},gs={class:'modal help-modal'},fs={class:'modal-header'},hs={class:'modal-footer'},ys={class:'modal save-manager-modal'},Vs={class:'modal context-manager-modal'},Es={class:'modal history-text-modal'},bs={class:'modal roster-modal'},Ss={class:'modal document-modal'},Ns={class:'modal changelog-modal'},ks={class:'modal variable-manager-modal'},Cs=(0,l.defineComponent)({__name:'GameLayout',setup(e){const{currentContent:t,isProcessing:a,isStreaming:n,error:o,lastUpdateTime:r,variableChanges:s,sendMessageToAI:c}=vs(),{quickSave:i,quickLoad:u}=sl(),{statData:d,isMvuAvailable:m,getVariable:v,refresh:p,updateVersion:g,onUpdate:f,forceRefresh:h}=function(e){const t=Ke(),a=(0,l.ref)(0),n=(0,l.ref)('pending'),o=(0,l.ref)(null);let r=null,s=null,c=0;const i=async()=>{try{return n.value='initializing',o.value=null,await t.initialize(e),t.isMvuAvailable&&t.mvuData?(n.value='success',console.log('[useMVU] MVUåˆå§‹åŒ–æˆåŠŸ'),!0):t.isMvuAvailable?t.mvuData?(n.value='success',!0):(n.value='failed',o.value='MVUæ•°æ®ä¸ºç©º',console.warn('[useMVU] MVUæ•°æ®ä¸ºç©º'),!1):(n.value='failed',o.value='MVUæ¡†æ¶ä¸å¯ç”¨',console.warn('[useMVU] MVUæ¡†æ¶ä¸å¯ç”¨'),!1)}catch(e){return n.value='failed',o.value=e instanceof Error?e.message:'åˆå§‹åŒ–å¤±è´¥',console.error('[useMVU] MVUåˆå§‹åŒ–å¤±è´¥:',e),!1}},u=()=>{if(c>=3)return console.warn('[useMVU] å·²è¾¾æœ€å¤§é‡è¯•æ¬¡æ•°ï¼Œåœæ­¢é‡è¯•'),void(n.value='failed');c++,n.value='retrying';const e=1e3*c;console.log(`[useMVU] å°†åœ¨ ${e}ms åè¿›è¡Œç¬¬ ${c} æ¬¡é‡è¯•...`),s=setTimeout(async()=>{!await i()&&c<3&&u()},e)};return(0,l.onMounted)(async()=>{console.log('[useMVU] onMounted, isMvuAvailable:',t.isMvuAvailable),t.isMvuAvailable&&t.mvuData?(console.log('[useMVU] Storeå·²åˆå§‹åŒ–ï¼Œè·³è¿‡åˆå§‹åŒ–'),n.value='success'):await i()||u(),r=t.onUpdateEnd(()=>{console.log('[useMVU] æ”¶åˆ°å˜é‡æ›´æ–°ç»“æŸäº‹ä»¶ï¼Œè§¦å‘åˆ·æ–°'),a.value++,'failed'!==n.value&&'retrying'!==n.value||(n.value='success',o.value=null,console.log('[useMVU] MVUå·²å°±ç»ªï¼ˆé€šè¿‡æ›´æ–°äº‹ä»¶ç¡®è®¤ï¼‰'))})}),(0,l.onUnmounted)(()=>{r&&(r(),r=null),s&&(clearTimeout(s),s=null)}),{mvuData:(0,l.computed)(()=>(a.value,t.mvuData)),statData:(0,l.computed)(()=>(a.value,t.statData)),displayData:(0,l.computed)(()=>(a.value,t.displayData)),deltaData:(0,l.computed)(()=>(a.value,t.deltaData)),isLoading:(0,l.computed)(()=>t.isLoading),error:(0,l.computed)(()=>t.error),isMvuAvailable:(0,l.computed)(()=>t.isMvuAvailable),updateVersion:a,initState:n,initError:o,refresh:t.refresh,forceRefresh:()=>(a.value++,t.refresh()),getVariable:t.getVariable,setVariable:t.setVariable,setVariables:t.setVariables,updateVariable:t.updateVariable,clearError:t.clearError,onUpdate:e=>t.onUpdateEnd(e),retryInitialize:async()=>(s&&(clearTimeout(s),s=null),c=0,await i())}}(),y=(0,l.computed)(()=>{g.value;return v('MC.ç³»ç»Ÿ.å½“å‰æ—¶é—´.æ—¥æœŸ','')}),V=(0,l.computed)(()=>{g.value;return v('MC.ç³»ç»Ÿ.å½“å‰æ—¶é—´.æ—¶é—´','')}),E=(0,l.computed)(()=>{g.value;return v('MC.ç³»ç»Ÿ.å½“å‰åœ°ç‚¹','')}),b=(0,l.computed)(()=>{g.value;return v('MC.ç©å®¶.å§“å','')}),S=(0,l.computed)(()=>{g.value;return v('MC.ç©å®¶.èŒä½','')}),N=(0,l.computed)(()=>{g.value;return v('MC.ç©å®¶.éƒ¨é—¨','')});(0,l.watch)([d,g],([e,t])=>{e&&console.log('[GameLayout] MVUæ•°æ®æ›´æ–° (v'+t+'):',{æ—¥æœŸ:v('MC.ç³»ç»Ÿ.å½“å‰æ—¶é—´.æ—¥æœŸ',''),æ—¶é—´:v('MC.ç³»ç»Ÿ.å½“å‰æ—¶é—´.æ—¶é—´',''),åœ°ç‚¹:v('MC.ç³»ç»Ÿ.å½“å‰åœ°ç‚¹',''),ç©å®¶å§“å:v('MC.ç©å®¶.å§“å',''),ç©å®¶èŒä½:v('MC.ç©å®¶.èŒä½',''),ç©å®¶éƒ¨é—¨:v('MC.ç©å®¶.éƒ¨é—¨','')})},{deep:!1,immediate:!1});const k=(0,l.ref)(!1),C=(0,l.ref)(!1),w=(0,l.ref)(!1),M=(0,l.ref)('connected'),I=(0,l.ref)(!1),D=(0,l.ref)('workplace'),B=(0,l.ref)(!1),x=(0,l.ref)(!1),T=(0,l.ref)(!1),L=(0,l.ref)(!1),O=(0,l.ref)(!1),R=(0,l.ref)(!1),U=(0,l.ref)(!1),j=(0,l.ref)(!1),P=(0,l.ref)(!1),F=(0,l.ref)(!1),H=()=>{document.fullscreenElement?(document.exitFullscreen?.(),k.value=!1):(document.documentElement.requestFullscreen?.(),k.value=!0)},W=()=>{k.value=!!document.fullscreenElement},G=e=>{'handbook'!==e?'personnel'!==e?(D.value=e,console.log('[GameLayout] åˆ‡æ¢åˆ°è§†å›¾:',e)):R.value=!0:U.value=!0},J=async e=>{console.log('[GameLayout] å‘é€æ¶ˆæ¯ç»™AI:',e);try{await c(e)}catch(e){console.error('[GameLayout] AIäº¤äº’é”™è¯¯:',e),'undefined'!=typeof toastr&&toastr.error('å‘é€æ¶ˆæ¯å¤±è´¥ï¼Œè¯·é‡è¯•')}},K=()=>{console.log('[GameLayout] æ¸…é™¤AIé”™è¯¯')},Y=()=>{F.value=!F.value,F.value?document.documentElement.classList.add('dark-theme'):document.documentElement.classList.remove('dark-theme'),console.log('[GameLayout] ä¸»é¢˜åˆ‡æ¢:',F.value?'æ·±è‰²':'æµ…è‰²')},q=e=>{console.log('[GameLayout] å­˜æ¡£å·²åŠ è½½:',e),T.value=!1,'undefined'!=typeof toastr&&toastr.success('å­˜æ¡£å·²åŠ è½½')},X=e=>{console.log('[GameLayout] å­˜æ¡£å·²åˆ›å»º:',e),'undefined'!=typeof toastr&&toastr.success('å­˜æ¡£å·²åˆ›å»º')},Q=(e,t)=>{console.log('[GameLayout] å˜é‡å·²æ›´æ–°:',e,t),h(),'undefined'!=typeof toastr&&toastr.success(`å˜é‡ ${e} å·²æ›´æ–°`)},Z=()=>{w.value=window.innerWidth<=768,w.value||(C.value=!1)},ee=()=>{Z()};return(0,l.onMounted)(()=>{console.log('[GameLayout] MCliteå¸ƒå±€å·²åŠ è½½'),document.addEventListener('fullscreenchange',W),window.addEventListener('resize',ee),Z(),console.log('[GameLayout] MVUå¯ç”¨çŠ¶æ€:',m.value)}),(0,l.onUnmounted)(()=>{document.removeEventListener('fullscreenchange',W),window.removeEventListener('resize',ee)}),(e,c)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{class:(0,l.normalizeClass)(['game-layout',{'is-fullscreen':k.value,'sidebar-open':C.value}])},[(0,l.createCommentVNode)(' é¡¶éƒ¨çŠ¶æ€æ  '),(0,l.createVNode)(A,{'connection-status':M.value,'is-fullscreen':k.value,'is-dark-theme':F.value,'game-date':y.value,'game-period':V.value,'game-location':E.value,'player-name':b.value,'player-position':S.value,'player-department':N.value,onToggleFullscreen:H,onToggleTheme:Y},null,8,['connection-status','is-fullscreen','is-dark-theme','game-date','game-period','game-location','player-name','player-position','player-department']),(0,l.createCommentVNode)(' ä¸­é—´åŒºåŸŸï¼šä¸»å†…å®¹ + å³ä¾§å¯¼èˆª '),(0,l.createElementVNode)('div',ps,[(0,l.createCommentVNode)(' ä¸»å†…å®¹åŒºï¼ˆæ¸¸æˆæ–‡æœ¬æ˜¾ç¤ºåŒºåŸŸï¼‰ '),(0,l.createVNode)(ie,{ref:'mainContentRef','current-content':(0,l.unref)(t),'is-processing':(0,l.unref)(a),'is-streaming':(0,l.unref)(n),'variable-changes':(0,l.unref)(s),'last-update-time':(0,l.unref)(r)},null,8,['current-content','is-processing','is-streaming','variable-changes','last-update-time']),(0,l.createCommentVNode)(' å³ä¾§å¯¼èˆªæ  '),(0,l.createVNode)(St,{ref:'sidebarRef','active-menu':D.value,collapsed:I.value,'mobile-visible':C.value,onMenuChange:G,'onUpdate:collapsed':c[0]||(c[0]=e=>I.value=e),onOpenHelp:c[1]||(c[1]=e=>B.value=!0),onOpenAiFilter:c[2]||(c[2]=e=>x.value=!0),onOpenSaveManager:c[3]||(c[3]=e=>T.value=!0),onOpenContextManager:c[4]||(c[4]=e=>L.value=!0),onOpenHistoryText:c[5]||(c[5]=e=>O.value=!0),onOpenChangelog:c[6]||(c[6]=e=>j.value=!0),onOpenVariableManager:c[7]||(c[7]=e=>P.value=!0),onCloseMobile:c[8]||(c[8]=e=>C.value=!1)},null,8,['active-menu','collapsed','mobile-visible']),(0,l.createCommentVNode)(' ç§»åŠ¨ç«¯ä¾§è¾¹æ é®ç½© '),C.value&&w.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'sidebar-overlay',onClick:c[9]||(c[9]=e=>C.value=!1)})):(0,l.createCommentVNode)('v-if',!0)]),(0,l.createCommentVNode)(' ç§»åŠ¨ç«¯æµ®åŠ¨èœå•æŒ‰é’® '),w.value&&!C.value?((0,l.openBlock)(),(0,l.createElementBlock)('button',{key:0,class:'mobile-menu-fab',onClick:c[10]||(c[10]=e=>C.value=!0),title:'æ‰“å¼€èœå•'},[...c[28]||(c[28]=[(0,l.createElementVNode)('span',{class:'fab-icon'},'â˜°',-1)])])):(0,l.createCommentVNode)('v-if',!0),(0,l.createCommentVNode)(' åº•éƒ¨è¾“å…¥æ  '),(0,l.createVNode)(We,{ref:'bottomBarRef','is-loading':(0,l.unref)(a),error:(0,l.unref)(o),onSend:J,onClearError:K},null,8,['is-loading','error']),(0,l.createCommentVNode)(' AIä¸Šä¸‹æ–‡è¿‡æ»¤æµ‹è¯•é¢æ¿ï¼ˆå·²ç¦ç”¨ï¼‰\n    <Teleport to="body">\n      <div v-if="showAIFilterPanel" class="modal-overlay fullscreen-modal" @click.self="showAIFilterPanel = false">\n        <div class="modal ai-filter-modal">\n          <AIContextFilterPanel @close="showAIFilterPanel = false" />\n        </div>\n      </div>\n    </Teleport>\n    '),(0,l.createCommentVNode)(' å¸®åŠ©å¼¹çª— '),((0,l.openBlock)(),(0,l.createBlock)(l.Teleport,{to:'body'},[B.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'modal-overlay fullscreen-modal help-overlay',onClick:c[13]||(c[13]=(0,l.withModifiers)(e=>B.value=!1,['self']))},[(0,l.createElementVNode)('div',gs,[(0,l.createElementVNode)('div',fs,[c[29]||(c[29]=(0,l.createElementVNode)('h3',null,'â“ å¸®åŠ©è¯´æ˜',-1)),(0,l.createElementVNode)('button',{class:'btn-close',onClick:c[11]||(c[11]=e=>B.value=!1)},'âœ•')]),c[30]||(c[30]=(0,l.createElementVNode)('div',{class:'modal-body'},[(0,l.createElementVNode)('div',{class:'help-section'},[(0,l.createElementVNode)('h4',null,'ğŸ“ å¦‚ä½•å¼€æ–°æ¡£ï¼Ÿ'),(0,l.createElementVNode)('ol',{class:'help-steps'},[(0,l.createElementVNode)('li',null,[(0,l.createTextVNode)('æ‰“å¼€'),(0,l.createElementVNode)('strong',null,'ä¸Šä¸‹æ–‡é¢æ¿'),(0,l.createTextVNode)('ï¼Œç‚¹å‡»"æ¸…ç©ºæ‰€æœ‰"æŒ‰é’®ï¼Œæ¸…ç†ä¸–ç•Œä¹¦å†…å®¹')]),(0,l.createElementVNode)('li',null,[(0,l.createTextVNode)('å¼€å¯'),(0,l.createElementVNode)('strong',null,'æ–°èŠå¤©')]),(0,l.createElementVNode)('li',null,[(0,l.createTextVNode)('æ‰“å¼€'),(0,l.createElementVNode)('strong',null,'å­˜æ¡£ç®¡ç†é¢æ¿'),(0,l.createTextVNode)(' - è®¾ç½® - ä¿®æ”¹'),(0,l.createElementVNode)('strong',null,'[è‡ªåŠ¨å­˜æ¡£]å‰ç¼€')]),(0,l.createElementVNode)('li',null,'æ­£å¸¸æ¸¸ç©å³å¯')])])],-1)),(0,l.createElementVNode)('div',hs,[(0,l.createElementVNode)('button',{class:'btn btn-primary',onClick:c[12]||(c[12]=e=>B.value=!1)},'æˆ‘çŸ¥é“äº†')])])])):(0,l.createCommentVNode)('v-if',!0)])),(0,l.createCommentVNode)(' å­˜æ¡£ç®¡ç†é¢æ¿ '),((0,l.openBlock)(),(0,l.createBlock)(l.Teleport,{to:'body'},[T.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'modal-overlay fullscreen-modal save-manager-overlay',onClick:c[15]||(c[15]=(0,l.withModifiers)(e=>T.value=!1,['self']))},[(0,l.createElementVNode)('div',ys,[(0,l.createVNode)(wr,{onClose:c[14]||(c[14]=e=>T.value=!1),onSaveLoaded:q,onSaveCreated:X})])])):(0,l.createCommentVNode)('v-if',!0)])),(0,l.createCommentVNode)(' ä¸Šä¸‹æ–‡ç®¡ç†é¢æ¿ '),((0,l.openBlock)(),(0,l.createBlock)(l.Teleport,{to:'body'},[L.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'modal-overlay fullscreen-modal context-manager-overlay',onClick:c[17]||(c[17]=(0,l.withModifiers)(e=>L.value=!1,['self']))},[(0,l.createElementVNode)('div',Vs,[(0,l.createVNode)(ms,{onClose:c[16]||(c[16]=e=>L.value=!1)})])])):(0,l.createCommentVNode)('v-if',!0)])),(0,l.createCommentVNode)(' å†å²æ­£æ–‡é¢æ¿ - æ¨¡æ€æ¡†æ–¹å¼ '),((0,l.openBlock)(),(0,l.createBlock)(l.Teleport,{to:'body'},[O.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'modal-overlay fullscreen-modal history-text-overlay',onClick:c[19]||(c[19]=(0,l.withModifiers)(e=>O.value=!1,['self']))},[(0,l.createElementVNode)('div',Es,[(0,l.createVNode)(On,{onClose:c[18]||(c[18]=e=>O.value=!1)})])])):(0,l.createCommentVNode)('v-if',!0)])),(0,l.createCommentVNode)(' MClite v2 èŠ±åå†Œé¢æ¿ '),((0,l.openBlock)(),(0,l.createBlock)(l.Teleport,{to:'body'},[R.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'modal-overlay fullscreen-modal roster-overlay',onClick:c[21]||(c[21]=(0,l.withModifiers)(e=>R.value=!1,['self']))},[(0,l.createElementVNode)('div',bs,[(0,l.createVNode)(ya,{onClose:c[20]||(c[20]=e=>R.value=!1)})])])):(0,l.createCommentVNode)('v-if',!0)])),(0,l.createCommentVNode)(' MClite v2 æ–‡æ¡£é¢æ¿ '),((0,l.openBlock)(),(0,l.createBlock)(l.Teleport,{to:'body'},[U.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'modal-overlay fullscreen-modal document-overlay',onClick:c[23]||(c[23]=(0,l.withModifiers)(e=>U.value=!1,['self']))},[(0,l.createElementVNode)('div',Ss,[(0,l.createVNode)(an,{onClose:c[22]||(c[22]=e=>U.value=!1)})])])):(0,l.createCommentVNode)('v-if',!0)])),(0,l.createCommentVNode)(' æ›´æ–°æ—¥å¿—é¢æ¿ '),((0,l.openBlock)(),(0,l.createBlock)(l.Teleport,{to:'body'},[j.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'modal-overlay fullscreen-modal changelog-overlay',onClick:c[25]||(c[25]=(0,l.withModifiers)(e=>j.value=!1,['self']))},[(0,l.createElementVNode)('div',Ns,[(0,l.createVNode)(uo,{onClose:c[24]||(c[24]=e=>j.value=!1)})])])):(0,l.createCommentVNode)('v-if',!0)])),(0,l.createCommentVNode)(' å˜é‡ç®¡ç†å™¨é¢æ¿ '),((0,l.openBlock)(),(0,l.createBlock)(l.Teleport,{to:'body'},[P.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'modal-overlay fullscreen-modal variable-manager-overlay',onClick:c[27]||(c[27]=(0,l.withModifiers)(e=>P.value=!1,['self']))},[(0,l.createElementVNode)('div',ks,[(0,l.createVNode)(Zo,{onClose:c[26]||(c[26]=e=>P.value=!1),onVariableUpdated:Q})])])):(0,l.createCommentVNode)('v-if',!0)]))],2))}}),ws=(0,M.A)(Cs,[['__scopeId','data-v-6a3a554f']]),Ms={key:0,class:'error-boundary'},As={class:'error-content'},Is={class:'error-message'},Ds={key:0,class:'error-details'},Bs=(0,l.defineComponent)({__name:'ErrorBoundary',props:{showDetails:{type:Boolean,default:!0},fallbackMessage:{default:'ç»„ä»¶åŠ è½½æ—¶å‘ç”Ÿé”™è¯¯ï¼Œè¯·ç¨åé‡è¯•ã€‚'}},emits:['error','retry','dismiss'],setup(e,{expose:t,emit:a}){const n=e,o=a,r=(0,l.ref)(!1),s=(0,l.ref)(''),c=(0,l.ref)('');(0,l.onErrorCaptured)((e,t,a)=>(r.value=!0,s.value=e.message||n.fallbackMessage,n.showDetails&&(c.value=`\né”™è¯¯ç±»å‹: ${e.name}\né”™è¯¯ä¿¡æ¯: ${e.message}\nç»„ä»¶ä¿¡æ¯: ${a}\nå †æ ˆä¿¡æ¯:\n${e.stack||'æ— å †æ ˆä¿¡æ¯'}\n    `.trim()),console.error('[ErrorBoundary] æ•è·åˆ°é”™è¯¯:',e),console.error('[ErrorBoundary] ç»„ä»¶ä¿¡æ¯:',a),o('error',e,a),!1));const i=()=>{r.value=!1,s.value='',c.value='',o('retry')},u=()=>{r.value=!1,s.value='',c.value='',o('dismiss')};return t({reset:()=>{r.value=!1,s.value='',c.value=''},hasError:r}),(e,t)=>r.value?((0,l.openBlock)(),(0,l.createElementBlock)('div',Ms,[(0,l.createElementVNode)('div',As,[t[1]||(t[1]=(0,l.createElementVNode)('div',{class:'error-icon'},'âš ï¸',-1)),t[2]||(t[2]=(0,l.createElementVNode)('h3',{class:'error-title'},'å‡ºç°äº†ä¸€äº›é—®é¢˜',-1)),(0,l.createElementVNode)('p',Is,(0,l.toDisplayString)(s.value),1),(0,l.createElementVNode)('div',{class:'error-actions'},[(0,l.createElementVNode)('button',{class:'btn btn-primary',onClick:i},'é‡è¯•'),(0,l.createElementVNode)('button',{class:'btn btn-secondary',onClick:u},'å¿½ç•¥')]),c.value?((0,l.openBlock)(),(0,l.createElementBlock)('details',Ds,[t[0]||(t[0]=(0,l.createElementVNode)('summary',null,'æŸ¥çœ‹è¯¦ç»†ä¿¡æ¯',-1)),(0,l.createElementVNode)('pre',null,(0,l.toDisplayString)(c.value),1)])):(0,l.createCommentVNode)('v-if',!0)])])):(0,l.renderSlot)(e.$slots,'default',{key:1})}}),xs=(0,M.A)(Bs,[['__scopeId','data-v-7b143150']]),_s={class:'dialog-header'},Ts={class:'dialog-icon'},$s={class:'dialog-title'},Ls={class:'dialog-body'},Os={class:'dialog-message'},Rs={class:'dialog-footer'},Us=['disabled'],js=['disabled'],Ps={key:0,class:'loading-spinner'},zs=(0,l.defineComponent)({__name:'ConfirmDialog',setup(e){const{state:t,handleConfirm:a,handleCancel:n}=be(),o=()=>{t.showCancel&&!t.isProcessing&&n()};return(e,r)=>((0,l.openBlock)(),(0,l.createElementBlock)(l.Fragment,null,[(0,l.createCommentVNode)(' ç§»é™¤ Teleportï¼Œç›´æ¥åœ¨å½“å‰å®¹å™¨ä¸­æ¸²æŸ“ï¼Œä»¥æ”¯æŒå…¨å±æ¨¡å¼ '),(0,l.createVNode)(l.Transition,{name:'confirm-dialog'},{default:(0,l.withCtx)(()=>[(0,l.unref)(t).visible?((0,l.openBlock)(),(0,l.createElementBlock)('div',{key:0,class:'confirm-dialog-overlay',onClick:(0,l.withModifiers)(o,['self'])},[(0,l.createElementVNode)('div',{class:(0,l.normalizeClass)(['confirm-dialog',[`type-${(0,l.unref)(t).type}`]]),role:'dialog','aria-modal':'true'},[(0,l.createCommentVNode)(' å¯¹è¯æ¡†å¤´éƒ¨ '),(0,l.createElementVNode)('div',_s,[(0,l.createElementVNode)('span',Ts,(0,l.toDisplayString)((0,l.unref)(t).icon),1),(0,l.createElementVNode)('h3',$s,(0,l.toDisplayString)((0,l.unref)(t).title),1)]),(0,l.createCommentVNode)(' å¯¹è¯æ¡†å†…å®¹ '),(0,l.createElementVNode)('div',Ls,[(0,l.createElementVNode)('p',Os,(0,l.toDisplayString)((0,l.unref)(t).message),1)]),(0,l.createCommentVNode)(' å¯¹è¯æ¡†åº•éƒ¨æŒ‰é’® '),(0,l.createElementVNode)('div',Rs,[(0,l.unref)(t).showCancel?((0,l.openBlock)(),(0,l.createElementBlock)('button',{key:0,class:'btn btn-cancel',disabled:(0,l.unref)(t).isProcessing,onClick:r[0]||(r[0]=(...e)=>(0,l.unref)(n)&&(0,l.unref)(n)(...e))},(0,l.toDisplayString)((0,l.unref)(t).cancelText),9,Us)):(0,l.createCommentVNode)('v-if',!0),(0,l.createElementVNode)('button',{class:(0,l.normalizeClass)(['btn btn-confirm',[`btn-${(0,l.unref)(t).type}`]]),disabled:(0,l.unref)(t).isProcessing,onClick:r[1]||(r[1]=(...e)=>(0,l.unref)(a)&&(0,l.unref)(a)(...e))},[(0,l.unref)(t).isProcessing?((0,l.openBlock)(),(0,l.createElementBlock)('span',Ps)):(0,l.createCommentVNode)('v-if',!0),(0,l.createElementVNode)('span',null,(0,l.toDisplayString)((0,l.unref)(t).confirmText),1)],10,js)])],2)])):(0,l.createCommentVNode)('v-if',!0)]),_:1})],2112))}}),Fs=(0,M.A)(zs,[['__scopeId','data-v-61be8e67']]),Hs=(0,l.defineComponent)({__name:'App',setup(e){const t=Ye(),a=(0,l.ref)(),n=(e,t)=>{console.error('[App] æ•è·åˆ°é”™è¯¯:',e),console.error('[App] ç»„ä»¶ä¿¡æ¯:',t),'undefined'!=typeof toastr&&toastr.error('åº”ç”¨å‘ç”Ÿé”™è¯¯ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•')},o=()=>{console.log('[App] ç”¨æˆ·ç‚¹å‡»é‡è¯•'),t.initialize()};return(0,l.onMounted)(async()=>{console.log('[App] MCæˆ¿å­åº”ç”¨å·²æŒ‚è½½');try{await t.initialize(),console.log('[App] åº”ç”¨çŠ¶æ€åˆå§‹åŒ–å®Œæˆ')}catch(e){console.error('[App] åˆå§‹åŒ–å¤±è´¥:',e)}}),(0,l.onUnmounted)(()=>{console.log('[App] MCæˆ¿å­åº”ç”¨æ­£åœ¨å¸è½½')}),(e,t)=>((0,l.openBlock)(),(0,l.createElementBlock)('div',{id:'app-container',ref_key:'appContainer',ref:a},[(0,l.createVNode)(xs,{onError:n,onRetry:o},{default:(0,l.withCtx)(()=>[((0,l.openBlock)(),(0,l.createBlock)(l.Suspense,null,{default:(0,l.withCtx)(()=>[(0,l.createVNode)(ws)]),fallback:(0,l.withCtx)(()=>[...t[0]||(t[0]=[(0,l.createElementVNode)('div',{class:'loading-container'},[(0,l.createElementVNode)('div',{class:'loading-spinner'}),(0,l.createElementVNode)('p',{class:'loading-text'},'æ­£åœ¨åŠ è½½MCæˆ¿å­...')],-1)])]),_:1}))]),_:1}),(0,l.createCommentVNode)(' å…¨å±€ç¡®è®¤å¯¹è¯æ¡† '),(0,l.createVNode)(Fs)],512))}}),Ws=(0,M.A)(Hs,[['__scopeId','data-v-9c83b896']]),Gs=e(),Js=(0,l.createApp)(Ws);Js.use(Gs),Js.mount('#app');Ye().initialize(),console.log('[MCæˆ¿å­] åº”ç”¨å·²å¯åŠ¨'),'undefined'!=typeof toastr&&toastr.success('MCæˆ¿å­ç³»ç»ŸåŠ è½½æˆåŠŸ'),window.addEventListener('pagehide',()=>{console.log('[MCæˆ¿å­] åº”ç”¨æ­£åœ¨å¸è½½'),'undefined'!=typeof toastr&&toastr.info('MCæˆ¿å­ç³»ç»Ÿå·²å¸è½½')});</script><style>.top-bar[data-v-255ae3ac]{display:flex;align-items:center;justify-content:space-between;gap:var(--spacing-sm);height:50px;padding:0 var(--spacing-md);background:var(--office-header);border-bottom:1px solid var(--border-color);flex-shrink:0;position:relative;z-index:100}.top-bar-left[data-v-255ae3ac]{display:flex;align-items:center;gap:var(--spacing-xs);min-width:0;flex-shrink:0}.player-card[data-v-255ae3ac]{display:flex;align-items:center;gap:6px;padding:4px 8px;background:hsla(0,0%,100%,.08);border:1px solid hsla(0,0%,100%,.1);border-radius:var(--radius-sm);min-width:0;flex:1;max-width:180px}.player-avatar[data-v-255ae3ac]{flex-shrink:0;width:26px;height:26px;display:flex;align-items:center;justify-content:center;background:rgba(99,102,241,.3);border-radius:50%}.player-avatar .avatar-icon[data-v-255ae3ac]{font-size:13px}.player-info[data-v-255ae3ac]{display:flex;flex-direction:column;min-width:0;line-height:1.15}.player-name[data-v-255ae3ac]{font-size:12px;font-weight:600;color:#fff;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.player-role[data-v-255ae3ac]{font-size:9px;color:hsla(0,0%,100%,.55);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.top-bar-center[data-v-255ae3ac]{display:flex;align-items:center;justify-content:center;gap:var(--spacing-sm);flex:1;min-width:0}.datetime-group[data-v-255ae3ac]{display:flex;align-items:center;gap:4px}.date-item[data-v-255ae3ac],.time-item[data-v-255ae3ac],.location-item[data-v-255ae3ac]{display:flex;align-items:center;gap:3px;padding:3px 6px;background:hsla(0,0%,100%,.08);border-radius:var(--radius-xs);border:1px solid hsla(0,0%,100%,.1)}.item-icon[data-v-255ae3ac]{font-size:11px;flex-shrink:0}.item-value[data-v-255ae3ac]{font-size:11px;font-weight:500;color:#fff;white-space:nowrap}.location-text[data-v-255ae3ac]{max-width:120px;overflow:hidden;text-overflow:ellipsis}.period-badge[data-v-255ae3ac]{display:inline-block;padding:2px 6px;border-radius:3px;font-size:10px;font-weight:600;font-family:monospace;letter-spacing:.3px}.period-badge.period-morning[data-v-255ae3ac]{background:rgba(255,193,7,.25);color:#ffc107;box-shadow:inset 0 0 0 1px rgba(255,193,7,.3)}.period-badge.period-noon[data-v-255ae3ac]{background:rgba(255,152,0,.25);color:#ff9800;box-shadow:inset 0 0 0 1px rgba(255,152,0,.3)}.period-badge.period-afternoon[data-v-255ae3ac]{background:rgba(255,87,34,.25);color:#ff7043;box-shadow:inset 0 0 0 1px rgba(255,87,34,.3)}.period-badge.period-evening[data-v-255ae3ac]{background:rgba(156,39,176,.25);color:#ce93d8;box-shadow:inset 0 0 0 1px rgba(156,39,176,.3)}.period-badge.period-night[data-v-255ae3ac]{background:rgba(63,81,181,.25);color:#9fa8da;box-shadow:inset 0 0 0 1px rgba(63,81,181,.3)}.period-badge.period-default[data-v-255ae3ac]{background:rgba(158,158,158,.25);color:#bdbdbd;box-shadow:inset 0 0 0 1px rgba(158,158,158,.3)}.top-bar-right[data-v-255ae3ac]{display:flex;align-items:center;gap:var(--spacing-xs);flex-shrink:0}.connection-indicator[data-v-255ae3ac]{padding:4px}.connection-indicator .status-dot[data-v-255ae3ac]{width:8px;height:8px;border-radius:50%;transition:background-color var(--transition-normal)}.connection-indicator.connected .status-dot[data-v-255ae3ac]{background:var(--success-color);box-shadow:0 0 6px var(--success-color)}.connection-indicator.connecting .status-dot[data-v-255ae3ac]{background:var(--warning-color);animation:pulse-255ae3ac 1.5s ease-in-out infinite}.connection-indicator.disconnected .status-dot[data-v-255ae3ac]{background:var(--error-color)}@keyframes pulse-255ae3ac{0%,100%{opacity:1}50%{opacity:.4}}.action-buttons[data-v-255ae3ac]{display:flex;align-items:center;gap:4px}.action-btn[data-v-255ae3ac]{display:flex;align-items:center;justify-content:center;width:34px;height:34px;background:hsla(0,0%,100%,.1);border:1px solid hsla(0,0%,100%,.15);border-radius:var(--radius-sm);cursor:pointer;transition:all var(--transition-fast)}.action-btn .btn-icon[data-v-255ae3ac]{font-size:15px}.action-btn[data-v-255ae3ac]:hover{background:hsla(0,0%,100%,.2);border-color:hsla(0,0%,100%,.25)}.action-btn[data-v-255ae3ac]:active{transform:scale(0.95)}@media (max-width:1024px){.top-bar[data-v-255ae3ac]{gap:var(--spacing-xs)}.player-card[data-v-255ae3ac]{max-width:150px}.location-text[data-v-255ae3ac]{max-width:100px}}@media (max-width:768px){.top-bar[data-v-255ae3ac]{height:46px;padding:0 var(--spacing-sm);gap:6px}.top-bar-left[data-v-255ae3ac]{gap:4px}.player-card[data-v-255ae3ac]{max-width:120px;padding:3px 6px}.player-avatar[data-v-255ae3ac]{width:22px;height:22px}.player-avatar .avatar-icon[data-v-255ae3ac]{font-size:11px}.player-name[data-v-255ae3ac]{font-size:11px}.player-role[data-v-255ae3ac]{font-size:8px}.top-bar-center[data-v-255ae3ac]{gap:4px;justify-content:flex-start}.datetime-group[data-v-255ae3ac]{gap:3px}.date-item[data-v-255ae3ac],.time-item[data-v-255ae3ac]{padding:2px 4px}.item-icon[data-v-255ae3ac]{font-size:10px}.item-value[data-v-255ae3ac]{font-size:10px}.period-badge[data-v-255ae3ac]{font-size:9px;padding:2px 4px}.location-item[data-v-255ae3ac]{display:none}.connection-indicator[data-v-255ae3ac]{padding:2px}.connection-indicator .status-dot[data-v-255ae3ac]{width:6px;height:6px}.action-btn[data-v-255ae3ac]{width:30px;height:30px}.action-btn .btn-icon[data-v-255ae3ac]{font-size:13px}}@media (max-width:480px){.top-bar[data-v-255ae3ac]{height:42px;padding:0 6px;grid-template-columns:auto 1fr auto;gap:4px}.player-card[data-v-255ae3ac]{max-width:100px;padding:2px 4px;gap:4px}.player-avatar[data-v-255ae3ac]{width:20px;height:20px}.player-avatar .avatar-icon[data-v-255ae3ac]{font-size:10px}.player-info[data-v-255ae3ac]{display:flex;flex-direction:column}.player-name[data-v-255ae3ac]{font-size:10px}.player-role[data-v-255ae3ac]{display:none}.top-bar-center[data-v-255ae3ac]{justify-content:center}.datetime-group[data-v-255ae3ac]{gap:2px}.date-item[data-v-255ae3ac]{display:none}.time-item[data-v-255ae3ac]{padding:2px 4px}.period-badge[data-v-255ae3ac]{font-size:9px;padding:2px 5px}.action-buttons[data-v-255ae3ac]{gap:2px}.action-btn[data-v-255ae3ac]{width:28px;height:28px}.action-btn .btn-icon[data-v-255ae3ac]{font-size:12px}}@media (max-width:360px){.top-bar[data-v-255ae3ac]{height:38px;padding:0 4px;gap:2px}.player-card[data-v-255ae3ac]{max-width:80px;padding:2px 3px}.player-avatar[data-v-255ae3ac]{width:18px;height:18px}.player-avatar .avatar-icon[data-v-255ae3ac]{font-size:9px}.player-name[data-v-255ae3ac]{font-size:9px}.period-badge[data-v-255ae3ac]{font-size:8px;padding:1px 3px}.connection-indicator[data-v-255ae3ac]{display:none}.action-btn[data-v-255ae3ac]{width:26px;height:26px}.action-btn .btn-icon[data-v-255ae3ac]{font-size:11px}}
.content-renderer[data-v-17b96b08]{font-size:var(--font-md,15px);line-height:1.8;color:var(--text-color,#1a1a1a)}.content-renderer--dark[data-v-17b96b08]{color:var(--text-color,#e8e8e8)}.content-text[data-v-17b96b08] .block-dialogue{color:#0d47a1;font-weight:500}.content-text[data-v-17b96b08] .block-thought{color:#6b21a8;font-style:italic;opacity:.9}.content-text[data-v-17b96b08] .block-scenery{color:#166534;opacity:.95}.content-text[data-v-17b96b08] .block-system{color:#b91c1c;font-weight:700}.content-renderer--dark .content-text[data-v-17b96b08] .block-dialogue{color:#93c5fd;font-weight:500}.content-renderer--dark .content-text[data-v-17b96b08] .block-thought{color:#c4b5fd;opacity:.95}.content-renderer--dark .content-text[data-v-17b96b08] .block-scenery{color:#6ee7b7;opacity:1}.content-renderer--dark .content-text[data-v-17b96b08] .block-system{color:#fca5a5;font-weight:700}.streaming-cursor[data-v-17b96b08]{display:inline-block;animation:cursorBlink-17b96b08 1s step-end infinite;color:var(--primary-color,#1a5fb4);font-weight:bold}.content-renderer--dark .streaming-cursor[data-v-17b96b08]{color:var(--primary-color,#60a5fa)}@keyframes cursorBlink-17b96b08{0%,50%{opacity:1}51%,100%{opacity:0}}
.variable-changes-panel[data-v-2e3cf9d4]{background:var(--bg-tertiary,#f5f5f5);border:1px solid var(--border-color,#e0e0e0);border-radius:var(--radius-md,8px);overflow:hidden;transition:all var(--transition-normal,0.3s) ease}.variable-changes-panel.expanded[data-v-2e3cf9d4]{box-shadow:var(--shadow-sm,0 2px 4px rgba(0,0,0,0.1))}.panel-header[data-v-2e3cf9d4]{display:flex;align-items:center;justify-content:space-between;padding:var(--spacing-sm,8px) var(--spacing-md,12px);cursor:pointer;-webkit-user-select:none;user-select:none;transition:background var(--transition-fast,0.15s)}.panel-header[data-v-2e3cf9d4]:hover{background:var(--bg-hover,rgba(0,0,0,0.05))}.header-left[data-v-2e3cf9d4]{display:flex;align-items:center;gap:var(--spacing-sm,8px)}.header-icon[data-v-2e3cf9d4]{font-size:14px}.header-title[data-v-2e3cf9d4]{font-size:var(--font-sm,14px);font-weight:500;color:var(--text-color,#333)}.changes-count[data-v-2e3cf9d4]{display:inline-flex;align-items:center;justify-content:center;min-width:20px;height:20px;padding:0 6px;background:var(--primary-color,#6366f1);color:#fff;font-size:var(--font-xs,12px);font-weight:600;border-radius:10px}.header-right[data-v-2e3cf9d4]{display:flex;align-items:center}.toggle-icon[data-v-2e3cf9d4]{font-size:10px;color:var(--text-secondary,#666);transition:transform var(--transition-fast,0.15s)}.panel-content[data-v-2e3cf9d4]{border-top:1px solid var(--border-color,#e0e0e0);background:var(--bg-color,#fff)}.no-changes[data-v-2e3cf9d4]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:var(--spacing-lg,16px);gap:var(--spacing-xs,4px)}.no-changes .empty-icon[data-v-2e3cf9d4]{font-size:24px;opacity:.5}.no-changes .empty-text[data-v-2e3cf9d4]{font-size:var(--font-sm,14px);color:var(--text-disabled,#999)}.changes-list[data-v-2e3cf9d4]{max-height:300px;overflow-y:auto;padding:var(--spacing-sm,8px)}.change-item[data-v-2e3cf9d4]{display:flex;flex-direction:column;gap:var(--spacing-xs,4px);padding:var(--spacing-sm,8px);border-radius:var(--radius-sm,4px);margin-bottom:var(--spacing-xs,4px);background:var(--bg-secondary,#fafafa);border-left:3px solid rgba(0,0,0,0);transition:all var(--transition-fast,0.15s)}.change-item[data-v-2e3cf9d4]:last-child{margin-bottom:0}.change-item[data-v-2e3cf9d4]:hover{background:var(--bg-hover,#f0f0f0)}.change-item.change-new[data-v-2e3cf9d4]{border-left-color:var(--success-color,#4caf50);background:rgba(76,175,80,.05)}.change-item.change-new .path-icon[data-v-2e3cf9d4]{color:var(--success-color,#4caf50)}.change-item.change-increase[data-v-2e3cf9d4]{border-left-color:var(--info-color,#2196f3);background:rgba(33,150,243,.05)}.change-item.change-increase .path-icon[data-v-2e3cf9d4]{color:var(--info-color,#2196f3)}.change-item.change-decrease[data-v-2e3cf9d4]{border-left-color:var(--warning-color,#ff9800);background:rgba(255,152,0,.05)}.change-item.change-decrease .path-icon[data-v-2e3cf9d4]{color:var(--warning-color,#ff9800)}.change-item.change-modify[data-v-2e3cf9d4]{border-left-color:var(--primary-color,#6366f1);background:rgba(99,102,241,.05)}.change-item.change-modify .path-icon[data-v-2e3cf9d4]{color:var(--primary-color,#6366f1)}.change-path[data-v-2e3cf9d4]{display:flex;align-items:center;gap:var(--spacing-xs,4px)}.change-path .path-icon[data-v-2e3cf9d4]{font-size:12px}.change-path .path-text[data-v-2e3cf9d4]{font-size:var(--font-xs,12px);font-family:monospace;color:var(--text-secondary,#666);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.change-values[data-v-2e3cf9d4]{display:flex;align-items:center;gap:var(--spacing-sm,8px);padding-left:var(--spacing-md,12px)}.change-values .old-value[data-v-2e3cf9d4]{font-size:var(--font-sm,14px);font-family:monospace;color:var(--text-disabled,#999);text-decoration:line-through}.change-values .arrow[data-v-2e3cf9d4]{font-size:var(--font-xs,12px);color:var(--text-disabled,#999)}.change-values .new-value[data-v-2e3cf9d4]{font-size:var(--font-sm,14px);font-family:monospace;color:var(--text-color,#333);font-weight:500}.change-comment[data-v-2e3cf9d4]{display:flex;align-items:center;gap:var(--spacing-xs,4px);padding-left:var(--spacing-md,12px)}.change-comment .comment-icon[data-v-2e3cf9d4]{font-size:10px;opacity:.7}.change-comment .comment-text[data-v-2e3cf9d4]{font-size:var(--font-xs,12px);color:var(--text-secondary,#666);font-style:italic}.panel-footer[data-v-2e3cf9d4]{display:flex;justify-content:flex-end;gap:var(--spacing-sm,8px);padding:var(--spacing-sm,8px) var(--spacing-md,12px);border-top:1px solid var(--border-color,#e0e0e0);background:var(--bg-tertiary,#f5f5f5)}.btn-clear[data-v-2e3cf9d4],.btn-copy[data-v-2e3cf9d4]{display:flex;align-items:center;gap:var(--spacing-xs,4px);padding:var(--spacing-xs,4px) var(--spacing-sm,8px);font-size:var(--font-xs,12px);color:var(--text-secondary,#666);background:rgba(0,0,0,0);border:1px solid var(--border-color,#e0e0e0);border-radius:var(--radius-sm,4px);cursor:pointer;transition:all var(--transition-fast,0.15s)}.btn-clear[data-v-2e3cf9d4]:hover,.btn-copy[data-v-2e3cf9d4]:hover{background:var(--bg-hover,#f0f0f0);color:var(--text-color,#333);border-color:var(--border-hover,#ccc)}.btn-clear .btn-icon[data-v-2e3cf9d4],.btn-copy .btn-icon[data-v-2e3cf9d4]{font-size:10px}.expand-enter-active[data-v-2e3cf9d4],.expand-leave-active[data-v-2e3cf9d4]{transition:all .3s ease;max-height:400px;overflow:hidden}.expand-enter-from[data-v-2e3cf9d4],.expand-leave-to[data-v-2e3cf9d4]{max-height:0;opacity:0}@media (max-width:768px){.changes-list[data-v-2e3cf9d4]{max-height:200px}.change-item[data-v-2e3cf9d4]{padding:var(--spacing-xs,4px) var(--spacing-sm,8px)}.change-values[data-v-2e3cf9d4]{flex-wrap:wrap}}
.main-content[data-v-38cea020]{flex:1;display:flex;flex-direction:column;overflow:hidden;min-height:0;background:var(--bg-color)}.game-text-container[data-v-38cea020]{flex:1;display:flex;flex-direction:column;overflow:hidden;padding:var(--spacing-md)}.processing-state[data-v-38cea020]{flex:1;display:flex;align-items:center;justify-content:center}.thinking-panel[data-v-38cea020]{text-align:center;padding:var(--spacing-xl)}.thinking-animation[data-v-38cea020]{display:flex;justify-content:center;gap:8px;margin-bottom:var(--spacing-md)}.thinking-animation .thinking-dot[data-v-38cea020]{width:12px;height:12px;background:var(--primary-color);border-radius:50%;animation:thinkingPulse-38cea020 1.4s ease-in-out infinite}.thinking-animation .thinking-dot[data-v-38cea020]:nth-child(1){animation-delay:0s}.thinking-animation .thinking-dot[data-v-38cea020]:nth-child(2){animation-delay:.2s}.thinking-animation .thinking-dot[data-v-38cea020]:nth-child(3){animation-delay:.4s}@keyframes thinkingPulse-38cea020{0%,80%,100%{transform:scale(0.6);opacity:.5}40%{transform:scale(1);opacity:1}}.thinking-text[data-v-38cea020]{font-size:var(--font-md);color:var(--text-secondary);margin:0}.content-display[data-v-38cea020]{flex:1;display:flex;flex-direction:column;overflow-y:auto;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-md)}.content-header[data-v-38cea020]{display:flex;justify-content:space-between;align-items:center;padding:var(--spacing-sm) var(--spacing-md);border-bottom:1px solid var(--border-color);background:var(--bg-tertiary);flex-shrink:0}.content-meta[data-v-38cea020]{display:flex;align-items:center;gap:var(--spacing-md)}.content-meta .meta-item[data-v-38cea020]{display:flex;align-items:center;gap:var(--spacing-xs);font-size:var(--font-xs);color:var(--text-disabled)}.content-meta .meta-item .meta-icon[data-v-38cea020]{font-size:12px}.content-meta .streaming-badge[data-v-38cea020]{color:var(--primary-color)}.content-meta .streaming-badge .streaming-dot[data-v-38cea020]{display:inline-block;width:6px;height:6px;background:var(--primary-color);border-radius:50%;animation:streamingBlink-38cea020 1s ease-in-out infinite}.version-badge .version-tag[data-v-38cea020]{display:inline-block;padding:2px 8px;font-size:10px;font-family:monospace;font-weight:500;color:var(--text-disabled);background:var(--bg-color);border:1px solid var(--border-color);border-radius:3px;white-space:nowrap}@keyframes streamingBlink-38cea020{0%,100%{opacity:1}50%{opacity:.3}}.game-text[data-v-38cea020]{flex:1;padding:var(--spacing-lg);overflow-y:auto}.game-text[data-v-38cea020] .content-block-renderer{font-size:var(--font-md);line-height:1.8;color:var(--text-color)}[data-v-38cea020] .variable-changes-panel{margin-top:auto;border-radius:0;border-left:none;border-right:none;border-bottom:none}@media (max-width:768px){.game-text-container[data-v-38cea020]{padding:var(--spacing-sm)}.content-header[data-v-38cea020]{flex-direction:row;justify-content:space-between;align-items:center;padding:var(--spacing-xs) var(--spacing-sm)}.content-meta[data-v-38cea020]{gap:var(--spacing-sm)}.content-meta .meta-item[data-v-38cea020]{font-size:11px}.version-badge .version-tag[data-v-38cea020]{padding:1px 6px;font-size:9px}.game-text[data-v-38cea020]{padding:var(--spacing-md)}.text-content[data-v-38cea020]{font-size:var(--font-sm)}}
.bottom-bar[data-v-1712b424]{display:flex;flex-direction:column;gap:0;padding:0;background:var(--bg-secondary);border-top:1px solid var(--border-color);flex-shrink:0;position:relative;z-index:50}.history-panel[data-v-1712b424]{background:var(--bg-color);border-bottom:1px solid var(--border-color);max-height:300px;display:flex;flex-direction:column}.history-header[data-v-1712b424]{display:flex;align-items:center;gap:var(--spacing-sm);padding:var(--spacing-sm) var(--spacing-md);background:var(--bg-secondary);border-bottom:1px solid var(--border-color)}.history-header .history-title[data-v-1712b424]{font-size:var(--font-sm);font-weight:500;color:var(--text-color)}.history-header .history-count[data-v-1712b424]{font-size:var(--font-xs);color:var(--text-secondary);background:var(--bg-tertiary);padding:2px 8px;border-radius:var(--radius-sm)}.history-header .history-actions[data-v-1712b424]{margin-left:auto;display:flex;gap:var(--spacing-xs)}.history-header .history-clear-btn[data-v-1712b424],.history-header .history-close-btn[data-v-1712b424]{width:24px;height:24px;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0);border:none;border-radius:var(--radius-xs);cursor:pointer;font-size:12px;color:var(--text-secondary)}.history-header .history-clear-btn[data-v-1712b424]:hover,.history-header .history-close-btn[data-v-1712b424]:hover{background:var(--bg-tertiary);color:var(--text-color)}.history-header .history-clear-btn[data-v-1712b424]:hover{color:var(--error-color)}.history-search[data-v-1712b424]{padding:var(--spacing-xs) var(--spacing-md);border-bottom:1px solid var(--border-color)}.history-search .history-search-input[data-v-1712b424]{width:100%;padding:var(--spacing-xs) var(--spacing-sm);background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-sm);color:var(--text-color);font-size:var(--font-xs);outline:none}.history-search .history-search-input[data-v-1712b424]:focus{border-color:var(--primary-color)}.history-search .history-search-input[data-v-1712b424]::placeholder{color:var(--text-disabled)}.history-list[data-v-1712b424]{flex:1;overflow-y:auto;padding:var(--spacing-xs) 0}.history-item[data-v-1712b424]{display:flex;align-items:center;gap:var(--spacing-sm);padding:var(--spacing-xs) var(--spacing-md);cursor:pointer;transition:background var(--transition-fast)}.history-item[data-v-1712b424]:hover{background:var(--bg-secondary)}.history-item:hover .history-delete-btn[data-v-1712b424]{opacity:1}.history-item.is-active[data-v-1712b424]{background:rgba(var(--primary-color-rgb),0.1);border-left:3px solid var(--primary-color);padding-left:calc(var(--spacing-md) - 3px)}.history-item .history-content[data-v-1712b424]{flex:1;font-size:var(--font-xs);color:var(--text-color);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.history-item .history-time[data-v-1712b424]{font-size:10px;color:var(--text-disabled);flex-shrink:0}.history-item .history-delete-btn[data-v-1712b424]{width:20px;height:20px;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0);border:none;border-radius:var(--radius-xs);cursor:pointer;font-size:10px;color:var(--text-secondary);opacity:0;transition:all var(--transition-fast)}.history-item .history-delete-btn[data-v-1712b424]:hover{background:rgba(var(--error-color-rgb),0.1);color:var(--error-color)}.history-empty[data-v-1712b424]{padding:var(--spacing-lg);text-align:center;color:var(--text-disabled);font-size:var(--font-xs)}.input-area[data-v-1712b424]{flex:1;min-width:0;display:flex;flex-direction:column;gap:var(--spacing-xs);padding:var(--spacing-sm) var(--spacing-md)}.input-container[data-v-1712b424]{display:flex;align-items:flex-end;gap:var(--spacing-sm);background:var(--bg-color);border:1px solid var(--border-color);border-radius:var(--radius-md);padding:var(--spacing-xs);transition:border-color var(--transition-fast),box-shadow var(--transition-fast)}.input-container[data-v-1712b424]:focus-within{border-color:var(--primary-color);box-shadow:0 0 0 2px rgba(var(--primary-color-rgb),0.1)}.input-container.is-loading[data-v-1712b424]{opacity:.7;border-color:var(--border-color)}.input-container.has-error[data-v-1712b424]{border-color:var(--error-color)}.history-toggle-btn[data-v-1712b424]{width:36px;height:36px;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0);border:1px solid var(--border-color);border-radius:var(--radius-sm);cursor:pointer;transition:all var(--transition-fast);flex-shrink:0}.history-toggle-btn .history-icon[data-v-1712b424]{font-size:16px}.history-toggle-btn[data-v-1712b424]:hover{background:var(--bg-secondary);border-color:var(--primary-color)}.history-toggle-btn.is-active[data-v-1712b424]{background:rgba(var(--primary-color-rgb),0.1);border-color:var(--primary-color)}.history-toggle-btn[data-v-1712b424]:not(.has-history){opacity:.5}.history-toggle-btn[data-v-1712b424]:not(.has-history):hover{opacity:.7}.message-input[data-v-1712b424]{flex:1;min-height:36px;max-height:120px;padding:var(--spacing-xs) var(--spacing-sm);background:rgba(0,0,0,0);border:none;color:var(--text-color);font-size:var(--font-sm);line-height:1.5;resize:none;outline:none}.message-input[data-v-1712b424]::placeholder{color:var(--text-disabled)}.message-input[data-v-1712b424]:disabled{opacity:.6;cursor:not-allowed}.send-btn[data-v-1712b424]{width:36px;height:36px;display:flex;align-items:center;justify-content:center;background:var(--primary-color);border:none;border-radius:var(--radius-sm);cursor:pointer;transition:all var(--transition-fast);flex-shrink:0}.send-btn .send-icon[data-v-1712b424],.send-btn .loading-icon[data-v-1712b424]{font-size:16px}.send-btn[data-v-1712b424]:hover:not(:disabled){background:var(--primary-hover);transform:scale(1.05)}.send-btn[data-v-1712b424]:active:not(:disabled){transform:scale(0.95)}.send-btn[data-v-1712b424]:disabled{background:var(--bg-tertiary);cursor:not-allowed;opacity:.6}.send-btn.is-loading[data-v-1712b424]{animation:pulse-1712b424 1.5s infinite}@keyframes pulse-1712b424{0%,100%{opacity:1}50%{opacity:.6}}.navigation-hint[data-v-1712b424]{display:flex;align-items:center;gap:var(--spacing-xs);padding:var(--spacing-xs) var(--spacing-sm);background:rgba(var(--primary-color-rgb),0.1);border-radius:var(--radius-sm);font-size:var(--font-xs);color:var(--primary-color)}.navigation-hint .hint-icon[data-v-1712b424]{font-size:12px}.navigation-hint .hint-text[data-v-1712b424]{flex:1}.navigation-hint .hint-cancel[data-v-1712b424]{width:16px;height:16px;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0);border:none;border-radius:var(--radius-xs);cursor:pointer;font-size:10px;color:var(--primary-color)}.navigation-hint .hint-cancel[data-v-1712b424]:hover{background:rgba(var(--primary-color-rgb),0.2)}.error-message[data-v-1712b424]{display:flex;align-items:center;gap:var(--spacing-xs);padding:var(--spacing-xs) var(--spacing-sm);background:rgba(var(--error-color-rgb),0.1);border-radius:var(--radius-sm);color:var(--error-color);font-size:var(--font-xs)}.error-message .error-icon[data-v-1712b424]{flex-shrink:0}.error-message .error-text[data-v-1712b424]{flex:1;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.error-message .error-dismiss[data-v-1712b424]{width:20px;height:20px;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0);border:none;color:var(--error-color);cursor:pointer;border-radius:var(--radius-xs)}.error-message .error-dismiss[data-v-1712b424]:hover{background:rgba(var(--error-color-rgb),0.2)}.slide-up-enter-active[data-v-1712b424],.slide-up-leave-active[data-v-1712b424]{transition:all .2s ease}.slide-up-enter-from[data-v-1712b424],.slide-up-leave-to[data-v-1712b424]{opacity:0;max-height:0;transform:translateY(10px)}.slide-up-enter-to[data-v-1712b424],.slide-up-leave-from[data-v-1712b424]{opacity:1;max-height:300px;transform:translateY(0)}@media (max-width:768px){.bottom-bar[data-v-1712b424]{flex-direction:column}.input-area[data-v-1712b424]{padding:var(--spacing-sm);padding-bottom:calc(var(--spacing-sm) + env(safe-area-inset-bottom,0px))}.input-container[data-v-1712b424]{padding:var(--spacing-sm)}.message-input[data-v-1712b424]{font-size:16px}.send-btn[data-v-1712b424],.history-toggle-btn[data-v-1712b424]{width:44px;height:44px}.send-btn .send-icon[data-v-1712b424],.send-btn .loading-icon[data-v-1712b424],.send-btn .history-icon[data-v-1712b424],.history-toggle-btn .send-icon[data-v-1712b424],.history-toggle-btn .loading-icon[data-v-1712b424],.history-toggle-btn .history-icon[data-v-1712b424]{font-size:18px}.history-panel[data-v-1712b424]{max-height:250px}}
.sidebar[data-v-0cb86708]{display:flex;flex-direction:column;width:280px;height:100%;background:var(--bg-secondary);border-left:1px solid var(--border-color);transition:width var(--transition-normal),transform var(--transition-normal);flex-shrink:0;position:relative;overflow:hidden}.sidebar.is-collapsed[data-v-0cb86708]{width:60px}.sidebar.is-collapsed .nav-item[data-v-0cb86708]{justify-content:center;padding:var(--spacing-md)}.mobile-close-btn[data-v-0cb86708]{display:none;position:absolute;right:var(--spacing-sm);top:var(--spacing-sm);width:36px;height:36px;align-items:center;justify-content:center;background:var(--bg-hover);border:1px solid var(--border-color);border-radius:var(--radius-sm);cursor:pointer;z-index:11;transition:all var(--transition-fast)}.mobile-close-btn .close-icon[data-v-0cb86708]{font-size:18px;color:var(--text-secondary)}.mobile-close-btn[data-v-0cb86708]:hover{background:var(--bg-tertiary)}.mobile-close-btn:hover .close-icon[data-v-0cb86708]{color:var(--text-color)}.collapse-btn[data-v-0cb86708]{position:absolute;left:-12px;top:50%;transform:translateY(-50%);width:24px;height:48px;display:flex;align-items:center;justify-content:center;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-sm) 0 0 var(--radius-sm);cursor:pointer;z-index:10;transition:all var(--transition-fast)}.collapse-btn .collapse-icon[data-v-0cb86708]{font-size:10px;color:var(--text-secondary)}.collapse-btn[data-v-0cb86708]:hover{background:var(--bg-hover);border-color:var(--border-hover)}.collapse-btn:hover .collapse-icon[data-v-0cb86708]{color:var(--text-color)}.nav-menu[data-v-0cb86708]{padding:var(--spacing-sm);flex-shrink:0}.nav-item[data-v-0cb86708]{display:flex;align-items:center;gap:var(--spacing-sm);padding:var(--spacing-sm) var(--spacing-md);margin-bottom:var(--spacing-xs);border-radius:var(--radius-sm);cursor:pointer;transition:all var(--transition-fast);position:relative}.nav-item .nav-icon[data-v-0cb86708]{font-size:16px;flex-shrink:0}.nav-item .nav-label[data-v-0cb86708]{font-size:var(--font-sm);color:var(--text-color);white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.nav-item .lite-tag[data-v-0cb86708]{margin-left:auto;padding:1px 4px;font-size:9px;font-weight:500;background:var(--warning-light);color:var(--warning-color);border-radius:3px;opacity:.8}.nav-item[data-v-0cb86708]:hover{background:var(--bg-hover)}.nav-item:hover .nav-label[data-v-0cb86708]{color:var(--text-highlight)}.nav-item.is-active[data-v-0cb86708]{background:var(--primary-light);border-left:3px solid var(--primary-color)}.nav-item.is-active .nav-label[data-v-0cb86708]{color:var(--primary-color);font-weight:600}.nav-item.is-disabled[data-v-0cb86708]{opacity:.5;cursor:not-allowed}.info-panels[data-v-0cb86708]{flex:1;overflow-y:auto;padding:var(--spacing-sm);display:flex;flex-direction:column;gap:var(--spacing-sm)}.info-panel[data-v-0cb86708]{background:var(--bg-color);border:1px solid var(--border-light);border-radius:var(--radius-sm);overflow:hidden}.panel-header[data-v-0cb86708]{display:flex;align-items:center;gap:var(--spacing-xs);padding:var(--spacing-xs) var(--spacing-sm);background:var(--bg-tertiary);border-bottom:1px solid var(--border-light)}.panel-header .panel-icon[data-v-0cb86708]{font-size:14px}.panel-header .panel-title[data-v-0cb86708]{font-size:var(--font-xs);font-weight:600;color:var(--text-color)}.panel-header .panel-count[data-v-0cb86708]{margin-left:auto;min-width:18px;height:18px;display:flex;align-items:center;justify-content:center;padding:0 5px;background:var(--primary-light);color:var(--primary-color);font-size:10px;font-weight:600;border-radius:9px}.panel-body[data-v-0cb86708]{padding:var(--spacing-xs);max-height:150px;overflow-y:auto}.settings-panel .panel-body[data-v-0cb86708]{padding:var(--spacing-sm)}.setting-item[data-v-0cb86708]{display:flex;align-items:center;justify-content:space-between;padding:var(--spacing-xs) 0}.setting-label[data-v-0cb86708]{display:flex;align-items:center;gap:var(--spacing-xs)}.setting-label .setting-icon[data-v-0cb86708]{font-size:14px}.setting-label .setting-text[data-v-0cb86708]{font-size:var(--font-sm);color:var(--text-color)}.setting-hint[data-v-0cb86708]{font-size:10px;color:var(--text-muted);margin-top:2px;padding-left:22px}.toggle-switch[data-v-0cb86708]{position:relative;display:inline-block;width:40px;height:20px;cursor:pointer}.toggle-switch input[data-v-0cb86708]{opacity:0;width:0;height:0}.toggle-switch input:checked+.toggle-slider[data-v-0cb86708]{background:var(--primary-color)}.toggle-switch input:checked+.toggle-slider[data-v-0cb86708]::before{transform:translateX(20px)}.toggle-switch .toggle-slider[data-v-0cb86708]{position:absolute;top:0;left:0;right:0;bottom:0;background:var(--bg-tertiary);border-radius:20px;transition:all var(--transition-fast)}.toggle-switch .toggle-slider[data-v-0cb86708]::before{content:"";position:absolute;left:2px;bottom:2px;width:16px;height:16px;background:#fff;border-radius:50%;transition:all var(--transition-fast);box-shadow:0 1px 3px rgba(0,0,0,.2)}.lite-info-panel[data-v-0cb86708]{background:var(--warning-light);border:1px solid var(--warning-color)}.lite-notice[data-v-0cb86708]{text-align:center;padding:var(--spacing-xs)}.lite-notice p[data-v-0cb86708]{margin:0;font-size:var(--font-xs);color:var(--text-color)}.lite-notice p.lite-detail[data-v-0cb86708]{font-size:10px;color:var(--text-secondary);margin-top:2px}.sidebar-footer[data-v-0cb86708]{padding:var(--spacing-sm);border-top:1px solid var(--border-light);flex-shrink:0}.mobile-settings[data-v-0cb86708]{display:none}.divider[data-v-0cb86708]{height:1px;background:var(--border-light);margin:var(--spacing-xs) 0}.footer-item[data-v-0cb86708]{margin-bottom:var(--spacing-xs)}.footer-item[data-v-0cb86708]:last-child{margin-bottom:0}.footer-item .nav-label[data-v-0cb86708]{color:var(--text-secondary)}.footer-item:hover .nav-label[data-v-0cb86708]{color:var(--text-color)}.footer-item.highlight-item[data-v-0cb86708]{background:rgba(99,102,241,.1);border:1px solid rgba(99,102,241,.2);border-radius:var(--radius-sm);margin-bottom:var(--spacing-xs)}.footer-item.highlight-item .nav-label[data-v-0cb86708]{color:var(--primary-color);font-weight:500}.footer-item.highlight-item[data-v-0cb86708]:hover{background:rgba(99,102,241,.2);border-color:rgba(99,102,241,.4)}.footer-item.highlight-item.secondary[data-v-0cb86708]{background:rgba(59,130,246,.08);border:1px solid rgba(59,130,246,.15)}.footer-item.highlight-item.secondary .nav-label[data-v-0cb86708]{color:#3b82f6;font-weight:500}.footer-item.highlight-item.secondary[data-v-0cb86708]:hover{background:rgba(59,130,246,.15);border-color:rgba(59,130,246,.3)}.footer-item.highlight-item.dev-tool[data-v-0cb86708]{background:rgba(245,158,11,.08);border:1px solid rgba(245,158,11,.15)}.footer-item.highlight-item.dev-tool .nav-label[data-v-0cb86708]{color:#f59e0b;font-weight:500}.footer-item.highlight-item.dev-tool[data-v-0cb86708]:hover{background:rgba(245,158,11,.15);border-color:rgba(245,158,11,.3)}.footer-item.debug-item[data-v-0cb86708]{border-top:1px dashed var(--border-light);padding-top:var(--spacing-sm);margin-top:var(--spacing-sm)}.footer-item.debug-item .nav-icon[data-v-0cb86708]{opacity:.7}.footer-item.debug-item .nav-label[data-v-0cb86708]{color:var(--text-muted);font-size:11px}.footer-item.debug-item:hover .nav-icon[data-v-0cb86708]{opacity:1}.footer-item.debug-item:hover .nav-label[data-v-0cb86708]{color:var(--text-secondary)}@media (max-width:768px){.sidebar[data-v-0cb86708]{position:fixed;right:8px;top:50%;transform:translateY(-50%) translateX(calc(100% + 16px));bottom:auto;width:auto;min-width:150px;max-width:200px;height:auto;max-height:80vh;z-index:100;box-shadow:var(--shadow-lg);transition:transform var(--transition-normal);border:1px solid var(--border-color);border-radius:var(--radius-md);padding:var(--spacing-xs) 0}.sidebar.is-visible[data-v-0cb86708]{transform:translateY(-50%) translateX(0)}.sidebar.is-collapsed[data-v-0cb86708]{width:auto;min-width:150px;max-width:200px}.sidebar.is-collapsed .nav-item[data-v-0cb86708]{justify-content:flex-start;padding:var(--spacing-xs) var(--spacing-sm)}.sidebar.is-collapsed .nav-label[data-v-0cb86708],.sidebar.is-collapsed .lite-tag[data-v-0cb86708]{display:inline}.desktop-only[data-v-0cb86708]{display:none !important}.mobile-settings[data-v-0cb86708]{display:block;padding:var(--spacing-xs) var(--spacing-sm);background:var(--bg-tertiary);border-radius:var(--radius-xs);margin:0 var(--spacing-xs) var(--spacing-xs)}.mobile-setting-item[data-v-0cb86708]{display:flex;align-items:center;gap:var(--spacing-xs)}.mobile-setting-item .setting-icon[data-v-0cb86708]{font-size:12px}.mobile-setting-item .setting-text[data-v-0cb86708]{font-size:11px;color:var(--text-color);flex:1}.toggle-switch.small[data-v-0cb86708]{width:32px;height:16px}.toggle-switch.small .toggle-slider[data-v-0cb86708]::before{width:12px;height:12px;left:2px;bottom:2px}.toggle-switch.small input:checked+.toggle-slider[data-v-0cb86708]::before{transform:translateX(16px)}.mobile-close-btn[data-v-0cb86708]{display:flex;position:relative;right:auto;top:auto;width:28px;height:28px;margin:var(--spacing-xs) auto var(--spacing-xs)}.mobile-close-btn .close-icon[data-v-0cb86708]{font-size:14px}.collapse-btn[data-v-0cb86708]{display:none}.nav-menu[data-v-0cb86708]{padding:var(--spacing-xs);padding-top:0}.nav-item[data-v-0cb86708]{padding:var(--spacing-xs) var(--spacing-sm);margin-bottom:2px}.nav-item .nav-icon[data-v-0cb86708]{font-size:14px}.nav-item .nav-label[data-v-0cb86708]{font-size:var(--font-xs);white-space:nowrap}.nav-item .lite-tag[data-v-0cb86708]{font-size:8px;padding:1px 3px}.sidebar-footer[data-v-0cb86708]{padding:var(--spacing-xs);border-top:none}.footer-item[data-v-0cb86708]{padding:var(--spacing-xs) var(--spacing-sm);margin-bottom:2px}.footer-item .nav-icon[data-v-0cb86708]{font-size:12px}.footer-item .nav-label[data-v-0cb86708]{font-size:11px;white-space:nowrap}.footer-item.highlight-item[data-v-0cb86708]{padding:var(--spacing-xs) var(--spacing-sm)}.footer-item.highlight-item.secondary[data-v-0cb86708]{background:rgba(59,130,246,.12);border-color:rgba(59,130,246,.25)}.footer-item.debug-item[data-v-0cb86708]{padding-top:var(--spacing-xs);margin-top:var(--spacing-xs)}.divider[data-v-0cb86708]{margin:2px 0}}@media (max-width:480px){.sidebar[data-v-0cb86708]{right:4px;min-width:130px;max-width:170px;max-height:75vh;border-radius:var(--radius-sm)}.mobile-settings[data-v-0cb86708]{padding:var(--spacing-xs);margin:0 var(--spacing-xs) var(--spacing-xs)}.mobile-setting-item .setting-icon[data-v-0cb86708]{font-size:11px}.mobile-setting-item .setting-text[data-v-0cb86708]{font-size:10px}.toggle-switch.small[data-v-0cb86708]{width:28px;height:14px}.toggle-switch.small .toggle-slider[data-v-0cb86708]::before{width:10px;height:10px;left:2px;bottom:2px}.toggle-switch.small input:checked+.toggle-slider[data-v-0cb86708]::before{transform:translateX(14px)}.nav-item[data-v-0cb86708]{padding:var(--spacing-xs) var(--spacing-xs)}.nav-item .nav-icon[data-v-0cb86708]{font-size:13px}.nav-item .nav-label[data-v-0cb86708]{font-size:11px}.footer-item .nav-icon[data-v-0cb86708]{font-size:11px}.footer-item .nav-label[data-v-0cb86708]{font-size:10px}.footer-item.highlight-item[data-v-0cb86708]{padding:var(--spacing-xs)}.footer-item.highlight-item.secondary .nav-icon[data-v-0cb86708]{font-size:12px}}
.schema-field[data-v-7e8ff355]{display:flex;flex-direction:column;gap:6px;padding:8px 10px;background:var(--bg-secondary);border-radius:6px;border:1px solid var(--border-color)}.field-label[data-v-7e8ff355]{font-size:11px;font-weight:500;color:var(--text-secondary);text-transform:uppercase;letter-spacing:.3px}.field-value[data-v-7e8ff355]{font-size:14px;color:var(--text-color);line-height:1.4}.value-text[data-v-7e8ff355]{word-break:break-word}.text-content[data-v-7e8ff355]{margin:0;white-space:pre-wrap;line-height:1.6}.enum-badge[data-v-7e8ff355]{display:inline-block;padding:3px 10px;background:var(--primary-light);color:var(--primary-color);border-radius:4px;font-size:12px;font-weight:500}.tags-container[data-v-7e8ff355]{display:flex;flex-wrap:wrap;gap:4px}.tag[data-v-7e8ff355]{display:inline-block;padding:3px 10px;background:var(--bg-tertiary);color:var(--text-color);border-radius:12px;font-size:12px;border:1px solid var(--border-color)}.empty-tags[data-v-7e8ff355]{color:var(--text-disabled);font-style:italic;font-size:13px}.boolean-value[data-v-7e8ff355]{display:inline-flex;align-items:center;gap:4px;padding:3px 10px;border-radius:4px;font-size:13px;font-weight:500}.boolean-value .boolean-icon[data-v-7e8ff355]{font-size:12px}.boolean-value.is-true[data-v-7e8ff355]{background:var(--success-light);color:var(--success-color)}.boolean-value.is-false[data-v-7e8ff355]{background:var(--bg-tertiary);color:var(--text-secondary)}.field-type-text .field-value[data-v-7e8ff355]{font-size:13px}.field-type-number .value-text[data-v-7e8ff355]{font-family:"SF Mono",Monaco,Consolas,monospace;font-weight:500}
.roster-panel[data-v-7a96e4b1]{display:flex;flex-direction:column;height:100%;background:var(--bg-secondary);border-radius:8px;overflow:hidden;color:var(--text-color)}.panel-header[data-v-7a96e4b1]{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-bottom:1px solid var(--border-color);background:var(--bg-tertiary)}.panel-header .header-left[data-v-7a96e4b1]{display:flex;align-items:center;gap:10px}.panel-header .header-left .panel-icon[data-v-7a96e4b1]{font-size:20px}.panel-header .header-left h2[data-v-7a96e4b1]{margin:0;font-size:18px;font-weight:600;color:var(--text-color)}.panel-header .header-right[data-v-7a96e4b1]{display:flex;align-items:center;gap:12px}.panel-header .header-right .entry-count[data-v-7a96e4b1]{font-size:14px;color:var(--text-secondary);background:var(--bg-secondary);padding:4px 10px;border-radius:12px}.panel-header .header-right .close-btn[data-v-7a96e4b1]{background:none;border:none;font-size:18px;cursor:pointer;padding:4px 8px;color:var(--text-secondary);border-radius:4px;transition:all .2s}.panel-header .header-right .close-btn[data-v-7a96e4b1]:hover{background:var(--bg-hover);color:var(--text-color)}.panel-main[data-v-7a96e4b1]{display:flex;flex:1;overflow:hidden}.category-sidebar[data-v-7a96e4b1]{width:160px;min-width:160px;background:var(--bg-tertiary);border-right:1px solid var(--border-color);display:flex;flex-direction:column}.category-sidebar .sidebar-header[data-v-7a96e4b1]{padding:12px;border-bottom:1px solid var(--border-color)}.category-sidebar .sidebar-header .sidebar-title[data-v-7a96e4b1]{font-size:13px;font-weight:600;color:var(--text-secondary);text-transform:uppercase;letter-spacing:.5px}.category-sidebar .category-list[data-v-7a96e4b1]{flex:1;overflow-y:auto;padding:8px}.category-sidebar .category-item[data-v-7a96e4b1]{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;margin-bottom:4px;border-radius:6px;cursor:pointer;transition:all .2s;background:rgba(0,0,0,0)}.category-sidebar .category-item .category-name[data-v-7a96e4b1]{font-size:13px;color:var(--text-color)}.category-sidebar .category-item .category-count[data-v-7a96e4b1]{font-size:12px;color:var(--text-secondary);background:var(--bg-secondary);padding:2px 8px;border-radius:10px}.category-sidebar .category-item[data-v-7a96e4b1]:hover{background:var(--bg-hover)}.category-sidebar .category-item.active[data-v-7a96e4b1]{background:var(--primary-light)}.category-sidebar .category-item.active .category-name[data-v-7a96e4b1]{color:var(--primary-color);font-weight:600}.category-sidebar .category-item.active .category-count[data-v-7a96e4b1]{background:var(--primary-color);color:#fff}.panel-body[data-v-7a96e4b1]{flex:1;overflow-y:auto;padding:16px;background:var(--bg-color)}.state-container[data-v-7a96e4b1]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:48px;height:100%}.state-container .state-icon[data-v-7a96e4b1]{font-size:48px;margin-bottom:16px}.state-container p[data-v-7a96e4b1]{margin:0 0 8px 0;color:var(--text-secondary);font-size:15px}.state-container .empty-hint[data-v-7a96e4b1]{font-size:13px;color:var(--text-disabled)}.state-container .empty-hint code[data-v-7a96e4b1]{background:var(--bg-tertiary);padding:2px 6px;border-radius:4px;font-family:monospace;color:var(--text-color)}.state-container .retry-btn[data-v-7a96e4b1]{margin-top:16px;padding:8px 20px;background:var(--primary-color);color:#fff;border:none;border-radius:6px;cursor:pointer;font-size:14px;transition:background .2s}.state-container .retry-btn[data-v-7a96e4b1]:hover{background:var(--primary-hover)}.content-area[data-v-7a96e4b1]{display:flex;flex-direction:column;gap:16px}.group-header[data-v-7a96e4b1]{display:flex;align-items:center;justify-content:space-between;padding-bottom:12px;border-bottom:2px solid var(--primary-color)}.group-header .group-title[data-v-7a96e4b1]{margin:0;font-size:18px;color:var(--text-color)}.group-header .group-count[data-v-7a96e4b1]{font-size:14px;color:var(--text-secondary)}.entry-table[data-v-7a96e4b1]{background:var(--bg-secondary);border-radius:8px;border:1px solid var(--border-color);overflow:hidden}.table-header[data-v-7a96e4b1]{display:flex;align-items:center;padding:12px 16px;background:var(--bg-tertiary);border-bottom:1px solid var(--border-color);font-size:13px;font-weight:600;color:var(--text-secondary);text-transform:uppercase;letter-spacing:.3px}.table-body[data-v-7a96e4b1]{max-height:calc(100vh - 320px);overflow-y:auto}.table-row[data-v-7a96e4b1]{border-bottom:1px solid var(--border-color)}.table-row[data-v-7a96e4b1]:last-child{border-bottom:none}.table-row.is-expanded[data-v-7a96e4b1]{background:var(--bg-color)}.row-main[data-v-7a96e4b1]{display:flex;align-items:center;padding:12px 16px;cursor:pointer;transition:background .2s}.row-main[data-v-7a96e4b1]:hover{background:var(--bg-hover)}.col-name[data-v-7a96e4b1]{flex:2;display:flex;align-items:center;gap:12px;min-width:150px}.col-name .person-avatar[data-v-7a96e4b1]{width:36px;height:36px;display:flex;align-items:center;justify-content:center;background:var(--primary-light);color:var(--primary-color);border-radius:50%;font-size:14px;font-weight:600}.col-name .person-name[data-v-7a96e4b1]{font-weight:500;color:var(--text-color)}.col-summary[data-v-7a96e4b1]{flex:1;min-width:100px}.col-summary .summary-value[data-v-7a96e4b1]{font-size:13px;color:var(--text-secondary)}.col-action[data-v-7a96e4b1]{width:80px;text-align:right}.col-action .expand-btn[data-v-7a96e4b1]{font-size:12px;color:var(--primary-color);cursor:pointer}.col-action .expand-btn[data-v-7a96e4b1]:hover{text-decoration:underline}.row-details[data-v-7a96e4b1]{padding:0 16px 16px 16px}.details-content[data-v-7a96e4b1]{background:var(--bg-tertiary);border-radius:8px;padding:16px}.detail-section[data-v-7a96e4b1]{margin-bottom:20px}.detail-section[data-v-7a96e4b1]:last-child{margin-bottom:0}.detail-section .section-title[data-v-7a96e4b1]{margin:0 0 12px 0;font-size:14px;font-weight:600;color:var(--primary-color);padding-bottom:8px;border-bottom:1px solid var(--border-color)}.field-grid[data-v-7a96e4b1]{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:12px 16px}@media (max-width:768px){.panel-main[data-v-7a96e4b1]{flex-direction:column}.category-sidebar[data-v-7a96e4b1]{width:100%;min-width:auto;flex-direction:row;border-right:none;border-bottom:1px solid var(--border-color)}.category-sidebar .sidebar-header[data-v-7a96e4b1]{display:none}.category-sidebar .category-list[data-v-7a96e4b1]{display:flex;flex-wrap:nowrap;overflow-x:auto;padding:8px;gap:8px}.category-sidebar .category-item[data-v-7a96e4b1]{flex-shrink:0;margin-bottom:0}.table-header[data-v-7a96e4b1]{display:none}.row-main[data-v-7a96e4b1]{flex-wrap:wrap;gap:8px}.col-name[data-v-7a96e4b1]{flex:1 1 100%}.col-summary[data-v-7a96e4b1]{flex:0 0 auto}.col-action[data-v-7a96e4b1]{flex:0 0 auto;width:auto}.field-grid[data-v-7a96e4b1]{grid-template-columns:1fr}}
.tree-node[data-v-644583f3]{margin:8px 0}.node-header[data-v-644583f3]{display:flex;align-items:center;gap:8px;cursor:pointer;padding:4px 8px;border-radius:var(--radius-sm,4px)}.node-header[data-v-644583f3]:hover{background:var(--bg-hover)}.expand-icon[data-v-644583f3],.expand-placeholder[data-v-644583f3]{width:16px;font-size:10px;color:var(--text-secondary);flex-shrink:0}.node-title[data-v-644583f3]{font-weight:600;color:var(--text-color)}.node-content[data-v-644583f3]{margin-top:8px;padding-left:24px;color:var(--text-color);line-height:1.8;text-align:justify;white-space:pre-wrap}.node-children[data-v-644583f3]{margin-left:16px;padding-left:8px;border-left:2px solid var(--border-color)}.depth-0 .node-title[data-v-644583f3]{font-size:20px;color:var(--primary-color)}.depth-1 .node-title[data-v-644583f3]{font-size:17px;color:var(--text-color)}.depth-2 .node-title[data-v-644583f3]{font-size:15px;color:var(--text-color)}.depth-3 .node-title[data-v-644583f3]{font-size:14px;color:var(--text-secondary)}.depth-4 .node-title[data-v-644583f3],.depth-5 .node-title[data-v-644583f3]{font-size:13px;color:var(--text-secondary)}
.document-panel[data-v-40ace65a]{display:flex;flex-direction:column;height:100%;background:var(--bg-secondary);border-radius:8px;overflow:hidden;color:var(--text-color)}.panel-header[data-v-40ace65a]{display:flex;align-items:center;padding:12px 16px;border-bottom:1px solid var(--border-color);background:var(--bg-tertiary)}.panel-header h2[data-v-40ace65a]{margin:0;font-size:18px;flex:1;color:var(--text-color)}.panel-header .doc-count[data-v-40ace65a]{margin-right:16px;font-size:14px;color:var(--text-secondary)}.panel-header .close-btn[data-v-40ace65a]{background:none;border:none;font-size:18px;cursor:pointer;padding:4px 8px;color:var(--text-secondary)}.panel-header .close-btn[data-v-40ace65a]:hover{color:var(--text-color)}.panel-main[data-v-40ace65a]{display:flex;flex:1;overflow:hidden}.document-sidebar[data-v-40ace65a]{width:220px;min-width:220px;background:var(--bg-tertiary);border-right:1px solid var(--border-color);display:flex;flex-direction:column;transition:width .25s ease,min-width .25s ease}.document-sidebar.collapsed[data-v-40ace65a]{width:50px;min-width:50px}.sidebar-header[data-v-40ace65a]{display:flex;align-items:center;justify-content:space-between;padding:10px 12px;border-bottom:1px solid var(--border-color);background:var(--bg-secondary)}.sidebar-header .sidebar-title[data-v-40ace65a]{font-size:13px;font-weight:600;color:var(--text-color)}.sidebar-header .toggle-btn[data-v-40ace65a]{background:none;border:none;font-size:12px;cursor:pointer;padding:4px 6px;color:var(--text-secondary);border-radius:4px;transition:background .2s}.sidebar-header .toggle-btn[data-v-40ace65a]:hover{background:var(--bg-hover);color:var(--text-color)}.document-list[data-v-40ace65a]{flex:1;overflow-y:auto;padding:8px}.doc-item[data-v-40ace65a]{display:flex;align-items:flex-start;gap:10px;padding:10px 12px;margin-bottom:6px;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:6px;cursor:pointer;transition:all .2s ease}.doc-item .doc-icon[data-v-40ace65a]{font-size:16px;flex-shrink:0;margin-top:2px}.doc-item .doc-info[data-v-40ace65a]{flex:1;min-width:0;display:flex;flex-direction:column;gap:4px}.doc-item .doc-title[data-v-40ace65a]{font-size:13px;font-weight:500;color:var(--text-color);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.doc-item .doc-desc[data-v-40ace65a]{font-size:11px;color:var(--text-secondary);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.doc-item[data-v-40ace65a]:hover{background:var(--bg-hover);border-color:var(--primary-color)}.doc-item.active[data-v-40ace65a]{background:var(--primary-light);border-color:var(--primary-color)}.doc-item.active .doc-title[data-v-40ace65a]{color:var(--primary-color);font-weight:600}.sidebar-empty[data-v-40ace65a]{padding:20px;text-align:center;color:var(--text-secondary);font-size:12px}.collapsed-list[data-v-40ace65a]{flex:1;overflow-y:auto;padding:8px 4px;display:flex;flex-direction:column;align-items:center;gap:6px}.collapsed-item[data-v-40ace65a]{width:36px;height:36px;display:flex;align-items:center;justify-content:center;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:6px;cursor:pointer;font-size:16px;transition:all .2s ease}.collapsed-item[data-v-40ace65a]:hover{background:var(--bg-hover);border-color:var(--primary-color)}.collapsed-item.active[data-v-40ace65a]{background:var(--primary-light);border-color:var(--primary-color)}.panel-body[data-v-40ace65a]{flex:1;overflow-y:auto;padding:16px;background:var(--bg-color)}.loading-state[data-v-40ace65a],.error-state[data-v-40ace65a],.empty-state[data-v-40ace65a]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:48px;color:var(--text-secondary);height:100%}.loading-state button[data-v-40ace65a],.error-state button[data-v-40ace65a],.empty-state button[data-v-40ace65a]{margin-top:16px;padding:8px 16px;background:var(--primary-color);color:#fff;border:none;border-radius:4px;cursor:pointer}.loading-state button[data-v-40ace65a]:hover,.error-state button[data-v-40ace65a]:hover,.empty-state button[data-v-40ace65a]:hover{background:var(--primary-hover)}.loading-state .empty-hint[data-v-40ace65a],.error-state .empty-hint[data-v-40ace65a],.empty-state .empty-hint[data-v-40ace65a]{font-size:12px;margin-top:8px;color:var(--text-disabled)}.loading-state .empty-hint code[data-v-40ace65a],.error-state .empty-hint code[data-v-40ace65a],.empty-state .empty-hint code[data-v-40ace65a]{background:var(--bg-tertiary);padding:2px 6px;border-radius:4px;font-family:monospace;color:var(--text-color)}.document-content[data-v-40ace65a]{padding:8px}.current-doc-header[data-v-40ace65a]{display:flex;align-items:center;margin-bottom:16px;padding-bottom:12px;border-bottom:2px solid var(--primary-color)}.current-doc-header .current-doc-title[data-v-40ace65a]{margin:0;font-size:20px;color:var(--text-color);flex:1}.current-doc-header .section-count[data-v-40ace65a]{font-size:14px;color:var(--text-secondary);background:var(--bg-tertiary);padding:4px 10px;border-radius:12px}.document-description[data-v-40ace65a]{margin-bottom:24px;padding:16px;background:var(--bg-tertiary);border-radius:8px;color:var(--text-secondary);line-height:1.6;font-style:italic;border-left:4px solid var(--primary-color)}@media (max-width:768px){.panel-header[data-v-40ace65a]{padding:10px 12px}.panel-header h2[data-v-40ace65a]{font-size:16px}.panel-header .doc-count[data-v-40ace65a]{font-size:12px}.document-sidebar[data-v-40ace65a]{width:180px;min-width:180px}.document-sidebar.collapsed[data-v-40ace65a]{width:44px;min-width:44px}.sidebar-header[data-v-40ace65a]{padding:8px 10px}.sidebar-header .sidebar-title[data-v-40ace65a]{font-size:12px}.doc-item[data-v-40ace65a]{padding:8px 10px}.doc-item .doc-title[data-v-40ace65a]{font-size:12px}.doc-item .doc-desc[data-v-40ace65a]{font-size:10px}.panel-body[data-v-40ace65a]{padding:12px}.current-doc-header .current-doc-title[data-v-40ace65a]{font-size:18px}.current-doc-header .section-count[data-v-40ace65a]{font-size:12px;padding:3px 8px}}@media (max-width:480px){.document-sidebar[data-v-40ace65a]{width:44px;min-width:44px}.document-sidebar[data-v-40ace65a]:not(.collapsed){position:absolute;left:0;top:0;bottom:0;width:200px;min-width:200px;z-index:10;box-shadow:2px 0 8px rgba(0,0,0,.15)}.panel-main[data-v-40ace65a]{position:relative}.collapsed-item[data-v-40ace65a]{width:32px;height:32px;font-size:14px}}
.history-text-panel[data-v-9256f22a]{display:flex;flex-direction:column;width:100%;height:100%;background:var(--bg-secondary);border-radius:var(--radius-md);overflow:hidden}.panel-header[data-v-9256f22a]{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;background:linear-gradient(135deg,#3b82f6 0%,#1d4ed8 100%);color:#fff;flex-shrink:0}.header-left[data-v-9256f22a]{display:flex;align-items:center;gap:10px}.panel-icon[data-v-9256f22a]{font-size:20px}.panel-title[data-v-9256f22a]{margin:0;font-size:16px;font-weight:600}.text-count[data-v-9256f22a]{padding:3px 10px;font-size:11px;font-weight:500;background:hsla(0,0%,100%,.2);border-radius:10px}.header-actions[data-v-9256f22a]{display:flex;align-items:center;gap:8px}.btn-refresh[data-v-9256f22a],.btn-close[data-v-9256f22a]{width:30px;height:30px;display:flex;align-items:center;justify-content:center;background:hsla(0,0%,100%,.1);border:none;color:#fff;font-size:14px;cursor:pointer;border-radius:4px;transition:all .2s ease}.btn-refresh[data-v-9256f22a]:hover:not(:disabled),.btn-close[data-v-9256f22a]:hover:not(:disabled){background:hsla(0,0%,100%,.25)}.btn-refresh[data-v-9256f22a]:disabled,.btn-close[data-v-9256f22a]:disabled{opacity:.4;cursor:not-allowed}.search-bar[data-v-9256f22a]{display:flex;align-items:center;gap:var(--spacing-sm);padding:var(--spacing-sm) var(--spacing-md);background:var(--bg-tertiary);border-bottom:1px solid var(--border-color);flex-shrink:0}.search-input[data-v-9256f22a]{flex:1;padding:8px 12px;background:var(--bg-color);border:1px solid var(--border-color);border-radius:var(--radius-sm);font-size:var(--font-sm);color:var(--text-color);outline:none;transition:border-color var(--transition-fast)}.search-input[data-v-9256f22a]:focus{border-color:var(--primary-color)}.search-input[data-v-9256f22a]::placeholder{color:var(--text-muted)}.search-result-count[data-v-9256f22a]{font-size:var(--font-xs);color:var(--text-secondary);white-space:nowrap}.panel-body[data-v-9256f22a]{flex:1;overflow-y:auto;min-height:0}.panel-body[data-v-9256f22a]::-webkit-scrollbar{width:6px}.panel-body[data-v-9256f22a]::-webkit-scrollbar-track{background:var(--bg-tertiary)}.panel-body[data-v-9256f22a]::-webkit-scrollbar-thumb{background:var(--border-color);border-radius:3px}.panel-body[data-v-9256f22a]::-webkit-scrollbar-thumb:hover{background:var(--border-hover)}.state-container[data-v-9256f22a]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 40px;gap:var(--spacing-md)}.state-icon[data-v-9256f22a]{font-size:48px;opacity:.4}.state-text[data-v-9256f22a]{font-size:var(--font-md);color:var(--text-secondary)}.state-hint[data-v-9256f22a]{margin:0;font-size:var(--font-sm);color:var(--text-muted)}.loading-spinner[data-v-9256f22a]{animation:spin-9256f22a 1s linear infinite}@keyframes spin-9256f22a{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}.error-icon[data-v-9256f22a]{color:var(--error-color)}.error-state .state-text[data-v-9256f22a]{color:var(--error-color)}.text-list[data-v-9256f22a]{padding:var(--spacing-sm)}.text-item[data-v-9256f22a]{margin-bottom:var(--spacing-sm);background:var(--bg-color);border:1px solid var(--border-color);border-radius:var(--radius-sm);overflow:hidden;transition:all var(--transition-fast)}.text-item[data-v-9256f22a]:hover{border-color:var(--border-hover)}.text-item.is-expanded[data-v-9256f22a]{border-color:var(--primary-color);box-shadow:0 2px 8px rgba(59,130,246,.15)}.text-header[data-v-9256f22a]{display:flex;align-items:center;justify-content:space-between;padding:var(--spacing-sm) var(--spacing-md);cursor:pointer;transition:background var(--transition-fast)}.text-header[data-v-9256f22a]:hover{background:var(--bg-hover)}.text-meta[data-v-9256f22a]{display:flex;align-items:center;gap:var(--spacing-sm);flex:1;min-width:0}.text-number[data-v-9256f22a]{font-size:var(--font-xs);font-weight:600;color:var(--primary-color);padding:2px 6px;background:var(--primary-light);border-radius:var(--radius-xs);flex-shrink:0}.text-preview[data-v-9256f22a]{font-size:var(--font-sm);color:var(--text-secondary);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.expand-icon[data-v-9256f22a]{font-size:10px;color:var(--text-muted);flex-shrink:0}.text-content[data-v-9256f22a]{padding:var(--spacing-md);border-top:1px solid var(--border-color);background:var(--bg-tertiary)}.content-body[data-v-9256f22a]{font-size:var(--font-sm);line-height:1.8;color:var(--text-color);white-space:pre-wrap;word-break:break-word}.content-actions[data-v-9256f22a]{display:flex;justify-content:flex-end;margin-top:var(--spacing-md);padding-top:var(--spacing-sm);border-top:1px solid var(--border-light)}.btn-action[data-v-9256f22a]{padding:4px 10px;font-size:var(--font-xs);background:var(--bg-color);border:1px solid var(--border-color);border-radius:var(--radius-xs);color:var(--text-secondary);cursor:pointer;transition:all var(--transition-fast)}.btn-action[data-v-9256f22a]:hover{background:var(--bg-hover);border-color:var(--border-hover);color:var(--text-color)}.panel-footer[data-v-9256f22a]{display:flex;align-items:center;justify-content:space-between;padding:var(--spacing-sm) var(--spacing-md);background:var(--bg-tertiary);border-top:1px solid var(--border-color);flex-shrink:0}.footer-info .info-text[data-v-9256f22a]{font-size:var(--font-xs);color:var(--text-muted)}.footer-actions[data-v-9256f22a]{display:flex;gap:var(--spacing-xs)}.btn[data-v-9256f22a]{padding:6px 12px;border:none;border-radius:var(--radius-sm);font-size:var(--font-xs);font-weight:500;cursor:pointer;transition:all var(--transition-fast)}.btn[data-v-9256f22a]:disabled{opacity:.5;cursor:not-allowed}.btn-secondary[data-v-9256f22a]{background:var(--bg-color);color:var(--text-secondary);border:1px solid var(--border-color)}.btn-secondary[data-v-9256f22a]:hover:not(:disabled){background:var(--bg-hover);border-color:var(--border-hover);color:var(--text-color)}@media (max-width:768px){.history-text-panel[data-v-9256f22a]{border-radius:var(--radius-sm)}.panel-header[data-v-9256f22a]{padding:10px 12px}.header-left[data-v-9256f22a]{gap:6px}.panel-icon[data-v-9256f22a]{font-size:16px}.panel-title[data-v-9256f22a]{font-size:14px}.text-count[data-v-9256f22a]{padding:2px 8px;font-size:10px}.btn-refresh[data-v-9256f22a],.btn-close[data-v-9256f22a]{width:26px;height:26px;font-size:12px}.search-bar[data-v-9256f22a]{padding:var(--spacing-xs) var(--spacing-sm)}.search-input[data-v-9256f22a]{padding:6px 10px;font-size:12px}.search-result-count[data-v-9256f22a]{font-size:10px}.text-list[data-v-9256f22a]{padding:var(--spacing-xs)}.text-item[data-v-9256f22a]{margin-bottom:var(--spacing-xs)}.text-header[data-v-9256f22a]{padding:var(--spacing-xs) var(--spacing-sm)}.text-number[data-v-9256f22a]{font-size:10px;padding:1px 4px}.text-preview[data-v-9256f22a]{font-size:11px}.text-content[data-v-9256f22a]{padding:var(--spacing-sm)}.content-body[data-v-9256f22a]{font-size:12px;line-height:1.6}.panel-footer[data-v-9256f22a]{flex-direction:column;gap:var(--spacing-xs);padding:var(--spacing-xs) var(--spacing-sm)}.footer-actions[data-v-9256f22a]{width:100%;justify-content:center}.btn[data-v-9256f22a]{padding:5px 10px;font-size:11px}.state-container[data-v-9256f22a]{padding:40px 20px}.state-icon[data-v-9256f22a]{font-size:36px}.state-text[data-v-9256f22a]{font-size:13px}}@media (max-width:480px){.panel-header[data-v-9256f22a]{padding:8px 10px}.header-left[data-v-9256f22a]{gap:4px}.panel-icon[data-v-9256f22a]{font-size:14px}.panel-title[data-v-9256f22a]{font-size:13px}.text-count[data-v-9256f22a]{display:none}.header-actions[data-v-9256f22a]{gap:4px}.btn-refresh[data-v-9256f22a],.btn-close[data-v-9256f22a]{width:24px;height:24px;font-size:11px}.search-bar[data-v-9256f22a]{padding:4px 8px}.search-input[data-v-9256f22a]{padding:5px 8px;font-size:11px}.text-list[data-v-9256f22a]{padding:4px}.text-header[data-v-9256f22a]{padding:6px 8px}.text-meta[data-v-9256f22a]{gap:4px}.text-number[data-v-9256f22a]{font-size:9px}.text-preview[data-v-9256f22a]{font-size:10px}.expand-icon[data-v-9256f22a]{font-size:8px}.text-content[data-v-9256f22a]{padding:8px}.content-body[data-v-9256f22a]{font-size:11px;line-height:1.5}.content-actions[data-v-9256f22a]{margin-top:8px;padding-top:6px}.btn-action[data-v-9256f22a]{padding:3px 8px;font-size:10px}.panel-footer[data-v-9256f22a]{padding:6px 8px}.footer-info .info-text[data-v-9256f22a]{font-size:10px}.footer-actions .btn[data-v-9256f22a]{padding:4px 8px;font-size:10px}.state-container[data-v-9256f22a]{padding:30px 15px}.state-icon[data-v-9256f22a]{font-size:32px}.state-text[data-v-9256f22a]{font-size:12px}.state-hint[data-v-9256f22a]{font-size:11px}}
.changelog-panel[data-v-64d33b34]{display:flex;flex-direction:column;height:100%;background:var(--bg-secondary);overflow:hidden}.panel-header[data-v-64d33b34]{display:flex;align-items:center;justify-content:space-between;padding:var(--spacing-md) var(--spacing-lg);background:var(--bg-tertiary);border-bottom:1px solid var(--border-color);flex-shrink:0}.header-left[data-v-64d33b34]{display:flex;align-items:center;gap:var(--spacing-sm)}.header-icon[data-v-64d33b34]{font-size:20px}.header-title[data-v-64d33b34]{margin:0;font-size:var(--font-lg);font-weight:600;color:var(--text-color)}.header-right[data-v-64d33b34]{display:flex;align-items:center;gap:var(--spacing-xs)}.btn-refresh[data-v-64d33b34],.btn-close[data-v-64d33b34]{display:flex;align-items:center;justify-content:center;width:32px;height:32px;background:rgba(0,0,0,0);border:1px solid var(--border-color);border-radius:var(--radius-sm);cursor:pointer;transition:all var(--transition-fast);font-size:16px;color:var(--text-secondary)}.btn-refresh[data-v-64d33b34]:hover:not(:disabled),.btn-close[data-v-64d33b34]:hover:not(:disabled){background:var(--bg-hover);color:var(--text-color);border-color:var(--border-hover)}.btn-refresh[data-v-64d33b34]:disabled,.btn-close[data-v-64d33b34]:disabled{opacity:.5;cursor:not-allowed}.refresh-icon[data-v-64d33b34]{display:inline-block;transition:transform .3s ease}.refresh-icon.spinning[data-v-64d33b34]{animation:spin-64d33b34 1s linear infinite}@keyframes spin-64d33b34{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}.panel-body[data-v-64d33b34]{flex:1;overflow-y:auto;padding:var(--spacing-lg)}.loading-state[data-v-64d33b34]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:200px;gap:var(--spacing-md);color:var(--text-secondary)}.loading-state .loading-spinner[data-v-64d33b34]{width:40px;height:40px;border:3px solid var(--border-color);border-top-color:var(--primary-color);border-radius:50%;animation:spin-64d33b34 .8s linear infinite}.loading-state p[data-v-64d33b34]{margin:0;font-size:var(--font-sm)}.error-state[data-v-64d33b34]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:200px;gap:var(--spacing-sm);text-align:center}.error-state .error-icon[data-v-64d33b34]{font-size:40px}.error-state .error-message[data-v-64d33b34]{margin:0;color:var(--error-color);font-size:var(--font-sm)}.error-state .btn-retry[data-v-64d33b34]{padding:var(--spacing-xs) var(--spacing-md);background:var(--primary-color);color:#fff;border:none;border-radius:var(--radius-sm);cursor:pointer;font-size:var(--font-sm);transition:background var(--transition-fast)}.error-state .btn-retry[data-v-64d33b34]:hover{background:var(--primary-hover)}.changelog-content[data-v-64d33b34]{line-height:1.6;color:var(--text-color)}.changelog-content[data-v-64d33b34] .md-h2{font-size:var(--font-xl);font-weight:700;color:var(--text-color);margin:0 0 var(--spacing-lg);padding-bottom:var(--spacing-sm);border-bottom:2px solid var(--primary-color)}.changelog-content[data-v-64d33b34] .md-h3{font-size:var(--font-lg);font-weight:600;color:var(--text-color);margin:var(--spacing-lg) 0 var(--spacing-md);padding-left:var(--spacing-sm);border-left:3px solid var(--primary-color)}.changelog-content[data-v-64d33b34] .md-h4{font-size:var(--font-md);font-weight:600;color:var(--text-secondary);margin:var(--spacing-md) 0 var(--spacing-sm)}.changelog-content[data-v-64d33b34] .md-p{margin:var(--spacing-sm) 0;font-size:var(--font-sm)}.changelog-content[data-v-64d33b34] .md-quote{margin:var(--spacing-md) 0;padding:var(--spacing-sm) var(--spacing-md);background:rgba(99,102,241,.1);border-left:3px solid var(--primary-color);border-radius:0 var(--radius-sm) var(--radius-sm) 0;font-size:var(--font-sm);color:var(--text-secondary)}.changelog-content[data-v-64d33b34] .md-ul,.changelog-content[data-v-64d33b34] .md-ol{margin:var(--spacing-sm) 0;padding-left:var(--spacing-lg)}.changelog-content[data-v-64d33b34] .md-li,.changelog-content[data-v-64d33b34] .md-li-ordered{margin:var(--spacing-xs) 0;font-size:var(--font-sm)}.changelog-content[data-v-64d33b34] .md-hr{margin:var(--spacing-lg) 0;border:none;border-top:1px solid var(--border-color)}.changelog-content[data-v-64d33b34] .code-block{margin:var(--spacing-md) 0;padding:var(--spacing-md);background:var(--bg-tertiary);border:1px solid var(--border-color);border-radius:var(--radius-sm);overflow-x:auto}.changelog-content[data-v-64d33b34] .code-block code{font-family:"Consolas","Monaco",monospace;font-size:var(--font-xs);line-height:1.5;white-space:pre}.changelog-content[data-v-64d33b34] .inline-code{padding:1px 4px;background:var(--bg-tertiary);border:1px solid var(--border-color);border-radius:3px;font-family:"Consolas","Monaco",monospace;font-size:.9em;color:var(--primary-color)}.changelog-content[data-v-64d33b34] a{color:var(--primary-color);text-decoration:none}.changelog-content[data-v-64d33b34] a:hover{text-decoration:underline}.changelog-content[data-v-64d33b34] strong{font-weight:600;color:var(--text-color)}.changelog-content[data-v-64d33b34] .version-highlight{padding:1px 6px;background:rgba(99,102,241,.15);color:var(--primary-color);border-radius:3px;font-weight:600;font-family:monospace}.changelog-content[data-v-64d33b34] .emoji-success{color:var(--success-color)}.changelog-content[data-v-64d33b34] .emoji-error{color:var(--error-color)}.changelog-content[data-v-64d33b34] .emoji-warning{color:var(--warning-color)}.changelog-content[data-v-64d33b34] .emoji-alert{color:var(--error-color)}.panel-footer[data-v-64d33b34]{display:flex;align-items:center;justify-content:space-between;padding:var(--spacing-sm) var(--spacing-lg);background:var(--bg-tertiary);border-top:1px solid var(--border-color);flex-shrink:0}.footer-info .update-time[data-v-64d33b34]{font-size:var(--font-xs);color:var(--text-muted)}.footer-actions[data-v-64d33b34]{display:flex;gap:var(--spacing-sm)}.btn-clear-cache[data-v-64d33b34]{display:flex;align-items:center;gap:var(--spacing-xs);padding:var(--spacing-xs) var(--spacing-sm);background:rgba(0,0,0,0);border:1px solid var(--border-color);border-radius:var(--radius-sm);font-size:var(--font-xs);color:var(--text-secondary);cursor:pointer;transition:all var(--transition-fast)}.btn-clear-cache[data-v-64d33b34]:hover:not(:disabled){background:rgba(239,68,68,.1);color:var(--error-color);border-color:var(--error-color)}.btn-clear-cache[data-v-64d33b34]:disabled{opacity:.5;cursor:not-allowed}.btn-clear-cache .cache-icon[data-v-64d33b34]{font-size:14px}.btn-github[data-v-64d33b34]{display:flex;align-items:center;gap:var(--spacing-xs);padding:var(--spacing-xs) var(--spacing-sm);background:rgba(0,0,0,0);border:1px solid var(--border-color);border-radius:var(--radius-sm);font-size:var(--font-xs);color:var(--text-secondary);text-decoration:none;transition:all var(--transition-fast)}.btn-github[data-v-64d33b34]:hover{background:var(--bg-hover);color:var(--text-color);border-color:var(--border-hover)}.btn-github .github-icon[data-v-64d33b34]{font-size:14px}.cache-status[data-v-64d33b34]{color:var(--success-color);font-size:var(--font-xs);margin-left:var(--spacing-sm);animation:fadeIn-64d33b34 .3s ease}@keyframes fadeIn-64d33b34{from{opacity:0}to{opacity:1}}.cache-dialog-overlay[data-v-64d33b34]{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:1000;animation:fadeIn-64d33b34 .2s ease}.cache-dialog[data-v-64d33b34]{background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-md);width:90%;max-width:400px;box-shadow:0 10px 40px rgba(0,0,0,.3);animation:slideUp-64d33b34 .3s ease}@keyframes slideUp-64d33b34{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.dialog-header[data-v-64d33b34]{display:flex;align-items:center;gap:var(--spacing-sm);padding:var(--spacing-md) var(--spacing-lg);border-bottom:1px solid var(--border-color)}.dialog-header .dialog-icon[data-v-64d33b34]{font-size:20px}.dialog-header h4[data-v-64d33b34]{margin:0;font-size:var(--font-md);font-weight:600;color:var(--text-color)}.dialog-body[data-v-64d33b34]{padding:var(--spacing-lg)}.dialog-body>p[data-v-64d33b34]{margin:0 0 var(--spacing-md);font-size:var(--font-sm);color:var(--text-secondary)}.cache-options[data-v-64d33b34]{display:flex;flex-direction:column;gap:var(--spacing-sm)}.cache-option[data-v-64d33b34]{display:flex;align-items:flex-start;gap:var(--spacing-sm);padding:var(--spacing-sm) var(--spacing-md);background:var(--bg-tertiary);border:1px solid var(--border-color);border-radius:var(--radius-sm);cursor:pointer;transition:all var(--transition-fast)}.cache-option[data-v-64d33b34]:hover{border-color:var(--primary-color)}.cache-option input[type=checkbox][data-v-64d33b34]{margin-top:2px;cursor:pointer;accent-color:var(--primary-color)}.cache-option .option-text[data-v-64d33b34]{display:flex;flex-direction:column;gap:2px}.cache-option .option-text strong[data-v-64d33b34]{font-size:var(--font-sm);color:var(--text-color)}.cache-option .option-text small[data-v-64d33b34]{font-size:var(--font-xs);color:var(--text-muted);line-height:1.4}.dialog-footer[data-v-64d33b34]{display:flex;justify-content:flex-end;gap:var(--spacing-sm);padding:var(--spacing-md) var(--spacing-lg);border-top:1px solid var(--border-color)}.btn-cancel[data-v-64d33b34]{padding:var(--spacing-xs) var(--spacing-md);background:rgba(0,0,0,0);border:1px solid var(--border-color);border-radius:var(--radius-sm);font-size:var(--font-sm);color:var(--text-secondary);cursor:pointer;transition:all var(--transition-fast)}.btn-cancel[data-v-64d33b34]:hover{background:var(--bg-hover);color:var(--text-color)}.btn-confirm[data-v-64d33b34]{padding:var(--spacing-xs) var(--spacing-md);background:var(--primary-color);border:none;border-radius:var(--radius-sm);font-size:var(--font-sm);color:#fff;cursor:pointer;transition:all var(--transition-fast)}.btn-confirm[data-v-64d33b34]:hover:not(:disabled){background:var(--primary-hover)}.btn-confirm[data-v-64d33b34]:disabled{opacity:.5;cursor:not-allowed}@media (max-width:768px){.panel-header[data-v-64d33b34]{padding:var(--spacing-sm) var(--spacing-md)}.header-title[data-v-64d33b34]{font-size:var(--font-md)}.panel-body[data-v-64d33b34]{padding:var(--spacing-md)}.changelog-content[data-v-64d33b34] .md-h2{font-size:var(--font-lg)}.changelog-content[data-v-64d33b34] .md-h3{font-size:var(--font-md)}.changelog-content[data-v-64d33b34] .code-block{padding:var(--spacing-sm)}.changelog-content[data-v-64d33b34] .code-block code{font-size:11px}.panel-footer[data-v-64d33b34]{padding:var(--spacing-xs) var(--spacing-md);flex-wrap:wrap;gap:var(--spacing-xs)}.footer-info[data-v-64d33b34]{width:100%;margin-bottom:var(--spacing-xs)}.footer-actions[data-v-64d33b34]{width:100%;justify-content:flex-end}.cache-dialog[data-v-64d33b34]{width:95%;margin:var(--spacing-md)}.dialog-body[data-v-64d33b34]{padding:var(--spacing-md)}.dialog-footer[data-v-64d33b34]{padding:var(--spacing-sm) var(--spacing-md)}}
.tree-item[data-v-78809202]{font-family:"SF Mono","Fira Code","Consolas",monospace;font-size:13px;line-height:1.4}.item-row[data-v-78809202]{display:flex;align-items:center;gap:4px;padding:3px 8px;padding-right:16px;min-height:26px;cursor:default;border-radius:4px;transition:background .1s}.item-row[data-v-78809202]:hover{background:var(--vm-bg-hover,var(--bg-hover,#f0f0f0))}.tree-item.is-match>.item-row[data-v-78809202]{background:rgba(255,235,59,.15)}.toggle-btn[data-v-78809202]{display:flex;align-items:center;justify-content:center;width:16px;height:16px;flex-shrink:0;cursor:pointer;color:var(--vm-text-muted,var(--text-disabled,#9a9996));transition:color .1s}.toggle-btn svg[data-v-78809202]{width:12px;height:12px}.toggle-btn[data-v-78809202]:hover{color:var(--vm-text-primary,var(--text-color,#2e3436))}.toggle-placeholder[data-v-78809202]{width:16px;flex-shrink:0}.item-key[data-v-78809202]{color:var(--vm-text-primary,var(--text-color,#2e3436));font-weight:500;flex-shrink:0}.item-key.is-meta[data-v-78809202]{color:var(--vm-text-muted,var(--text-disabled,#9a9996));font-style:italic}.separator[data-v-78809202]{color:var(--vm-text-muted,var(--text-disabled,#9a9996));margin:0 4px;flex-shrink:0}.item-value[data-v-78809202]{flex:1;min-width:0;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.item-value.type-string[data-v-78809202]{color:#b35000}.item-value.type-number[data-v-78809202]{color:#2e7d32}.item-value.type-boolean[data-v-78809202]{color:#0d47a1}.item-value.type-array[data-v-78809202]{color:#7b1fa2;font-style:italic}.item-value.type-object[data-v-78809202]{color:#6d5600;font-style:italic}.item-value.type-null[data-v-78809202],.item-value.type-undefined[data-v-78809202]{color:#616161;font-style:italic}:root.dark-theme .item-value.type-string[data-v-78809202]{color:#e9a178}:root.dark-theme .item-value.type-number[data-v-78809202]{color:#b8d7a3}:root.dark-theme .item-value.type-boolean[data-v-78809202]{color:#7eb8da}:root.dark-theme .item-value.type-array[data-v-78809202]{color:#c792ea}:root.dark-theme .item-value.type-object[data-v-78809202]{color:#dcdcaa}:root.dark-theme .item-value.type-null[data-v-78809202],:root.dark-theme .item-value.type-undefined[data-v-78809202]{color:#9e9e9e}.children-hint[data-v-78809202]{color:var(--vm-text-muted,var(--text-disabled,#9a9996));font-size:11px;margin-left:4px}.inline-editor[data-v-78809202]{display:flex;align-items:center;gap:6px;flex:1}.edit-input[data-v-78809202],.edit-select[data-v-78809202]{flex:1;min-width:120px;max-width:400px;padding:2px 8px;background:var(--vm-bg-tertiary,var(--bg-tertiary,#deddda));border:1px solid var(--vm-accent-color,var(--primary-color,#1a5fb4));border-radius:4px;font-family:"SF Mono","Fira Code","Consolas",monospace;font-size:13px;color:var(--vm-text-primary,var(--text-color,#2e3436));outline:none}.edit-select[data-v-78809202]{cursor:pointer}.edit-actions[data-v-78809202]{display:flex;gap:4px}.btn-edit-save[data-v-78809202],.btn-edit-cancel[data-v-78809202]{width:24px;height:24px;display:flex;align-items:center;justify-content:center;border:none;border-radius:4px;font-size:12px;cursor:pointer;transition:all .1s}.btn-edit-save[data-v-78809202]{background:var(--vm-success-color,var(--success-color,#26a269));color:#fff}.btn-edit-save[data-v-78809202]:hover{filter:brightness(0.9)}.btn-edit-cancel[data-v-78809202]{background:var(--vm-bg-tertiary,var(--bg-tertiary,#deddda));color:var(--vm-text-secondary,var(--text-secondary,#5e5c64))}.btn-edit-cancel[data-v-78809202]:hover{background:var(--vm-bg-hover,var(--bg-hover,#f0f0f0));color:var(--vm-text-primary,var(--text-color,#2e3436))}.item-actions[data-v-78809202]{display:flex;gap:2px;margin-left:auto;flex-shrink:0}.action-btn[data-v-78809202]{display:flex;align-items:center;justify-content:center;width:22px;height:22px;background:rgba(0,0,0,0);border:none;border-radius:4px;color:var(--vm-text-muted,var(--text-disabled,#9a9996));cursor:pointer;transition:all .1s}.action-btn svg[data-v-78809202]{width:13px;height:13px}.action-btn[data-v-78809202]:hover{background:var(--vm-bg-hover,var(--bg-hover,#f0f0f0));color:var(--vm-text-primary,var(--text-color,#2e3436))}.action-btn.action-delete[data-v-78809202]:hover{background:rgba(192,28,40,.15);color:var(--vm-danger-color,var(--danger-color,#c01c28))}.item-children[data-v-78809202]{border-left:1px solid var(--vm-border-color,var(--border-color,#c0bfbc));margin-left:15px}
.variable-manager-panel[data-v-2eea0e48]{--vm-bg-primary:var(--bg-color,#f6f5f4);--vm-bg-secondary:var(--bg-secondary,#ffffff);--vm-bg-tertiary:var(--bg-tertiary,#deddda);--vm-bg-hover:var(--bg-hover,#f0f0f0);--vm-border-color:var(--border-color,#c0bfbc);--vm-border-light:var(--border-light,#e5e5e5);--vm-text-primary:var(--text-color,#2e3436);--vm-text-secondary:var(--text-secondary,#5e5c64);--vm-text-muted:var(--text-disabled,#9a9996);--vm-accent-color:var(--primary-color,#1a5fb4);--vm-accent-hover:var(--primary-hover,#3584e4);--vm-success-color:var(--success-color,#26a269);--vm-danger-color:var(--danger-color,#c01c28);display:flex;flex-direction:column;height:100%;background:var(--vm-bg-primary);font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","PingFang SC","Hiragino Sans GB","Microsoft YaHei",sans-serif;font-size:14px;color:var(--vm-text-primary);overflow:hidden;-webkit-font-smoothing:antialiased}.panel-header[data-v-2eea0e48]{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;background:var(--vm-bg-secondary);border-bottom:1px solid var(--vm-border-color);flex-shrink:0}.header-left[data-v-2eea0e48]{display:flex;align-items:center;gap:10px}.header-title[data-v-2eea0e48]{font-size:16px;font-weight:600;letter-spacing:.3px}.status-dot[data-v-2eea0e48]{width:8px;height:8px;border-radius:50%;background:var(--vm-danger-color)}.status-dot.connected[data-v-2eea0e48]{background:var(--vm-success-color)}.header-actions[data-v-2eea0e48]{display:flex;align-items:center;gap:8px}.btn-text[data-v-2eea0e48]{display:flex;align-items:center;gap:4px;padding:6px 12px;background:var(--vm-accent-color);border:none;border-radius:6px;color:#fff;font-size:13px;font-weight:500;cursor:pointer;transition:background .15s}.btn-text[data-v-2eea0e48]:hover{background:var(--vm-accent-hover)}.btn-text .btn-icon[data-v-2eea0e48]{font-size:16px;font-weight:600}.btn-icon-only[data-v-2eea0e48]{display:flex;align-items:center;justify-content:center;width:32px;height:32px;background:rgba(0,0,0,0);border:1px solid var(--vm-border-color);border-radius:6px;color:var(--vm-text-secondary);cursor:pointer;transition:all .15s}.btn-icon-only svg[data-v-2eea0e48]{width:18px;height:18px}.btn-icon-only[data-v-2eea0e48]:hover{background:var(--vm-bg-hover);color:var(--vm-text-primary);border-color:var(--vm-border-light)}.btn-icon-only[data-v-2eea0e48]:disabled{opacity:.5;cursor:not-allowed}.btn-icon-only.loading .icon-refresh[data-v-2eea0e48]{animation:spin-2eea0e48 1s linear infinite}.btn-icon-only.btn-close[data-v-2eea0e48]:hover{background:rgba(192,28,40,.15);border-color:var(--vm-danger-color);color:var(--vm-danger-color)}@keyframes spin-2eea0e48{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}.toolbar[data-v-2eea0e48]{display:flex;align-items:center;gap:12px;padding:10px 16px;background:var(--vm-bg-secondary);border-bottom:1px solid var(--vm-border-color);flex-shrink:0}.search-box[data-v-2eea0e48]{flex:1;display:flex;align-items:center;gap:8px;padding:8px 12px;background:var(--vm-bg-tertiary);border:1px solid var(--vm-border-color);border-radius:8px;transition:border-color .15s}.search-box[data-v-2eea0e48]:focus-within{border-color:var(--vm-accent-color)}.search-box .search-icon[data-v-2eea0e48]{width:16px;height:16px;color:var(--vm-text-muted);flex-shrink:0}.search-box .search-input[data-v-2eea0e48]{flex:1;background:rgba(0,0,0,0);border:none;font-size:14px;color:var(--vm-text-primary);outline:none}.search-box .search-input[data-v-2eea0e48]::placeholder{color:var(--vm-text-muted)}.search-box .btn-clear[data-v-2eea0e48]{display:flex;align-items:center;justify-content:center;width:20px;height:20px;background:rgba(0,0,0,0);border:none;color:var(--vm-text-muted);cursor:pointer;padding:0}.search-box .btn-clear svg[data-v-2eea0e48]{width:14px;height:14px}.search-box .btn-clear[data-v-2eea0e48]:hover{color:var(--vm-text-primary)}.view-options[data-v-2eea0e48]{display:flex;align-items:center}.option-toggle[data-v-2eea0e48]{display:flex;align-items:center;gap:6px;font-size:12px;color:var(--vm-text-secondary);cursor:pointer}.option-toggle input[type=checkbox][data-v-2eea0e48]{width:14px;height:14px;accent-color:var(--vm-accent-color)}.option-toggle[data-v-2eea0e48]:hover{color:var(--vm-text-primary)}.main-content[data-v-2eea0e48]{flex:1;overflow-y:auto;min-height:0}.main-content[data-v-2eea0e48]::-webkit-scrollbar{width:8px}.main-content[data-v-2eea0e48]::-webkit-scrollbar-thumb{background:var(--vm-border-color);border-radius:4px}.main-content[data-v-2eea0e48]::-webkit-scrollbar-track{background:rgba(0,0,0,0)}.state-container[data-v-2eea0e48]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:60px 20px;gap:16px}.state-icon[data-v-2eea0e48]{width:64px;height:64px;color:var(--vm-text-muted)}.state-text[data-v-2eea0e48]{font-size:15px;color:var(--vm-text-secondary)}.loading-spinner[data-v-2eea0e48]{width:36px;height:36px;border:3px solid var(--vm-border-color);border-top-color:var(--vm-accent-color);border-radius:50%;animation:spin-2eea0e48 .8s linear infinite}.tree-view[data-v-2eea0e48]{padding:8px 0}.tree-root[data-v-2eea0e48]{font-family:"SF Mono","Fira Code","Consolas",monospace;font-size:13px;line-height:1.6}.status-bar[data-v-2eea0e48]{display:flex;align-items:center;justify-content:space-between;padding:8px 16px;background:var(--vm-bg-secondary);border-top:1px solid var(--vm-border-color);flex-shrink:0}.stat-item[data-v-2eea0e48]{font-size:12px;color:var(--vm-text-muted)}.modal-overlay[data-v-2eea0e48]{position:fixed;inset:0;background:rgba(0,0,0,.6);display:flex;align-items:center;justify-content:center;z-index:1000;backdrop-filter:blur(2px)}.modal-dialog[data-v-2eea0e48]{background:var(--vm-bg-primary);border:1px solid var(--vm-border-color);border-radius:12px;width:420px;max-width:calc(100% - 32px);box-shadow:var(--shadow-lg,0 20px 60px rgba(0,0,0,0.4))}.modal-header[data-v-2eea0e48]{display:flex;align-items:center;justify-content:space-between;padding:16px 20px;border-bottom:1px solid var(--vm-border-color)}.modal-header h3[data-v-2eea0e48]{margin:0;font-size:16px;font-weight:600}.btn-close-modal[data-v-2eea0e48]{display:flex;align-items:center;justify-content:center;width:28px;height:28px;background:rgba(0,0,0,0);border:none;border-radius:6px;color:var(--vm-text-secondary);cursor:pointer}.btn-close-modal svg[data-v-2eea0e48]{width:16px;height:16px}.btn-close-modal[data-v-2eea0e48]:hover{background:var(--vm-bg-hover);color:var(--vm-text-primary)}.modal-body[data-v-2eea0e48]{padding:20px}.modal-footer[data-v-2eea0e48]{display:flex;justify-content:flex-end;gap:10px;padding:16px 20px;border-top:1px solid var(--vm-border-color)}.form-group[data-v-2eea0e48]{margin-bottom:20px}.form-group[data-v-2eea0e48]:last-child{margin-bottom:0}.form-label[data-v-2eea0e48]{display:block;margin-bottom:8px;font-size:13px;font-weight:500;color:var(--vm-text-secondary)}.path-input-group[data-v-2eea0e48]{display:flex;align-items:center;gap:4px}.path-input-group .path-prefix[data-v-2eea0e48]{font-family:"SF Mono","Fira Code","Consolas",monospace;font-size:13px;color:var(--vm-text-muted);white-space:nowrap}.form-input[data-v-2eea0e48]{flex:1;width:100%;padding:10px 12px;background:var(--vm-bg-tertiary);border:1px solid var(--vm-border-color);border-radius:8px;font-size:14px;color:var(--vm-text-primary);outline:none;transition:border-color .15s}.form-input[data-v-2eea0e48]:focus{border-color:var(--vm-accent-color)}.form-input[data-v-2eea0e48]::placeholder{color:var(--vm-text-muted)}.type-selector[data-v-2eea0e48]{display:grid;grid-template-columns:repeat(3,1fr);gap:8px}.type-option[data-v-2eea0e48]{display:flex;flex-direction:column;align-items:center;gap:4px;padding:12px 8px;background:var(--vm-bg-tertiary);border:1px solid var(--vm-border-color);border-radius:8px;cursor:pointer;transition:all .15s}.type-option .type-icon[data-v-2eea0e48]{font-family:"SF Mono","Fira Code","Consolas",monospace;font-size:16px;font-weight:600}.type-option .type-name[data-v-2eea0e48]{font-size:11px;color:var(--vm-text-secondary)}.type-option[data-v-2eea0e48]:hover{background:var(--vm-bg-hover);border-color:var(--vm-border-light)}.type-option.active[data-v-2eea0e48]{border-width:2px}.type-option.active.type-string[data-v-2eea0e48]{border-color:#b35000}.type-option.active.type-string .type-icon[data-v-2eea0e48]{color:#b35000}.type-option.active.type-number[data-v-2eea0e48]{border-color:#2e7d32}.type-option.active.type-number .type-icon[data-v-2eea0e48]{color:#2e7d32}.type-option.active.type-boolean[data-v-2eea0e48]{border-color:#0d47a1}.type-option.active.type-boolean .type-icon[data-v-2eea0e48]{color:#0d47a1}.type-option.active.type-object[data-v-2eea0e48]{border-color:#6d5600}.type-option.active.type-object .type-icon[data-v-2eea0e48]{color:#6d5600}.type-option.active.type-array[data-v-2eea0e48]{border-color:#7b1fa2}.type-option.active.type-array .type-icon[data-v-2eea0e48]{color:#7b1fa2}.type-option.active.type-null[data-v-2eea0e48]{border-color:#616161}.type-option.active.type-null .type-icon[data-v-2eea0e48]{color:#616161}.boolean-toggle[data-v-2eea0e48]{display:flex;gap:10px}.bool-btn[data-v-2eea0e48]{flex:1;padding:10px;background:var(--vm-bg-tertiary);border:1px solid var(--vm-border-color);border-radius:8px;font-size:14px;font-weight:500;color:var(--vm-text-secondary);cursor:pointer;transition:all .15s}.bool-btn[data-v-2eea0e48]:hover{background:var(--vm-bg-hover);border-color:var(--vm-border-light)}.bool-btn.active[data-v-2eea0e48]{background:rgba(13,71,161,.15);border-color:#0d47a1;color:#0d47a1}.btn-primary[data-v-2eea0e48]{padding:10px 20px;background:var(--vm-accent-color);border:none;border-radius:8px;font-size:14px;font-weight:500;color:#fff;cursor:pointer;transition:background .15s}.btn-primary[data-v-2eea0e48]:hover:not(:disabled){background:var(--vm-accent-hover)}.btn-primary[data-v-2eea0e48]:disabled{opacity:.5;cursor:not-allowed}.btn-secondary[data-v-2eea0e48]{padding:10px 20px;background:rgba(0,0,0,0);border:1px solid var(--vm-border-color);border-radius:8px;font-size:14px;font-weight:500;color:var(--vm-text-secondary);cursor:pointer;transition:all .15s}.btn-secondary[data-v-2eea0e48]:hover{background:var(--vm-bg-hover);color:var(--vm-text-primary)}
.auto-save-settings[data-v-1d1dfdc8]{padding:var(--spacing-sm)}.settings-title[data-v-1d1dfdc8]{margin:0 0 var(--spacing-md) 0;font-size:var(--font-md);font-weight:600;color:var(--text-color);border-bottom:1px solid var(--border-light);padding-bottom:var(--spacing-sm)}.setting-item[data-v-1d1dfdc8]{display:flex;justify-content:space-between;align-items:center;padding:var(--spacing-md);background:var(--bg-secondary);border:1px solid var(--border-light);border-radius:var(--radius-md);margin-bottom:var(--spacing-sm);transition:all var(--transition-fast)}.setting-item[data-v-1d1dfdc8]:hover:not(.disabled){border-color:var(--border-hover)}.setting-item.disabled[data-v-1d1dfdc8]{opacity:.5;background:var(--bg-tertiary)}.setting-info[data-v-1d1dfdc8]{flex:1;margin-right:var(--spacing-md)}.setting-label[data-v-1d1dfdc8]{font-size:var(--font-sm);font-weight:500;color:var(--text-color);margin-bottom:var(--spacing-xs)}.setting-desc[data-v-1d1dfdc8]{font-size:var(--font-xs);color:var(--text-secondary);line-height:1.5}.setting-control[data-v-1d1dfdc8]{display:flex;align-items:center;gap:var(--spacing-sm)}.number-input[data-v-1d1dfdc8],.text-input[data-v-1d1dfdc8]{padding:var(--spacing-sm) var(--spacing-md);background:var(--bg-color);border:1px solid var(--border-color);border-radius:var(--radius-sm);color:var(--text-color);font-size:var(--font-sm);transition:all var(--transition-fast)}.number-input[data-v-1d1dfdc8]:focus,.text-input[data-v-1d1dfdc8]:focus{outline:none;border-color:var(--primary-color);box-shadow:0 0 0 2px var(--primary-light)}.number-input[data-v-1d1dfdc8]:disabled,.text-input[data-v-1d1dfdc8]:disabled{opacity:.5;cursor:not-allowed;background:var(--bg-tertiary)}.number-input[data-v-1d1dfdc8]{width:80px;text-align:center}.text-input[data-v-1d1dfdc8]{width:120px}.unit[data-v-1d1dfdc8]{font-size:var(--font-xs);color:var(--text-secondary)}.toggle-switch[data-v-1d1dfdc8]{position:relative;display:inline-block;width:48px;height:26px}.toggle-switch input[data-v-1d1dfdc8]{opacity:0;width:0;height:0}.toggle-switch input:checked+.toggle-slider[data-v-1d1dfdc8]{background:var(--primary-color)}.toggle-switch input:checked+.toggle-slider[data-v-1d1dfdc8]::before{transform:translateX(22px)}.toggle-switch input:disabled+.toggle-slider[data-v-1d1dfdc8]{opacity:.5;cursor:not-allowed}.toggle-slider[data-v-1d1dfdc8]{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background:var(--bg-tertiary);border-radius:26px;transition:all var(--transition-normal);border:1px solid var(--border-color)}.toggle-slider[data-v-1d1dfdc8]::before{position:absolute;content:"";height:20px;width:20px;left:2px;bottom:2px;background:#fff;border-radius:50%;transition:all var(--transition-normal);box-shadow:var(--shadow-sm)}.setting-actions[data-v-1d1dfdc8]{display:flex;justify-content:flex-end;margin-top:var(--spacing-md);padding-top:var(--spacing-md);border-top:1px solid var(--border-light)}.status-section[data-v-1d1dfdc8]{margin-top:var(--spacing-lg);padding:var(--spacing-md);background:var(--bg-secondary);border:1px solid var(--border-light);border-radius:var(--radius-md)}.status-title[data-v-1d1dfdc8]{margin:0 0 var(--spacing-sm) 0;font-size:var(--font-sm);font-weight:600;color:var(--text-color)}.status-items[data-v-1d1dfdc8]{display:flex;flex-direction:column;gap:var(--spacing-xs)}.status-item[data-v-1d1dfdc8]{display:flex;align-items:center;gap:var(--spacing-sm);font-size:var(--font-sm)}.status-label[data-v-1d1dfdc8]{color:var(--text-secondary)}.status-value[data-v-1d1dfdc8]{color:var(--text-color);font-weight:500}.status-value.active[data-v-1d1dfdc8]{color:var(--success-color)}.info-section[data-v-1d1dfdc8]{margin-top:var(--spacing-md);padding:var(--spacing-md);background:var(--info-light);border:1px solid var(--info-color);border-radius:var(--radius-md)}.info-title[data-v-1d1dfdc8]{margin:0 0 var(--spacing-sm) 0;font-size:var(--font-sm);font-weight:600;color:var(--info-color)}.info-list[data-v-1d1dfdc8]{margin:0;padding-left:var(--spacing-lg);font-size:var(--font-xs);color:var(--text-secondary);line-height:1.8}.info-list li[data-v-1d1dfdc8]{margin-bottom:var(--spacing-xs)}.btn[data-v-1d1dfdc8]{display:inline-flex;align-items:center;justify-content:center;padding:var(--spacing-sm) var(--spacing-md);border:none;border-radius:var(--radius-sm);cursor:pointer;font-size:var(--font-sm);font-weight:500;transition:all var(--transition-fast)}.btn.btn-secondary[data-v-1d1dfdc8]{background:var(--bg-secondary);color:var(--text-color);border:1px solid var(--border-color)}.btn.btn-secondary[data-v-1d1dfdc8]:hover{background:var(--bg-hover);border-color:var(--border-hover)}@media (max-width:768px){.setting-item[data-v-1d1dfdc8]{flex-direction:column;align-items:flex-start;gap:var(--spacing-sm)}.setting-info[data-v-1d1dfdc8]{margin-right:0}.setting-control[data-v-1d1dfdc8]{width:100%;justify-content:flex-end}}
.save-manager[data-v-63e5f2b9]{display:flex;flex-direction:column;height:100%;background:var(--bg-secondary);color:var(--text-color);border-radius:var(--radius-lg);overflow:hidden}.save-header[data-v-63e5f2b9]{display:flex;justify-content:space-between;align-items:center;padding:var(--spacing-md);background:var(--bg-tertiary);border-bottom:1px solid var(--border-color)}.save-title[data-v-63e5f2b9]{margin:0;font-size:var(--font-lg);font-weight:600;display:flex;align-items:center;gap:var(--spacing-sm);color:var(--text-color)}.save-title .icon[data-v-63e5f2b9]{font-size:var(--font-xl)}.header-actions[data-v-63e5f2b9]{display:flex;gap:var(--spacing-xs)}.save-stats[data-v-63e5f2b9]{display:flex;gap:var(--spacing-lg);padding:var(--spacing-sm) var(--spacing-md);background:var(--bg-color);border-bottom:1px solid var(--border-light)}.stat-item[data-v-63e5f2b9]{display:flex;flex-direction:column;align-items:center;gap:2px}.stat-item .stat-label[data-v-63e5f2b9]{font-size:var(--font-xs);color:var(--text-secondary)}.stat-item .stat-value[data-v-63e5f2b9]{font-size:var(--font-lg);font-weight:600;color:var(--primary-color)}.tab-bar[data-v-63e5f2b9]{display:flex;background:var(--bg-secondary);border-bottom:1px solid var(--border-color)}.tab-btn[data-v-63e5f2b9]{flex:1;padding:var(--spacing-sm) var(--spacing-md);background:rgba(0,0,0,0);border:none;border-bottom:2px solid rgba(0,0,0,0);color:var(--text-secondary);font-size:var(--font-sm);cursor:pointer;transition:all var(--transition-fast)}.tab-btn[data-v-63e5f2b9]:hover{background:var(--bg-hover);color:var(--text-color)}.tab-btn.active[data-v-63e5f2b9]{color:var(--primary-color);border-bottom-color:var(--primary-color);background:var(--primary-light);font-weight:500}.save-content[data-v-63e5f2b9]{flex:1;overflow-y:auto;padding:var(--spacing-md);background:var(--bg-color)}.save-list-container[data-v-63e5f2b9]{display:flex;flex-direction:column;gap:var(--spacing-md)}.create-save-section[data-v-63e5f2b9]{display:flex;gap:var(--spacing-sm)}.save-name-input[data-v-63e5f2b9]{flex:1;padding:var(--spacing-sm) var(--spacing-md);background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-sm);color:var(--text-color);font-size:var(--font-sm);transition:border-color var(--transition-fast)}.save-name-input[data-v-63e5f2b9]:focus{outline:none;border-color:var(--primary-color);box-shadow:0 0 0 2px var(--primary-light)}.save-name-input[data-v-63e5f2b9]::placeholder{color:var(--text-disabled)}.auto-save-actions[data-v-63e5f2b9]{display:flex;gap:var(--spacing-sm)}.save-list[data-v-63e5f2b9]{display:flex;flex-direction:column;gap:var(--spacing-sm)}.save-item[data-v-63e5f2b9]{display:flex;justify-content:space-between;align-items:center;padding:var(--spacing-md);background:var(--bg-secondary);border:1px solid var(--border-light);border-radius:var(--radius-md);transition:all var(--transition-fast)}.save-item[data-v-63e5f2b9]:hover{border-color:var(--primary-color);box-shadow:var(--shadow-sm)}.save-item.active[data-v-63e5f2b9]{border-color:var(--primary-color);background:var(--primary-light)}.save-item.auto-save[data-v-63e5f2b9]{border-left:3px solid var(--warning-color)}.save-info[data-v-63e5f2b9]{flex:1;min-width:0}.save-name[data-v-63e5f2b9]{font-weight:500;font-size:var(--font-sm);margin-bottom:var(--spacing-xs);display:flex;align-items:center;gap:var(--spacing-sm);color:var(--text-color)}.auto-badge[data-v-63e5f2b9]{font-size:10px;padding:2px 6px;background:var(--warning-color);color:var(--text-highlight);border-radius:var(--radius-xs);font-weight:500}.save-time[data-v-63e5f2b9]{font-size:var(--font-xs);color:var(--text-secondary);display:flex;flex-wrap:wrap;gap:var(--spacing-sm)}.save-source[data-v-63e5f2b9]{color:var(--primary-color)}.save-actions[data-v-63e5f2b9]{display:flex;gap:var(--spacing-xs)}.empty-state[data-v-63e5f2b9]{text-align:center;padding:var(--spacing-xxl) var(--spacing-lg);color:var(--text-secondary)}.empty-state p[data-v-63e5f2b9]{margin:0}.empty-state .hint[data-v-63e5f2b9]{font-size:var(--font-xs);margin-top:var(--spacing-sm);color:var(--text-disabled)}.save-footer[data-v-63e5f2b9]{display:flex;justify-content:space-between;align-items:center;padding:var(--spacing-sm) var(--spacing-md);background:var(--bg-tertiary);border-top:1px solid var(--border-color)}.footer-left[data-v-63e5f2b9],.footer-right[data-v-63e5f2b9]{display:flex;gap:var(--spacing-sm)}.import-btn[data-v-63e5f2b9]{cursor:pointer}.error-message[data-v-63e5f2b9]{display:flex;justify-content:space-between;align-items:center;padding:var(--spacing-sm) var(--spacing-md);background:var(--error-light);color:var(--error-color);border-top:1px solid var(--error-color);font-size:var(--font-sm)}.btn-close[data-v-63e5f2b9]{background:none;border:none;color:inherit;font-size:var(--font-lg);cursor:pointer;padding:var(--spacing-xs);border-radius:var(--radius-xs);transition:background var(--transition-fast)}.btn-close[data-v-63e5f2b9]:hover{background:rgba(0,0,0,.1)}.btn[data-v-63e5f2b9]{display:inline-flex;align-items:center;justify-content:center;padding:var(--spacing-sm) var(--spacing-md);border:none;border-radius:var(--radius-sm);cursor:pointer;font-size:var(--font-sm);font-weight:500;transition:all var(--transition-fast)}.btn[data-v-63e5f2b9]:disabled{opacity:.5;cursor:not-allowed}.btn.btn-primary[data-v-63e5f2b9]{background:var(--primary-color);color:#fff}.btn.btn-primary[data-v-63e5f2b9]:hover:not(:disabled){background:var(--primary-hover)}.btn.btn-primary[data-v-63e5f2b9]:active:not(:disabled){background:var(--primary-active)}.btn.btn-secondary[data-v-63e5f2b9]{background:var(--bg-secondary);color:var(--text-color);border:1px solid var(--border-color)}.btn.btn-secondary[data-v-63e5f2b9]:hover:not(:disabled){background:var(--bg-hover);border-color:var(--border-hover)}.btn.btn-danger[data-v-63e5f2b9]{background:var(--error-color);color:#fff}.btn.btn-danger[data-v-63e5f2b9]:hover:not(:disabled){background:var(--error-hover)}.btn.btn-sm[data-v-63e5f2b9]{padding:var(--spacing-xs) var(--spacing-sm);font-size:var(--font-xs)}.btn.btn-icon[data-v-63e5f2b9]{padding:var(--spacing-xs) var(--spacing-sm);background:rgba(0,0,0,0);color:var(--text-secondary)}.btn.btn-icon[data-v-63e5f2b9]:hover:not(:disabled){background:var(--bg-hover);color:var(--text-color)}.spinning[data-v-63e5f2b9]{display:inline-block;animation:spin-63e5f2b9 1s linear infinite}@keyframes spin-63e5f2b9{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}.confirm-overlay[data-v-63e5f2b9]{position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);backdrop-filter:blur(2px);display:flex;justify-content:center;align-items:center;z-index:var(--z-modal)}.confirm-dialog[data-v-63e5f2b9]{background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-lg);padding:var(--spacing-lg);min-width:300px;max-width:400px;box-shadow:var(--shadow-lg)}.confirm-title[data-v-63e5f2b9]{font-size:var(--font-lg);font-weight:600;margin-bottom:var(--spacing-sm);color:var(--text-color)}.confirm-message[data-v-63e5f2b9]{color:var(--text-secondary);margin-bottom:var(--spacing-lg);line-height:1.6;font-size:var(--font-sm)}.confirm-actions[data-v-63e5f2b9]{display:flex;justify-content:flex-end;gap:var(--spacing-sm)}@media (max-width:768px){.save-stats[data-v-63e5f2b9]{justify-content:space-around}.save-item[data-v-63e5f2b9]{flex-direction:column;align-items:flex-start;gap:var(--spacing-sm)}.save-actions[data-v-63e5f2b9]{width:100%;justify-content:flex-end}.save-footer[data-v-63e5f2b9]{flex-direction:column;gap:var(--spacing-sm)}.footer-left[data-v-63e5f2b9],.footer-right[data-v-63e5f2b9]{width:100%;justify-content:center}}
.context-manager-panel[data-v-71562640]{display:flex;flex-direction:column;height:100%;background:var(--bg-secondary);color:var(--text-color)}.panel-header[data-v-71562640]{display:flex;align-items:center;justify-content:space-between;padding:var(--spacing-md) var(--spacing-lg);border-bottom:1px solid var(--border-color);flex-shrink:0}.panel-header h3[data-v-71562640]{margin:0;font-size:var(--font-lg);display:flex;align-items:center;gap:var(--spacing-sm)}.btn-close[data-v-71562640]{width:32px;height:32px;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0);border:none;color:var(--text-secondary);font-size:var(--font-lg);cursor:pointer;border-radius:var(--radius-sm);transition:all var(--transition-fast)}.btn-close[data-v-71562640]:hover{background:var(--bg-hover);color:var(--text-color)}.panel-body[data-v-71562640]{flex:1;overflow-y:auto;padding:var(--spacing-md);display:flex;flex-direction:column;gap:var(--spacing-md)}.section-title[data-v-71562640]{font-size:var(--font-sm);font-weight:600;color:var(--text-color);margin-bottom:var(--spacing-sm);display:flex;align-items:center;gap:var(--spacing-xs)}.stats-section[data-v-71562640]{background:var(--bg-color);border:1px solid var(--border-light);border-radius:var(--radius-sm);padding:var(--spacing-md)}.stats-grid[data-v-71562640]{display:grid;grid-template-columns:repeat(2,1fr);gap:var(--spacing-sm)}.stat-item[data-v-71562640]{display:flex;justify-content:space-between;align-items:center;padding:var(--spacing-xs) var(--spacing-sm);background:var(--bg-secondary);border-radius:var(--radius-xs)}.stat-item .stat-label[data-v-71562640]{font-size:var(--font-xs);color:var(--text-secondary)}.stat-item .stat-value[data-v-71562640]{font-size:var(--font-sm);font-weight:600;color:var(--primary-color)}.last-update[data-v-71562640]{margin-top:var(--spacing-sm);font-size:10px;color:var(--text-muted);text-align:right}.enable-section[data-v-71562640]{background:var(--bg-color);border:1px solid var(--border-light);border-radius:var(--radius-sm);padding:var(--spacing-md)}.enable-row[data-v-71562640]{display:flex;justify-content:space-between;align-items:center;margin-top:var(--spacing-sm)}.enable-label[data-v-71562640]{font-size:var(--font-sm);color:var(--text-color)}.toggle-switch[data-v-71562640]{position:relative;display:inline-block;width:44px;height:22px}.toggle-switch input[data-v-71562640]{opacity:0;width:0;height:0}.toggle-slider[data-v-71562640]{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:var(--bg-tertiary,#555);transition:.3s;border-radius:22px}.toggle-slider[data-v-71562640]:before{position:absolute;content:"";height:16px;width:16px;left:3px;bottom:3px;background-color:#fff;transition:.3s;border-radius:50%}input:checked+.toggle-slider[data-v-71562640]{background-color:var(--success-color,#4ade80)}input:disabled+.toggle-slider[data-v-71562640]{opacity:.5;cursor:not-allowed}input:checked+.toggle-slider[data-v-71562640]:before{transform:translateX(22px)}.enable-status[data-v-71562640]{margin-top:var(--spacing-sm);padding:var(--spacing-xs) var(--spacing-sm);border-radius:var(--radius-xs);font-size:var(--font-xs);text-align:center}.enable-status.enabled[data-v-71562640]{background:rgba(74,222,128,.1);color:var(--success-color,#4ade80)}.enable-status.disabled[data-v-71562640]{background:rgba(251,191,36,.1);color:var(--warning-color,#fbbf24)}.mode-section[data-v-71562640]{background:var(--bg-color);border:1px solid var(--border-light);border-radius:var(--radius-sm);padding:var(--spacing-md)}.mode-selector[data-v-71562640]{display:flex;gap:var(--spacing-sm)}.mode-option[data-v-71562640]{flex:1;display:flex;align-items:center;justify-content:center;gap:var(--spacing-xs);padding:var(--spacing-sm);background:var(--bg-secondary);border:1px solid var(--border-light);border-radius:var(--radius-sm);cursor:pointer;transition:all var(--transition-fast);font-size:var(--font-sm)}.mode-option input[data-v-71562640]{display:none}.mode-option[data-v-71562640]:hover:not(.disabled){border-color:var(--primary-color)}.mode-option.active[data-v-71562640]{background:var(--primary-light);border-color:var(--primary-color);color:var(--primary-color);font-weight:500}.mode-option.disabled[data-v-71562640]{opacity:.5;cursor:not-allowed}.config-section[data-v-71562640]{background:var(--bg-color);border:1px solid var(--border-light);border-radius:var(--radius-sm);padding:var(--spacing-md)}.config-item[data-v-71562640]{margin-bottom:var(--spacing-md)}.config-item[data-v-71562640]:last-child{margin-bottom:0}.config-item label[data-v-71562640]{display:block;font-size:var(--font-sm);color:var(--text-color);margin-bottom:var(--spacing-xs)}.config-control[data-v-71562640]{display:flex;gap:var(--spacing-xs)}.config-input[data-v-71562640]{flex:1;padding:var(--spacing-xs) var(--spacing-sm);background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-sm);color:var(--text-color);font-size:var(--font-sm)}.config-input[data-v-71562640]:focus{outline:none;border-color:var(--primary-color)}.btn-apply[data-v-71562640]{padding:var(--spacing-xs) var(--spacing-md);background:var(--primary-color);color:#fff;border:none;border-radius:var(--radius-sm);font-size:var(--font-xs);cursor:pointer;transition:all var(--transition-fast)}.btn-apply[data-v-71562640]:hover:not(:disabled){background:var(--primary-hover)}.btn-apply[data-v-71562640]:disabled{opacity:.5;cursor:not-allowed}.config-hint[data-v-71562640]{display:block;margin-top:4px;font-size:10px;color:var(--text-muted)}.actions-section[data-v-71562640]{background:var(--bg-color);border:1px solid var(--border-light);border-radius:var(--radius-sm);padding:var(--spacing-md)}.action-buttons[data-v-71562640]{display:flex;flex-direction:column;gap:var(--spacing-xs)}.btn[data-v-71562640]{padding:var(--spacing-sm) var(--spacing-md);border:none;border-radius:var(--radius-sm);font-size:var(--font-sm);cursor:pointer;transition:all var(--transition-fast)}.btn[data-v-71562640]:disabled{opacity:.5;cursor:not-allowed}.btn-primary[data-v-71562640]{background:var(--primary-color);color:#fff}.btn-primary[data-v-71562640]:hover:not(:disabled){background:var(--primary-hover)}.btn-secondary[data-v-71562640]{background:var(--bg-secondary);color:var(--text-color);border:1px solid var(--border-color)}.btn-secondary[data-v-71562640]:hover:not(:disabled){background:var(--bg-hover)}.btn-danger[data-v-71562640]{background:var(--error-color);color:#fff}.btn-danger[data-v-71562640]:hover:not(:disabled){opacity:.9}.btn-danger-outline[data-v-71562640]{background:rgba(0,0,0,0);color:var(--error-color);border:1px solid var(--error-color)}.btn-danger-outline[data-v-71562640]:hover:not(:disabled){background:rgba(244,67,54,.1)}.error-message[data-v-71562640]{padding:var(--spacing-sm) var(--spacing-md);background:rgba(244,67,54,.1);border:1px solid var(--error-color);border-radius:var(--radius-sm);color:var(--error-color);font-size:var(--font-sm)}
.placeholder-panel[data-v-6a3a554f]{flex:1;display:flex;align-items:center;justify-content:center;background:var(--bg-color)}.placeholder-content[data-v-6a3a554f]{text-align:center;padding:var(--spacing-xl)}.placeholder-content .placeholder-icon[data-v-6a3a554f]{font-size:48px;margin-bottom:var(--spacing-md)}.placeholder-content h3[data-v-6a3a554f]{margin:0 0 var(--spacing-sm);color:var(--text-color);font-size:var(--font-lg)}.placeholder-content p[data-v-6a3a554f]{margin:0 0 var(--spacing-lg);color:var(--text-secondary);font-size:var(--font-sm)}.game-layout[data-v-6a3a554f]{display:flex;flex-direction:column;width:100%;height:100%;background:var(--bg-color);overflow:hidden}.game-layout.is-fullscreen[data-v-6a3a554f]{position:fixed;top:0;left:0;right:0;bottom:0;z-index:9999}.main-area[data-v-6a3a554f]{flex:1;display:flex;overflow:hidden;min-height:0}.modal-overlay[data-v-6a3a554f]{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:var(--z-modal);animation:fadeIn-6a3a554f .2s ease}@keyframes fadeIn-6a3a554f{from{opacity:0}to{opacity:1}}.modal[data-v-6a3a554f]{background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-md);width:90%;max-width:480px;max-height:80vh;box-shadow:var(--shadow-lg);animation:slideUp-6a3a554f .3s ease;display:flex;flex-direction:column}@keyframes slideUp-6a3a554f{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}.modal-header[data-v-6a3a554f]{display:flex;align-items:center;justify-content:space-between;padding:var(--spacing-md) var(--spacing-lg);border-bottom:1px solid var(--border-color);flex-shrink:0}.modal-header h3[data-v-6a3a554f]{margin:0;font-size:var(--font-lg);color:var(--text-color);display:flex;align-items:center;gap:var(--spacing-sm)}.btn-close[data-v-6a3a554f]{width:32px;height:32px;display:flex;align-items:center;justify-content:center;background:rgba(0,0,0,0);border:none;color:var(--text-secondary);font-size:var(--font-lg);cursor:pointer;border-radius:var(--radius-sm);transition:all var(--transition-fast)}.btn-close[data-v-6a3a554f]:hover{background:var(--bg-hover);color:var(--text-color)}.modal-body[data-v-6a3a554f]{padding:var(--spacing-lg);overflow-y:auto;flex:1}.modal-footer[data-v-6a3a554f]{display:flex;justify-content:flex-end;gap:var(--spacing-sm);padding:var(--spacing-md) var(--spacing-lg);border-top:1px solid var(--border-color);flex-shrink:0}.help-overlay[data-v-6a3a554f]{position:fixed !important;top:0 !important;left:0 !important;right:0 !important;bottom:0 !important;z-index:10004 !important}.help-overlay .help-modal[data-v-6a3a554f]{width:90%;max-width:480px;max-height:60vh;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-md);box-shadow:var(--shadow-lg)}.help-modal[data-v-6a3a554f]{max-width:480px}.help-steps[data-v-6a3a554f]{margin:0;padding-left:var(--spacing-lg);counter-reset:step-counter}.help-steps li[data-v-6a3a554f]{font-size:var(--font-sm);color:var(--text-color);line-height:1.8;margin-bottom:var(--spacing-sm);padding-left:var(--spacing-xs)}.help-steps li[data-v-6a3a554f]:last-child{margin-bottom:0}.help-steps li strong[data-v-6a3a554f]{color:var(--primary-color);font-weight:600}.help-section[data-v-6a3a554f]{margin-bottom:var(--spacing-lg)}.help-section[data-v-6a3a554f]:last-child{margin-bottom:0}.help-section h4[data-v-6a3a554f]{margin:0 0 var(--spacing-sm);font-size:var(--font-md);color:var(--text-color);display:flex;align-items:center;gap:var(--spacing-xs)}.help-section p[data-v-6a3a554f]{margin:0;font-size:var(--font-sm);color:var(--text-secondary);line-height:1.6}.help-section ul[data-v-6a3a554f]{margin:0;padding-left:var(--spacing-lg)}.help-section ul li[data-v-6a3a554f]{font-size:var(--font-sm);color:var(--text-secondary);line-height:1.8}.help-section ul li strong[data-v-6a3a554f]{color:var(--text-color)}.btn[data-v-6a3a554f]{padding:var(--spacing-sm) var(--spacing-lg);border:none;border-radius:var(--radius-sm);font-size:var(--font-sm);font-weight:500;cursor:pointer;transition:all var(--transition-fast)}.btn[data-v-6a3a554f]:disabled{opacity:.5;cursor:not-allowed}.btn-primary[data-v-6a3a554f]{background:var(--primary-color);color:#fff}.btn-primary[data-v-6a3a554f]:hover:not(:disabled){background:var(--primary-hover)}.btn-primary[data-v-6a3a554f]:active:not(:disabled){background:var(--primary-active)}.btn-secondary[data-v-6a3a554f]{background:var(--bg-color);color:var(--text-color);border:1px solid var(--border-color)}.btn-secondary[data-v-6a3a554f]:hover:not(:disabled){background:var(--bg-hover);border-color:var(--border-hover)}.fullscreen-modal[data-v-6a3a554f]{padding:var(--spacing-lg);z-index:10000 !important}.fullscreen-modal .ai-filter-modal[data-v-6a3a554f]{width:100%;max-width:1400px;height:90vh;max-height:none;display:flex;flex-direction:column}.context-manager-overlay[data-v-6a3a554f]{position:fixed !important;top:0 !important;left:0 !important;right:0 !important;bottom:0 !important;z-index:10001 !important}.context-manager-overlay .context-manager-modal[data-v-6a3a554f]{width:90%;max-width:520px;max-height:85vh;height:auto;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-md);box-shadow:var(--shadow-lg)}.context-manager-overlay .context-manager-modal .modal-body[data-v-6a3a554f]{padding:0}.save-manager-overlay[data-v-6a3a554f]{position:fixed !important;top:0 !important;left:0 !important;right:0 !important;bottom:0 !important;z-index:10002 !important}.save-manager-overlay .save-manager-modal[data-v-6a3a554f]{width:90%;max-width:600px;max-height:85vh;height:80vh;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-md);box-shadow:var(--shadow-lg);overflow:hidden}.history-text-overlay[data-v-6a3a554f]{position:fixed !important;top:0 !important;left:0 !important;right:0 !important;bottom:0 !important;z-index:10005 !important;padding:var(--spacing-md)}.history-text-overlay .history-text-modal[data-v-6a3a554f]{width:100%;max-width:700px;max-height:85vh;height:80vh;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-md);box-shadow:var(--shadow-lg);overflow:hidden}.roster-overlay[data-v-6a3a554f]{position:fixed !important;top:0 !important;left:0 !important;right:0 !important;bottom:0 !important;z-index:10006 !important;padding:var(--spacing-md)}.roster-overlay .roster-modal[data-v-6a3a554f]{width:100%;max-width:800px;max-height:85vh;height:80vh;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-md);box-shadow:var(--shadow-lg);overflow:hidden}.document-overlay[data-v-6a3a554f]{position:fixed !important;top:0 !important;left:0 !important;right:0 !important;bottom:0 !important;z-index:10007 !important;padding:var(--spacing-md)}.document-overlay .document-modal[data-v-6a3a554f]{width:100%;max-width:800px;max-height:85vh;height:80vh;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-md);box-shadow:var(--shadow-lg);overflow:hidden}.changelog-overlay[data-v-6a3a554f]{position:fixed !important;top:0 !important;left:0 !important;right:0 !important;bottom:0 !important;z-index:10008 !important;padding:var(--spacing-md)}.changelog-overlay .changelog-modal[data-v-6a3a554f]{width:100%;max-width:700px;max-height:85vh;height:80vh;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-md);box-shadow:var(--shadow-lg);overflow:hidden}.variable-manager-overlay[data-v-6a3a554f]{position:fixed !important;top:0 !important;left:0 !important;right:0 !important;bottom:0 !important;z-index:10009 !important;padding:var(--spacing-md)}.variable-manager-overlay .variable-manager-modal[data-v-6a3a554f]{width:100%;max-width:900px;max-height:90vh;height:85vh;background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-md);box-shadow:var(--shadow-lg);overflow:hidden}.auto-save-indicator[data-v-6a3a554f]{position:fixed;bottom:80px;right:20px;display:flex;align-items:center;gap:8px;padding:10px 16px;background:var(--bg-secondary);border:1px solid var(--success-color,#4caf50);border-radius:var(--radius-md);box-shadow:var(--shadow-md);opacity:0;transform:translateY(20px);transition:all .3s ease;z-index:9998}.auto-save-indicator.visible[data-v-6a3a554f]{opacity:1;transform:translateY(0)}.auto-save-indicator .icon[data-v-6a3a554f]{font-size:16px}.auto-save-indicator .text[data-v-6a3a554f]{font-size:12px;color:var(--text-secondary);max-width:200px;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.sidebar-overlay[data-v-6a3a554f]{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.3);z-index:99;animation:fadeIn-6a3a554f .2s ease}.mobile-menu-fab[data-v-6a3a554f]{position:fixed;right:12px;top:50%;transform:translateY(-50%);width:40px;height:40px;border-radius:var(--radius-sm);background:var(--primary-color);color:#fff;border:none;box-shadow:0 2px 8px rgba(99,102,241,.4);cursor:pointer;z-index:98;display:flex;align-items:center;justify-content:center;transition:all var(--transition-fast)}.mobile-menu-fab .fab-icon[data-v-6a3a554f]{font-size:18px;line-height:1}.mobile-menu-fab[data-v-6a3a554f]:hover{transform:translateY(-50%) scale(1.05);box-shadow:0 4px 12px rgba(99,102,241,.5)}.mobile-menu-fab[data-v-6a3a554f]:active{transform:translateY(-50%) scale(0.95)}@media (max-width:480px){.mobile-menu-fab[data-v-6a3a554f]{width:36px;height:36px;right:8px}.mobile-menu-fab .fab-icon[data-v-6a3a554f]{font-size:16px}}@media (max-width:768px){.main-area[data-v-6a3a554f]{position:relative}.modal[data-v-6a3a554f]{width:95%;max-height:90vh}.fullscreen-modal[data-v-6a3a554f]{padding:var(--spacing-sm)}.fullscreen-modal .ai-filter-modal[data-v-6a3a554f]{height:95vh}.save-manager-overlay .save-manager-modal[data-v-6a3a554f]{width:95%;height:90vh;max-height:90vh}.history-text-overlay[data-v-6a3a554f]{padding:var(--spacing-sm)}.history-text-overlay .history-text-modal[data-v-6a3a554f]{width:100%;height:85vh;max-height:90vh;border-radius:var(--radius-sm)}.auto-save-indicator[data-v-6a3a554f]{bottom:100px;right:10px;left:10px}.auto-save-indicator .text[data-v-6a3a554f]{max-width:none}.game-layout.sidebar-open .mobile-menu-fab[data-v-6a3a554f]{opacity:0;pointer-events:none}}@media (max-width:480px){.history-text-overlay[data-v-6a3a554f]{padding:var(--spacing-xs)}.history-text-overlay .history-text-modal[data-v-6a3a554f]{height:90vh;max-height:95vh;border-radius:var(--radius-xs)}.save-manager-overlay[data-v-6a3a554f]{padding:var(--spacing-xs)}.save-manager-overlay .save-manager-modal[data-v-6a3a554f]{width:100%;height:92vh;max-height:95vh}.context-manager-overlay[data-v-6a3a554f]{padding:var(--spacing-xs)}.context-manager-overlay .context-manager-modal[data-v-6a3a554f]{width:100%;max-height:90vh}.help-overlay[data-v-6a3a554f]{padding:var(--spacing-xs)}.help-overlay .help-modal[data-v-6a3a554f]{width:100%;max-height:80vh}}
.error-boundary[data-v-7b143150]{display:flex;align-items:center;justify-content:center;min-height:200px;padding:var(--spacing-lg)}.error-content[data-v-7b143150]{max-width:500px;text-align:center;padding:var(--spacing-xl);background:var(--bg-secondary);border:1px solid var(--border-color);border-radius:var(--radius-md)}.error-icon[data-v-7b143150]{font-size:48px;margin-bottom:var(--spacing-md)}.error-title[data-v-7b143150]{margin:0 0 var(--spacing-sm);color:var(--text-color);font-size:var(--font-lg);font-weight:600}.error-message[data-v-7b143150]{margin:0 0 var(--spacing-lg);color:var(--text-secondary);font-size:var(--font-sm);line-height:1.5}.error-actions[data-v-7b143150]{display:flex;justify-content:center;gap:var(--spacing-sm);margin-bottom:var(--spacing-md)}.error-details[data-v-7b143150]{text-align:left;margin-top:var(--spacing-md)}.error-details summary[data-v-7b143150]{cursor:pointer;color:var(--text-secondary);font-size:var(--font-xs);padding:var(--spacing-sm)}.error-details summary[data-v-7b143150]:hover{color:var(--text-color)}.error-details pre[data-v-7b143150]{margin-top:var(--spacing-sm);padding:var(--spacing-md);background:var(--bg-tertiary);border-radius:var(--radius-sm);font-size:var(--font-xs);color:var(--text-secondary);overflow-x:auto;white-space:pre-wrap;word-break:break-all;max-height:200px;overflow-y:auto}
.confirm-dialog-overlay[data-v-61be8e67]{position:fixed !important;top:0 !important;left:0 !important;right:0 !important;bottom:0 !important;background:rgba(0,0,0,.5);backdrop-filter:blur(2px);display:flex;align-items:center;justify-content:center;z-index:10010 !important;padding:var(--spacing-md,16px)}.confirm-dialog[data-v-61be8e67]{background:var(--bg-secondary,#ffffff);border-radius:var(--radius-lg,8px);box-shadow:var(--shadow-lg,0 10px 20px rgba(0,0,0,0.12));max-width:420px;width:100%;overflow:hidden;animation:dialog-enter-61be8e67 .2s ease-out}.confirm-dialog.type-info[data-v-61be8e67]{--dialog-accent:var(--info-color,#1c71d8);--dialog-accent-light:var(--info-light,rgba(28,113,216,0.1))}.confirm-dialog.type-warning[data-v-61be8e67]{--dialog-accent:var(--warning-color,#e5a50a);--dialog-accent-light:var(--warning-light,rgba(229,165,10,0.1))}.confirm-dialog.type-danger[data-v-61be8e67]{--dialog-accent:var(--error-color,#c01c28);--dialog-accent-light:var(--error-light,rgba(192,28,40,0.1))}.confirm-dialog.type-success[data-v-61be8e67]{--dialog-accent:var(--success-color,#26a269);--dialog-accent-light:var(--success-light,rgba(38,162,105,0.1))}.dialog-header[data-v-61be8e67]{display:flex;align-items:center;gap:var(--spacing-sm,8px);padding:var(--spacing-lg,24px) var(--spacing-lg,24px) var(--spacing-sm,8px)}.dialog-icon[data-v-61be8e67]{font-size:28px;line-height:1;flex-shrink:0}.dialog-title[data-v-61be8e67]{margin:0;font-size:var(--font-lg,17px);font-weight:600;color:var(--text-color,#2e3436)}.dialog-body[data-v-61be8e67]{padding:var(--spacing-sm,8px) var(--spacing-lg,24px) var(--spacing-lg,24px)}.dialog-message[data-v-61be8e67]{margin:0;font-size:var(--font-md,15px);color:var(--text-secondary,#5e5c64);line-height:1.6;word-break:break-word}.dialog-footer[data-v-61be8e67]{display:flex;justify-content:flex-end;gap:var(--spacing-sm,8px);padding:var(--spacing-md,16px) var(--spacing-lg,24px);background:var(--bg-tertiary,#f6f5f4);border-top:1px solid var(--border-light,#e5e5e5)}.btn[data-v-61be8e67]{display:inline-flex;align-items:center;justify-content:center;gap:var(--spacing-xs,4px);padding:var(--spacing-sm,8px) var(--spacing-lg,24px);font-size:var(--font-sm,13px);font-weight:500;border-radius:var(--radius-md,6px);border:none;cursor:pointer;transition:all var(--transition-fast,0.1s ease);min-width:80px}.btn[data-v-61be8e67]:disabled{opacity:.6;cursor:not-allowed}.btn-cancel[data-v-61be8e67]{background:var(--bg-color,#f6f5f4);color:var(--text-color,#2e3436);border:1px solid var(--border-color,#c0bfbc)}.btn-cancel[data-v-61be8e67]:hover:not(:disabled){background:var(--bg-hover,#f0f0f0);border-color:var(--border-hover,#9a9996)}.btn-cancel[data-v-61be8e67]:active:not(:disabled){background:var(--bg-tertiary,#deddda)}.btn-confirm[data-v-61be8e67]{background:var(--dialog-accent,var(--primary-color,#1a5fb4));color:#fff}.btn-confirm[data-v-61be8e67]:hover:not(:disabled){filter:brightness(1.1)}.btn-confirm[data-v-61be8e67]:active:not(:disabled){filter:brightness(0.95)}.btn-confirm.btn-info[data-v-61be8e67]{background:var(--info-color,#1c71d8)}.btn-confirm.btn-warning[data-v-61be8e67]{background:var(--warning-color,#e5a50a);color:var(--text-highlight,#000)}.btn-confirm.btn-danger[data-v-61be8e67]{background:var(--error-color,#c01c28)}.btn-confirm.btn-success[data-v-61be8e67]{background:var(--success-color,#26a269)}.loading-spinner[data-v-61be8e67]{width:14px;height:14px;border:2px solid hsla(0,0%,100%,.3);border-top-color:#fff;border-radius:50%;animation:spin-61be8e67 .8s linear infinite}@keyframes spin-61be8e67{to{transform:rotate(360deg)}}@keyframes dialog-enter-61be8e67{from{opacity:0;transform:scale(0.95) translateY(-10px)}to{opacity:1;transform:scale(1) translateY(0)}}.confirm-dialog-enter-active[data-v-61be8e67],.confirm-dialog-leave-active[data-v-61be8e67]{transition:opacity .2s ease}.confirm-dialog-enter-from[data-v-61be8e67],.confirm-dialog-leave-to[data-v-61be8e67]{opacity:0}.confirm-dialog-enter-active .confirm-dialog[data-v-61be8e67]{animation:dialog-enter-61be8e67 .2s ease-out}.confirm-dialog-leave-active .confirm-dialog[data-v-61be8e67]{animation:dialog-enter-61be8e67 .15s ease-in reverse}@media (max-width:480px){.confirm-dialog[data-v-61be8e67]{max-width:calc(100vw - 32px)}.dialog-footer[data-v-61be8e67]{flex-direction:column-reverse}.btn[data-v-61be8e67]{width:100%}}:root.dark-theme .confirm-dialog[data-v-61be8e67]{background:var(--bg-secondary,#2d2d2d);box-shadow:0 10px 30px rgba(0,0,0,.4)}:root.dark-theme .dialog-title[data-v-61be8e67]{color:var(--text-color,#f5f5f5)}:root.dark-theme .dialog-message[data-v-61be8e67]{color:var(--text-secondary,#b0b0b0)}:root.dark-theme .dialog-footer[data-v-61be8e67]{background:var(--bg-tertiary,#3d3d3d);border-top-color:var(--border-color,#4d4d4d)}:root.dark-theme .btn-cancel[data-v-61be8e67]{background:var(--bg-color,#1e1e1e);color:var(--text-color,#f5f5f5);border-color:var(--border-color,#4d4d4d)}:root.dark-theme .btn-cancel[data-v-61be8e67]:hover:not(:disabled){background:var(--bg-hover,#3d3d3d)}
#app-container[data-v-9c83b896]{width:100%;height:100%;display:flex;flex-direction:column;overflow:hidden;background:var(--bg-color)}.loading-container[data-v-9c83b896]{display:flex;flex-direction:column;align-items:center;justify-content:center;height:100%;gap:var(--spacing-md);background:var(--bg-color)}.loading-spinner[data-v-9c83b896]{width:48px;height:48px;border:4px solid var(--border-color);border-top-color:var(--primary-color);border-radius:50%;animation:spin-9c83b896 .8s linear infinite}.loading-text[data-v-9c83b896]{color:var(--text-secondary);font-size:var(--font-md)}@keyframes spin-9c83b896{to{transform:rotate(360deg)}}
:root{--primary-color:#1a5fb4;--primary-hover:#3584e4;--primary-active:#154d93;--primary-light:rgba(26,95,180,0.1);--bg-color:#f6f5f4;--bg-secondary:#ffffff;--bg-tertiary:#deddda;--bg-panel:#ffffff;--bg-hover:#f0f0f0;--text-color:#2e3436;--text-secondary:#5e5c64;--text-disabled:#9a9996;--text-highlight:#000000;--border-color:#c0bfbc;--border-hover:#9a9996;--border-active:#77767b;--border-light:#e5e5e5;--success-color:#26a269;--success-hover:#2ec27e;--success-light:rgba(38,162,105,0.1);--warning-color:#e5a50a;--warning-hover:#f5c211;--warning-light:rgba(229,165,10,0.1);--error-color:#c01c28;--error-hover:#e01b24;--error-light:rgba(192,28,40,0.1);--danger-color:#c01c28;--danger-hover:#e01b24;--info-color:#1c71d8;--info-hover:#3584e4;--info-light:rgba(28,113,216,0.1);--office-header:#2c3e50;--office-sidebar:#34495e;--office-accent:#e74c3c;--office-gold:#d4af37;--office-stamp:#c0392b;--office-paper:#fffef5;--office-ink:#1a1a2e;--shadow-sm:0 1px 3px rgba(0,0,0,0.08);--shadow-md:0 4px 6px rgba(0,0,0,0.1);--shadow-lg:0 10px 20px rgba(0,0,0,0.12);--shadow-card:0 2px 8px rgba(0,0,0,0.06);--radius-xs:2px;--radius-sm:4px;--radius-md:6px;--radius-lg:8px;--spacing-xs:4px;--spacing-sm:8px;--spacing-md:16px;--spacing-lg:24px;--spacing-xl:32px;--spacing-xxl:48px;--font-xs:11px;--font-sm:13px;--font-md:15px;--font-lg:17px;--font-xl:20px;--font-2xl:24px;--handbook-bg:#fdfcf8;--handbook-text:#2c2c2c;--handbook-text-secondary:#5a5a5a;--handbook-text-muted:#8a8a8a;--handbook-accent:#1a4a7a;--handbook-divider:#b8b8b8;--handbook-border:#d4d0c8;--handbook-title-xl:22px;--handbook-title-lg:18px;--handbook-title-md:16px;--handbook-body:15px;--handbook-detail:14px;--handbook-sub-detail:13px;--handbook-line-height:2;--transition-fast:0.1s ease;--transition-normal:0.2s ease;--transition-slow:0.3s ease;--z-dropdown:100;--z-modal:200;--z-tooltip:300;--z-notification:400}:root.dark-theme{--primary-color:#3584e4;--primary-hover:#62a0ea;--primary-active:#1c71d8;--primary-light:rgba(53,132,228,0.15);--bg-color:#1e1e1e;--bg-secondary:#2d2d2d;--bg-tertiary:#3d3d3d;--bg-panel:#2d2d2d;--bg-hover:#3d3d3d;--text-color:#f5f5f5;--text-secondary:#b0b0b0;--text-disabled:#707070;--text-highlight:#ffffff;--border-color:#4d4d4d;--border-hover:#5d5d5d;--border-active:#6d6d6d;--border-light:#3d3d3d;--office-header:#1a1a2e;--office-sidebar:#252540;--office-paper:#2d2d3d;--shadow-sm:0 1px 3px rgba(0,0,0,0.3);--shadow-md:0 4px 6px rgba(0,0,0,0.4);--shadow-lg:0 10px 20px rgba(0,0,0,0.5);--shadow-card:0 2px 8px rgba(0,0,0,0.3);--handbook-bg:#1e1e24;--handbook-text:#e8e8e8;--handbook-text-secondary:#b0b0b0;--handbook-text-muted:#808080;--handbook-accent:#6ba3d6;--handbook-divider:#4a4a50;--handbook-border:#3a3a42}::-webkit-scrollbar{width:6px;height:6px}::-webkit-scrollbar-track{background:var(--bg-secondary);border-radius:var(--radius-xs)}::-webkit-scrollbar-thumb{background:var(--border-color);border-radius:var(--radius-xs)}::-webkit-scrollbar-thumb:hover{background:var(--border-hover)}.btn{display:inline-flex;align-items:center;justify-content:center;padding:var(--spacing-sm) var(--spacing-md);border:1px solid rgba(0,0,0,0);border-radius:var(--radius-sm);font-size:var(--font-sm);font-weight:500;cursor:pointer;transition:all var(--transition-fast);gap:var(--spacing-xs);background:var(--bg-tertiary);color:var(--text-color)}.btn:hover:not(:disabled){transform:translateY(-1px);box-shadow:var(--shadow-sm)}.btn:active:not(:disabled){transform:translateY(0)}.btn:disabled{opacity:.5;cursor:not-allowed}.btn:focus{outline:none;box-shadow:0 0 0 2px var(--primary-color)}.btn-primary{background:var(--primary-color);color:#fff;border-color:var(--primary-color)}.btn-primary:hover:not(:disabled){background:var(--primary-hover);border-color:var(--primary-hover)}.btn-secondary{background:var(--bg-tertiary);color:var(--text-color);border-color:var(--border-color)}.btn-secondary:hover:not(:disabled){background:var(--border-color)}.btn-success{background:var(--success-color);color:#fff;border-color:var(--success-color)}.btn-success:hover:not(:disabled){background:var(--success-hover);border-color:var(--success-hover)}.btn-danger{background:var(--danger-color);color:#fff;border-color:var(--danger-color)}.btn-danger:hover:not(:disabled){background:var(--danger-hover);border-color:var(--danger-hover)}.btn-warning{background:var(--warning-color);color:#fff;border-color:var(--warning-color)}.btn-warning:hover:not(:disabled){background:var(--warning-hover);border-color:var(--warning-hover)}.btn-ghost{background:rgba(0,0,0,0);border-color:rgba(0,0,0,0);color:var(--text-secondary)}.btn-ghost:hover:not(:disabled){background:var(--bg-tertiary);color:var(--text-color)}.btn-sm{padding:var(--spacing-xs) var(--spacing-sm);font-size:var(--font-xs)}.btn-lg{padding:var(--spacing-md) var(--spacing-lg);font-size:var(--font-md)}.btn-icon{width:32px;height:32px;padding:0;border-radius:var(--radius-sm)}.input,.select,.textarea{width:100%;padding:var(--spacing-sm) var(--spacing-md);background:var(--bg-tertiary);border:1px solid var(--border-color);border-radius:var(--radius-sm);color:var(--text-color);font-size:var(--font-sm);transition:border-color var(--transition-fast),box-shadow var(--transition-fast)}.input:focus,.select:focus,.textarea:focus{outline:none;border-color:var(--primary-color);box-shadow:0 0 0 2px rgba(74,159,74,.2)}.input::placeholder,.select::placeholder,.textarea::placeholder{color:var(--text-disabled)}.input:disabled,.select:disabled,.textarea:disabled{opacity:.5;cursor:not-allowed;background:var(--bg-secondary)}.textarea{min-height:80px;resize:vertical;line-height:1.5}.select{cursor:pointer;-webkit-appearance:none;appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 12 12'%3E%3Cpath fill='%23a0a0a0' d='M6 8L1 3h10z'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 12px center;padding-right:36px}.checkbox,.radio{display:inline-flex;align-items:center;gap:var(--spacing-sm);cursor:pointer;font-size:var(--font-sm);color:var(--text-color)}.checkbox input,.radio input{width:16px;height:16px;margin:0;cursor:pointer;accent-color:var(--primary-color)}.card{background:var(--bg-secondary);border-radius:var(--radius-md);padding:var(--spacing-md);border:1px solid var(--border-color)}.card-header{display:flex;align-items:center;justify-content:space-between;padding-bottom:var(--spacing-md);margin-bottom:var(--spacing-md);border-bottom:1px solid var(--border-color)}.card-header h3,.card-header h4{margin:0;color:var(--text-color);font-weight:600}.card-body{color:var(--text-secondary);line-height:1.6}.card-footer{display:flex;align-items:center;justify-content:flex-end;gap:var(--spacing-sm);padding-top:var(--spacing-md);margin-top:var(--spacing-md);border-top:1px solid var(--border-color)}.panel{background:var(--bg-panel);border:2px solid var(--border-color);border-radius:var(--radius-sm);box-shadow:var(--shadow-md)}.panel-header{background:var(--bg-tertiary);padding:var(--spacing-sm) var(--spacing-md);border-bottom:1px solid var(--border-color);font-weight:600;color:var(--text-color)}.panel-body{padding:var(--spacing-md)}.badge{display:inline-flex;align-items:center;padding:2px 8px;border-radius:var(--radius-xs);font-size:var(--font-xs);font-weight:500}.badge-primary{background:rgba(74,159,74,.2);color:var(--primary-color)}.badge-success{background:rgba(92,184,92,.2);color:var(--success-color)}.badge-warning{background:rgba(240,173,78,.2);color:var(--warning-color)}.badge-danger{background:rgba(217,83,79,.2);color:var(--danger-color)}.badge-info{background:rgba(91,192,222,.2);color:var(--info-color)}.progress{width:100%;height:8px;background:var(--bg-tertiary);border-radius:var(--radius-xs);overflow:hidden}.progress-bar{height:100%;background:var(--primary-color);transition:width var(--transition-normal)}.progress-bar-success{background:var(--success-color)}.progress-bar-warning{background:var(--warning-color)}.progress-bar-danger{background:var(--danger-color)}.divider{height:1px;background:var(--border-color);margin:var(--spacing-md) 0}.divider-vertical{width:1px;height:100%;background:var(--border-color);margin:0 var(--spacing-md)}.text-center{text-align:center}.text-left{text-align:left}.text-right{text-align:right}.text-primary{color:var(--primary-color)}.text-secondary{color:var(--text-secondary)}.text-success{color:var(--success-color)}.text-warning{color:var(--warning-color)}.text-danger{color:var(--danger-color)}.text-info{color:var(--info-color)}.flex{display:flex}.flex-col{flex-direction:column}.flex-wrap{flex-wrap:wrap}.items-start{align-items:flex-start}.items-center{align-items:center}.items-end{align-items:flex-end}.justify-start{justify-content:flex-start}.justify-center{justify-content:center}.justify-end{justify-content:flex-end}.justify-between{justify-content:space-between}.flex-1{flex:1}.gap-xs{gap:var(--spacing-xs)}.gap-sm{gap:var(--spacing-sm)}.gap-md{gap:var(--spacing-md)}.gap-lg{gap:var(--spacing-lg)}.w-full{width:100%}.h-full{height:100%}.w-auto{width:auto}.h-auto{height:auto}.m-0{margin:0}.p-0{padding:0}.mt-sm{margin-top:var(--spacing-sm)}.mt-md{margin-top:var(--spacing-md)}.mb-sm{margin-bottom:var(--spacing-sm)}.mb-md{margin-bottom:var(--spacing-md)}@keyframes fadeIn{from{opacity:0}to{opacity:1}}@keyframes fadeOut{from{opacity:1}to{opacity:0}}@keyframes slideInUp{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}@keyframes slideInDown{from{opacity:0;transform:translateY(-10px)}to{opacity:1;transform:translateY(0)}}@keyframes pulse{0%,100%{opacity:1}50%{opacity:.5}}@keyframes spin{to{transform:rotate(360deg)}}.animate-fadeIn{animation:fadeIn var(--transition-normal)}.animate-slideInUp{animation:slideInUp var(--transition-normal)}.animate-slideInDown{animation:slideInDown var(--transition-normal)}.animate-pulse{animation:pulse 2s infinite}.animate-spin{animation:spin 1s linear infinite}.hidden{display:none !important}.visible{visibility:visible}.invisible{visibility:hidden}.overflow-hidden{overflow:hidden}.overflow-auto{overflow:auto}.overflow-scroll{overflow:scroll}.truncate{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}:root{--cb-dialogue-color:#1a5fb4;--cb-dialogue-bg:rgba(26,95,180,0.05);--cb-dialogue-border:rgba(26,95,180,0.2);--cb-dialogue-icon:"ğŸ’¬";--cb-thought-color:#8b5cf6;--cb-thought-bg:rgba(139,92,246,0.05);--cb-thought-border:rgba(139,92,246,0.15);--cb-thought-icon:"ğŸ’­";--cb-scenery-color:#059669;--cb-scenery-bg:rgba(5,150,105,0.05);--cb-scenery-border:rgba(5,150,105,0.15);--cb-scenery-icon:"ğŸï¸";--cb-system-color:#dc2626;--cb-system-bg:rgba(220,38,38,0.08);--cb-system-border:#dc2626;--cb-system-icon:"âš ï¸";--cb-text-color:var(--text-color,#2e3436);--cb-transition:0.15s ease;--cb-radius-sm:4px;--cb-radius-md:6px;--cb-radius-lg:8px}:root.dark-theme,.dark-theme{--cb-dialogue-color:#60a5fa;--cb-dialogue-bg:rgba(96,165,250,0.1);--cb-dialogue-border:rgba(96,165,250,0.3);--cb-thought-color:#a78bfa;--cb-thought-bg:rgba(167,139,250,0.1);--cb-thought-border:rgba(167,139,250,0.2);--cb-scenery-color:#34d399;--cb-scenery-bg:rgba(52,211,153,0.1);--cb-scenery-border:rgba(52,211,153,0.2);--cb-system-color:#f87171;--cb-system-bg:rgba(248,113,113,0.15);--cb-system-border:#f87171;--cb-text-color:var(--text-color,#f5f5f5)}.content-block-renderer{font-size:var(--font-md,15px);line-height:1.8;color:var(--cb-text-color);word-wrap:break-word;overflow-wrap:break-word}.content-block{display:inline;transition:all var(--cb-transition)}.content-block__icon{margin-right:4px;font-size:.9em;vertical-align:middle;opacity:.8}.content-block__content{vertical-align:baseline}.content-block--text{color:var(--cb-text-color)}.content-block--dialogue{display:inline-block;position:relative;color:var(--cb-dialogue-color);background:var(--cb-dialogue-bg);border-left:3px solid var(--cb-dialogue-border);border-radius:0 var(--cb-radius-sm) var(--cb-radius-sm) 0;padding:6px 12px;margin:4px 2px}.content-block--dialogue::before{content:"ã€Œ";position:absolute;left:-2px;top:-4px;font-size:1.5em;color:var(--cb-dialogue-border);opacity:.4;font-weight:bold}.content-block--dialogue:hover{background:var(--cb-dialogue-bg);border-left-color:var(--cb-dialogue-color);transform:translateX(2px);box-shadow:-2px 2px 8px rgba(26,95,180,.15)}.content-block--thought{display:inline-block;color:var(--cb-thought-color);background:var(--cb-thought-bg);font-style:italic;padding:4px 10px;margin:2px;border-radius:var(--cb-radius-sm);position:relative}.content-block--thought::after{content:"";position:absolute;bottom:2px;left:10%;right:10%;height:2px;background:linear-gradient(90deg,transparent 0%,var(--cb-thought-border) 20%,var(--cb-thought-color) 50%,var(--cb-thought-border) 80%,transparent 100%);opacity:.3;border-radius:1px}.content-block--thought .content-block__icon{animation:thoughtBubble 2s ease-in-out infinite}.content-block--thought:hover{background:rgba(139,92,246,.1)}.content-block--thought:hover::after{opacity:.5}@keyframes thoughtBubble{0%,100%{transform:translateY(0);opacity:.8}50%{transform:translateY(-2px);opacity:1}}.content-block--scenery{display:block;color:var(--cb-scenery-color);background:var(--cb-scenery-bg);border:1px dashed var(--cb-scenery-border);border-radius:var(--cb-radius-md);padding:12px 16px;margin:10px 0;line-height:1.9;position:relative}.content-block--scenery::before,.content-block--scenery::after{content:"";position:absolute;width:12px;height:12px;border:2px solid var(--cb-scenery-border);opacity:.4}.content-block--scenery::before{top:-1px;left:-1px;border-right:none;border-bottom:none;border-radius:var(--cb-radius-sm) 0 0 0}.content-block--scenery::after{bottom:-1px;right:-1px;border-left:none;border-top:none;border-radius:0 0 var(--cb-radius-sm) 0}.content-block--scenery:hover{border-style:solid;box-shadow:0 4px 12px rgba(5,150,105,.1)}.content-block--scenery:hover::before,.content-block--scenery:hover::after{opacity:.7}.content-block--scenery .content-block__content{display:block;text-indent:2em}.content-block--system{display:block;color:var(--cb-system-color);background:var(--cb-system-bg);border:2px solid var(--cb-system-border);border-radius:var(--cb-radius-lg);padding:14px 20px;margin:12px 0;text-align:center;font-weight:600;position:relative;overflow:hidden}.content-block--system::before{content:"";position:absolute;top:0;left:0;right:0;height:4px;background:repeating-linear-gradient(90deg,var(--cb-system-color),var(--cb-system-color) 10px,transparent 10px,transparent 20px);opacity:.3}.content-block--system .content-block__icon{font-size:1.2em;margin-right:8px;animation:systemPulse 1.5s ease-in-out infinite}.content-block--system:hover{transform:scale(1.01);box-shadow:0 4px 16px rgba(220,38,38,.2)}.content-block--system:hover::before{opacity:.5}@keyframes systemPulse{0%,100%{transform:scale(1)}50%{transform:scale(1.1)}}.streaming-cursor{display:inline-block;color:var(--primary-color,#1a5fb4);font-weight:bold;animation:cursorBlink 1s step-end infinite;margin-left:2px}@keyframes cursorBlink{0%,50%{opacity:1}51%,100%{opacity:0}}.content-block--animated{animation:blockFadeIn .3s ease-out}@keyframes blockFadeIn{from{opacity:0;transform:translateY(4px)}to{opacity:1;transform:translateY(0)}}@media print{.content-block{background:none !important;border:none !important;padding:0 !important;margin:0 !important}.content-block::before,.content-block::after{display:none !important}.content-block--dialogue::before{display:inline !important;content:"ã€Œ" !important;position:static !important}.content-block--dialogue::after{content:"ã€" !important}.content-block--scenery::before{content:"ã€" !important}.content-block--scenery::after{content:"ã€‘" !important}.content-block--system{border:1px solid #000 !important;text-align:center}.streaming-cursor{display:none !important}}@media (max-width:768px){.content-block--dialogue{padding:4px 8px;margin:2px 1px}.content-block--dialogue::before{font-size:1.2em}.content-block--thought{padding:3px 8px}.content-block--scenery{padding:8px 12px;margin:8px 0}.content-block--scenery .content-block__content{text-indent:1em}.content-block--system{padding:10px 14px;margin:8px 0}}@media (prefers-reduced-motion:reduce){.content-block,.content-block--animated,.streaming-cursor,.content-block__icon{animation:none !important;transition:none !important}}@media (prefers-contrast:high){:root{--cb-dialogue-color:#0055cc;--cb-dialogue-bg:rgba(0,85,204,0.15);--cb-dialogue-border:#0055cc;--cb-thought-color:#6b21a8;--cb-thought-bg:rgba(107,33,168,0.15);--cb-scenery-color:#047857;--cb-scenery-bg:rgba(4,120,87,0.15);--cb-scenery-border:#047857;--cb-system-color:#b91c1c;--cb-system-bg:rgba(185,28,28,0.15);--cb-system-border:#b91c1c}.content-block{border-width:2px !important}}*,*::before,*::after{margin:0;padding:0;box-sizing:border-box}html,body{width:100%;height:100%;font-family:"Microsoft YaHei",-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Oxygen","Ubuntu","Cantarell","Fira Sans","Droid Sans","Helvetica Neue",sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;background-color:var(--bg-color);color:var(--text-color);font-size:var(--font-md);line-height:1.5;overflow:hidden}#app{width:100%;height:100%;display:flex;flex-direction:column}.no-select{user-select:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none}input,textarea,.selectable{user-select:text;-webkit-user-select:text;-moz-user-select:text;-ms-user-select:text}a{color:var(--primary-color);text-decoration:none;transition:color var(--transition-fast)}a:hover{color:var(--primary-hover);text-decoration:underline}ul,ol{list-style:none}img{max-width:100%;height:auto;vertical-align:middle}code,pre{font-family:"Consolas","Monaco","Courier New",monospace;background:var(--bg-tertiary);border-radius:var(--radius-xs)}code{padding:2px 6px;font-size:var(--font-sm)}pre{padding:var(--spacing-md);overflow-x:auto}pre code{padding:0;background:none}table{width:100%;border-collapse:collapse;background:var(--bg-secondary)}table th,table td{padding:var(--spacing-sm) var(--spacing-md);border:1px solid var(--border-color);text-align:left}table th{background:var(--bg-tertiary);font-weight:600;color:var(--text-color)}table tr:hover{background:var(--bg-tertiary)}:focus-visible{outline:2px solid var(--primary-color);outline-offset:2px}.loading-spinner{width:32px;height:32px;border:3px solid var(--border-color);border-top-color:var(--primary-color);border-radius:50%;animation:spin .8s linear infinite}.loading-container{display:flex;flex-direction:column;align-items:center;justify-content:center;gap:var(--spacing-md);min-height:200px}.loading-container p{color:var(--text-secondary);font-size:var(--font-sm)}.pixel-border{border:2px solid var(--border-color);box-shadow:inset 2px 2px 0 hsla(0,0%,100%,.1),inset -2px -2px 0 rgba(0,0,0,.2)}.mc-btn{display:inline-flex;align-items:center;justify-content:center;padding:var(--spacing-sm) var(--spacing-lg);background:linear-gradient(180deg,var(--bg-tertiary) 0%,var(--bg-secondary) 100%);border:2px solid var(--border-color);border-radius:0;color:var(--text-color);font-size:var(--font-sm);font-weight:500;cursor:pointer;transition:all var(--transition-fast);box-shadow:inset 1px 1px 0 hsla(0,0%,100%,.1),inset -1px -1px 0 rgba(0,0,0,.2)}.mc-btn:hover:not(:disabled){background:linear-gradient(180deg,var(--border-color) 0%,var(--bg-tertiary) 100%);border-color:var(--border-hover)}.mc-btn:active:not(:disabled){box-shadow:inset -1px -1px 0 hsla(0,0%,100%,.1),inset 1px 1px 0 rgba(0,0,0,.2)}.mc-btn:disabled{opacity:.5;cursor:not-allowed}.tooltip{position:absolute;padding:var(--spacing-xs) var(--spacing-sm);background:var(--bg-tertiary);border:1px solid var(--border-color);border-radius:var(--radius-sm);font-size:var(--font-xs);color:var(--text-color);white-space:nowrap;z-index:var(--z-tooltip);box-shadow:var(--shadow-md);pointer-events:none}.overlay{position:fixed;top:0;left:0;right:0;bottom:0;background:rgba(0,0,0,.6);z-index:var(--z-modal);display:flex;align-items:center;justify-content:center}.modal{background:var(--bg-secondary);border:2px solid var(--border-color);border-radius:var(--radius-md);box-shadow:var(--shadow-lg);max-width:90vw;max-height:90vh;overflow:auto}.modal-header{display:flex;align-items:center;justify-content:space-between;padding:var(--spacing-md);border-bottom:1px solid var(--border-color)}.modal-header h3{margin:0;font-weight:600;color:var(--text-color)}.modal-body{padding:var(--spacing-md)}.modal-footer{display:flex;align-items:center;justify-content:flex-end;gap:var(--spacing-sm);padding:var(--spacing-md);border-top:1px solid var(--border-color)}
</style></head><body><div id="app"></div></body></html>